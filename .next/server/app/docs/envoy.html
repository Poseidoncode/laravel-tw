<!DOCTYPE html><!--mFHGnIr2wV_N13OtGl4eL--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/d0bdc467f6614b6a.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/080eab8e3bf47110.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs CN</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Envoy</h1><p class="text-xl text-muted-foreground mt-2">Laravel Envoy 提供了簡潔的語法來定義在遠端伺服器上執行的任務</p></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="laravel-envoy"><a href="#laravel-envoy">Laravel Envoy</a></h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#writing-tasks">Writing Tasks</a>
<ul>
<li><a href="#defining-tasks">Defining Tasks</a></li>
<li><a href="#multiple-servers">Multiple Servers</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#variables">Variables</a></li>
<li><a href="#stories">Stories</a></li>
<li><a href="#completion-hooks">Hooks</a></li>
</ul>
</li>
<li><a href="#running-tasks">Running Tasks</a>
<ul>
<li><a href="#confirming-task-execution">Confirming Task Execution</a></li>
</ul>
</li>
<li><a href="#notifications">Notifications</a>
<ul>
<li><a href="#slack">Slack</a></li>
<li><a href="#discord">Discord</a></li>
<li><a href="#telegram">Telegram</a></li>
<li><a href="#microsoft-teams">Microsoft Teams</a></li>
</ul>
</li>
</ul>
<a name="introduction"></a>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p><a href="https://github.com/laravel/envoy">Laravel Envoy</a> is a tool for executing common tasks you run on your remote servers. Using <a href="/docs/12.x/blade">Blade</a> style syntax, you can easily setup tasks for deployment, Artisan commands, and more. Currently, Envoy only supports the Mac and Linux operating systems. However, Windows support is achievable using <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">WSL2</a>.</p>
<a name="installation"></a>
<h2 id="安裝"><a href="#安裝">安裝</a></h2>
<p>First, install Envoy into your project using the Composer package manager:</p>
<pre><code class="language-shell">composer require laravel/envoy --dev
</code></pre>
<p>Once Envoy has been installed, the Envoy binary will be available in your application&#x27;s <code>vendor/bin</code> directory:</p>
<pre><code class="language-shell">php vendor/bin/envoy
</code></pre>
<a name="writing-tasks"></a>
<h2 id="writing-tasks"><a href="#writing-tasks">Writing Tasks</a></h2>
<a name="defining-tasks"></a>
<h3 id="defining-tasks"><a href="#defining-tasks">Defining Tasks</a></h3>
<p>Tasks are the basic building block of Envoy. Tasks define the shell commands that should execute on your remote servers when the task is invoked. For example, you might define a task that executes the <code>php artisan queue:restart</code> command on all of your application&#x27;s queue worker servers.</p>
<p>All of your Envoy tasks should be defined in an <code>Envoy.blade.php</code> file at the root of your application. Here&#x27;s an example to get you started:</p>
<pre><code class="language-blade">@servers([&#x27;web&#x27; =&gt; [&#x27;user@192.168.1.1&#x27;], &#x27;workers&#x27; =&gt; [&#x27;user@192.168.1.2&#x27;]])

@task(&#x27;restart-queues&#x27;, [&#x27;on&#x27; =&gt; &#x27;workers&#x27;])
    cd /home/user/example.com
    php artisan queue:restart
@endtask
</code></pre>
<p>As you can see, an array of <code>@servers</code> is defined at the top of the file, allowing you to reference these servers via the <code>on</code> option of your task declarations. The <code>@servers</code> declaration should always be placed on a single line. Within your <code>@task</code> declarations, you should place the shell commands that should execute on your servers when the task is invoked.</p>
<a name="local-tasks"></a>
<h4 id="local-tasks"><a href="#local-tasks">Local Tasks</a></h4>
<p>You can force a script to run on your local computer by specifying the server&#x27;s IP address as <code>127.0.0.1</code>:</p>
<pre><code class="language-blade">@servers([&#x27;localhost&#x27; =&gt; &#x27;127.0.0.1&#x27;])
</code></pre>
<a name="importing-envoy-tasks"></a>
<h4 id="importing-envoy-tasks"><a href="#importing-envoy-tasks">Importing Envoy Tasks</a></h4>
<p>Using the <code>@import</code> directive, you may import other Envoy files so their stories and tasks are added to yours. After the files have been imported, you may execute the tasks they contain as if they were defined in your own Envoy file:</p>
<pre><code class="language-blade">@import(&#x27;vendor/package/Envoy.blade.php&#x27;)
</code></pre>
<a name="multiple-servers"></a>
<h3 id="multiple-servers"><a href="#multiple-servers">Multiple Servers</a></h3>
<p>Envoy allows you to easily run a task across multiple servers. First, add additional servers to your <code>@servers</code> declaration. Each server should be assigned a unique name. Once you have defined your additional servers you may list each of the servers in the task&#x27;s <code>on</code> array:</p>
<pre><code class="language-blade">@servers([&#x27;web-1&#x27; =&gt; &#x27;192.168.1.1&#x27;, &#x27;web-2&#x27; =&gt; &#x27;192.168.1.2&#x27;])

@task(&#x27;deploy&#x27;, [&#x27;on&#x27; =&gt; [&#x27;web-1&#x27;, &#x27;web-2&#x27;]])
    cd /home/user/example.com
    git pull origin {{ $branch }}
    php artisan migrate --force
@endtask
</code></pre>
<a name="parallel-execution"></a>
<h4 id="parallel-execution"><a href="#parallel-execution">Parallel Execution</a></h4>
<p>By default, tasks will be executed on each server serially. In other words, a task will finish running on the first server before proceeding to execute on the second server. If you would like to run a task across multiple servers in parallel, add the <code>parallel</code> option to your task declaration:</p>
<pre><code class="language-blade">@servers([&#x27;web-1&#x27; =&gt; &#x27;192.168.1.1&#x27;, &#x27;web-2&#x27; =&gt; &#x27;192.168.1.2&#x27;])

@task(&#x27;deploy&#x27;, [&#x27;on&#x27; =&gt; [&#x27;web-1&#x27;, &#x27;web-2&#x27;], &#x27;parallel&#x27; =&gt; true])
    cd /home/user/example.com
    git pull origin {{ $branch }}
    php artisan migrate --force
@endtask
</code></pre>
<a name="setup"></a>
<h3 id="setup"><a href="#setup">Setup</a></h3>
<p>Sometimes, you may need to execute arbitrary PHP code before running your Envoy tasks. You may use the <code>@setup</code> directive to define a block of PHP code that should execute before your tasks:</p>
<pre><code class="language-php">@setup
    $now = new DateTime;
@endsetup
</code></pre>
<p>If you need to require other PHP files before your task is executed, you may use the <code>@include</code> directive at the top of your <code>Envoy.blade.php</code> file:</p>
<pre><code class="language-blade">@include(&#x27;vendor/autoload.php&#x27;)

@task(&#x27;restart-queues&#x27;)
    # ...
@endtask
</code></pre>
<a name="variables"></a>
<h3 id="variables"><a href="#variables">Variables</a></h3>
<p>If needed, you may pass arguments to Envoy tasks by specifying them on the command line when invoking Envoy:</p>
<pre><code class="language-shell">php vendor/bin/envoy run deploy --branch=master
</code></pre>
<p>You may access the options within your tasks using Blade&#x27;s &quot;echo&quot; syntax. You may also define Blade <code>if</code> statements and loops within your tasks. For example, let&#x27;s verify the presence of the <code>$branch</code> variable before executing the <code>git pull</code> command:</p>
<pre><code class="language-blade">@servers([&#x27;web&#x27; =&gt; [&#x27;user@192.168.1.1&#x27;]])

@task(&#x27;deploy&#x27;, [&#x27;on&#x27; =&gt; &#x27;web&#x27;])
    cd /home/user/example.com

    @if ($branch)
        git pull origin {{ $branch }}
    @endif

    php artisan migrate --force
@endtask
</code></pre>
<a name="stories"></a>
<h3 id="stories"><a href="#stories">Stories</a></h3>
<p>Stories group a set of tasks under a single, convenient name. For instance, a <code>deploy</code> story may run the <code>update-code</code> and <code>install-dependencies</code> tasks by listing the task names within its definition:</p>
<pre><code class="language-blade">@servers([&#x27;web&#x27; =&gt; [&#x27;user@192.168.1.1&#x27;]])

@story(&#x27;deploy&#x27;)
    update-code
    install-dependencies
@endstory

@task(&#x27;update-code&#x27;)
    cd /home/user/example.com
    git pull origin master
@endtask

@task(&#x27;install-dependencies&#x27;)
    cd /home/user/example.com
    composer install
@endtask
</code></pre>
<p>Once the story has been written, you may invoke it in the same way you would invoke a task:</p>
<pre><code class="language-shell">php vendor/bin/envoy run deploy
</code></pre>
<a name="completion-hooks"></a>
<h3 id="hooks"><a href="#hooks">Hooks</a></h3>
<p>When tasks and stories run, a number of hooks are executed. The hook types supported by Envoy are <code>@before</code>, <code>@after</code>, <code>@error</code>, <code>@success</code>, and <code>@finished</code>. All of the code in these hooks is interpreted as PHP and executed locally, not on the remote servers that your tasks interact with.</p>
<p>You may define as many of each of these hooks as you like. They will be executed in the order that they appear in your Envoy script.</p>
<a name="hook-before"></a>
<h4 id="before"><a href="#before"><code>@before</code></a></h4>
<p>Before each task execution, all of the <code>@before</code> hooks registered in your Envoy script will execute. The <code>@before</code> hooks receive the name of the task that will be executed:</p>
<pre><code class="language-blade">@before
    if ($task === &#x27;deploy&#x27;) {
        // ...
    }
@endbefore
</code></pre>
<a name="completion-after"></a>
<h4 id="after"><a href="#after"><code>@after</code></a></h4>
<p>After each task execution, all of the <code>@after</code> hooks registered in your Envoy script will execute. The <code>@after</code> hooks receive the name of the task that was executed:</p>
<pre><code class="language-blade">@after
    if ($task === &#x27;deploy&#x27;) {
        // ...
    }
@endafter
</code></pre>
<a name="completion-error"></a>
<h4 id="error"><a href="#error"><code>@error</code></a></h4>
<p>After every task failure (exits with a status code greater than <code>0</code>), all of the <code>@error</code> hooks registered in your Envoy script will execute. The <code>@error</code> hooks receive the name of the task that was executed:</p>
<pre><code class="language-blade">@error
    if ($task === &#x27;deploy&#x27;) {
        // ...
    }
@enderror
</code></pre>
<a name="completion-success"></a>
<h4 id="success"><a href="#success"><code>@success</code></a></h4>
<p>If all tasks have executed without errors, all of the <code>@success</code> hooks registered in your Envoy script will execute:</p>
<pre><code class="language-blade">@success
    // ...
@endsuccess
</code></pre>
<a name="completion-finished"></a>
<h4 id="finished"><a href="#finished"><code>@finished</code></a></h4>
<p>After all tasks have been executed (regardless of exit status), all of the <code>@finished</code> hooks will be executed. The <code>@finished</code> hooks receive the status code of the completed task, which may be <code>null</code> or an <code>integer</code> greater than or equal to <code>0</code>:</p>
<pre><code class="language-blade">@finished
    if ($exitCode &gt; 0) {
        // There were errors in one of the tasks...
    }
@endfinished
</code></pre>
<a name="running-tasks"></a>
<h2 id="running-tasks"><a href="#running-tasks">Running Tasks</a></h2>
<p>To run a task or story that is defined in your application&#x27;s <code>Envoy.blade.php</code> file, execute Envoy&#x27;s <code>run</code> command, passing the name of the task or story you would like to execute. Envoy will execute the task and display the output from your remote servers as the task is running:</p>
<pre><code class="language-shell">php vendor/bin/envoy run deploy
</code></pre>
<a name="confirming-task-execution"></a>
<h3 id="confirming-task-execution"><a href="#confirming-task-execution">Confirming Task Execution</a></h3>
<p>If you would like to be prompted for confirmation before running a given task on your servers, you should add the <code>confirm</code> directive to your task declaration. This option is particularly useful for destructive operations:</p>
<pre><code class="language-blade">@task(&#x27;deploy&#x27;, [&#x27;on&#x27; =&gt; &#x27;web&#x27;, &#x27;confirm&#x27; =&gt; true])
    cd /home/user/example.com
    git pull origin {{ $branch }}
    php artisan migrate
@endtask
</code></pre>
<a name="notifications"></a>
<h2 id="notifications"><a href="#notifications">Notifications</a></h2>
<a name="slack"></a>
<h3 id="slack"><a href="#slack">Slack</a></h3>
<p>Envoy supports sending notifications to <a href="https://slack.com">Slack</a> after each task is executed. The <code>@slack</code> directive accepts a Slack hook URL and a channel / user name. You may retrieve your webhook URL by creating an &quot;Incoming WebHooks&quot; integration in your Slack control panel.</p>
<p>You should pass the entire webhook URL as the first argument given to the <code>@slack</code> directive. The second argument given to the <code>@slack</code> directive should be a channel name (<code>#channel</code>) or a user name (<code>@user</code>):</p>
<pre><code class="language-blade">@finished
    @slack(&#x27;webhook-url&#x27;, &#x27;#bots&#x27;)
@endfinished
</code></pre>
<p>By default, Envoy notifications will send a message to the notification channel describing the task that was executed. However, you may overwrite this message with your own custom message by passing a third argument to the <code>@slack</code> directive:</p>
<pre><code class="language-blade">@finished
    @slack(&#x27;webhook-url&#x27;, &#x27;#bots&#x27;, &#x27;Hello, Slack.&#x27;)
@endfinished
</code></pre>
<a name="discord"></a>
<h3 id="discord"><a href="#discord">Discord</a></h3>
<p>Envoy also supports sending notifications to <a href="https://discord.com">Discord</a> after each task is executed. The <code>@discord</code> directive accepts a Discord hook URL and a message. You may retrieve your webhook URL by creating a &quot;Webhook&quot; in your Server Settings and choosing which channel the webhook should post to. You should pass the entire Webhook URL into the <code>@discord</code> directive:</p>
<pre><code class="language-blade">@finished
    @discord(&#x27;discord-webhook-url&#x27;)
@endfinished
</code></pre>
<a name="telegram"></a>
<h3 id="telegram"><a href="#telegram">Telegram</a></h3>
<p>Envoy also supports sending notifications to <a href="https://telegram.org">Telegram</a> after each task is executed. The <code>@telegram</code> directive accepts a Telegram Bot ID and a Chat ID. You may retrieve your Bot ID by creating a new bot using <a href="https://t.me/botfather">BotFather</a>. You can retrieve a valid Chat ID using <a href="https://t.me/username_to_id_bot">@username_to_id_bot</a>. You should pass the entire Bot ID and Chat ID into the <code>@telegram</code> directive:</p>
<pre><code class="language-blade">@finished
    @telegram(&#x27;bot-id&#x27;,&#x27;chat-id&#x27;)
@endfinished
</code></pre>
<a name="microsoft-teams"></a>
<h3 id="microsoft-teams"><a href="#microsoft-teams">Microsoft Teams</a></h3>
<p>Envoy also supports sending notifications to <a href="https://www.microsoft.com/en-us/microsoft-teams">Microsoft Teams</a> after each task is executed. The <code>@microsoftTeams</code> directive accepts a Teams Webhook (required), a message, theme color (success, info, warning, error), and an array of options. You may retrieve your Teams Webhook by creating a new <a href="https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook">incoming webhook</a>. The Teams API has many other attributes to customize your message box like title, summary, and sections. You can find more information on the <a href="https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/connectors-using?tabs=cURL#example-of-connector-message">Microsoft Teams documentation</a>. You should pass the entire Webhook URL into the <code>@microsoftTeams</code> directive:</p>
<pre><code class="language-blade">@finished
    @microsoftTeams(&#x27;webhook-url&#x27;)
@endfinished
</code></pre></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/080eab8e3bf47110.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/d0bdc467f6614b6a.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"mFHGnIr2wV_N13OtGl4eL\",\"c\":[\"\",\"docs\",\"envoy\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"envoy\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/d0bdc467f6614b6a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/080eab8e3bf47110.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"Envoy\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-muted-foreground mt-2\",\"children\":\"Laravel Envoy 提供了簡潔的語法來定義在遠端伺服器上執行的任務\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"laravel-envoy\",\"children\":[\"$\",\"a\",null,{\"href\":\"#laravel-envoy\",\"children\":\"Laravel Envoy\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#introduction\",\"children\":\"Introduction\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#installation\",\"children\":\"Installation\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#writing-tasks\",\"children\":\"Writing Tasks\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-tasks\",\"children\":\"Defining Tasks\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#multiple-servers\",\"children\":\"Multiple Servers\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#setup\",\"children\":\"Setup\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#variables\",\"children\":\"Variables\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#stories\",\"children\":\"Stories\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#completion-hooks\",\"children\":\"Hooks\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#running-tasks\",\"children\":\"Running Tasks\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#confirming-task-execution\",\"children\":\"Confirming Task Execution\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#notifications\",\"children\":\"Notifications\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#slack\",\"children\":\"Slack\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#discord\",\"children\":\"Discord\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#telegram\",\"children\":\"Telegram\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#microsoft-teams\",\"children\":\"Microsoft Teams\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"introduction\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"簡介\",\"children\":[\"$\",\"a\",null,{\"href\":\"#簡介\",\"children\":\"簡介\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/laravel/envoy\",\"children\":\"Laravel Envoy\"}],\" is a tool for executing common tasks you run on your remote servers. Using \",[\"$\",\"a\",null,{\"href\":\"/docs/12.x/blade\",\"children\":\"Blade\"}],\" style syntax, you can easily setup tasks for deployment, Artisan commands, and more. Currently, Envoy only supports the Mac and Linux operating systems. However, Windows support is achievable using \",[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/windows/wsl/install-win10\",\"children\":\"WSL2\"}],\".\"]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"installation\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"安裝\",\"children\":[\"$\",\"a\",null,{\"href\":\"#安裝\",\"children\":\"安裝\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"First, install Envoy into your project using the Composer package manager:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"composer require laravel/envoy --dev\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Once Envoy has been installed, the Envoy binary will be available in your application's \",[\"$\",\"code\",null,{\"children\":\"vendor/bin\"}],\" directory:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php vendor/bin/envoy\\n\"}]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"writing-tasks\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"writing-tasks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#writing-tasks\",\"children\":\"Writing Tasks\"}]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"defining-tasks\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"defining-tasks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-tasks\",\"children\":\"Defining Tasks\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Tasks are the basic building block of Envoy. Tasks define the shell commands that should execute on your remote servers when the task is invoked. For example, you might define a task that executes the \",[\"$\",\"code\",null,{\"children\":\"php artisan queue:restart\"}],\" command on all of your application's queue worker servers.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"All of your Envoy tasks should be defined in an \",[\"$\",\"code\",null,{\"children\":\"Envoy.blade.php\"}],\" file at the root of your application. Here's an example to get you started:\"]}],\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['web' =\u003e ['user@192.168.1.1'], 'workers' =\u003e ['user@192.168.1.2']])\\n\\n@task('restart-queues', ['on' =\u003e 'workers'])\\n    cd /home/user/example.com\\n    php artisan queue:restart\\n@endtask\\n\"}]}]\nf:[\"$\",\"p\",null,{\"children\":[\"As you can see, an array of \",[\"$\",\"code\",null,{\"children\":\"@servers\"}],\" is defined at the top of the file, allowing you to reference these servers via the \",[\"$\",\"code\",null,{\"children\":\"on\"}],\" option of your task declarations. The \",[\"$\",\"code\",null,{\"children\":\"@servers\"}],\" declaration should always be placed on a single line. Within your \",[\"$\",\"code\",null,{\"children\":\"@task\"}],\" declarations, you should place the shell commands that should execute on your servers when the task is invoked.\"]}]\n10:[\"$\",\"a\",null,{\"name\":\"local-tasks\"}]\n11:[\"$\",\"h4\",null,{\"id\":\"local-tasks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#local-tasks\",\"children\":\"Local Tasks\"}]}]\n12:[\"$\",\"p\",null,{\"children\":[\"You can force a script to run on your local computer by specifying the server's IP address as \",[\"$\",\"code\",null,{\"children\":\"127.0.0.1\"}],\":\"]}]\n13:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['localhost' =\u003e '127.0.0.1'])\\n\"}]}]\n14:[\"$\",\"a\",null,{\"name\":\"importing-envoy-tasks\"}]\n15:[\"$\",\"h4\",null,{\"id\":\"importing-envoy-tasks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#importing-envoy-tasks\",\"children\":\"Importing Envoy Tasks\"}]}]\n16:[\"$\",\"p\",null,{\"children\":[\"Using the \",[\"$\",\"code\",null,{\"children\":\"@import\"}],\" directive, you may import other Envoy files so their stories and tasks are added to yours. After the files have been imported, you may execute the tasks they contain as if they were defined in your own Envoy file:\"]}]\n17:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@import('vendor/package/Envoy.blade.php')\\n\"}]}]\n18:[\"$\",\"a\",null,{\"name\":\"multiple-servers\"}]\n19:[\"$\",\"h3\",null,{\"id\":\"multiple-servers\",\"children\":[\"$\",\"a\",null,{\"href\":\"#multiple-servers\",\"children\":\"Multiple Servers\"}]}]\n1a:[\"$\",\"p\",null,{\"children\":[\"Envoy allows you to easily run a task across multiple servers. First, add additional servers to your \",[\"$\",\"code\",null,{\"children\":\"@servers\"}],\" declaration. Each server should be assigned a unique name. Once you have defined your additional servers you may list each of the servers in the task's \",[\"$\",\"code\",null,{\"children\":\"on\"}],\" array:\"]}]\n1b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['web-1' =\u003e '192.168.1.1', 'web-2' =\u003e '192.168.1.2'])\\n\\n@task('deploy', ['on' =\u003e ['web-1', 'web-2']])\\n    cd /home/user/example.com\\n    git pull origin {{ $branch }}\\n    php artisan migrate --force\\n@endtask\\n\"}]}]\n1c:[\"$\",\"a\",null,{\"name\":\"parallel-execution\"}]\n1d:[\"$\",\"h4\",null,{\"id\":\"parallel-execution\",\"children\":[\"$\",\"a\",null,{\"href\":\"#parallel-execution\",\"children\":\"Parallel Execution\"}]}]\n1e:[\"$\",\"p\",null,{\"children\":[\"By default, tasks will be executed on each server serially. In other words, a task will finish running on the first server before proceeding to execute on the second server. If you would like to run a task across multiple servers in parallel, add the \",[\"$\",\"code\",null,{\"children\":\"parallel\"}],\" option to your task declaration:\"]}]\n1f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['web-1' =\u003e '192.168.1.1', 'web-2' =\u003e '192.168.1.2'])\\n\\n@task('deploy', ['on' =\u003e ['web-1', 'web-2'], 'parallel' =\u003e true])\\n    cd /home/user/example.com\\n    git pull origin {{ $branch }}\\n    php artisan migrate --force\\n@endtask\\n\"}]}]\n20:[\"$\",\"a\",null,{\"name\":\"setup\"}]\n21:[\"$\",\"h3\",null,{\"id\":\"setup\",\"children\":[\"$\",\"a\",null,{\"href\":\"#setup\",\"children\":\"Setup\"}]}]\n22:[\"$\",\"p\",null,{\"children\":[\"Sometimes, you may need to execute arbitrary PHP code before running your Envoy tasks. You may use the \",[\"$\",\"code\",null,{\"children\":\"@setup\"}],\" directive to define a block of PHP code that should execute before your tasks:\"]}]\n23:["])</script><script>self.__next_f.push([1,"\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"@setup\\n    $now = new DateTime;\\n@endsetup\\n\"}]}]\n24:[\"$\",\"p\",null,{\"children\":[\"If you need to require other PHP files before your task is executed, you may use the \",[\"$\",\"code\",null,{\"children\":\"@include\"}],\" directive at the top of your \",[\"$\",\"code\",null,{\"children\":\"Envoy.blade.php\"}],\" file:\"]}]\n25:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@include('vendor/autoload.php')\\n\\n@task('restart-queues')\\n    # ...\\n@endtask\\n\"}]}]\n26:[\"$\",\"a\",null,{\"name\":\"variables\"}]\n27:[\"$\",\"h3\",null,{\"id\":\"variables\",\"children\":[\"$\",\"a\",null,{\"href\":\"#variables\",\"children\":\"Variables\"}]}]\n28:[\"$\",\"p\",null,{\"children\":\"If needed, you may pass arguments to Envoy tasks by specifying them on the command line when invoking Envoy:\"}]\n29:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php vendor/bin/envoy run deploy --branch=master\\n\"}]}]\n2a:[\"$\",\"p\",null,{\"children\":[\"You may access the options within your tasks using Blade's \\\"echo\\\" syntax. You may also define Blade \",[\"$\",\"code\",null,{\"children\":\"if\"}],\" statements and loops within your tasks. For example, let's verify the presence of the \",[\"$\",\"code\",null,{\"children\":\"$$branch\"}],\" variable before executing the \",[\"$\",\"code\",null,{\"children\":\"git pull\"}],\" command:\"]}]\n2b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['web' =\u003e ['user@192.168.1.1']])\\n\\n@task('deploy', ['on' =\u003e 'web'])\\n    cd /home/user/example.com\\n\\n    @if ($branch)\\n        git pull origin {{ $branch }}\\n    @endif\\n\\n    php artisan migrate --force\\n@endtask\\n\"}]}]\n2c:[\"$\",\"a\",null,{\"name\":\"stories\"}]\n2d:[\"$\",\"h3\",null,{\"id\":\"stories\",\"children\":[\"$\",\"a\",null,{\"href\":\"#stories\",\"children\":\"Stories\"}]}]\n2e:[\"$\",\"p\",null,{\"children\":[\"Stories group a set of tasks under a single, convenient name. For instance, a \",[\"$\",\"code\",null,{\"children\":\"deploy\"}],\" story may run the \",[\"$\",\"code\",null,{\"children\":\"update-code\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"install-dependencies\"}],\" tasks by listing the task names within its definition:\"]}]\n2f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@servers(['web' =\u003e ['user@192.168.1.1']])\\n\\n@story('deploy')\\n    update-code\\n    install-dependencies\\n@endstory\\n\\n@task('update-code')\\n    cd /home/user/example.com\\n    git pull origin master\\n@endtask\\n\\n@task('install-dependencies')\\n    cd /home/user/example.com\\n    composer install\\n@endtask\\n\"}]}]\n30:[\"$\",\"p\",null,{\"children\":\"Once the story has been written, you may invoke it in the same way you would invoke a task:\"}]\n31:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php vendor/bin/envoy run deploy\\n\"}]}]\n32:[\"$\",\"a\",null,{\"name\":\"completion-hooks\"}]\n33:[\"$\",\"h3\",null,{\"id\":\"hooks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#hooks\",\"children\":\"Hooks\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"When tasks and stories run, a number of hooks are executed. The hook types supported by Envoy are \",[\"$\",\"code\",null,{\"children\":\"@before\"}],\", \",[\"$\",\"code\",null,{\"children\":\"@after\"}],\", \",[\"$\",\"code\",null,{\"children\":\"@error\"}],\", \",[\"$\",\"code\",null,{\"children\":\"@success\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"@finished\"}],\". All of the code in these hooks is interpreted as PHP and executed locally, not on the remote servers that your tasks interact with.\"]}]\n35:[\"$\",\"p\",null,{\"children\":\"You may define as many of each of these hooks as you like. They will be executed in the order that they appear in your Envoy script.\"}]\n36:[\"$\",\"a\",null,{\"name\":\"hook-before\"}]\n37:[\"$\",\"h4\",null,{\"id\":\"before\",\"children\":[\"$\",\"a\",null,{\"href\":\"#before\",\"children\":[\"$\",\"code\",null,{\"children\":\"@before\"}]}]}]\n38:[\"$\",\"p\",null,{\"children\":[\"Before each task execution, all of the \",[\"$\",\"code\",null,{\"children\":\"@before\"}],\" hooks registered in your Envoy script will execute. The \",[\"$\",\"code\",null,{\"children\":\"@before\"}],\" hooks receive the name of the task that wil"])</script><script>self.__next_f.push([1,"l be executed:\"]}]\n39:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@before\\n    if ($task === 'deploy') {\\n        // ...\\n    }\\n@endbefore\\n\"}]}]\n3a:[\"$\",\"a\",null,{\"name\":\"completion-after\"}]\n3b:[\"$\",\"h4\",null,{\"id\":\"after\",\"children\":[\"$\",\"a\",null,{\"href\":\"#after\",\"children\":[\"$\",\"code\",null,{\"children\":\"@after\"}]}]}]\n3c:[\"$\",\"p\",null,{\"children\":[\"After each task execution, all of the \",[\"$\",\"code\",null,{\"children\":\"@after\"}],\" hooks registered in your Envoy script will execute. The \",[\"$\",\"code\",null,{\"children\":\"@after\"}],\" hooks receive the name of the task that was executed:\"]}]\n3d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@after\\n    if ($task === 'deploy') {\\n        // ...\\n    }\\n@endafter\\n\"}]}]\n3e:[\"$\",\"a\",null,{\"name\":\"completion-error\"}]\n3f:[\"$\",\"h4\",null,{\"id\":\"error\",\"children\":[\"$\",\"a\",null,{\"href\":\"#error\",\"children\":[\"$\",\"code\",null,{\"children\":\"@error\"}]}]}]\n40:[\"$\",\"p\",null,{\"children\":[\"After every task failure (exits with a status code greater than \",[\"$\",\"code\",null,{\"children\":\"0\"}],\"), all of the \",[\"$\",\"code\",null,{\"children\":\"@error\"}],\" hooks registered in your Envoy script will execute. The \",[\"$\",\"code\",null,{\"children\":\"@error\"}],\" hooks receive the name of the task that was executed:\"]}]\n41:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@error\\n    if ($task === 'deploy') {\\n        // ...\\n    }\\n@enderror\\n\"}]}]\n42:[\"$\",\"a\",null,{\"name\":\"completion-success\"}]\n43:[\"$\",\"h4\",null,{\"id\":\"success\",\"children\":[\"$\",\"a\",null,{\"href\":\"#success\",\"children\":[\"$\",\"code\",null,{\"children\":\"@success\"}]}]}]\n44:[\"$\",\"p\",null,{\"children\":[\"If all tasks have executed without errors, all of the \",[\"$\",\"code\",null,{\"children\":\"@success\"}],\" hooks registered in your Envoy script will execute:\"]}]\n45:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@success\\n    // ...\\n@endsuccess\\n\"}]}]\n46:[\"$\",\"a\",null,{\"name\":\"completion-finished\"}]\n47:[\"$\",\"h4\",null,{\"id\":\"finished\",\"children\":[\"$\",\"a\",null,{\"href\":\"#finished\",\"children\":[\"$\",\"code\",null,{\"children\":\"@finished\"}]}]}]\n48:[\"$\",\"p\",null,{\"children\":[\"After all tasks have been executed (regardless of exit status), all of the \",[\"$\",\"code\",null,{\"children\":\"@finished\"}],\" hooks will be executed. The \",[\"$\",\"code\",null,{\"children\":\"@finished\"}],\" hooks receive the status code of the completed task, which may be \",[\"$\",\"code\",null,{\"children\":\"null\"}],\" or an \",[\"$\",\"code\",null,{\"children\":\"integer\"}],\" greater than or equal to \",[\"$\",\"code\",null,{\"children\":\"0\"}],\":\"]}]\n49:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    if ($exitCode \u003e 0) {\\n        // There were errors in one of the tasks...\\n    }\\n@endfinished\\n\"}]}]\n4a:[\"$\",\"a\",null,{\"name\":\"running-tasks\"}]\n4b:[\"$\",\"h2\",null,{\"id\":\"running-tasks\",\"children\":[\"$\",\"a\",null,{\"href\":\"#running-tasks\",\"children\":\"Running Tasks\"}]}]\n4c:[\"$\",\"p\",null,{\"children\":[\"To run a task or story that is defined in your application's \",[\"$\",\"code\",null,{\"children\":\"Envoy.blade.php\"}],\" file, execute Envoy's \",[\"$\",\"code\",null,{\"children\":\"run\"}],\" command, passing the name of the task or story you would like to execute. Envoy will execute the task and display the output from your remote servers as the task is running:\"]}]\n4d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php vendor/bin/envoy run deploy\\n\"}]}]\n4e:[\"$\",\"a\",null,{\"name\":\"confirming-task-execution\"}]\n4f:[\"$\",\"h3\",null,{\"id\":\"confirming-task-execution\",\"children\":[\"$\",\"a\",null,{\"href\":\"#confirming-task-execution\",\"children\":\"Confirming Task Execution\"}]}]\n50:[\"$\",\"p\",null,{\"children\":[\"If you would like to be prompted for confirmation before running a given task on your servers, you should add the \",[\"$\",\"code\",null,{\"children\":\"confirm\"}],\" directive to your task declaration. This option is particularly useful for destructive operations:\"]}]\n51:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"l"])</script><script>self.__next_f.push([1,"anguage-blade\",\"children\":\"@task('deploy', ['on' =\u003e 'web', 'confirm' =\u003e true])\\n    cd /home/user/example.com\\n    git pull origin {{ $branch }}\\n    php artisan migrate\\n@endtask\\n\"}]}]\n52:[\"$\",\"a\",null,{\"name\":\"notifications\"}]\n53:[\"$\",\"h2\",null,{\"id\":\"notifications\",\"children\":[\"$\",\"a\",null,{\"href\":\"#notifications\",\"children\":\"Notifications\"}]}]\n54:[\"$\",\"a\",null,{\"name\":\"slack\"}]\n55:[\"$\",\"h3\",null,{\"id\":\"slack\",\"children\":[\"$\",\"a\",null,{\"href\":\"#slack\",\"children\":\"Slack\"}]}]\n56:[\"$\",\"p\",null,{\"children\":[\"Envoy supports sending notifications to \",[\"$\",\"a\",null,{\"href\":\"https://slack.com\",\"children\":\"Slack\"}],\" after each task is executed. The \",[\"$\",\"code\",null,{\"children\":\"@slack\"}],\" directive accepts a Slack hook URL and a channel / user name. You may retrieve your webhook URL by creating an \\\"Incoming WebHooks\\\" integration in your Slack control panel.\"]}]\n57:[\"$\",\"p\",null,{\"children\":[\"You should pass the entire webhook URL as the first argument given to the \",[\"$\",\"code\",null,{\"children\":\"@slack\"}],\" directive. The second argument given to the \",[\"$\",\"code\",null,{\"children\":\"@slack\"}],\" directive should be a channel name (\",[\"$\",\"code\",null,{\"children\":\"#channel\"}],\") or a user name (\",[\"$\",\"code\",null,{\"children\":\"@user\"}],\"):\"]}]\n58:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    @slack('webhook-url', '#bots')\\n@endfinished\\n\"}]}]\n59:[\"$\",\"p\",null,{\"children\":[\"By default, Envoy notifications will send a message to the notification channel describing the task that was executed. However, you may overwrite this message with your own custom message by passing a third argument to the \",[\"$\",\"code\",null,{\"children\":\"@slack\"}],\" directive:\"]}]\n5a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    @slack('webhook-url', '#bots', 'Hello, Slack.')\\n@endfinished\\n\"}]}]\n5b:[\"$\",\"a\",null,{\"name\":\"discord\"}]\n5c:[\"$\",\"h3\",null,{\"id\":\"discord\",\"children\":[\"$\",\"a\",null,{\"href\":\"#discord\",\"children\":\"Discord\"}]}]\n5d:[\"$\",\"p\",null,{\"children\":[\"Envoy also supports sending notifications to \",[\"$\",\"a\",null,{\"href\":\"https://discord.com\",\"children\":\"Discord\"}],\" after each task is executed. The \",[\"$\",\"code\",null,{\"children\":\"@discord\"}],\" directive accepts a Discord hook URL and a message. You may retrieve your webhook URL by creating a \\\"Webhook\\\" in your Server Settings and choosing which channel the webhook should post to. You should pass the entire Webhook URL into the \",[\"$\",\"code\",null,{\"children\":\"@discord\"}],\" directive:\"]}]\n5e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    @discord('discord-webhook-url')\\n@endfinished\\n\"}]}]\n5f:[\"$\",\"a\",null,{\"name\":\"telegram\"}]\n60:[\"$\",\"h3\",null,{\"id\":\"telegram\",\"children\":[\"$\",\"a\",null,{\"href\":\"#telegram\",\"children\":\"Telegram\"}]}]\n61:[\"$\",\"p\",null,{\"children\":[\"Envoy also supports sending notifications to \",[\"$\",\"a\",null,{\"href\":\"https://telegram.org\",\"children\":\"Telegram\"}],\" after each task is executed. The \",[\"$\",\"code\",null,{\"children\":\"@telegram\"}],\" directive accepts a Telegram Bot ID and a Chat ID. You may retrieve your Bot ID by creating a new bot using \",[\"$\",\"a\",null,{\"href\":\"https://t.me/botfather\",\"children\":\"BotFather\"}],\". You can retrieve a valid Chat ID using \",[\"$\",\"a\",null,{\"href\":\"https://t.me/username_to_id_bot\",\"children\":\"@username_to_id_bot\"}],\". You should pass the entire Bot ID and Chat ID into the \",[\"$\",\"code\",null,{\"children\":\"@telegram\"}],\" directive:\"]}]\n62:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    @telegram('bot-id','chat-id')\\n@endfinished\\n\"}]}]\n63:[\"$\",\"a\",null,{\"name\":\"microsoft-teams\"}]\n64:[\"$\",\"h3\",null,{\"id\":\"microsoft-teams\",\"children\":[\"$\",\"a\",null,{\"href\":\"#microsoft-teams\",\"children\":\"Microsoft Teams\"}]}]\n65:[\"$\",\"p\",null,{\"children\":[\"Envoy also supports sending notifications to \",[\"$\",\"a\",null,{\"href\":\"https://www.microsoft.com/en-us/microsoft-teams\",\"children\":\"Microsoft Teams\"}],\" after each task is executed. The \",[\"$\",\"code\""])</script><script>self.__next_f.push([1,",null,{\"children\":\"@microsoftTeams\"}],\" directive accepts a Teams Webhook (required), a message, theme color (success, info, warning, error), and an array of options. You may retrieve your Teams Webhook by creating a new \",[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook\",\"children\":\"incoming webhook\"}],\". The Teams API has many other attributes to customize your message box like title, summary, and sections. You can find more information on the \",[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/connectors-using?tabs=cURL#example-of-connector-message\",\"children\":\"Microsoft Teams documentation\"}],\". You should pass the entire Webhook URL into the \",[\"$\",\"code\",null,{\"children\":\"@microsoftTeams\"}],\" directive:\"]}]\n66:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-blade\",\"children\":\"@finished\\n    @microsoftTeams('webhook-url')\\n@endfinished\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"67:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L67\",\"3\",{}]]\n8:null\n"])</script></body></html>