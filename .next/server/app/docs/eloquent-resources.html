<!DOCTYPE html><!--kE5s4wNidqhVn8fA906WC--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/bc6e94e20a39014e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/2b257daea29fbb42.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs（中文）</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a><a class="block" href="/docs/frontend"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">前端</button></a><a class="block" href="/docs/starter-kits"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">啟動套件</button></a><a class="block" href="/docs/deployment"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">部署</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Eloquent：API Resources</h1></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="eloquentapi-resources"><a href="#eloquentapi-resources">Eloquent：API Resources</a></h1>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p>當建構 API 時，你可能需要一個轉換層，位於 Eloquent Model 和實際回傳給應用程式使用者的 JSON 回應之間。例如，你可能希望為一部分使用者顯示某些屬性而不是其他使用者，或者你可能希望在 Model 的 JSON 表示中始終包含某些關聯。Eloquent 的 Resource 類別讓你可以表達性地且輕鬆地將 Model 和 Model Collection 轉換為 JSON。</p>
<p>當然，你可以使用 Eloquent Model 或 Collection 的 <code>toJson</code> 方法將它們轉換為 JSON；但是，Eloquent Resources 提供了對 Model 及其關聯的 JSON 序列化更細緻和強大的控制。</p>
<h2 id="產生-resources"><a href="#產生-resources">產生 Resources</a></h2>
<p>要產生一個 Resource 類別，你可以使用 <code>make:resource</code> Artisan 指令。預設情況下，Resources 會放置在應用程式的 <code>app/Http/Resources</code> 目錄中。Resources 繼承 <code>Illuminate\Http\Resources\Json\JsonResource</code> 類別：</p>
<pre><code class="language-shell">php artisan make:resource UserResource
</code></pre>
<h4 id="resource-collections"><a href="#resource-collections">Resource Collections</a></h4>
<p>除了產生轉換個別 Model 的 Resources 之外，你還可以產生負責轉換 Model Collection 的 Resources。這讓你的 JSON 回應可以包含與給定 Resource 整個 Collection 相關的連結和其他元資訊。</p>
<p>要建立一個 Resource Collection，你應該在建立 Resource 時使用 <code>--collection</code> 旗標。或者，在 Resource 名稱中包含 <code>Collection</code> 這個詞會讓 Laravel 知道它應該建立一個 Collection Resource。Collection Resources 繼承 <code>Illuminate\Http\Resources\Json\ResourceCollection</code> 類別：</p>
<pre><code class="language-shell">php artisan make:resource User --collection

php artisan make:resource UserCollection
</code></pre>
<h2 id="概念概述"><a href="#概念概述">概念概述</a></h2>
<blockquote>
<p>[!NOTE]
這是對 Resources 和 Resource Collections 的高階概述。強烈建議你閱讀本文件的其他章節，以深入了解 Resources 提供給你的自訂和功能。</p>
</blockquote>
<p>在深入了解撰寫 Resources 時可用的所有選項之前，讓我們先從高階層面看看如何在 Laravel 中使用 Resources。一個 Resource 類別代表一個需要轉換為 JSON 結構的單一 Model。例如，這是一個簡單的 <code>UserResource</code> Resource 類別：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\JsonResource;

class UserResource extends JsonResource
{
    /**
     * 將 Resource 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [
            &#x27;id&#x27; =&gt; $this-&gt;id,
            &#x27;name&#x27; =&gt; $this-&gt;name,
            &#x27;email&#x27; =&gt; $this-&gt;email,
            &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
            &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
        ];
    }
}
</code></pre>
<p>每個 Resource 類別都定義一個 <code>toArray</code> 方法，當 Resource 從路由或控制器方法作為回應回傳時，它會回傳應該轉換為 JSON 的屬性陣列。</p>
<p>請注意，我們可以直接從 <code>$this</code> 變數存取 Model 屬性。這是因為 Resource 類別會自動將屬性和方法存取代理到底層 Model 以方便存取。一旦定義了 Resource，它可以從路由或控制器回傳。Resource 透過其建構函式接受底層 Model 實例：</p>
<pre><code class="language-php">use App\Http\Resources\UserResource;
use App\Models\User;

Route::get(&#x27;/user/{id}&#x27;, function (string $id) {
    return new UserResource(User::findOrFail($id));
});
</code></pre>
<p>為了方便起見，你可以使用 Model 的 <code>toResource</code> 方法，它會使用框架約定自動發現 Model 的底層 Resource：</p>
<pre><code class="language-php">return User::findOrFail($id)-&gt;toResource();
</code></pre>
<p>當呼叫 <code>toResource</code> 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且可選地以 <code>Resource</code> 為後綴的 Resource，位於最接近 Model 命名空間的 <code>Http\Resources</code> 命名空間中。</p>
<p>如果你的 Resource 類別不遵循這個命名約定或位於不同的命名空間，你可以使用 <code>UseResource</code> 屬性為 Model 指定預設的 Resource：</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use App\Http\Resources\CustomUserResource;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Attributes\UseResource;

#[UseResource(CustomUserResource::class)]
class User extends Model
{
    // ...
}
</code></pre>
<p>或者，你可以透過將它傳遞給 <code>toResource</code> 方法來指定 Resource 類別：</p>
<pre><code class="language-php">return User::findOrFail($id)-&gt;toResource(CustomUserResource::class);
</code></pre>
<h3 id="resource-collections-1"><a href="#resource-collections-1">Resource Collections</a></h3>
<p>如果你要回傳一個 Resource Collection 或分頁回應，你應該在路由或控制器中建立 Resource 實例時使用 Resource 類別提供的 <code>collection</code> 方法：</p>
<pre><code class="language-php">use App\Http\Resources\UserResource;
use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return UserResource::collection(User::all());
});
</code></pre>
<p>或者，為了方便起見，你可以使用 Eloquent Collection 的 <code>toResourceCollection</code> 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：</p>
<pre><code class="language-php">return User::all()-&gt;toResourceCollection();
</code></pre>
<p>當呼叫 <code>toResourceCollection</code> 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 <code>Collection</code> 為後綴的 Resource Collection，位於最接近 Model 命名空間的 <code>Http\Resources</code> 命名空間中。</p>
<p>如果你的 Resource Collection 類別不遵循這個命名約定或位於不同的命名空間，你可以使用 <code>UseResourceCollection</code> 屬性為 Model 指定預設的 Resource Collection：</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use App\Http\Resources\CustomUserCollection;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Attributes\UseResourceCollection;

#[UseResourceCollection(CustomUserCollection::class)]
class User extends Model
{
    // ...
}
</code></pre>
<p>或者，你可以透過將它傳遞給 <code>toResourceCollection</code> 方法來指定 Resource Collection 類別：</p>
<pre><code class="language-php">return User::all()-&gt;toResourceCollection(CustomUserCollection::class);
</code></pre>
<h4 id="自訂-resource-collections"><a href="#自訂-resource-collections">自訂 Resource Collections</a></h4>
<p>預設情況下，Resource Collections 不允許新增任何可能需要與 Collection 一起回傳的自訂元資料。如果你想自訂 Resource Collection 回應，你可以建立一個專用的 Resource 來代表 Collection：</p>
<pre><code class="language-shell">php artisan make:resource UserCollection
</code></pre>
<p>一旦 Resource Collection 類別產生後，你可以輕鬆地定義任何應該包含在回應中的元資料：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 將 Resource Collection 轉換為陣列。
     *
     * @return array&lt;int|string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [
            &#x27;data&#x27; =&gt; $this-&gt;collection,
            &#x27;links&#x27; =&gt; [
                &#x27;self&#x27; =&gt; &#x27;link-value&#x27;,
            ],
        ];
    }
}
</code></pre>
<p>定義 Resource Collection 後，它可以從路由或控制器回傳：</p>
<pre><code class="language-php">use App\Http\Resources\UserCollection;
use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return new UserCollection(User::all());
});
</code></pre>
<p>或者，為了方便起見，你可以使用 Eloquent Collection 的 <code>toResourceCollection</code> 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：</p>
<pre><code class="language-php">return User::all()-&gt;toResourceCollection();
</code></pre>
<p>當呼叫 <code>toResourceCollection</code> 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 <code>Collection</code> 為後綴的 Resource Collection，位於最接近 Model 命名空間的 <code>Http\Resources</code> 命名空間中。</p>
<h4 id="保留-collection-鍵"><a href="#保留-collection-鍵">保留 Collection 鍵</a></h4>
<p>當從路由回傳 Resource Collection 時，Laravel 會重置 Collection 的鍵，使它們按數字順序排列。但是，你可以在 Resource 類別中新增 <code>preserveKeys</code> 屬性，指示是否應該保留 Collection 的原始鍵：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\JsonResource;

class UserResource extends JsonResource
{
    /**
     * 指示是否應該保留 Resource 的 Collection 鍵。
     *
     * @var bool
     */
    public $preserveKeys = true;
}
</code></pre>
<p>當 <code>preserveKeys</code> 屬性設定為 <code>true</code> 時，當 Collection 從路由或控制器回傳時，Collection 鍵將被保留：</p>
<pre><code class="language-php">use App\Http\Resources\UserResource;
use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return UserResource::collection(User::all()-&gt;keyBy-&gt;id);
});
</code></pre>
<h4 id="自訂底層-resource-類別"><a href="#自訂底層-resource-類別">自訂底層 Resource 類別</a></h4>
<p>通常，Resource Collection 的 <code>$this-&gt;collection</code> 屬性會自動填入將 Collection 的每個項目映射到其單數 Resource 類別的結果。單數 Resource 類別被假設為 Collection 的類別名稱，去掉類別名稱末尾的 <code>Collection</code> 部分。此外，根據你的個人偏好，單數 Resource 類別可能有也可能沒有 <code>Resource</code> 後綴。</p>
<p>例如，<code>UserCollection</code> 會嘗試將給定的使用者實例映射到 <code>UserResource</code> Resource。要自訂此行為，你可以覆寫 Resource Collection 的 <code>$collects</code> 屬性：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 此 Resource 收集的 Resource。
     *
     * @var string
     */
    public $collects = Member::class;
}
</code></pre>
<h2 id="撰寫-resources"><a href="#撰寫-resources">撰寫 Resources</a></h2>
<blockquote>
<p>[!NOTE]
如果你還沒有閱讀<a href="#concept-overview">概念概述</a>，強烈建議你在繼續閱讀本文件之前先閱讀。</p>
</blockquote>
<p>Resources 只需要將給定的 Model 轉換為陣列。因此，每個 Resource 都包含一個 <code>toArray</code> 方法，它將你 Model 的屬性轉換為可以從應用程式的路由或控制器回傳的 API 友好陣列：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\JsonResource;

class UserResource extends JsonResource
{
    /**
     * 將 Resource 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [
            &#x27;id&#x27; =&gt; $this-&gt;id,
            &#x27;name&#x27; =&gt; $this-&gt;name,
            &#x27;email&#x27; =&gt; $this-&gt;email,
            &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
            &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
        ];
    }
}
</code></pre>
<p>一旦定義了 Resource，它可以直接從路由或控制器回傳：</p>
<pre><code class="language-php">use App\Models\User;

Route::get(&#x27;/user/{id}&#x27;, function (string $id) {
    return User::findOrFail($id)-&gt;toUserResource();
});
</code></pre>
<h4 id="關聯"><a href="#關聯">關聯</a></h4>
<p>如果你想在回應中包含相關的 Resources，你可以將它們加入到 Resource 的 <code>toArray</code> 方法回傳的陣列中。在這個範例中，我們將使用 <code>PostResource</code> Resource 的 <code>collection</code> 方法將使用者的部落格文章加入到 Resource 回應中：</p>
<pre><code class="language-php">use App\Http\Resources\PostResource;
use Illuminate\Http\Request;

/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;email&#x27; =&gt; $this-&gt;email,
        &#x27;posts&#x27; =&gt; PostResource::collection($this-&gt;posts),
        &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
        &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
    ];
}
</code></pre>
<blockquote>
<p>[!NOTE]
如果你只想在關聯已經載入時才包含它們，請查看<a href="#conditional-relationships">條件式關聯</a>的文件。</p>
</blockquote>
<h4 id="resource-collections-2"><a href="#resource-collections-2">Resource Collections</a></h4>
<p>雖然 Resources 將單一 Model 轉換為陣列，但 Resource Collections 將 Model Collection 轉換為陣列。但是，並非絕對必要為每個 Model 定義一個 Resource Collection 類別，因為所有 Eloquent Model Collection 都提供 <code>toResourceCollection</code> 方法來動態產生「即時」Resource Collection：</p>
<pre><code class="language-php">use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return User::all()-&gt;toResourceCollection();
});
</code></pre>
<p>但是，如果你需要自訂與 Collection 一起回傳的元資料，則有必要定義你自己的 Resource Collection：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 將 Resource Collection 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [
            &#x27;data&#x27; =&gt; $this-&gt;collection,
            &#x27;links&#x27; =&gt; [
                &#x27;self&#x27; =&gt; &#x27;link-value&#x27;,
            ],
        ];
    }
}
</code></pre>
<p>與單數 Resources 一樣，Resource Collections 可以直接從路由或控制器回傳：</p>
<pre><code class="language-php">use App\Http\Resources\UserCollection;
use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return new UserCollection(User::all());
});
</code></pre>
<p>或者，為了方便起見，你可以使用 Eloquent Collection 的 <code>toResourceCollection</code> 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：</p>
<pre><code class="language-php">return User::all()-&gt;toResourceCollection();
</code></pre>
<p>當呼叫 <code>toResourceCollection</code> 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 <code>Collection</code> 為後綴的 Resource Collection，位於最接近 Model 命名空間的 <code>Http\Resources</code> 命名空間中。</p>
<h3 id="資料包裝"><a href="#資料包裝">資料包裝</a></h3>
<p>預設情況下，當 Resource 回應轉換為 JSON 時，最外層的 Resource 會被包裝在 <code>data</code> 鍵中。因此，例如，一個典型的 Resource Collection 回應看起來像這樣：</p>
<pre><code class="language-json">{
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Eladio Schroeder Sr.&quot;,
            &quot;email&quot;: &quot;therese28@example.com&quot;
        },
        {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;Liliana Mayert&quot;,
            &quot;email&quot;: &quot;evandervort@example.com&quot;
        }
    ]
}
</code></pre>
<p>如果你想停用最外層 Resource 的包裝，你應該在基礎 <code>Illuminate\Http\Resources\Json\JsonResource</code> 類別上呼叫 <code>withoutWrapping</code> 方法。通常，你應該從 <code>AppServiceProvider</code> 或另一個在每次請求時載入的<a href="/docs/%7B%7Bversion%7D%7D/providers">服務提供者</a>呼叫此方法：</p>
<pre><code class="language-php">&lt;?php

namespace App\Providers;

use Illuminate\Http\Resources\Json\JsonResource;
use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    /**
     * 註冊任何應用程式服務。
     */
    public function register(): void
    {
        // ...
    }

    /**
     * 啟動任何應用程式服務。
     */
    public function boot(): void
    {
        JsonResource::withoutWrapping();
    }
}
</code></pre>
<blockquote>
<p>[!WARNING]
<code>withoutWrapping</code> 方法只影響最外層的回應，不會移除你手動加入到自己 Resource Collections 的 <code>data</code> 鍵。</p>
</blockquote>
<h4 id="包裝巢狀-resources"><a href="#包裝巢狀-resources">包裝巢狀 Resources</a></h4>
<p>你可以完全自由地決定 Resource 的關聯如何被包裝。如果你希望所有 Resource Collections 都被包裝在 <code>data</code> 鍵中，無論它們的巢狀層級如何，你應該為每個 Resource 定義一個 Resource Collection 類別，並在 <code>data</code> 鍵中回傳 Collection。</p>
<p>你可能會想知道這是否會導致最外層的 Resource 被包裝在兩個 <code>data</code> 鍵中。別擔心，Laravel 永遠不會讓你的 Resources 意外地被雙重包裝，所以你不必擔心正在轉換的 Resource Collection 的巢狀層級：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class CommentsCollection extends ResourceCollection
{
    /**
     * 將 Resource Collection 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [&#x27;data&#x27; =&gt; $this-&gt;collection];
    }
}
</code></pre>
<h4 id="資料包裝與分頁"><a href="#資料包裝與分頁">資料包裝與分頁</a></h4>
<p>當透過 Resource 回應回傳分頁 Collections 時，即使呼叫了 <code>withoutWrapping</code> 方法，Laravel 也會將 Resource 資料包裝在 <code>data</code> 鍵中。這是因為分頁回應總是包含關於分頁器狀態的 <code>meta</code> 和 <code>links</code> 鍵：</p>
<pre><code class="language-json">{
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Eladio Schroeder Sr.&quot;,
            &quot;email&quot;: &quot;therese28@example.com&quot;
        },
        {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;Liliana Mayert&quot;,
            &quot;email&quot;: &quot;evandervort@example.com&quot;
        }
    ],
    &quot;links&quot;:{
        &quot;first&quot;: &quot;http://example.com/users?page=1&quot;,
        &quot;last&quot;: &quot;http://example.com/users?page=1&quot;,
        &quot;prev&quot;: null,
        &quot;next&quot;: null
    },
    &quot;meta&quot;:{
        &quot;current_page&quot;: 1,
        &quot;from&quot;: 1,
        &quot;last_page&quot;: 1,
        &quot;path&quot;: &quot;http://example.com/users&quot;,
        &quot;per_page&quot;: 15,
        &quot;to&quot;: 10,
        &quot;total&quot;: 10
    }
}
</code></pre>
<h3 id="分頁"><a href="#分頁">分頁</a></h3>
<p>你可以將 Laravel 分頁器實例傳遞給 Resource 的 <code>collection</code> 方法或自訂 Resource Collection：</p>
<pre><code class="language-php">use App\Http\Resources\UserCollection;
use App\Models\User;

Route::get(&#x27;/users&#x27;, function () {
    return new UserCollection(User::paginate());
});
</code></pre>
<p>或者，為了方便起見，你可以使用分頁器的 <code>toResourceCollection</code> 方法，它會使用框架約定自動發現分頁 Model 的底層 Resource Collection：</p>
<pre><code class="language-php">return User::paginate()-&gt;toResourceCollection();
</code></pre>
<p>分頁回應總是包含關於分頁器狀態的 <code>meta</code> 和 <code>links</code> 鍵：</p>
<pre><code class="language-json">{
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Eladio Schroeder Sr.&quot;,
            &quot;email&quot;: &quot;therese28@example.com&quot;
        },
        {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;Liliana Mayert&quot;,
            &quot;email&quot;: &quot;evandervort@example.com&quot;
        }
    ],
    &quot;links&quot;:{
        &quot;first&quot;: &quot;http://example.com/users?page=1&quot;,
        &quot;last&quot;: &quot;http://example.com/users?page=1&quot;,
        &quot;prev&quot;: null,
        &quot;next&quot;: null
    },
    &quot;meta&quot;:{
        &quot;current_page&quot;: 1,
        &quot;from&quot;: 1,
        &quot;last_page&quot;: 1,
        &quot;path&quot;: &quot;http://example.com/users&quot;,
        &quot;per_page&quot;: 15,
        &quot;to&quot;: 10,
        &quot;total&quot;: 10
    }
}
</code></pre>
<h4 id="自訂分頁資訊"><a href="#自訂分頁資訊">自訂分頁資訊</a></h4>
<p>如果你想自訂分頁回應中 <code>links</code> 或 <code>meta</code> 鍵中包含的資訊，你可以在 Resource 上定義一個 <code>paginationInformation</code> 方法。此方法會接收 <code>$paginated</code> 資料和 <code>$default</code> 資訊陣列，這是一個包含 <code>links</code> 和 <code>meta</code> 鍵的陣列：</p>
<pre><code class="language-php">/**
 * 自訂 Resource 的分頁資訊。
 *
 * @param  \Illuminate\Http\Request  $request
 * @param  array  $paginated
 * @param  array  $default
 * @return array
 */
public function paginationInformation($request, $paginated, $default)
{
    $default[&#x27;links&#x27;][&#x27;custom&#x27;] = &#x27;https://example.com&#x27;;

    return $default;
}
</code></pre>
<h3 id="條件式屬性"><a href="#條件式屬性">條件式屬性</a></h3>
<p>有時你可能希望只在滿足給定條件時才在 Resource 回應中包含屬性。例如，你可能希望只在當前使用者是「管理員」時才包含一個值。Laravel 提供了各種輔助方法來協助你處理這種情況。<code>when</code> 方法可用於有條件地將屬性加入到 Resource 回應中：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;email&#x27; =&gt; $this-&gt;email,
        &#x27;secret&#x27; =&gt; $this-&gt;when($request-&gt;user()-&gt;isAdmin(), &#x27;secret-value&#x27;),
        &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
        &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
    ];
}
</code></pre>
<p>在這個範例中，只有當已認證使用者的 <code>isAdmin</code> 方法回傳 <code>true</code> 時，<code>secret</code> 鍵才會在最終 Resource 回應中回傳。如果該方法回傳 <code>false</code>，<code>secret</code> 鍵會在 Resource 回應發送給客戶端之前被移除。<code>when</code> 方法讓你可以表達性地定義 Resources，而無需在建構陣列時使用條件陳述式。</p>
<p><code>when</code> 方法也接受閉包作為其第二個參數，讓你只在給定條件為 <code>true</code> 時才計算結果值：</p>
<pre><code class="language-php">&#x27;secret&#x27; =&gt; $this-&gt;when($request-&gt;user()-&gt;isAdmin(), function () {
    return &#x27;secret-value&#x27;;
}),
</code></pre>
<p><code>whenHas</code> 方法可用於在屬性實際存在於底層 Model 時包含它：</p>
<pre><code class="language-php">&#x27;name&#x27; =&gt; $this-&gt;whenHas(&#x27;name&#x27;),
</code></pre>
<p>此外，<code>whenNotNull</code> 方法可用於在屬性不為 null 時將它包含在 Resource 回應中：</p>
<pre><code class="language-php">&#x27;name&#x27; =&gt; $this-&gt;whenNotNull($this-&gt;name),
</code></pre>
<h4 id="合併條件式屬性"><a href="#合併條件式屬性">合併條件式屬性</a></h4>
<p>有時你可能有多個屬性應該只在相同條件下包含在 Resource 回應中。在這種情況下，你可以使用 <code>mergeWhen</code> 方法，只在給定條件為 <code>true</code> 時才將屬性包含在回應中：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;email&#x27; =&gt; $this-&gt;email,
        $this-&gt;mergeWhen($request-&gt;user()-&gt;isAdmin(), [
            &#x27;first-secret&#x27; =&gt; &#x27;value&#x27;,
            &#x27;second-secret&#x27; =&gt; &#x27;value&#x27;,
        ]),
        &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
        &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
    ];
}
</code></pre>
<p>同樣地，如果給定條件為 <code>false</code>，這些屬性會在 Resource 回應發送給客戶端之前被移除。</p>
<blockquote>
<p>[!WARNING]
<code>mergeWhen</code> 方法不應該用於混合字串和數字鍵的陣列中。此外，它不應該用於數字鍵未按順序排列的陣列中。</p>
</blockquote>
<h3 id="條件式關聯"><a href="#條件式關聯">條件式關聯</a></h3>
<p>除了有條件地載入屬性之外，你還可以根據關聯是否已經載入到 Model 上，有條件地在 Resource 回應中包含關聯。這讓你的控制器可以決定哪些關聯應該載入到 Model 上，而 Resource 可以在它們實際被載入時才輕鬆地包含它們。最終，這讓你更容易避免 Resources 中的「N+1」查詢問題。</p>
<p><code>whenLoaded</code> 方法可用於有條件地載入關聯。為了避免不必要地載入關聯，此方法接受關聯的名稱而不是關聯本身：</p>
<pre><code class="language-php">use App\Http\Resources\PostResource;

/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;email&#x27; =&gt; $this-&gt;email,
        &#x27;posts&#x27; =&gt; PostResource::collection($this-&gt;whenLoaded(&#x27;posts&#x27;)),
        &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
        &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
    ];
}
</code></pre>
<p>在這個範例中，如果關聯尚未載入，<code>posts</code> 鍵會在 Resource 回應發送給客戶端之前被移除。</p>
<h4 id="條件式關聯計數"><a href="#條件式關聯計數">條件式關聯計數</a></h4>
<p>除了有條件地包含關聯之外，你還可以根據關聯的計數是否已載入到 Model 上，有條件地在 Resource 回應中包含關聯「計數」：</p>
<pre><code class="language-php">new UserResource($user-&gt;loadCount(&#x27;posts&#x27;));
</code></pre>
<p><code>whenCounted</code> 方法可用於有條件地在 Resource 回應中包含關聯的計數。如果關聯的計數不存在，此方法會避免不必要地包含屬性：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;email&#x27; =&gt; $this-&gt;email,
        &#x27;posts_count&#x27; =&gt; $this-&gt;whenCounted(&#x27;posts&#x27;),
        &#x27;created_at&#x27; =&gt; $this-&gt;created_at,
        &#x27;updated_at&#x27; =&gt; $this-&gt;updated_at,
    ];
}
</code></pre>
<p>在這個範例中，如果 <code>posts</code> 關聯的計數尚未載入，<code>posts_count</code> 鍵會在 Resource 回應發送給客戶端之前被移除。</p>
<p>其他類型的聚合，如 <code>avg</code>、<code>sum</code>、<code>min</code> 和 <code>max</code>，也可以使用 <code>whenAggregated</code> 方法有條件地載入：</p>
<pre><code class="language-php">&#x27;words_avg&#x27; =&gt; $this-&gt;whenAggregated(&#x27;posts&#x27;, &#x27;words&#x27;, &#x27;avg&#x27;),
&#x27;words_sum&#x27; =&gt; $this-&gt;whenAggregated(&#x27;posts&#x27;, &#x27;words&#x27;, &#x27;sum&#x27;),
&#x27;words_min&#x27; =&gt; $this-&gt;whenAggregated(&#x27;posts&#x27;, &#x27;words&#x27;, &#x27;min&#x27;),
&#x27;words_max&#x27; =&gt; $this-&gt;whenAggregated(&#x27;posts&#x27;, &#x27;words&#x27;, &#x27;max&#x27;),
</code></pre>
<h4 id="條件式-pivot-資訊"><a href="#條件式-pivot-資訊">條件式 Pivot 資訊</a></h4>
<p>除了有條件地在 Resource 回應中包含關聯資訊之外，你還可以使用 <code>whenPivotLoaded</code> 方法有條件地包含多對多關聯的中間資料表的資料。<code>whenPivotLoaded</code> 方法接受 pivot 資料表的名稱作為其第一個參數。第二個參數應該是一個閉包，它回傳當 Model 上有 pivot 資訊時要回傳的值：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;expires_at&#x27; =&gt; $this-&gt;whenPivotLoaded(&#x27;role_user&#x27;, function () {
            return $this-&gt;pivot-&gt;expires_at;
        }),
    ];
}
</code></pre>
<p>如果你的關聯使用<a href="/docs/%7B%7Bversion%7D%7D/eloquent-relationships#defining-custom-intermediate-table-models">自訂中間資料表 Model</a>，你可以將中間資料表 Model 的實例作為第一個參數傳遞給 <code>whenPivotLoaded</code> 方法：</p>
<pre><code class="language-php">&#x27;expires_at&#x27; =&gt; $this-&gt;whenPivotLoaded(new Membership, function () {
    return $this-&gt;pivot-&gt;expires_at;
}),
</code></pre>
<p>如果你的中間資料表使用的存取器不是 <code>pivot</code>，你可以使用 <code>whenPivotLoadedAs</code> 方法：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;id&#x27; =&gt; $this-&gt;id,
        &#x27;name&#x27; =&gt; $this-&gt;name,
        &#x27;expires_at&#x27; =&gt; $this-&gt;whenPivotLoadedAs(&#x27;subscription&#x27;, &#x27;role_user&#x27;, function () {
            return $this-&gt;subscription-&gt;expires_at;
        }),
    ];
}
</code></pre>
<h3 id="新增元資料"><a href="#新增元資料">新增元資料</a></h3>
<p>一些 JSON API 標準要求在 Resource 和 Resource Collection 回應中新增元資料。這通常包括 Resource 或相關 Resources 的 <code>links</code>，或關於 Resource 本身的元資料。如果你需要回傳關於 Resource 的額外元資料，請將其包含在你的 <code>toArray</code> 方法中。例如，你可能在轉換 Resource Collection 時包含 <code>links</code> 資訊：</p>
<pre><code class="language-php">/**
 * 將 Resource 轉換為陣列。
 *
 * @return array&lt;string, mixed&gt;
 */
public function toArray(Request $request): array
{
    return [
        &#x27;data&#x27; =&gt; $this-&gt;collection,
        &#x27;links&#x27; =&gt; [
            &#x27;self&#x27; =&gt; &#x27;link-value&#x27;,
        ],
    ];
}
</code></pre>
<p>當從 Resources 回傳額外的元資料時，你永遠不必擔心意外覆蓋 Laravel 在回傳分頁回應時自動新增的 <code>links</code> 或 <code>meta</code> 鍵。你定義的任何額外 <code>links</code> 都會與分頁器提供的連結合併。</p>
<h4 id="頂層元資料"><a href="#頂層元資料">頂層元資料</a></h4>
<p>有時你可能希望只在 Resource 是正在回傳的最外層 Resource 時才包含某些元資料。通常，這包括關於整個回應的元資訊。要定義此元資料，請在 Resource 類別中新增一個 <code>with</code> 方法。此方法應該回傳一個元資料陣列，只有當 Resource 是正在轉換的最外層 Resource 時才會包含在 Resource 回應中：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\ResourceCollection;

class UserCollection extends ResourceCollection
{
    /**
     * 將 Resource Collection 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return parent::toArray($request);
    }

    /**
     * 取得應該與 Resource 陣列一起回傳的額外資料。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function with(Request $request): array
    {
        return [
            &#x27;meta&#x27; =&gt; [
                &#x27;key&#x27; =&gt; &#x27;value&#x27;,
            ],
        ];
    }
}
</code></pre>
<h4 id="在建構-resources-時新增元資料"><a href="#在建構-resources-時新增元資料">在建構 Resources 時新增元資料</a></h4>
<p>你也可以在路由或控制器中建構 Resource 實例時新增頂層資料。所有 Resources 都有 <code>additional</code> 方法，它接受一個應該新增到 Resource 回應的資料陣列：</p>
<pre><code class="language-php">return User::all()
    -&gt;load(&#x27;roles&#x27;)
    -&gt;toResourceCollection()
    -&gt;additional([&#x27;meta&#x27; =&gt; [
        &#x27;key&#x27; =&gt; &#x27;value&#x27;,
    ]]);
</code></pre>
<h2 id="resource-回應"><a href="#resource-回應">Resource 回應</a></h2>
<p>如你所讀，Resources 可以直接從路由和控制器回傳：</p>
<pre><code class="language-php">use App\Models\User;

Route::get(&#x27;/user/{id}&#x27;, function (string $id) {
    return User::findOrFail($id)-&gt;toResource();
});
</code></pre>
<p>但是，有時你可能需要在將傳出的 HTTP 回應發送給客戶端之前自訂它。有兩種方式可以完成這個操作。首先，你可以在 Resource 上鏈接 <code>response</code> 方法。此方法會回傳一個 <code>Illuminate\Http\JsonResponse</code> 實例，讓你完全控制回應的標頭：</p>
<pre><code class="language-php">use App\Http\Resources\UserResource;
use App\Models\User;

Route::get(&#x27;/user&#x27;, function () {
    return User::find(1)
        -&gt;toResource()
        -&gt;response()
        -&gt;header(&#x27;X-Value&#x27;, &#x27;True&#x27;);
});
</code></pre>
<p>或者，你可以在 Resource 本身中定義一個 <code>withResponse</code> 方法。當 Resource 作為回應中最外層的 Resource 回傳時，會呼叫此方法：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\JsonResource;

class UserResource extends JsonResource
{
    /**
     * 將 Resource 轉換為陣列。
     *
     * @return array&lt;string, mixed&gt;
     */
    public function toArray(Request $request): array
    {
        return [
            &#x27;id&#x27; =&gt; $this-&gt;id,
        ];
    }

    /**
     * 自訂 Resource 的傳出回應。
     */
    public function withResponse(Request $request, JsonResponse $response): void
    {
        $response-&gt;header(&#x27;X-Value&#x27;, &#x27;True&#x27;);
    }
}
</code></pre></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/2b257daea29fbb42.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/bc6e94e20a39014e.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"kE5s4wNidqhVn8fA906WC\",\"c\":[\"\",\"docs\",\"eloquent-resources\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"eloquent-resources\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/bc6e94e20a39014e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/2b257daea29fbb42.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"Eloquent：API Resources\"}],\"$undefined\"]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"eloquentapi-resources\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eloquentapi-resources\",\"children\":\"Eloquent：API Resources\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"簡介\",\"children\":[\"$\",\"a\",null,{\"href\":\"#簡介\",\"children\":\"簡介\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"當建構 API 時，你可能需要一個轉換層，位於 Eloquent Model 和實際回傳給應用程式使用者的 JSON 回應之間。例如，你可能希望為一部分使用者顯示某些屬性而不是其他使用者，或者你可能希望在 Model 的 JSON 表示中始終包含某些關聯。Eloquent 的 Resource 類別讓你可以表達性地且輕鬆地將 Model 和 Model Collection 轉換為 JSON。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"當然，你可以使用 Eloquent Model 或 Collection 的 \",[\"$\",\"code\",null,{\"children\":\"toJson\"}],\" 方法將它們轉換為 JSON；但是，Eloquent Resources 提供了對 Model 及其關聯的 JSON 序列化更細緻和強大的控制。\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"產生-resources\",\"children\":[\"$\",\"a\",null,{\"href\":\"#產生-resources\",\"children\":\"產生 Resources\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"要產生一個 Resource 類別，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"make:resource\"}],\" Artisan 指令。預設情況下，Resources 會放置在應用程式的 \",[\"$\",\"code\",null,{\"children\":\"app/Http/Resources\"}],\" 目錄中。Resources 繼承 \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource\"}],\" 類別：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan make:resource UserResource\\n\"}]}],\"\\n\",[\"$\",\"h4\",null,{\"id\":\"resource-collections\",\"children\":[\"$\",\"a\",null,{\"href\":\"#resource-collections\",\"children\":\"Resource Collections\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"除了產生轉換個別 Model 的 Resources 之外，你還可以產生負責轉換 Model Collection 的 Resources。這讓你的 JSON 回應可以包含與給定 Resource 整個 Collection 相關的連結和其他元資訊。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"要建立一個 Resource Collection，你應該在建立 Resource 時使用 \",[\"$\",\"code\",null,{\"children\":\"--collection\"}],\" 旗標。或者，在 Resource 名稱中包含 \",[\"$\",\"code\",null,{\"children\":\"Collection\"}],\" 這個詞會讓 Laravel 知道它應該建立一個 Collection Resource。Collection Resources 繼承 \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection\"}],\" 類別：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan make:resource User --collection\\n\\nphp artisan make:resource UserCollection\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"概念概述\",\"children\":[\"$\",\"a\",null,{\"href\":\"#概念概述\",\"children\":\"概念概述\"}]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"[!NOTE]\\n這是對 Resources 和 Resource Collections 的高階概述。強烈建議你閱讀本文件的其他章節，以深入了解 Resources 提供給你的自訂和功能。\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"在深入了解撰寫 Resources 時可用的所有選項之前，讓我們先從高階層面看看如何在 Laravel 中使用 Resources。一個 Resource 類別代表一個需要轉換為 JSON 結構的單一 Model。例如，這是一個簡單的 \",[\"$\",\"code\",null,{\"children\":\"UserResource\"}],\" Resource 類別：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource;\\n\\nclass UserResource extends JsonResource\\n{\\n    /**\\n     * 將 Resource 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return [\\n            'id' =\u003e $this-\u003eid,\\n            'name' =\u003e $this-\u003ename,\\n            'email' =\u003e $this-\u003eemail,\\n            'created_at' =\u003e $this-\u003ecreated_at,\\n            'updated_at' =\u003e $this-\u003eupdated_at,\\n        ];\\n    }\\n}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"每個 Resource 類別都定義一個 \",[\"$\",\"code\",null,{\"children\":\"toArray\"}],\" 方法，當 Resource 從路由或控制器方法作為回應回傳時，它會回傳應該轉換為 JSON 的屬性陣列。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"請注意，我們可以直接從 \",[\"$\",\"code\",null,{\"children\":\"$$this\"}],\" 變數存取 Model 屬性。這是因為 Resource 類別會自動將屬性和方法存取代理到底層 Model 以方便存取。一旦定義了 Resource，它可以從路由或控制器回傳。Resource 透過其建構函式接受底層 Model 實例：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserResource;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/user/{id}', function (string $id) {\\n    return new UserResource(User::findOrFail($id));\\n});\\n\"}]}],\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\",\"\\n\",\"$L71\",\"\\n\",\"$L72\",\"\\n\",\"$L73\",\"\\n\",\"$L74\",\"\\n\",\"$L75\",\"\\n\",\"$L76\",\"\\n\",\"$L77\",\"\\n\",\"$L78\",\"\\n\",\"$L79\",\"\\n\",\"$L7a\",\"\\n\",\"$L7b\",\"\\n\",\"$L7c\",\"\\n\",\"$L7d\",\"\\n\",\"$L7e\",\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\",\"\\n\",\"$L82\",\"\\n\",\"$L83\",\"\\n\",\"$L84\",\"\\n\",\"$L85\",\"\\n\",\"$L86\",\"\\n\",\"$L87\",\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"p\",null,{\"children\":[\"為了方便起見，你可以使用 Model 的 \",[\"$\",\"code\",null,{\"children\":\"toResource\"}],\" 方法，它會使用框架約定自動發現 Model 的底層 Resource：\"]}]\nf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::findOrFail($id)-\u003etoResource();\\n\"}]}]\n10:[\"$\",\"p\",null,{\"children\":[\"當呼叫 \",[\"$\",\"code\",null,{\"children\":\"toResource\"}],\" 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且可選地以 \",[\"$\",\"code\",null,{\"children\":\"Resource\"}],\" 為後綴的 Resource，位於最接近 Model 命名空間的 \",[\"$\",\"code\",null,{\"children\":\"Http\\\\Resources\"}],\" 命名空間中。\"]}]\n11:[\"$\",\"p\",null,{\"children\":[\"如果你的 Resource 類別不遵循這個命名約定或位於不同的命名空間，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"UseResource\"}],\" 屬性為 Model 指定預設的 Resource：\"]}]\n12:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse App\\\\Http\\\\Resources\\\\CustomUserResource;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Attributes\\\\UseResource;\\n\\n#[UseResource(CustomUserResource::class)]\\nclass User extends Model\\n{\\n    // ...\\n}\\n\"}]}]\n13:[\"$\",\"p\",null,{\"children\":[\"或者，你可以透過將它傳遞給 \",[\"$\",\"code\",null,{\"children\":\"toResource\"}],\" 方法來指定 Resource 類別：\"]}]\n14:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::findOrFail($id)-\u003etoResource(CustomUserResource::class);\\n\"}]}]\n15:[\"$\",\"h3\",null,{\"id\":\"resource-collections-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#resource-collections-1\",\"children\":\"Resource Collections\"}]}]\n16:[\"$\",\"p\",null,{\"children\":[\"如果你要回傳一個 Resource Collection 或分頁回應，你應該在路由或控制器中建立 Resource 實例時使用 Resource 類別提供的 \",[\"$\",\"code\",null,{\"children\":\"collection\"}],\" 方法：\"]}]\n17:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserResource;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return UserResource::collection(User::all());\\n});\\n\"}]}]\n18:[\"$\",\"p\",null,{\"children\":[\"或者，為了方便起見，你可以使用 Eloquent Collection 的 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：\"]}]\n19:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::all()-\u003etoResourceCollection();\\n\"}]}]\n1a:[\"$\",\"p\",null,{\"children\":[\"當呼叫 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 \",[\"$\",\"code\",null,{\"children\":\"Collection\"}],\" 為後綴的 Resource Collection，位於最接近 Model 命名空間的 \",[\"$\",\"code\",null,{\"children\":\"Http\\\\Resources\"}],\" 命名空間中。\"]}]\n1b:[\"$\",\"p\",null,{\"children\":[\"如果你的 Resource Collection 類別不遵循這個命名約定或位於不同的命名空間，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"UseResourceCollection\"}],\" 屬性為 Model 指定預設的 Resource Collection：\"]}]\n1c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse App\\\\Http\\\\Resources\\\\CustomUserCollection;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Attributes\\\\UseResourceCollection;\\n\\n#[UseResourceCollection(CustomUserCollection::class)]\\nclass User extends Model\\n{\\n    // ...\\n}\\n\"}]}]\n1d:[\"$\",\"p\",null,{\"children\":[\"或者，你可以透過將它傳遞給 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法來指定 Resource Collection 類別：\"]}]\n1e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::all()-\u003etoResourceCollection(CustomUserCollection::class);\\n\"}]}]\n1f:[\"$\",\"h4\",null,{\"id\":\"自訂-resource-collections\",\"children\":[\"$\",\"a\",nu"])</script><script>self.__next_f.push([1,"ll,{\"href\":\"#自訂-resource-collections\",\"children\":\"自訂 Resource Collections\"}]}]\n20:[\"$\",\"p\",null,{\"children\":\"預設情況下，Resource Collections 不允許新增任何可能需要與 Collection 一起回傳的自訂元資料。如果你想自訂 Resource Collection 回應，你可以建立一個專用的 Resource 來代表 Collection：\"}]\n21:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan make:resource UserCollection\\n\"}]}]\n22:[\"$\",\"p\",null,{\"children\":\"一旦 Resource Collection 類別產生後，你可以輕鬆地定義任何應該包含在回應中的元資料：\"}]\n23:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection;\\n\\nclass UserCollection extends ResourceCollection\\n{\\n    /**\\n     * 將 Resource Collection 轉換為陣列。\\n     *\\n     * @return array\u003cint|string, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return [\\n            'data' =\u003e $this-\u003ecollection,\\n            'links' =\u003e [\\n                'self' =\u003e 'link-value',\\n            ],\\n        ];\\n    }\\n}\\n\"}]}]\n24:[\"$\",\"p\",null,{\"children\":\"定義 Resource Collection 後，它可以從路由或控制器回傳：\"}]\n25:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserCollection;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return new UserCollection(User::all());\\n});\\n\"}]}]\n26:[\"$\",\"p\",null,{\"children\":[\"或者，為了方便起見，你可以使用 Eloquent Collection 的 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：\"]}]\n27:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::all()-\u003etoResourceCollection();\\n\"}]}]\n28:[\"$\",\"p\",null,{\"children\":[\"當呼叫 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 \",[\"$\",\"code\",null,{\"children\":\"Collection\"}],\" 為後綴的 Resource Collection，位於最接近 Model 命名空間的 \",[\"$\",\"code\",null,{\"children\":\"Http\\\\Resources\"}],\" 命名空間中。\"]}]\n29:[\"$\",\"h4\",null,{\"id\":\"保留-collection-鍵\",\"children\":[\"$\",\"a\",null,{\"href\":\"#保留-collection-鍵\",\"children\":\"保留 Collection 鍵\"}]}]\n2a:[\"$\",\"p\",null,{\"children\":[\"當從路由回傳 Resource Collection 時，Laravel 會重置 Collection 的鍵，使它們按數字順序排列。但是，你可以在 Resource 類別中新增 \",[\"$\",\"code\",null,{\"children\":\"preserveKeys\"}],\" 屬性，指示是否應該保留 Collection 的原始鍵：\"]}]\n2b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource;\\n\\nclass UserResource extends JsonResource\\n{\\n    /**\\n     * 指示是否應該保留 Resource 的 Collection 鍵。\\n     *\\n     * @var bool\\n     */\\n    public $preserveKeys = true;\\n}\\n\"}]}]\n2c:[\"$\",\"p\",null,{\"children\":[\"當 \",[\"$\",\"code\",null,{\"children\":\"preserveKeys\"}],\" 屬性設定為 \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" 時，當 Collection 從路由或控制器回傳時，Collection 鍵將被保留：\"]}]\n2d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserResource;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return UserResource::collection(User::all()-\u003ekeyBy-\u003eid);\\n});\\n\"}]}]\n2e:[\"$\",\"h4\",null,{\"id\":\"自訂底層-resource-類別\",\"children\":[\"$\",\"a\",null,{\"href\":\"#自訂底層-resource-類別\",\"children\":\"自訂底層 Resource 類別\"}]}]\n2f:[\"$\",\"p\",null,{\"children\":[\"通常，Resource Collection 的 \",[\"$\",\"code\",null,{\"children\":\"$$this-\u003ecollection\"}],\" 屬性會自動填入將 Collection 的每個項目映射到其單數 Resource 類別的結果。單數 "])</script><script>self.__next_f.push([1,"Resource 類別被假設為 Collection 的類別名稱，去掉類別名稱末尾的 \",[\"$\",\"code\",null,{\"children\":\"Collection\"}],\" 部分。此外，根據你的個人偏好，單數 Resource 類別可能有也可能沒有 \",[\"$\",\"code\",null,{\"children\":\"Resource\"}],\" 後綴。\"]}]\n30:[\"$\",\"p\",null,{\"children\":[\"例如，\",[\"$\",\"code\",null,{\"children\":\"UserCollection\"}],\" 會嘗試將給定的使用者實例映射到 \",[\"$\",\"code\",null,{\"children\":\"UserResource\"}],\" Resource。要自訂此行為，你可以覆寫 Resource Collection 的 \",[\"$\",\"code\",null,{\"children\":\"$$collects\"}],\" 屬性：\"]}]\n31:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection;\\n\\nclass UserCollection extends ResourceCollection\\n{\\n    /**\\n     * 此 Resource 收集的 Resource。\\n     *\\n     * @var string\\n     */\\n    public $collects = Member::class;\\n}\\n\"}]}]\n32:[\"$\",\"h2\",null,{\"id\":\"撰寫-resources\",\"children\":[\"$\",\"a\",null,{\"href\":\"#撰寫-resources\",\"children\":\"撰寫 Resources\"}]}]\n33:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\n如果你還沒有閱讀\",[\"$\",\"a\",null,{\"href\":\"#concept-overview\",\"children\":\"概念概述\"}],\"，強烈建議你在繼續閱讀本文件之前先閱讀。\"]}],\"\\n\"]}]\n34:[\"$\",\"p\",null,{\"children\":[\"Resources 只需要將給定的 Model 轉換為陣列。因此，每個 Resource 都包含一個 \",[\"$\",\"code\",null,{\"children\":\"toArray\"}],\" 方法，它將你 Model 的屬性轉換為可以從應用程式的路由或控制器回傳的 API 友好陣列：\"]}]\n35:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource;\\n\\nclass UserResource extends JsonResource\\n{\\n    /**\\n     * 將 Resource 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return [\\n            'id' =\u003e $this-\u003eid,\\n            'name' =\u003e $this-\u003ename,\\n            'email' =\u003e $this-\u003eemail,\\n            'created_at' =\u003e $this-\u003ecreated_at,\\n            'updated_at' =\u003e $this-\u003eupdated_at,\\n        ];\\n    }\\n}\\n\"}]}]\n36:[\"$\",\"p\",null,{\"children\":\"一旦定義了 Resource，它可以直接從路由或控制器回傳：\"}]\n37:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\nRoute::get('/user/{id}', function (string $id) {\\n    return User::findOrFail($id)-\u003etoUserResource();\\n});\\n\"}]}]\n38:[\"$\",\"h4\",null,{\"id\":\"關聯\",\"children\":[\"$\",\"a\",null,{\"href\":\"#關聯\",\"children\":\"關聯\"}]}]\n39:[\"$\",\"p\",null,{\"children\":[\"如果你想在回應中包含相關的 Resources，你可以將它們加入到 Resource 的 \",[\"$\",\"code\",null,{\"children\":\"toArray\"}],\" 方法回傳的陣列中。在這個範例中，我們將使用 \",[\"$\",\"code\",null,{\"children\":\"PostResource\"}],\" Resource 的 \",[\"$\",\"code\",null,{\"children\":\"collection\"}],\" 方法將使用者的部落格文章加入到 Resource 回應中：\"]}]\n3a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\PostResource;\\nuse Illuminate\\\\Http\\\\Request;\\n\\n/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'email' =\u003e $this-\u003eemail,\\n        'posts' =\u003e PostResource::collection($this-\u003eposts),\\n        'created_at' =\u003e $this-\u003ecreated_at,\\n        'updated_at' =\u003e $this-\u003eupdated_at,\\n    ];\\n}\\n\"}]}]\n3b:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\n如果你只想在關聯已經載入時才包含它們，請查看\",[\"$\",\"a\",null,{\"href\":\"#conditional-relationships\",\"children\":\"條件式關聯\"}],\"的文件。\"]}],\"\\n\"]}]\n3c:[\"$\",\"h4\",null,{\"id\":\"resource-collections-2\",\"children\":[\"$\",\"a\",null,{\"hr"])</script><script>self.__next_f.push([1,"ef\":\"#resource-collections-2\",\"children\":\"Resource Collections\"}]}]\n3d:[\"$\",\"p\",null,{\"children\":[\"雖然 Resources 將單一 Model 轉換為陣列，但 Resource Collections 將 Model Collection 轉換為陣列。但是，並非絕對必要為每個 Model 定義一個 Resource Collection 類別，因為所有 Eloquent Model Collection 都提供 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法來動態產生「即時」Resource Collection：\"]}]\n3e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return User::all()-\u003etoResourceCollection();\\n});\\n\"}]}]\n3f:[\"$\",\"p\",null,{\"children\":\"但是，如果你需要自訂與 Collection 一起回傳的元資料，則有必要定義你自己的 Resource Collection：\"}]\n40:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection;\\n\\nclass UserCollection extends ResourceCollection\\n{\\n    /**\\n     * 將 Resource Collection 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return [\\n            'data' =\u003e $this-\u003ecollection,\\n            'links' =\u003e [\\n                'self' =\u003e 'link-value',\\n            ],\\n        ];\\n    }\\n}\\n\"}]}]\n41:[\"$\",\"p\",null,{\"children\":\"與單數 Resources 一樣，Resource Collections 可以直接從路由或控制器回傳：\"}]\n42:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserCollection;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return new UserCollection(User::all());\\n});\\n\"}]}]\n43:[\"$\",\"p\",null,{\"children\":[\"或者，為了方便起見，你可以使用 Eloquent Collection 的 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法，它會使用框架約定自動發現 Model 的底層 Resource Collection：\"]}]\n44:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::all()-\u003etoResourceCollection();\\n\"}]}]\n45:[\"$\",\"p\",null,{\"children\":[\"當呼叫 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法時，Laravel 會嘗試找到一個與 Model 名稱匹配且以 \",[\"$\",\"code\",null,{\"children\":\"Collection\"}],\" 為後綴的 Resource Collection，位於最接近 Model 命名空間的 \",[\"$\",\"code\",null,{\"children\":\"Http\\\\Resources\"}],\" 命名空間中。\"]}]\n46:[\"$\",\"h3\",null,{\"id\":\"資料包裝\",\"children\":[\"$\",\"a\",null,{\"href\":\"#資料包裝\",\"children\":\"資料包裝\"}]}]\n47:[\"$\",\"p\",null,{\"children\":[\"預設情況下，當 Resource 回應轉換為 JSON 時，最外層的 Resource 會被包裝在 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵中。因此，例如，一個典型的 Resource Collection 回應看起來像這樣：\"]}]\n48:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-json\",\"children\":\"{\\n    \\\"data\\\": [\\n        {\\n            \\\"id\\\": 1,\\n            \\\"name\\\": \\\"Eladio Schroeder Sr.\\\",\\n            \\\"email\\\": \\\"therese28@example.com\\\"\\n        },\\n        {\\n            \\\"id\\\": 2,\\n            \\\"name\\\": \\\"Liliana Mayert\\\",\\n            \\\"email\\\": \\\"evandervort@example.com\\\"\\n        }\\n    ]\\n}\\n\"}]}]\n49:[\"$\",\"p\",null,{\"children\":[\"如果你想停用最外層 Resource 的包裝，你應該在基礎 \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource\"}],\" 類別上呼叫 \",[\"$\",\"code\",null,{\"children\":\"withoutWrapping\"}],\" 方法。通常，你應該從 \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\" 或另一個在每次請求時載入的\",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/providers\",\"children\":\"服務提供者\"}],\"呼叫此方法：\"]}]\n4a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Providers;\\n\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource;\\nuse Illuminate\\\\Support\\\\ServiceProvide"])</script><script>self.__next_f.push([1,"r;\\n\\nclass AppServiceProvider extends ServiceProvider\\n{\\n    /**\\n     * 註冊任何應用程式服務。\\n     */\\n    public function register(): void\\n    {\\n        // ...\\n    }\\n\\n    /**\\n     * 啟動任何應用程式服務。\\n     */\\n    public function boot(): void\\n    {\\n        JsonResource::withoutWrapping();\\n    }\\n}\\n\"}]}]\n4b:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\n\",[\"$\",\"code\",null,{\"children\":\"withoutWrapping\"}],\" 方法只影響最外層的回應，不會移除你手動加入到自己 Resource Collections 的 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵。\"]}],\"\\n\"]}]\n4c:[\"$\",\"h4\",null,{\"id\":\"包裝巢狀-resources\",\"children\":[\"$\",\"a\",null,{\"href\":\"#包裝巢狀-resources\",\"children\":\"包裝巢狀 Resources\"}]}]\n4d:[\"$\",\"p\",null,{\"children\":[\"你可以完全自由地決定 Resource 的關聯如何被包裝。如果你希望所有 Resource Collections 都被包裝在 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵中，無論它們的巢狀層級如何，你應該為每個 Resource 定義一個 Resource Collection 類別，並在 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵中回傳 Collection。\"]}]\n4e:[\"$\",\"p\",null,{\"children\":[\"你可能會想知道這是否會導致最外層的 Resource 被包裝在兩個 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵中。別擔心，Laravel 永遠不會讓你的 Resources 意外地被雙重包裝，所以你不必擔心正在轉換的 Resource Collection 的巢狀層級：\"]}]\n4f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection;\\n\\nclass CommentsCollection extends ResourceCollection\\n{\\n    /**\\n     * 將 Resource Collection 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return ['data' =\u003e $this-\u003ecollection];\\n    }\\n}\\n\"}]}]\n50:[\"$\",\"h4\",null,{\"id\":\"資料包裝與分頁\",\"children\":[\"$\",\"a\",null,{\"href\":\"#資料包裝與分頁\",\"children\":\"資料包裝與分頁\"}]}]\n51:[\"$\",\"p\",null,{\"children\":[\"當透過 Resource 回應回傳分頁 Collections 時，即使呼叫了 \",[\"$\",\"code\",null,{\"children\":\"withoutWrapping\"}],\" 方法，Laravel 也會將 Resource 資料包裝在 \",[\"$\",\"code\",null,{\"children\":\"data\"}],\" 鍵中。這是因為分頁回應總是包含關於分頁器狀態的 \",[\"$\",\"code\",null,{\"children\":\"meta\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 鍵：\"]}]\n52:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-json\",\"children\":\"{\\n    \\\"data\\\": [\\n        {\\n            \\\"id\\\": 1,\\n            \\\"name\\\": \\\"Eladio Schroeder Sr.\\\",\\n            \\\"email\\\": \\\"therese28@example.com\\\"\\n        },\\n        {\\n            \\\"id\\\": 2,\\n            \\\"name\\\": \\\"Liliana Mayert\\\",\\n            \\\"email\\\": \\\"evandervort@example.com\\\"\\n        }\\n    ],\\n    \\\"links\\\":{\\n        \\\"first\\\": \\\"http://example.com/users?page=1\\\",\\n        \\\"last\\\": \\\"http://example.com/users?page=1\\\",\\n        \\\"prev\\\": null,\\n        \\\"next\\\": null\\n    },\\n    \\\"meta\\\":{\\n        \\\"current_page\\\": 1,\\n        \\\"from\\\": 1,\\n        \\\"last_page\\\": 1,\\n        \\\"path\\\": \\\"http://example.com/users\\\",\\n        \\\"per_page\\\": 15,\\n        \\\"to\\\": 10,\\n        \\\"total\\\": 10\\n    }\\n}\\n\"}]}]\n53:[\"$\",\"h3\",null,{\"id\":\"分頁\",\"children\":[\"$\",\"a\",null,{\"href\":\"#分頁\",\"children\":\"分頁\"}]}]\n54:[\"$\",\"p\",null,{\"children\":[\"你可以將 Laravel 分頁器實例傳遞給 Resource 的 \",[\"$\",\"code\",null,{\"children\":\"collection\"}],\" 方法或自訂 Resource Collection：\"]}]\n55:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserCollection;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/users', function () {\\n    return new UserCollection(User::paginate());\\n});\\n\"}]}]\n56:[\"$\",\"p\",null,{\"children\":[\"或者，為了方便起見，你可以使用分頁器的 \",[\"$\",\"code\",null,{\"children\":\"toResourceCollection\"}],\" 方法，它會使用框架約"])</script><script>self.__next_f.push([1,"定自動發現分頁 Model 的底層 Resource Collection：\"]}]\n57:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::paginate()-\u003etoResourceCollection();\\n\"}]}]\n58:[\"$\",\"p\",null,{\"children\":[\"分頁回應總是包含關於分頁器狀態的 \",[\"$\",\"code\",null,{\"children\":\"meta\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 鍵：\"]}]\n59:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-json\",\"children\":\"{\\n    \\\"data\\\": [\\n        {\\n            \\\"id\\\": 1,\\n            \\\"name\\\": \\\"Eladio Schroeder Sr.\\\",\\n            \\\"email\\\": \\\"therese28@example.com\\\"\\n        },\\n        {\\n            \\\"id\\\": 2,\\n            \\\"name\\\": \\\"Liliana Mayert\\\",\\n            \\\"email\\\": \\\"evandervort@example.com\\\"\\n        }\\n    ],\\n    \\\"links\\\":{\\n        \\\"first\\\": \\\"http://example.com/users?page=1\\\",\\n        \\\"last\\\": \\\"http://example.com/users?page=1\\\",\\n        \\\"prev\\\": null,\\n        \\\"next\\\": null\\n    },\\n    \\\"meta\\\":{\\n        \\\"current_page\\\": 1,\\n        \\\"from\\\": 1,\\n        \\\"last_page\\\": 1,\\n        \\\"path\\\": \\\"http://example.com/users\\\",\\n        \\\"per_page\\\": 15,\\n        \\\"to\\\": 10,\\n        \\\"total\\\": 10\\n    }\\n}\\n\"}]}]\n5a:[\"$\",\"h4\",null,{\"id\":\"自訂分頁資訊\",\"children\":[\"$\",\"a\",null,{\"href\":\"#自訂分頁資訊\",\"children\":\"自訂分頁資訊\"}]}]\n5b:[\"$\",\"p\",null,{\"children\":[\"如果你想自訂分頁回應中 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 或 \",[\"$\",\"code\",null,{\"children\":\"meta\"}],\" 鍵中包含的資訊，你可以在 Resource 上定義一個 \",[\"$\",\"code\",null,{\"children\":\"paginationInformation\"}],\" 方法。此方法會接收 \",[\"$\",\"code\",null,{\"children\":\"$$paginated\"}],\" 資料和 \",[\"$\",\"code\",null,{\"children\":\"$$default\"}],\" 資訊陣列，這是一個包含 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"meta\"}],\" 鍵的陣列：\"]}]\n5c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 自訂 Resource 的分頁資訊。\\n *\\n * @param  \\\\Illuminate\\\\Http\\\\Request  $request\\n * @param  array  $paginated\\n * @param  array  $default\\n * @return array\\n */\\npublic function paginationInformation($request, $paginated, $default)\\n{\\n    $default['links']['custom'] = 'https://example.com';\\n\\n    return $default;\\n}\\n\"}]}]\n5d:[\"$\",\"h3\",null,{\"id\":\"條件式屬性\",\"children\":[\"$\",\"a\",null,{\"href\":\"#條件式屬性\",\"children\":\"條件式屬性\"}]}]\n5e:[\"$\",\"p\",null,{\"children\":[\"有時你可能希望只在滿足給定條件時才在 Resource 回應中包含屬性。例如，你可能希望只在當前使用者是「管理員」時才包含一個值。Laravel 提供了各種輔助方法來協助你處理這種情況。\",[\"$\",\"code\",null,{\"children\":\"when\"}],\" 方法可用於有條件地將屬性加入到 Resource 回應中：\"]}]\n5f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'email' =\u003e $this-\u003eemail,\\n        'secret' =\u003e $this-\u003ewhen($request-\u003euser()-\u003eisAdmin(), 'secret-value'),\\n        'created_at' =\u003e $this-\u003ecreated_at,\\n        'updated_at' =\u003e $this-\u003eupdated_at,\\n    ];\\n}\\n\"}]}]\n60:[\"$\",\"p\",null,{\"children\":[\"在這個範例中，只有當已認證使用者的 \",[\"$\",\"code\",null,{\"children\":\"isAdmin\"}],\" 方法回傳 \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" 時，\",[\"$\",\"code\",null,{\"children\":\"secret\"}],\" 鍵才會在最終 Resource 回應中回傳。如果該方法回傳 \",[\"$\",\"code\",null,{\"children\":\"false\"}],\"，\",[\"$\",\"code\",null,{\"children\":\"secret\"}],\" 鍵會在 Resource 回應發送給客戶端之前被移除。\",[\"$\",\"code\",null,{\"children\":\"when\"}],\" 方法讓你可以表達性地定義 Resources，而無需在建構陣列時使用條件陳述式。\"]}]\n61:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"when\"}],\" 方法也接受閉包作為其第二個參數，讓你只在給定"])</script><script>self.__next_f.push([1,"條件為 \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" 時才計算結果值：\"]}]\n62:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'secret' =\u003e $this-\u003ewhen($request-\u003euser()-\u003eisAdmin(), function () {\\n    return 'secret-value';\\n}),\\n\"}]}]\n63:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"whenHas\"}],\" 方法可用於在屬性實際存在於底層 Model 時包含它：\"]}]\n64:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'name' =\u003e $this-\u003ewhenHas('name'),\\n\"}]}]\n65:[\"$\",\"p\",null,{\"children\":[\"此外，\",[\"$\",\"code\",null,{\"children\":\"whenNotNull\"}],\" 方法可用於在屬性不為 null 時將它包含在 Resource 回應中：\"]}]\n66:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'name' =\u003e $this-\u003ewhenNotNull($this-\u003ename),\\n\"}]}]\n67:[\"$\",\"h4\",null,{\"id\":\"合併條件式屬性\",\"children\":[\"$\",\"a\",null,{\"href\":\"#合併條件式屬性\",\"children\":\"合併條件式屬性\"}]}]\n68:[\"$\",\"p\",null,{\"children\":[\"有時你可能有多個屬性應該只在相同條件下包含在 Resource 回應中。在這種情況下，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"mergeWhen\"}],\" 方法，只在給定條件為 \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" 時才將屬性包含在回應中：\"]}]\n69:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'email' =\u003e $this-\u003eemail,\\n        $this-\u003emergeWhen($request-\u003euser()-\u003eisAdmin(), [\\n            'first-secret' =\u003e 'value',\\n            'second-secret' =\u003e 'value',\\n        ]),\\n        'created_at' =\u003e $this-\u003ecreated_at,\\n        'updated_at' =\u003e $this-\u003eupdated_at,\\n    ];\\n}\\n\"}]}]\n6a:[\"$\",\"p\",null,{\"children\":[\"同樣地，如果給定條件為 \",[\"$\",\"code\",null,{\"children\":\"false\"}],\"，這些屬性會在 Resource 回應發送給客戶端之前被移除。\"]}]\n6b:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\n\",[\"$\",\"code\",null,{\"children\":\"mergeWhen\"}],\" 方法不應該用於混合字串和數字鍵的陣列中。此外，它不應該用於數字鍵未按順序排列的陣列中。\"]}],\"\\n\"]}]\n6c:[\"$\",\"h3\",null,{\"id\":\"條件式關聯\",\"children\":[\"$\",\"a\",null,{\"href\":\"#條件式關聯\",\"children\":\"條件式關聯\"}]}]\n6d:[\"$\",\"p\",null,{\"children\":\"除了有條件地載入屬性之外，你還可以根據關聯是否已經載入到 Model 上，有條件地在 Resource 回應中包含關聯。這讓你的控制器可以決定哪些關聯應該載入到 Model 上，而 Resource 可以在它們實際被載入時才輕鬆地包含它們。最終，這讓你更容易避免 Resources 中的「N+1」查詢問題。\"}]\n6e:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"whenLoaded\"}],\" 方法可用於有條件地載入關聯。為了避免不必要地載入關聯，此方法接受關聯的名稱而不是關聯本身：\"]}]\n6f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\PostResource;\\n\\n/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'email' =\u003e $this-\u003eemail,\\n        'posts' =\u003e PostResource::collection($this-\u003ewhenLoaded('posts')),\\n        'created_at' =\u003e $this-\u003ecreated_at,\\n        'updated_at' =\u003e $this-\u003eupdated_at,\\n    ];\\n}\\n\"}]}]\n70:[\"$\",\"p\",null,{\"children\":[\"在這個範例中，如果關聯尚未載入，\",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" 鍵會在 Resource 回應發送給客戶端之前被移除。\"]}]\n71:[\"$\",\"h4\",null,{\"id\":\"條件式關聯計數\",\"children\":[\"$\",\"a\",null,{\"href\":\"#條件式關聯計數\",\"children\":\"條件式關聯計數\"}]}]\n72:[\"$\",\"p\",null,{\"children\":\"除了有條件地包含關聯之外，你還可以根據關聯的計"])</script><script>self.__next_f.push([1,"數是否已載入到 Model 上，有條件地在 Resource 回應中包含關聯「計數」：\"}]\n73:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"new UserResource($user-\u003eloadCount('posts'));\\n\"}]}]\n74:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"whenCounted\"}],\" 方法可用於有條件地在 Resource 回應中包含關聯的計數。如果關聯的計數不存在，此方法會避免不必要地包含屬性：\"]}]\n75:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'email' =\u003e $this-\u003eemail,\\n        'posts_count' =\u003e $this-\u003ewhenCounted('posts'),\\n        'created_at' =\u003e $this-\u003ecreated_at,\\n        'updated_at' =\u003e $this-\u003eupdated_at,\\n    ];\\n}\\n\"}]}]\n76:[\"$\",\"p\",null,{\"children\":[\"在這個範例中，如果 \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" 關聯的計數尚未載入，\",[\"$\",\"code\",null,{\"children\":\"posts_count\"}],\" 鍵會在 Resource 回應發送給客戶端之前被移除。\"]}]\n77:[\"$\",\"p\",null,{\"children\":[\"其他類型的聚合，如 \",[\"$\",\"code\",null,{\"children\":\"avg\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"sum\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"min\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"max\"}],\"，也可以使用 \",[\"$\",\"code\",null,{\"children\":\"whenAggregated\"}],\" 方法有條件地載入：\"]}]\n78:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'words_avg' =\u003e $this-\u003ewhenAggregated('posts', 'words', 'avg'),\\n'words_sum' =\u003e $this-\u003ewhenAggregated('posts', 'words', 'sum'),\\n'words_min' =\u003e $this-\u003ewhenAggregated('posts', 'words', 'min'),\\n'words_max' =\u003e $this-\u003ewhenAggregated('posts', 'words', 'max'),\\n\"}]}]\n79:[\"$\",\"h4\",null,{\"id\":\"條件式-pivot-資訊\",\"children\":[\"$\",\"a\",null,{\"href\":\"#條件式-pivot-資訊\",\"children\":\"條件式 Pivot 資訊\"}]}]\n7a:[\"$\",\"p\",null,{\"children\":[\"除了有條件地在 Resource 回應中包含關聯資訊之外，你還可以使用 \",[\"$\",\"code\",null,{\"children\":\"whenPivotLoaded\"}],\" 方法有條件地包含多對多關聯的中間資料表的資料。\",[\"$\",\"code\",null,{\"children\":\"whenPivotLoaded\"}],\" 方法接受 pivot 資料表的名稱作為其第一個參數。第二個參數應該是一個閉包，它回傳當 Model 上有 pivot 資訊時要回傳的值：\"]}]\n7b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'expires_at' =\u003e $this-\u003ewhenPivotLoaded('role_user', function () {\\n            return $this-\u003epivot-\u003eexpires_at;\\n        }),\\n    ];\\n}\\n\"}]}]\n7c:[\"$\",\"p\",null,{\"children\":[\"如果你的關聯使用\",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/eloquent-relationships#defining-custom-intermediate-table-models\",\"children\":\"自訂中間資料表 Model\"}],\"，你可以將中間資料表 Model 的實例作為第一個參數傳遞給 \",[\"$\",\"code\",null,{\"children\":\"whenPivotLoaded\"}],\" 方法：\"]}]\n7d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'expires_at' =\u003e $this-\u003ewhenPivotLoaded(new Membership, function () {\\n    return $this-\u003epivot-\u003eexpires_at;\\n}),\\n\"}]}]\n7e:[\"$\",\"p\",null,{\"children\":[\"如果你的中間資料表使用的存取器不是 \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\"，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"whenPivotLoadedAs\"}],\" 方法：\"]}]\n7f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'id' =\u003e $this-\u003eid,\\n        'name' =\u003e $this-\u003ename,\\n        'expires_at' =\u003e $this-\u003ewhenPivotLoadedAs('subscription', 'ro"])</script><script>self.__next_f.push([1,"le_user', function () {\\n            return $this-\u003esubscription-\u003eexpires_at;\\n        }),\\n    ];\\n}\\n\"}]}]\n80:[\"$\",\"h3\",null,{\"id\":\"新增元資料\",\"children\":[\"$\",\"a\",null,{\"href\":\"#新增元資料\",\"children\":\"新增元資料\"}]}]\n81:[\"$\",\"p\",null,{\"children\":[\"一些 JSON API 標準要求在 Resource 和 Resource Collection 回應中新增元資料。這通常包括 Resource 或相關 Resources 的 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\"，或關於 Resource 本身的元資料。如果你需要回傳關於 Resource 的額外元資料，請將其包含在你的 \",[\"$\",\"code\",null,{\"children\":\"toArray\"}],\" 方法中。例如，你可能在轉換 Resource Collection 時包含 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 資訊：\"]}]\n82:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * 將 Resource 轉換為陣列。\\n *\\n * @return array\u003cstring, mixed\u003e\\n */\\npublic function toArray(Request $request): array\\n{\\n    return [\\n        'data' =\u003e $this-\u003ecollection,\\n        'links' =\u003e [\\n            'self' =\u003e 'link-value',\\n        ],\\n    ];\\n}\\n\"}]}]\n83:[\"$\",\"p\",null,{\"children\":[\"當從 Resources 回傳額外的元資料時，你永遠不必擔心意外覆蓋 Laravel 在回傳分頁回應時自動新增的 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 或 \",[\"$\",\"code\",null,{\"children\":\"meta\"}],\" 鍵。你定義的任何額外 \",[\"$\",\"code\",null,{\"children\":\"links\"}],\" 都會與分頁器提供的連結合併。\"]}]\n84:[\"$\",\"h4\",null,{\"id\":\"頂層元資料\",\"children\":[\"$\",\"a\",null,{\"href\":\"#頂層元資料\",\"children\":\"頂層元資料\"}]}]\n85:[\"$\",\"p\",null,{\"children\":[\"有時你可能希望只在 Resource 是正在回傳的最外層 Resource 時才包含某些元資料。通常，這包括關於整個回應的元資訊。要定義此元資料，請在 Resource 類別中新增一個 \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" 方法。此方法應該回傳一個元資料陣列，只有當 Resource 是正在轉換的最外層 Resource 時才會包含在 Resource 回應中：\"]}]\n86:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\ResourceCollection;\\n\\nclass UserCollection extends ResourceCollection\\n{\\n    /**\\n     * 將 Resource Collection 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return parent::toArray($request);\\n    }\\n\\n    /**\\n     * 取得應該與 Resource 陣列一起回傳的額外資料。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function with(Request $request): array\\n    {\\n        return [\\n            'meta' =\u003e [\\n                'key' =\u003e 'value',\\n            ],\\n        ];\\n    }\\n}\\n\"}]}]\n87:[\"$\",\"h4\",null,{\"id\":\"在建構-resources-時新增元資料\",\"children\":[\"$\",\"a\",null,{\"href\":\"#在建構-resources-時新增元資料\",\"children\":\"在建構 Resources 時新增元資料\"}]}]\n88:[\"$\",\"p\",null,{\"children\":[\"你也可以在路由或控制器中建構 Resource 實例時新增頂層資料。所有 Resources 都有 \",[\"$\",\"code\",null,{\"children\":\"additional\"}],\" 方法，它接受一個應該新增到 Resource 回應的資料陣列：\"]}]\n89:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return User::all()\\n    -\u003eload('roles')\\n    -\u003etoResourceCollection()\\n    -\u003eadditional(['meta' =\u003e [\\n        'key' =\u003e 'value',\\n    ]]);\\n\"}]}]\n8a:[\"$\",\"h2\",null,{\"id\":\"resource-回應\",\"children\":[\"$\",\"a\",null,{\"href\":\"#resource-回應\",\"children\":\"Resource 回應\"}]}]\n8b:[\"$\",\"p\",null,{\"children\":\"如你所讀，Resources 可以直接從路由和控制器回傳：\"}]\n8c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\nRoute::get('/user/{id}', function (string $id) {\\n    return User::findOrFail($id)-\u003etoResource();\\n});\\n\"}]}]\n8d:[\"$\",\"p\",null,{\"children\":[\"但是，有時你可能需要在將傳出的 HTTP 回應發送給客戶端之前"])</script><script>self.__next_f.push([1,"自訂它。有兩種方式可以完成這個操作。首先，你可以在 Resource 上鏈接 \",[\"$\",\"code\",null,{\"children\":\"response\"}],\" 方法。此方法會回傳一個 \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Http\\\\JsonResponse\"}],\" 實例，讓你完全控制回應的標頭：\"]}]\n8e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Http\\\\Resources\\\\UserResource;\\nuse App\\\\Models\\\\User;\\n\\nRoute::get('/user', function () {\\n    return User::find(1)\\n        -\u003etoResource()\\n        -\u003eresponse()\\n        -\u003eheader('X-Value', 'True');\\n});\\n\"}]}]\n8f:[\"$\",\"p\",null,{\"children\":[\"或者，你可以在 Resource 本身中定義一個 \",[\"$\",\"code\",null,{\"children\":\"withResponse\"}],\" 方法。當 Resource 作為回應中最外層的 Resource 回傳時，會呼叫此方法：\"]}]\n90:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Resources;\\n\\nuse Illuminate\\\\Http\\\\JsonResponse;\\nuse Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Http\\\\Resources\\\\Json\\\\JsonResource;\\n\\nclass UserResource extends JsonResource\\n{\\n    /**\\n     * 將 Resource 轉換為陣列。\\n     *\\n     * @return array\u003cstring, mixed\u003e\\n     */\\n    public function toArray(Request $request): array\\n    {\\n        return [\\n            'id' =\u003e $this-\u003eid,\\n        ];\\n    }\\n\\n    /**\\n     * 自訂 Resource 的傳出回應。\\n     */\\n    public function withResponse(Request $request, JsonResponse $response): void\\n    {\\n        $response-\u003eheader('X-Value', 'True');\\n    }\\n}\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"91:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L91\",\"3\",{}]]\n8:null\n"])</script></body></html>