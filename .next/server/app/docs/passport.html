<!DOCTYPE html><!--kE5s4wNidqhVn8fA906WC--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/bc6e94e20a39014e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/2b257daea29fbb42.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs（中文）</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a><a class="block" href="/docs/frontend"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">前端</button></a><a class="block" href="/docs/starter-kits"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">啟動套件</button></a><a class="block" href="/docs/deployment"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">部署</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Passport</h1><p class="text-xl text-muted-foreground mt-2">Laravel Passport 為你的應用程式提供完整的 OAuth2 伺服器實作</p></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="laravel-passport"><a href="#laravel-passport">Laravel Passport</a></h1>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#passport-or-sanctum">Passport or Sanctum?</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a>
<ul>
<li><a href="#deploying-passport">Deploying Passport</a></li>
<li><a href="#upgrading-passport">Upgrading Passport</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#token-lifetimes">Token Lifetimes</a></li>
<li><a href="#overriding-default-models">Overriding Default Models</a></li>
<li><a href="#overriding-routes">Overriding Routes</a></li>
</ul>
</li>
<li><a href="#authorization-code-grant">Authorization Code Grant</a>
<ul>
<li><a href="#managing-clients">Managing Clients</a></li>
<li><a href="#requesting-tokens">Requesting Tokens</a></li>
<li><a href="#managing-tokens">Managing Tokens</a></li>
<li><a href="#refreshing-tokens">Refreshing Tokens</a></li>
<li><a href="#revoking-tokens">Revoking Tokens</a></li>
<li><a href="#purging-tokens">Purging Tokens</a></li>
</ul>
</li>
<li><a href="#code-grant-pkce">Authorization Code Grant With PKCE</a>
<ul>
<li><a href="#creating-a-auth-pkce-grant-client">Creating the Client</a></li>
<li><a href="#requesting-auth-pkce-grant-tokens">Requesting Tokens</a></li>
</ul>
</li>
<li><a href="#device-authorization-grant">Device Authorization Grant</a>
<ul>
<li><a href="#creating-a-device-authorization-grant-client">Creating a Device Code Grant Client</a></li>
<li><a href="#requesting-device-authorization-grant-tokens">Requesting Tokens</a></li>
</ul>
</li>
<li><a href="#password-grant">Password Grant</a>
<ul>
<li><a href="#creating-a-password-grant-client">Creating a Password Grant Client</a></li>
<li><a href="#requesting-password-grant-tokens">Requesting Tokens</a></li>
<li><a href="#requesting-all-scopes">Requesting All Scopes</a></li>
<li><a href="#customizing-the-user-provider">Customizing the User Provider</a></li>
<li><a href="#customizing-the-username-field">Customizing the Username Field</a></li>
<li><a href="#customizing-the-password-validation">Customizing the Password Validation</a></li>
</ul>
</li>
<li><a href="#implicit-grant">Implicit Grant</a></li>
<li><a href="#client-credentials-grant">Client Credentials Grant</a></li>
<li><a href="#personal-access-tokens">Personal Access Tokens</a>
<ul>
<li><a href="#creating-a-personal-access-client">Creating a Personal Access Client</a></li>
<li><a href="#customizing-the-user-provider-for-pat">Customizing the User Provider</a></li>
<li><a href="#managing-personal-access-tokens">Managing Personal Access Tokens</a></li>
</ul>
</li>
<li><a href="#protecting-routes">Protecting Routes</a>
<ul>
<li><a href="#via-middleware">Via Middleware</a></li>
<li><a href="#passing-the-access-token">Passing the Access Token</a></li>
</ul>
</li>
<li><a href="#token-scopes">Token Scopes</a>
<ul>
<li><a href="#defining-scopes">Defining Scopes</a></li>
<li><a href="#default-scope">Default Scope</a></li>
<li><a href="#assigning-scopes-to-tokens">Assigning Scopes to Tokens</a></li>
<li><a href="#checking-scopes">Checking Scopes</a></li>
</ul>
</li>
<li><a href="#spa-authentication">SPA Authentication</a></li>
<li><a href="#events">Events</a></li>
<li><a href="#testing">Testing</a></li>
</ul>
<a name="introduction"></a>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p><a href="https://github.com/laravel/passport">Laravel Passport</a> provides a full OAuth2 server implementation for your Laravel application in a matter of minutes. Passport is built on top of the <a href="https://github.com/thephpleague/oauth2-server">League OAuth2 server</a> that is maintained by Andy Millington and Simon Hamp.</p>
<blockquote>
<p>[!NOTE]
This documentation assumes you are already familiar with OAuth2. If you do not know anything about OAuth2, consider familiarizing yourself with the general <a href="https://oauth2.thephpleague.com/terminology/">terminology</a> and features of OAuth2 before continuing.</p>
</blockquote>
<a name="passport-or-sanctum"></a>
<h3 id="passport-or-sanctum"><a href="#passport-or-sanctum">Passport or Sanctum?</a></h3>
<p>Before getting started, you may wish to determine if your application would be better served by Laravel Passport or <a href="/docs/sanctum">Laravel Sanctum</a>. If your application absolutely needs to support OAuth2, then you should use Laravel Passport.</p>
<p>However, if you are attempting to authenticate a single-page application, mobile application, or issue API tokens, you should use <a href="/docs/sanctum">Laravel Sanctum</a>. Laravel Sanctum does not support OAuth2; however, it provides a much simpler API authentication development experience.</p>
<a name="installation"></a>
<h2 id="安裝"><a href="#安裝">安裝</a></h2>
<p>You may install Laravel Passport via the <code>install:api</code> Artisan command:</p>
<pre><code class="language-shell">php artisan install:api --passport
</code></pre>
<p>This command will publish and run the database migrations necessary for creating the tables your application needs to store OAuth2 clients and access tokens. The command will also create the encryption keys required to generate secure access tokens.</p>
<p>After running the <code>install:api</code> command, add the <code>Laravel\Passport\HasApiTokens</code> trait and <code>Laravel\Passport\Contracts\OAuthenticatable</code> interface to your <code>App\Models\User</code> model. This trait will provide a few helper methods to your model which allow you to inspect the authenticated user&#x27;s token and scopes:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Laravel\Passport\Contracts\OAuthenticatable;
use Laravel\Passport\HasApiTokens;

class User extends Authenticatable implements OAuthenticatable
{
    use HasApiTokens, HasFactory, Notifiable;
}
</code></pre>
<p>Finally, in your application&#x27;s <code>config/auth.php</code> configuration file, you should define an <code>api</code> authentication guard and set the <code>driver</code> option to <code>passport</code>. This will instruct your application to use Passport&#x27;s <code>TokenGuard</code> when authenticating incoming API requests:</p>
<pre><code class="language-php">&#x27;guards&#x27; =&gt; [
    &#x27;web&#x27; =&gt; [
        &#x27;driver&#x27; =&gt; &#x27;session&#x27;,
        &#x27;provider&#x27; =&gt; &#x27;users&#x27;,
    ],

    &#x27;api&#x27; =&gt; [
        &#x27;driver&#x27; =&gt; &#x27;passport&#x27;,
        &#x27;provider&#x27; =&gt; &#x27;users&#x27;,
    ],
],
</code></pre>
<a name="deploying-passport"></a>
<h3 id="deploying-passport"><a href="#deploying-passport">Deploying Passport</a></h3>
<p>When deploying Passport to your application&#x27;s servers for the first time, you will likely need to run the <code>passport:keys</code> command. This command generates the encryption keys Passport needs in order to generate access tokens. The generated keys are not typically kept in source control:</p>
<pre><code class="language-shell">php artisan passport:keys
</code></pre>
<p>If necessary, you may define the path where Passport&#x27;s keys should be loaded from. You may use the <code>Passport::loadKeysFrom</code> method to accomplish this. Typically, this method should be called from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::loadKeysFrom(__DIR__.&#x27;/../secrets/oauth&#x27;);
}
</code></pre>
<a name="loading-keys-from-the-environment"></a>
<h4 id="loading-keys-from-the-environment"><a href="#loading-keys-from-the-environment">Loading Keys From the Environment</a></h4>
<p>Alternatively, you may publish Passport&#x27;s configuration file using the <code>vendor:publish</code> Artisan command:</p>
<pre><code class="language-shell">php artisan vendor:publish --tag=passport-config
</code></pre>
<p>After the configuration file has been published, you may load your application&#x27;s encryption keys by defining them as environment variables:</p>
<pre><code class="language-ini">PASSPORT_PRIVATE_KEY=&quot;-----BEGIN RSA PRIVATE KEY-----
&lt;private key here&gt;
-----END RSA PRIVATE KEY-----&quot;

PASSPORT_PUBLIC_KEY=&quot;-----BEGIN PUBLIC KEY-----
&lt;public key here&gt;
-----END PUBLIC KEY-----&quot;
</code></pre>
<a name="upgrading-passport"></a>
<h3 id="upgrading-passport"><a href="#upgrading-passport">Upgrading Passport</a></h3>
<p>When upgrading to a new major version of Passport, it&#x27;s important that you carefully review <a href="https://github.com/laravel/passport/blob/master/UPGRADE.md">the upgrade guide</a>.</p>
<a name="configuration"></a>
<h2 id="設定"><a href="#設定">設定</a></h2>
<a name="token-lifetimes"></a>
<h3 id="token-lifetimes"><a href="#token-lifetimes">Token Lifetimes</a></h3>
<p>By default, Passport issues long-lived access tokens that expire after one year. If you would like to configure a longer / shorter token lifetime, you may use the <code>tokensExpireIn</code>, <code>refreshTokensExpireIn</code>, and <code>personalAccessTokensExpireIn</code> methods. These methods should be called from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">use Carbon\CarbonInterval;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::tokensExpireIn(CarbonInterval::days(15));
    Passport::refreshTokensExpireIn(CarbonInterval::days(30));
    Passport::personalAccessTokensExpireIn(CarbonInterval::months(6));
}
</code></pre>
<blockquote>
<p>[!WARNING]
The <code>expires_at</code> columns on Passport&#x27;s database tables are read-only and for display purposes only. When issuing tokens, Passport stores the expiration information within the signed and encrypted tokens. If you need to invalidate a token you should <a href="#revoking-tokens">revoke it</a>.</p>
</blockquote>
<a name="overriding-default-models"></a>
<h3 id="overriding-default-models"><a href="#overriding-default-models">Overriding Default Models</a></h3>
<p>You are free to extend the models used internally by Passport by defining your own model and extending the corresponding Passport model:</p>
<pre><code class="language-php">use Laravel\Passport\Client as PassportClient;

class Client extends PassportClient
{
    // ...
}
</code></pre>
<p>After defining your model, you may instruct Passport to use your custom model via the <code>Laravel\Passport\Passport</code> class. Typically, you should inform Passport about your custom models in the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">use App\Models\Passport\AuthCode;
use App\Models\Passport\Client;
use App\Models\Passport\DeviceCode;
use App\Models\Passport\RefreshToken;
use App\Models\Passport\Token;
use Laravel\Passport\Passport;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::useTokenModel(Token::class);
    Passport::useRefreshTokenModel(RefreshToken::class);
    Passport::useAuthCodeModel(AuthCode::class);
    Passport::useClientModel(Client::class);
    Passport::useDeviceCodeModel(DeviceCode::class);
}
</code></pre>
<a name="overriding-routes"></a>
<h3 id="overriding-routes"><a href="#overriding-routes">Overriding Routes</a></h3>
<p>Sometimes you may wish to customize the routes defined by Passport. To achieve this, you first need to ignore the routes registered by Passport by adding <code>Passport::ignoreRoutes</code> to the <code>register</code> method of your application&#x27;s <code>AppServiceProvider</code>:</p>
<pre><code class="language-php">use Laravel\Passport\Passport;

/**
 * Register any application services.
 */
public function register(): void
{
    Passport::ignoreRoutes();
}
</code></pre>
<p>Then, you may copy the routes defined by Passport in <a href="https://github.com/laravel/passport/blob/master/routes/web.php">its routes file</a> to your application&#x27;s <code>routes/web.php</code> file and modify them to your liking:</p>
<pre><code class="language-php">Route::group([
    &#x27;as&#x27; =&gt; &#x27;passport.&#x27;,
    &#x27;prefix&#x27; =&gt; config(&#x27;passport.path&#x27;, &#x27;oauth&#x27;),
    &#x27;namespace&#x27; =&gt; &#x27;\Laravel\Passport\Http\Controllers&#x27;,
], function () {
    // Passport routes...
});
</code></pre>
<a name="authorization-code-grant"></a>
<h2 id="authorization-code-grant"><a href="#authorization-code-grant">Authorization Code Grant</a></h2>
<p>Using OAuth2 via authorization codes is how most developers are familiar with OAuth2. When using authorization codes, a client application will redirect a user to your server where they will either approve or deny the request to issue an access token to the client.</p>
<p>To get started, we need to instruct Passport how to return our &quot;authorization&quot; view.</p>
<p>All the authorization view&#x27;s rendering logic may be customized using the appropriate methods available via the <code>Laravel\Passport\Passport</code> class. Typically, you should call this method from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">use Inertia\Inertia;
use Laravel\Passport\Passport;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    // By providing a view name...
    Passport::authorizationView(&#x27;auth.oauth.authorize&#x27;);

    // By providing a closure...
    Passport::authorizationView(
        fn ($parameters) =&gt; Inertia::render(&#x27;Auth/OAuth/Authorize&#x27;, [
            &#x27;request&#x27; =&gt; $parameters[&#x27;request&#x27;],
            &#x27;authToken&#x27; =&gt; $parameters[&#x27;authToken&#x27;],
            &#x27;client&#x27; =&gt; $parameters[&#x27;client&#x27;],
            &#x27;user&#x27; =&gt; $parameters[&#x27;user&#x27;],
            &#x27;scopes&#x27; =&gt; $parameters[&#x27;scopes&#x27;],
        ])
    );
}
</code></pre>
<p>Passport will automatically define the <code>/oauth/authorize</code> route that returns this view. Your <code>auth.oauth.authorize</code> template should include a form that makes a POST request to the <code>passport.authorizations.approve</code> route to approve the authorization and a form that makes a DELETE request to the <code>passport.authorizations.deny</code> route to deny the authorization. The <code>passport.authorizations.approve</code> and <code>passport.authorizations.deny</code> routes expect <code>state</code>, <code>client_id</code>, and <code>auth_token</code> fields.</p>
<a name="managing-clients"></a>
<h3 id="managing-clients"><a href="#managing-clients">Managing Clients</a></h3>
<p>Developers building applications that need to interact with your application&#x27;s API will need to register their application with yours by creating a &quot;client&quot;. Typically, this consists of providing the name of their application and a URI that your application can redirect to after users approve their request for authorization.</p>
<a name="managing-first-party-clients"></a>
<h4 id="first-party-clients"><a href="#first-party-clients">First-Party Clients</a></h4>
<p>The simplest way to create a client is using the <code>passport:client</code> Artisan command. This command may be used to create first-party clients or testing your OAuth2 functionality. When you run the <code>passport:client</code> command, Passport will prompt you for more information about your client and will provide you with a client ID and secret:</p>
<pre><code class="language-shell">php artisan passport:client
</code></pre>
<p>If you would like to allow multiple redirect URIs for your client, you may specify them using a comma-delimited list when prompted for the URI by the <code>passport:client</code> command. Any URIs which contain commas should be URI encoded:</p>
<pre><code class="language-shell">https://third-party-app.com/callback,https://example.com/oauth/redirect
</code></pre>
<a name="managing-third-party-clients"></a>
<h4 id="third-party-clients"><a href="#third-party-clients">Third-Party Clients</a></h4>
<p>Since your application&#x27;s users will not be able to utilize the <code>passport:client</code> command, you may use <code>createAuthorizationCodeGrantClient</code> method of the <code>Laravel\Passport\ClientRepository</code> class to register a client for a given user:</p>
<pre><code class="language-php">use App\Models\User;
use Laravel\Passport\ClientRepository;

$user = User::find($userId);

// Creating an OAuth app client that belongs to the given user...
$client = app(ClientRepository::class)-&gt;createAuthorizationCodeGrantClient(
    user: $user,
    name: &#x27;Example App&#x27;,
    redirectUris: [&#x27;https://third-party-app.com/callback&#x27;],
    confidential: false,
    enableDeviceFlow: true
);

// Retrieving all the OAuth app clients that belong to the user...
$clients = $user-&gt;oauthApps()-&gt;get();
</code></pre>
<p>The <code>createAuthorizationCodeGrantClient</code> method returns an instance of <code>Laravel\Passport\Client</code>. You may display the <code>$client-&gt;id</code> as the client ID and <code>$client-&gt;plainSecret</code> as the client secret to the user.</p>
<a name="requesting-tokens"></a>
<h3 id="requesting-tokens"><a href="#requesting-tokens">Requesting Tokens</a></h3>
<a name="requesting-tokens-redirecting-for-authorization"></a>
<h4 id="redirecting-for-authorization"><a href="#redirecting-for-authorization">Redirecting for Authorization</a></h4>
<p>Once a client has been created, developers may use their client ID and secret to request an authorization code and access token from your application. First, the consuming application should make a redirect request to your application&#x27;s <code>/oauth/authorize</code> route like so:</p>
<pre><code class="language-php">use Illuminate\Http\Request;
use Illuminate\Support\Str;

Route::get(&#x27;/redirect&#x27;, function (Request $request) {
    $request-&gt;session()-&gt;put(&#x27;state&#x27;, $state = Str::random(40));

    $query = http_build_query([
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;response_type&#x27; =&gt; &#x27;code&#x27;,
        &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
        &#x27;state&#x27; =&gt; $state,
        // &#x27;prompt&#x27; =&gt; &#x27;&#x27;, // &quot;none&quot;, &quot;consent&quot;, or &quot;login&quot;
    ]);

    return redirect(&#x27;https://passport-app.test/oauth/authorize?&#x27;.$query);
});
</code></pre>
<p>The <code>prompt</code> parameter may be used to specify the authentication behavior of the Passport application.</p>
<p>If the <code>prompt</code> value is <code>none</code>, Passport will always throw an authentication error if the user is not already authenticated with the Passport application. If the value is <code>consent</code>, Passport will always display the authorization approval screen, even if all scopes were previously granted to the consuming application. When the value is <code>login</code>, the Passport application will always prompt the user to re-login to the application, even if they already have an existing session.</p>
<p>If no <code>prompt</code> value is provided, the user will be prompted for authorization only if they have not previously authorized access to the consuming application for the requested scopes.</p>
<blockquote>
<p>[!NOTE]
Remember, the <code>/oauth/authorize</code> route is already defined by Passport. You do not need to manually define this route.</p>
</blockquote>
<a name="approving-the-request"></a>
<h4 id="approving-the-request"><a href="#approving-the-request">Approving the Request</a></h4>
<p>When receiving authorization requests, Passport will automatically respond based on the value of <code>prompt</code> parameter (if present) and may display a template to the user allowing them to approve or deny the authorization request. If they approve the request, they will be redirected back to the <code>redirect_uri</code> that was specified by the consuming application. The <code>redirect_uri</code> must match the <code>redirect</code> URL that was specified when the client was created.</p>
<p>Sometimes you may wish to skip the authorization prompt, such as when authorizing a first-party client. You may accomplish this by <a href="#overriding-default-models">extending the <code>Client</code> model</a> and defining a <code>skipsAuthorization</code> method. If <code>skipsAuthorization</code> returns <code>true</code> the client will be approved and the user will be redirected back to the <code>redirect_uri</code> immediately, unless the consuming application has explicitly set the <code>prompt</code> parameter when redirecting for authorization:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models\Passport;

use Illuminate\Contracts\Auth\Authenticatable;
use Laravel\Passport\Client as BaseClient;

class Client extends BaseClient
{
    /**
     * Determine if the client should skip the authorization prompt.
     *
     * @param  \Laravel\Passport\Scope[]  $scopes
     */
    public function skipsAuthorization(Authenticatable $user, array $scopes): bool
    {
        return $this-&gt;firstParty();
    }
}
</code></pre>
<a name="requesting-tokens-converting-authorization-codes-to-access-tokens"></a>
<h4 id="converting-authorization-codes-to-access-tokens"><a href="#converting-authorization-codes-to-access-tokens">Converting Authorization Codes to Access Tokens</a></h4>
<p>If the user approves the authorization request, they will be redirected back to the consuming application. The consumer should first verify the <code>state</code> parameter against the value that was stored prior to the redirect. If the state parameter matches then the consumer should issue a <code>POST</code> request to your application to request an access token. The request should include the authorization code that was issued by your application when the user approved the authorization request:</p>
<pre><code class="language-php">use Illuminate\Http\Request;
use Illuminate\Support\Facades\Http;

Route::get(&#x27;/callback&#x27;, function (Request $request) {
    $state = $request-&gt;session()-&gt;pull(&#x27;state&#x27;);

    throw_unless(
        strlen($state) &gt; 0 &amp;&amp; $state === $request-&gt;state,
        InvalidArgumentException::class,
        &#x27;Invalid state value.&#x27;
    );

    $response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
        &#x27;grant_type&#x27; =&gt; &#x27;authorization_code&#x27;,
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;code&#x27; =&gt; $request-&gt;code,
    ]);

    return $response-&gt;json();
});
</code></pre>
<p>This <code>/oauth/token</code> route will return a JSON response containing <code>access_token</code>, <code>refresh_token</code>, and <code>expires_in</code> attributes. The <code>expires_in</code> attribute contains the number of seconds until the access token expires.</p>
<blockquote>
<p>[!NOTE]
Like the <code>/oauth/authorize</code> route, the <code>/oauth/token</code> route is defined for you by Passport. There is no need to manually define this route.</p>
</blockquote>
<a name="managing-tokens"></a>
<h3 id="managing-tokens"><a href="#managing-tokens">Managing Tokens</a></h3>
<p>You may retrieve user&#x27;s authorized tokens using the <code>tokens</code> method of the <code>Laravel\Passport\HasApiTokens</code> trait. For example, this may be used to offer your users a dashboard to keep track of their connections with third-party applications:</p>
<pre><code class="language-php">use App\Models\User;
use Illuminate\Database\Eloquent\Collection;
use Illuminate\Support\Facades\Date;
use Laravel\Passport\Token;

$user = User::find($userId);

// Retrieving all of the valid tokens for the user...
$tokens = $user-&gt;tokens()
    -&gt;where(&#x27;revoked&#x27;, false)
    -&gt;where(&#x27;expires_at&#x27;, &#x27;&gt;&#x27;, Date::now())
    -&gt;get();

// Retrieving all the user&#x27;s connections to third-party OAuth app clients...
$connections = $tokens-&gt;load(&#x27;client&#x27;)
    -&gt;reject(fn (Token $token) =&gt; $token-&gt;client-&gt;firstParty())
    -&gt;groupBy(&#x27;client_id&#x27;)
    -&gt;map(fn (Collection $tokens) =&gt; [
        &#x27;client&#x27; =&gt; $tokens-&gt;first()-&gt;client,
        &#x27;scopes&#x27; =&gt; $tokens-&gt;pluck(&#x27;scopes&#x27;)-&gt;flatten()-&gt;unique()-&gt;values()-&gt;all(),
        &#x27;tokens_count&#x27; =&gt; $tokens-&gt;count(),
    ])
    -&gt;values();
</code></pre>
<a name="refreshing-tokens"></a>
<h3 id="refreshing-tokens"><a href="#refreshing-tokens">Refreshing Tokens</a></h3>
<p>If your application issues short-lived access tokens, users will need to refresh their access tokens via the refresh token that was provided to them when the access token was issued:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
    &#x27;grant_type&#x27; =&gt; &#x27;refresh_token&#x27;,
    &#x27;refresh_token&#x27; =&gt; &#x27;the-refresh-token&#x27;,
    &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
    &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;, // Required for confidential clients only...
    &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
]);

return $response-&gt;json();
</code></pre>
<p>This <code>/oauth/token</code> route will return a JSON response containing <code>access_token</code>, <code>refresh_token</code>, and <code>expires_in</code> attributes. The <code>expires_in</code> attribute contains the number of seconds until the access token expires.</p>
<a name="revoking-tokens"></a>
<h3 id="revoking-tokens"><a href="#revoking-tokens">Revoking Tokens</a></h3>
<p>You may revoke a token by using the <code>revoke</code> method on the <code>Laravel\Passport\Token</code> model. You may revoke a token&#x27;s refresh token using the <code>revoke</code> method on the <code>Laravel\Passport\RefreshToken</code> model:</p>
<pre><code class="language-php">use Laravel\Passport\Passport;
use Laravel\Passport\Token;

$token = Passport::token()-&gt;find($tokenId);

// Revoke an access token...
$token-&gt;revoke();

// Revoke the token&#x27;s refresh token...
$token-&gt;refreshToken?-&gt;revoke();

// Revoke all of the user&#x27;s tokens...
User::find($userId)-&gt;tokens()-&gt;each(function (Token $token) {
    $token-&gt;revoke();
    $token-&gt;refreshToken?-&gt;revoke();
});
</code></pre>
<a name="purging-tokens"></a>
<h3 id="purging-tokens"><a href="#purging-tokens">Purging Tokens</a></h3>
<p>When tokens have been revoked or expired, you might want to purge them from the database. Passport&#x27;s included <code>passport:purge</code> Artisan command can do this for you:</p>
<pre><code class="language-shell"># Purge revoked and expired tokens, auth codes, and device codes...
php artisan passport:purge

# Only purge tokens expired for more than 6 hours...
php artisan passport:purge --hours=6

# Only purge revoked tokens, auth codes, and device codes...
php artisan passport:purge --revoked

# Only purge expired tokens, auth codes, and device codes...
php artisan passport:purge --expired
</code></pre>
<p>You may also configure a <a href="/docs/scheduling">scheduled job</a> in your application&#x27;s <code>routes/console.php</code> file to automatically prune your tokens on a schedule:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Schedule;

Schedule::command(&#x27;passport:purge&#x27;)-&gt;hourly();
</code></pre>
<a name="code-grant-pkce"></a>
<h2 id="authorization-code-grant-with-pkce"><a href="#authorization-code-grant-with-pkce">Authorization Code Grant With PKCE</a></h2>
<p>The Authorization Code grant with &quot;Proof Key for Code Exchange&quot; (PKCE) is a secure way to authenticate single page applications or mobile applications to access your API. This grant should be used when you can&#x27;t guarantee that the client secret will be stored confidentially or in order to mitigate the threat of having the authorization code intercepted by an attacker. A combination of a &quot;code verifier&quot; and a &quot;code challenge&quot; replaces the client secret when exchanging the authorization code for an access token.</p>
<a name="creating-a-auth-pkce-grant-client"></a>
<h3 id="creating-the-client"><a href="#creating-the-client">Creating the Client</a></h3>
<p>Before your application can issue tokens via the authorization code grant with PKCE, you will need to create a PKCE-enabled client. You may do this using the <code>passport:client</code> Artisan command with the <code>--public</code> option:</p>
<pre><code class="language-shell">php artisan passport:client --public
</code></pre>
<a name="requesting-auth-pkce-grant-tokens"></a>
<h3 id="requesting-tokens-1"><a href="#requesting-tokens-1">Requesting Tokens</a></h3>
<a name="code-verifier-code-challenge"></a>
<h4 id="code-verifier-and-code-challenge"><a href="#code-verifier-and-code-challenge">Code Verifier and Code Challenge</a></h4>
<p>As this authorization grant does not provide a client secret, developers will need to generate a combination of a code verifier and a code challenge in order to request a token.</p>
<p>The code verifier should be a random string of between 43 and 128 characters containing letters, numbers, and  <code>&quot;-&quot;</code>, <code>&quot;.&quot;</code>, <code>&quot;_&quot;</code>, <code>&quot;~&quot;</code> characters, as defined in the <a href="https://tools.ietf.org/html/rfc7636">RFC 7636 specification</a>.</p>
<p>The code challenge should be a Base64 encoded string with URL and filename-safe characters. The trailing <code>&#x27;=&#x27;</code> characters should be removed and no line breaks, whitespace, or other additional characters should be present.</p>
<pre><code class="language-php">$encoded = base64_encode(hash(&#x27;sha256&#x27;, $codeVerifier, true));

$codeChallenge = strtr(rtrim($encoded, &#x27;=&#x27;), &#x27;+/&#x27;, &#x27;-_&#x27;);
</code></pre>
<a name="code-grant-pkce-redirecting-for-authorization"></a>
<h4 id="redirecting-for-authorization-1"><a href="#redirecting-for-authorization-1">Redirecting for Authorization</a></h4>
<p>Once a client has been created, you may use the client ID and the generated code verifier and code challenge to request an authorization code and access token from your application. First, the consuming application should make a redirect request to your application&#x27;s <code>/oauth/authorize</code> route:</p>
<pre><code class="language-php">use Illuminate\Http\Request;
use Illuminate\Support\Str;

Route::get(&#x27;/redirect&#x27;, function (Request $request) {
    $request-&gt;session()-&gt;put(&#x27;state&#x27;, $state = Str::random(40));

    $request-&gt;session()-&gt;put(
        &#x27;code_verifier&#x27;, $codeVerifier = Str::random(128)
    );

    $codeChallenge = strtr(rtrim(
        base64_encode(hash(&#x27;sha256&#x27;, $codeVerifier, true))
    , &#x27;=&#x27;), &#x27;+/&#x27;, &#x27;-_&#x27;);

    $query = http_build_query([
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;response_type&#x27; =&gt; &#x27;code&#x27;,
        &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
        &#x27;state&#x27; =&gt; $state,
        &#x27;code_challenge&#x27; =&gt; $codeChallenge,
        &#x27;code_challenge_method&#x27; =&gt; &#x27;S256&#x27;,
        // &#x27;prompt&#x27; =&gt; &#x27;&#x27;, // &quot;none&quot;, &quot;consent&quot;, or &quot;login&quot;
    ]);

    return redirect(&#x27;https://passport-app.test/oauth/authorize?&#x27;.$query);
});
</code></pre>
<a name="code-grant-pkce-converting-authorization-codes-to-access-tokens"></a>
<h4 id="converting-authorization-codes-to-access-tokens-1"><a href="#converting-authorization-codes-to-access-tokens-1">Converting Authorization Codes to Access Tokens</a></h4>
<p>If the user approves the authorization request, they will be redirected back to the consuming application. The consumer should verify the <code>state</code> parameter against the value that was stored prior to the redirect, as in the standard Authorization Code Grant.</p>
<p>If the state parameter matches, the consumer should issue a <code>POST</code> request to your application to request an access token. The request should include the authorization code that was issued by your application when the user approved the authorization request along with the originally generated code verifier:</p>
<pre><code class="language-php">use Illuminate\Http\Request;
use Illuminate\Support\Facades\Http;

Route::get(&#x27;/callback&#x27;, function (Request $request) {
    $state = $request-&gt;session()-&gt;pull(&#x27;state&#x27;);

    $codeVerifier = $request-&gt;session()-&gt;pull(&#x27;code_verifier&#x27;);

    throw_unless(
        strlen($state) &gt; 0 &amp;&amp; $state === $request-&gt;state,
        InvalidArgumentException::class
    );

    $response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
        &#x27;grant_type&#x27; =&gt; &#x27;authorization_code&#x27;,
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;code_verifier&#x27; =&gt; $codeVerifier,
        &#x27;code&#x27; =&gt; $request-&gt;code,
    ]);

    return $response-&gt;json();
});
</code></pre>
<a name="device-authorization-grant"></a>
<h2 id="device-authorization-grant"><a href="#device-authorization-grant">Device Authorization Grant</a></h2>
<p>The OAuth2 device authorization grant allows browserless or limited input devices, such as TVs and game consoles, to obtain an access token by exchanging a &quot;device code&quot;. When using device flow, the device client will instruct the user to use a secondary device, such as a computer or a smartphone and connect to your server where they will enter the provided &quot;user code&quot; and either approve or deny the access request.</p>
<p>To get started, we need to instruct Passport how to return our &quot;user code&quot; and &quot;authorization&quot; views.</p>
<p>All the authorization view&#x27;s rendering logic may be customized using the appropriate methods available via the <code>Laravel\Passport\Passport</code> class. Typically, you should call this method from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class.</p>
<pre><code class="language-php">use Inertia\Inertia;
use Laravel\Passport\Passport;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    // By providing a view name...
    Passport::deviceUserCodeView(&#x27;auth.oauth.device.user-code&#x27;);
    Passport::deviceAuthorizationView(&#x27;auth.oauth.device.authorize&#x27;);

    // By providing a closure...
    Passport::deviceUserCodeView(
        fn ($parameters) =&gt; Inertia::render(&#x27;Auth/OAuth/Device/UserCode&#x27;)
    );

    Passport::deviceAuthorizationView(
        fn ($parameters) =&gt; Inertia::render(&#x27;Auth/OAuth/Device/Authorize&#x27;, [
            &#x27;request&#x27; =&gt; $parameters[&#x27;request&#x27;],
            &#x27;authToken&#x27; =&gt; $parameters[&#x27;authToken&#x27;],
            &#x27;client&#x27; =&gt; $parameters[&#x27;client&#x27;],
            &#x27;user&#x27; =&gt; $parameters[&#x27;user&#x27;],
            &#x27;scopes&#x27; =&gt; $parameters[&#x27;scopes&#x27;],
        ])
    );

    // ...
}
</code></pre>
<p>Passport will automatically define routes that return these views. Your <code>auth.oauth.device.user-code</code> template should include a form that makes a GET request to the <code>passport.device.authorizations.authorize</code> route. The <code>passport.device.authorizations.authorize</code> route expects a <code>user_code</code> query parameter.</p>
<p>Your <code>auth.oauth.device.authorize</code> template should include a form that makes a POST request to the <code>passport.device.authorizations.approve</code> route to approve the authorization and a form that makes a DELETE request to the <code>passport.device.authorizations.deny</code> route to deny the authorization. The <code>passport.device.authorizations.approve</code> and <code>passport.device.authorizations.deny</code> routes expect <code>state</code>, <code>client_id</code>, and <code>auth_token</code> fields.</p>
<a name="creating-a-device-authorization-grant-client"></a>
<h3 id="creating-a-device-authorization-grant-client"><a href="#creating-a-device-authorization-grant-client">Creating a Device Authorization Grant Client</a></h3>
<p>Before your application can issue tokens via the device authorization grant, you will need to create a device flow enabled client. You may do this using the <code>passport:client</code> Artisan command with the <code>--device</code> option. This command will create a first-party device flow enabled client and provide you with a client ID and secret:</p>
<pre><code class="language-shell">php artisan passport:client --device
</code></pre>
<p>Additionally, you may use <code>createDeviceAuthorizationGrantClient</code> method on the <code>ClientRepository</code> class to register a third-party client that belongs to the given user:</p>
<pre><code class="language-php">use App\Models\User;
use Laravel\Passport\ClientRepository;

$user = User::find($userId);

$client = app(ClientRepository::class)-&gt;createDeviceAuthorizationGrantClient(
    user: $user,
    name: &#x27;Example Device&#x27;,
    confidential: false,
);
</code></pre>
<a name="requesting-device-authorization-grant-tokens"></a>
<h3 id="requesting-tokens-2"><a href="#requesting-tokens-2">Requesting Tokens</a></h3>
<a name="device-code"></a>
<h4 id="requesting-a-device-code"><a href="#requesting-a-device-code">Requesting a Device Code</a></h4>
<p>Once a client has been created, developers may use their client ID to request a device code from your application. First, the consuming device should make a <code>POST</code> request to your application&#x27;s <code>/oauth/device/code</code> route to request a device code:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/device/code&#x27;, [
    &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
    &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
]);

return $response-&gt;json();
</code></pre>
<p>This will return a JSON response containing <code>device_code</code>, <code>user_code</code>, <code>verification_uri</code>, <code>interval</code>, and <code>expires_in</code> attributes. The <code>expires_in</code> attribute contains the number of seconds until the device code expires. The <code>interval</code> attribute contains the number of seconds the consuming device should wait between requests when polling <code>/oauth/token</code> route to avoid rate limit errors.</p>
<blockquote>
<p>[!NOTE]
Remember, the <code>/oauth/device/code</code> route is already defined by Passport. You do not need to manually define this route.</p>
</blockquote>
<a name="user-code"></a>
<h4 id="displaying-the-verification-uri-and-user-code"><a href="#displaying-the-verification-uri-and-user-code">Displaying the Verification URI and User Code</a></h4>
<p>Once a device code request has been obtained, the consuming device should instruct the user to use another device and visit the provided <code>verification_uri</code> and enter the <code>user_code</code> in order to approve the authorization request.</p>
<a name="polling-token-request"></a>
<h4 id="polling-token-request"><a href="#polling-token-request">Polling Token Request</a></h4>
<p>Since the user will be using a separate device to grant (or deny) access, the consuming device should poll your application&#x27;s <code>/oauth/token</code> route to determine when the user has responded to the request. The consuming device should use the minimum polling <code>interval</code> provided in the JSON response when requesting device code to avoid rate limit errors:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;
use Illuminate\Support\Sleep;

$interval = 5;

do {
    Sleep::for($interval)-&gt;seconds();

    $response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
        &#x27;grant_type&#x27; =&gt; &#x27;urn:ietf:params:oauth:grant-type:device_code&#x27;,
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;, // Required for confidential clients only...
        &#x27;device_code&#x27; =&gt; &#x27;the-device-code&#x27;,
    ]);

    if ($response-&gt;json(&#x27;error&#x27;) === &#x27;slow_down&#x27;) {
        $interval += 5;
    }
} while (in_array($response-&gt;json(&#x27;error&#x27;), [&#x27;authorization_pending&#x27;, &#x27;slow_down&#x27;]));

return $response-&gt;json();
</code></pre>
<p>If the user has approved the authorization request, this will return a JSON response containing <code>access_token</code>, <code>refresh_token</code>, and <code>expires_in</code> attributes. The <code>expires_in</code> attribute contains the number of seconds until the access token expires.</p>
<a name="password-grant"></a>
<h2 id="password-grant"><a href="#password-grant">Password Grant</a></h2>
<blockquote>
<p>[!WARNING]
We no longer recommend using password grant tokens. Instead, you should choose <a href="https://oauth2.thephpleague.com/authorization-server/which-grant/">a grant type that is currently recommended by OAuth2 Server</a>.</p>
</blockquote>
<p>The OAuth2 password grant allows your other first-party clients, such as a mobile application, to obtain an access token using an email address / username and password. This allows you to issue access tokens securely to your first-party clients without requiring your users to go through the entire OAuth2 authorization code redirect flow.</p>
<p>To enable the password grant, call the <code>enablePasswordGrant</code> method in the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::enablePasswordGrant();
}
</code></pre>
<a name="creating-a-password-grant-client"></a>
<h3 id="creating-a-password-grant-client"><a href="#creating-a-password-grant-client">Creating a Password Grant Client</a></h3>
<p>Before your application can issue tokens via the password grant, you will need to create a password grant client. You may do this using the <code>passport:client</code> Artisan command with the <code>--password</code> option.</p>
<pre><code class="language-shell">php artisan passport:client --password
</code></pre>
<a name="requesting-password-grant-tokens"></a>
<h3 id="requesting-tokens-3"><a href="#requesting-tokens-3">Requesting Tokens</a></h3>
<p>Once you have enabled the grant and have created a password grant client, you may request an access token by issuing a <code>POST</code> request to the <code>/oauth/token</code> route with the user&#x27;s email address and password. Remember, this route is already registered by Passport so there is no need to define it manually. If the request is successful, you will receive an <code>access_token</code> and <code>refresh_token</code> in the JSON response from the server:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
    &#x27;grant_type&#x27; =&gt; &#x27;password&#x27;,
    &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
    &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;, // Required for confidential clients only...
    &#x27;username&#x27; =&gt; &#x27;taylor@laravel.com&#x27;,
    &#x27;password&#x27; =&gt; &#x27;my-password&#x27;,
    &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
]);

return $response-&gt;json();
</code></pre>
<blockquote>
<p>[!NOTE]
Remember, access tokens are long-lived by default. However, you are free to <a href="#configuration">configure your maximum access token lifetime</a> if needed.</p>
</blockquote>
<a name="requesting-all-scopes"></a>
<h3 id="requesting-all-scopes"><a href="#requesting-all-scopes">Requesting All Scopes</a></h3>
<p>When using the password grant or client credentials grant, you may wish to authorize the token for all of the scopes supported by your application. You can do this by requesting the <code>*</code> scope. If you request the <code>*</code> scope, the <code>can</code> method on the token instance will always return <code>true</code>. This scope may only be assigned to a token that is issued using the <code>password</code> or <code>client_credentials</code> grant:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
    &#x27;grant_type&#x27; =&gt; &#x27;password&#x27;,
    &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
    &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;, // Required for confidential clients only...
    &#x27;username&#x27; =&gt; &#x27;taylor@laravel.com&#x27;,
    &#x27;password&#x27; =&gt; &#x27;my-password&#x27;,
    &#x27;scope&#x27; =&gt; &#x27;*&#x27;,
]);
</code></pre>
<a name="customizing-the-user-provider"></a>
<h3 id="customizing-the-user-provider"><a href="#customizing-the-user-provider">Customizing the User Provider</a></h3>
<p>If your application uses more than one <a href="/docs/authentication#introduction">authentication user provider</a>, you may specify which user provider the password grant client uses by providing a <code>--provider</code> option when creating the client via the <code>artisan passport:client --password</code> command. The given provider name should match a valid provider defined in your application&#x27;s <code>config/auth.php</code> configuration file. You can then <a href="#multiple-authentication-guards">protect your route using middleware</a> to ensure that only users from the guard&#x27;s specified provider are authorized.</p>
<a name="customizing-the-username-field"></a>
<h3 id="customizing-the-username-field"><a href="#customizing-the-username-field">Customizing the Username Field</a></h3>
<p>When authenticating using the password grant, Passport will use the <code>email</code> attribute of your authenticatable model as the &quot;username&quot;. However, you may customize this behavior by defining a <code>findForPassport</code> method on your model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Laravel\Passport\Bridge\Client;
use Laravel\Passport\Contracts\OAuthenticatable;
use Laravel\Passport\HasApiTokens;

class User extends Authenticatable implements OAuthenticatable
{
    use HasApiTokens, Notifiable;

    /**
     * Find the user instance for the given username.
     */
    public function findForPassport(string $username, Client $client): User
    {
        return $this-&gt;where(&#x27;username&#x27;, $username)-&gt;first();
    }
}
</code></pre>
<a name="customizing-the-password-validation"></a>
<h3 id="customizing-the-password-validation"><a href="#customizing-the-password-validation">Customizing the Password Validation</a></h3>
<p>When authenticating using the password grant, Passport will use the <code>password</code> attribute of your model to validate the given password. If your model does not have a <code>password</code> attribute or you wish to customize the password validation logic, you can define a <code>validateForPassportPasswordGrant</code> method on your model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Illuminate\Support\Facades\Hash;
use Laravel\Passport\Contracts\OAuthenticatable;
use Laravel\Passport\HasApiTokens;

class User extends Authenticatable implements OAuthenticatable
{
    use HasApiTokens, Notifiable;

    /**
     * Validate the password of the user for the Passport password grant.
     */
    public function validateForPassportPasswordGrant(string $password): bool
    {
        return Hash::check($password, $this-&gt;password);
    }
}
</code></pre>
<a name="implicit-grant"></a>
<h2 id="implicit-grant"><a href="#implicit-grant">Implicit Grant</a></h2>
<blockquote>
<p>[!WARNING]
We no longer recommend using implicit grant tokens. Instead, you should choose <a href="https://oauth2.thephpleague.com/authorization-server/which-grant/">a grant type that is currently recommended by OAuth2 Server</a>.</p>
</blockquote>
<p>The implicit grant is similar to the authorization code grant; however, the token is returned to the client without exchanging an authorization code. This grant is most commonly used for JavaScript or mobile applications where the client credentials can&#x27;t be securely stored. To enable the grant, call the <code>enableImplicitGrant</code> method in the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::enableImplicitGrant();
}
</code></pre>
<p>Before your application can issue tokens via the implicit grant, you will need to create an implicit grant client. You may do this using the <code>passport:client</code> Artisan command with the <code>--implicit</code> option.</p>
<pre><code class="language-shell">php artisan passport:client --implicit
</code></pre>
<p>Once the grant has been enabled and an implicit client has been created, developers may use their client ID to request an access token from your application. The consuming application should make a redirect request to your application&#x27;s <code>/oauth/authorize</code> route like so:</p>
<pre><code class="language-php">use Illuminate\Http\Request;

Route::get(&#x27;/redirect&#x27;, function (Request $request) {
    $request-&gt;session()-&gt;put(&#x27;state&#x27;, $state = Str::random(40));

    $query = http_build_query([
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;response_type&#x27; =&gt; &#x27;token&#x27;,
        &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
        &#x27;state&#x27; =&gt; $state,
        // &#x27;prompt&#x27; =&gt; &#x27;&#x27;, // &quot;none&quot;, &quot;consent&quot;, or &quot;login&quot;
    ]);

    return redirect(&#x27;https://passport-app.test/oauth/authorize?&#x27;.$query);
});
</code></pre>
<blockquote>
<p>[!NOTE]
Remember, the <code>/oauth/authorize</code> route is already defined by Passport. You do not need to manually define this route.</p>
</blockquote>
<a name="client-credentials-grant"></a>
<h2 id="client-credentials-grant"><a href="#client-credentials-grant">Client Credentials Grant</a></h2>
<p>The client credentials grant is suitable for machine-to-machine authentication. For example, you might use this grant in a scheduled job which is performing maintenance tasks over an API.</p>
<p>Before your application can issue tokens via the client credentials grant, you will need to create a client credentials grant client. You may do this using the <code>--client</code> option of the <code>passport:client</code> Artisan command:</p>
<pre><code class="language-shell">php artisan passport:client --client
</code></pre>
<p>Next, assign the <code>Laravel\Passport\Http\Middleware\EnsureClientIsResourceOwner</code> middleware to a route:</p>
<pre><code class="language-php">use Laravel\Passport\Http\Middleware\EnsureClientIsResourceOwner;

Route::get(&#x27;/orders&#x27;, function (Request $request) {
    // Access token is valid and the client is resource owner...
})-&gt;middleware(EnsureClientIsResourceOwner::class);
</code></pre>
<p>To restrict access to the route to specific scopes, you may provide a list of the required scopes to the <code>using</code> method`:</p>
<pre><code class="language-php">Route::get(&#x27;/orders&#x27;, function (Request $request) {
    // Access token is valid, the client is resource owner, and has both &quot;servers:read&quot; and &quot;servers:create&quot; scopes...
})-&gt;middleware(EnsureClientIsResourceOwner::using(&#x27;servers:read&#x27;, &#x27;servers:create&#x27;));
</code></pre>
<a name="retrieving-tokens"></a>
<h3 id="retrieving-tokens"><a href="#retrieving-tokens">Retrieving Tokens</a></h3>
<p>To retrieve a token using this grant type, make a request to the <code>oauth/token</code> endpoint:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::asForm()-&gt;post(&#x27;https://passport-app.test/oauth/token&#x27;, [
    &#x27;grant_type&#x27; =&gt; &#x27;client_credentials&#x27;,
    &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
    &#x27;client_secret&#x27; =&gt; &#x27;your-client-secret&#x27;,
    &#x27;scope&#x27; =&gt; &#x27;servers:read servers:create&#x27;,
]);

return $response-&gt;json()[&#x27;access_token&#x27;];
</code></pre>
<a name="personal-access-tokens"></a>
<h2 id="personal-access-tokens"><a href="#personal-access-tokens">Personal Access Tokens</a></h2>
<p>Sometimes, your users may want to issue access tokens to themselves without going through the typical authorization code redirect flow. Allowing users to issue tokens to themselves via your application&#x27;s UI can be useful for allowing users to experiment with your API or may serve as a simpler approach to issuing access tokens in general.</p>
<blockquote>
<p>[!NOTE]
If your application is using Passport primarily to issue personal access tokens, consider using <a href="/docs/sanctum">Laravel Sanctum</a>, Laravel&#x27;s light-weight first-party library for issuing API access tokens.</p>
</blockquote>
<a name="creating-a-personal-access-client"></a>
<h3 id="creating-a-personal-access-client"><a href="#creating-a-personal-access-client">Creating a Personal Access Client</a></h3>
<p>Before your application can issue personal access tokens, you will need to create a personal access client. You may do this by executing the <code>passport:client</code> Artisan command with the <code>--personal</code> option. If you have already run the <code>passport:install</code> command, you do not need to run this command:</p>
<pre><code class="language-shell">php artisan passport:client --personal
</code></pre>
<a name="customizing-the-user-provider-for-pat"></a>
<h3 id="customizing-the-user-provider-1"><a href="#customizing-the-user-provider-1">Customizing the User Provider</a></h3>
<p>If your application uses more than one <a href="/docs/authentication#introduction">authentication user provider</a>, you may specify which user provider the personal access grant client uses by providing a <code>--provider</code> option when creating the client via the <code>artisan passport:client --personal</code> command. The given provider name should match a valid provider defined in your application&#x27;s <code>config/auth.php</code> configuration file. You can then <a href="#multiple-authentication-guards">protect your route using middleware</a> to ensure that only users from the guard&#x27;s specified provider are authorized.</p>
<a name="managing-personal-access-tokens"></a>
<h3 id="managing-personal-access-tokens"><a href="#managing-personal-access-tokens">Managing Personal Access Tokens</a></h3>
<p>Once you have created a personal access client, you may issue tokens for a given user using the <code>createToken</code> method on the <code>App\Models\User</code> model instance. The <code>createToken</code> method accepts the name of the token as its first argument and an optional array of <a href="#token-scopes">scopes</a> as its second argument:</p>
<pre><code class="language-php">use App\Models\User;
use Illuminate\Support\Facades\Date;
use Laravel\Passport\Token;

$user = User::find($userId);

// Creating a token without scopes...
$token = $user-&gt;createToken(&#x27;My Token&#x27;)-&gt;accessToken;

// Creating a token with scopes...
$token = $user-&gt;createToken(&#x27;My Token&#x27;, [&#x27;user:read&#x27;, &#x27;orders:create&#x27;])-&gt;accessToken;

// Creating a token with all scopes...
$token = $user-&gt;createToken(&#x27;My Token&#x27;, [&#x27;*&#x27;])-&gt;accessToken;

// Retrieving all the valid personal access tokens that belong to the user...
$tokens = $user-&gt;tokens()
    -&gt;with(&#x27;client&#x27;)
    -&gt;where(&#x27;revoked&#x27;, false)
    -&gt;where(&#x27;expires_at&#x27;, &#x27;&gt;&#x27;, Date::now())
    -&gt;get()
    -&gt;filter(fn (Token $token) =&gt; $token-&gt;client-&gt;hasGrantType(&#x27;personal_access&#x27;));
</code></pre>
<a name="protecting-routes"></a>
<h2 id="protecting-routes"><a href="#protecting-routes">Protecting Routes</a></h2>
<a name="via-middleware"></a>
<h3 id="via-middleware"><a href="#via-middleware">Via Middleware</a></h3>
<p>Passport includes an <a href="/docs/authentication#adding-custom-guards">authentication guard</a> that will validate access tokens on incoming requests. Once you have configured the <code>api</code> guard to use the <code>passport</code> driver, you only need to specify the <code>auth:api</code> middleware on any routes that should require a valid access token:</p>
<pre><code class="language-php">Route::get(&#x27;/user&#x27;, function () {
    // Only API authenticated users may access this route...
})-&gt;middleware(&#x27;auth:api&#x27;);
</code></pre>
<blockquote>
<p>[!WARNING]
If you are using the <a href="#client-credentials-grant">client credentials grant</a>, you should use <a href="#client-credentials-grant">the <code>Laravel\Passport\Http\Middleware\EnsureClientIsResourceOwner</code> middleware</a> to protect your routes instead of the <code>auth:api</code> middleware.</p>
</blockquote>
<a name="multiple-authentication-guards"></a>
<h4 id="multiple-authentication-guards"><a href="#multiple-authentication-guards">Multiple Authentication Guards</a></h4>
<p>If your application authenticates different types of users that perhaps use entirely different Eloquent models, you will likely need to define a guard configuration for each user provider type in your application. This allows you to protect requests intended for specific user providers. For example, given the following guard configuration the <code>config/auth.php</code> configuration file:</p>
<pre><code class="language-php">&#x27;guards&#x27; =&gt; [
    &#x27;api&#x27; =&gt; [
        &#x27;driver&#x27; =&gt; &#x27;passport&#x27;,
        &#x27;provider&#x27; =&gt; &#x27;users&#x27;,
    ],

    &#x27;api-customers&#x27; =&gt; [
        &#x27;driver&#x27; =&gt; &#x27;passport&#x27;,
        &#x27;provider&#x27; =&gt; &#x27;customers&#x27;,
    ],
],
</code></pre>
<p>The following route will utilize the <code>api-customers</code> guard, which uses the <code>customers</code> user provider, to authenticate incoming requests:</p>
<pre><code class="language-php">Route::get(&#x27;/customer&#x27;, function () {
    // ...
})-&gt;middleware(&#x27;auth:api-customers&#x27;);
</code></pre>
<blockquote>
<p>[!NOTE]
For more information on using multiple user providers with Passport, please consult the <a href="#customizing-the-user-provider-for-pat">personal access tokens documentation</a> and <a href="#customizing-the-user-provider">password grant documentation</a>.</p>
</blockquote>
<a name="passing-the-access-token"></a>
<h3 id="passing-the-access-token"><a href="#passing-the-access-token">Passing the Access Token</a></h3>
<p>When calling routes that are protected by Passport, your application&#x27;s API consumers should specify their access token as a <code>Bearer</code> token in the <code>Authorization</code> header of their request. For example, when using the <code>Http</code> Facade:</p>
<pre><code class="language-php">use Illuminate\Support\Facades\Http;

$response = Http::withHeaders([
    &#x27;Accept&#x27; =&gt; &#x27;application/json&#x27;,
    &#x27;Authorization&#x27; =&gt; &quot;Bearer $accessToken&quot;,
])-&gt;get(&#x27;https://passport-app.test/api/user&#x27;);

return $response-&gt;json();
</code></pre>
<a name="token-scopes"></a>
<h2 id="token-scopes"><a href="#token-scopes">Token Scopes</a></h2>
<p>Scopes allow your API clients to request a specific set of permissions when requesting authorization to access an account. For example, if you are building an e-commerce application, not all API consumers will need the ability to place orders. Instead, you may allow the consumers to only request authorization to access order shipment statuses. In other words, scopes allow your application&#x27;s users to limit the actions a third-party application can perform on their behalf.</p>
<a name="defining-scopes"></a>
<h3 id="defining-scopes"><a href="#defining-scopes">Defining Scopes</a></h3>
<p>You may define your API&#x27;s scopes using the <code>Passport::tokensCan</code> method in the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class. The <code>tokensCan</code> method accepts an array of scope names and scope descriptions. The scope description may be anything you wish and will be displayed to users on the authorization approval screen:</p>
<pre><code class="language-php">/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::tokensCan([
        &#x27;user:read&#x27; =&gt; &#x27;Retrieve the user info&#x27;,
        &#x27;orders:create&#x27; =&gt; &#x27;Place orders&#x27;,
        &#x27;orders:read:status&#x27; =&gt; &#x27;Check order status&#x27;,
    ]);
}
</code></pre>
<a name="default-scope"></a>
<h3 id="default-scope"><a href="#default-scope">Default Scope</a></h3>
<p>If a client does not request any specific scopes, you may configure your Passport server to attach default scopes to the token using the <code>defaultScopes</code> method. Typically, you should call this method from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">use Laravel\Passport\Passport;

Passport::tokensCan([
    &#x27;user:read&#x27; =&gt; &#x27;Retrieve the user info&#x27;,
    &#x27;orders:create&#x27; =&gt; &#x27;Place orders&#x27;,
    &#x27;orders:read:status&#x27; =&gt; &#x27;Check order status&#x27;,
]);

Passport::defaultScopes([
    &#x27;user:read&#x27;,
    &#x27;orders:create&#x27;,
]);
</code></pre>
<a name="assigning-scopes-to-tokens"></a>
<h3 id="assigning-scopes-to-tokens"><a href="#assigning-scopes-to-tokens">Assigning Scopes to Tokens</a></h3>
<a name="when-requesting-authorization-codes"></a>
<h4 id="when-requesting-authorization-codes"><a href="#when-requesting-authorization-codes">When Requesting Authorization Codes</a></h4>
<p>When requesting an access token using the authorization code grant, consumers should specify their desired scopes as the <code>scope</code> query string parameter. The <code>scope</code> parameter should be a space-delimited list of scopes:</p>
<pre><code class="language-php">Route::get(&#x27;/redirect&#x27;, function () {
    $query = http_build_query([
        &#x27;client_id&#x27; =&gt; &#x27;your-client-id&#x27;,
        &#x27;redirect_uri&#x27; =&gt; &#x27;https://third-party-app.com/callback&#x27;,
        &#x27;response_type&#x27; =&gt; &#x27;code&#x27;,
        &#x27;scope&#x27; =&gt; &#x27;user:read orders:create&#x27;,
    ]);

    return redirect(&#x27;https://passport-app.test/oauth/authorize?&#x27;.$query);
});
</code></pre>
<a name="when-issuing-personal-access-tokens"></a>
<h4 id="when-issuing-personal-access-tokens"><a href="#when-issuing-personal-access-tokens">When Issuing Personal Access Tokens</a></h4>
<p>If you are issuing personal access tokens using the <code>App\Models\User</code> model&#x27;s <code>createToken</code> method, you may pass the array of desired scopes as the second argument to the method:</p>
<pre><code class="language-php">$token = $user-&gt;createToken(&#x27;My Token&#x27;, [&#x27;orders:create&#x27;])-&gt;accessToken;
</code></pre>
<a name="checking-scopes"></a>
<h3 id="checking-scopes"><a href="#checking-scopes">Checking Scopes</a></h3>
<p>Passport includes two middleware that may be used to verify that an incoming request is authenticated with a token that has been granted a given scope.</p>
<a name="check-for-all-scopes"></a>
<h4 id="check-for-all-scopes"><a href="#check-for-all-scopes">Check For All Scopes</a></h4>
<p>The <code>Laravel\Passport\Http\Middleware\CheckToken</code> middleware may be assigned to a route to verify that the incoming request&#x27;s access token has all the listed scopes:</p>
<pre><code class="language-php">use Laravel\Passport\Http\Middleware\CheckToken;

Route::get(&#x27;/orders&#x27;, function () {
    // Access token has both &quot;orders:read&quot; and &quot;orders:create&quot; scopes...
})-&gt;middleware([&#x27;auth:api&#x27;, CheckToken::using(&#x27;orders:read&#x27;, &#x27;orders:create&#x27;)]);
</code></pre>
<a name="check-for-any-scopes"></a>
<h4 id="check-for-any-scopes"><a href="#check-for-any-scopes">Check for Any Scopes</a></h4>
<p>The <code>Laravel\Passport\Http\Middleware\CheckTokenForAnyScope</code> middleware may be assigned to a route to verify that the incoming request&#x27;s access token has <em>at least one</em> of the listed scopes:</p>
<pre><code class="language-php">use Laravel\Passport\Http\Middleware\CheckTokenForAnyScope;

Route::get(&#x27;/orders&#x27;, function () {
    // Access token has either &quot;orders:read&quot; or &quot;orders:create&quot; scope...
})-&gt;middleware([&#x27;auth:api&#x27;, CheckTokenForAnyScope::using(&#x27;orders:read&#x27;, &#x27;orders:create&#x27;)]);
</code></pre>
<a name="checking-scopes-on-a-token-instance"></a>
<h4 id="checking-scopes-on-a-token-instance"><a href="#checking-scopes-on-a-token-instance">Checking Scopes on a Token Instance</a></h4>
<p>Once an access token authenticated request has entered your application, you may still check if the token has a given scope using the <code>tokenCan</code> method on the authenticated <code>App\Models\User</code> instance:</p>
<pre><code class="language-php">use Illuminate\Http\Request;

Route::get(&#x27;/orders&#x27;, function (Request $request) {
    if ($request-&gt;user()-&gt;tokenCan(&#x27;orders:create&#x27;)) {
        // ...
    }
});
</code></pre>
<a name="additional-scope-methods"></a>
<h4 id="additional-scope-methods"><a href="#additional-scope-methods">Additional Scope Methods</a></h4>
<p>The <code>scopeIds</code> method will return an array of all defined IDs / names:</p>
<pre><code class="language-php">use Laravel\Passport\Passport;

Passport::scopeIds();
</code></pre>
<p>The <code>scopes</code> method will return an array of all defined scopes as instances of <code>Laravel\Passport\Scope</code>:</p>
<pre><code class="language-php">Passport::scopes();
</code></pre>
<p>The <code>scopesFor</code> method will return an array of <code>Laravel\Passport\Scope</code> instances matching the given IDs / names:</p>
<pre><code class="language-php">Passport::scopesFor([&#x27;user:read&#x27;, &#x27;orders:create&#x27;]);
</code></pre>
<p>You may determine if a given scope has been defined using the <code>hasScope</code> method:</p>
<pre><code class="language-php">Passport::hasScope(&#x27;orders:create&#x27;);
</code></pre>
<a name="spa-authentication"></a>
<h2 id="spa-authentication"><a href="#spa-authentication">SPA Authentication</a></h2>
<p>When building an API, it can be extremely useful to be able to consume your own API from your JavaScript application. This approach to API development allows your own application to consume the same API that you are sharing with the world. The same API may be consumed by your web application, mobile applications, third-party applications, and any SDKs that you may publish on various package managers.</p>
<p>Typically, if you want to consume your API from your JavaScript application, you would need to manually send an access token to the application and pass it with each request to your application. However, Passport includes a middleware that can handle this for you. All you need to do is append the <code>CreateFreshApiToken</code> middleware to the <code>web</code> middleware group in your application&#x27;s <code>bootstrap/app.php</code> file:</p>
<pre><code class="language-php">use Laravel\Passport\Http\Middleware\CreateFreshApiToken;

-&gt;withMiddleware(function (Middleware $middleware): void {
    $middleware-&gt;web(append: [
        CreateFreshApiToken::class,
    ]);
})
</code></pre>
<blockquote>
<p>[!WARNING]
You should ensure that the <code>CreateFreshApiToken</code> middleware is the last middleware listed in your middleware stack.</p>
</blockquote>
<p>This middleware will attach a <code>laravel_token</code> cookie to your outgoing responses. This cookie contains an encrypted JWT that Passport will use to authenticate API requests from your JavaScript application. The JWT has a lifetime equal to your <code>session.lifetime</code> configuration value. Now, since the browser will automatically send the cookie with all subsequent requests, you may make requests to your application&#x27;s API without explicitly passing an access token:</p>
<pre><code class="language-js">axios.get(&#x27;/api/user&#x27;)
    .then(response =&gt; {
        console.log(response.data);
    });
</code></pre>
<a name="customizing-the-cookie-name"></a>
<h4 id="customizing-the-cookie-name"><a href="#customizing-the-cookie-name">Customizing the Cookie Name</a></h4>
<p>If needed, you can customize the <code>laravel_token</code> cookie&#x27;s name using the <code>Passport::cookie</code> method. Typically, this method should be called from the <code>boot</code> method of your application&#x27;s <code>App\Providers\AppServiceProvider</code> class:</p>
<pre><code class="language-php">/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Passport::cookie(&#x27;custom_name&#x27;);
}
</code></pre>
<a name="csrf-protection"></a>
<h4 id="csrf-protection"><a href="#csrf-protection">CSRF Protection</a></h4>
<p>When using this method of authentication, you will need to ensure a valid CSRF token header is included in your requests. The default Laravel JavaScript scaffolding included with the skeleton application and all starter kits includes an <a href="https://github.com/axios/axios">Axios</a> instance, which will automatically use the encrypted <code>XSRF-TOKEN</code> cookie value to send an <code>X-XSRF-TOKEN</code> header on same-origin requests.</p>
<blockquote>
<p>[!NOTE]
If you choose to send the <code>X-CSRF-TOKEN</code> header instead of <code>X-XSRF-TOKEN</code>, you will need to use the unencrypted token provided by <code>csrf_token()</code>.</p>
</blockquote>
<a name="events"></a>
<h2 id="events"><a href="#events">Events</a></h2>
<p>Passport raises events when issuing access tokens and refresh tokens. You may <a href="/docs/events">listen for these events</a> to prune or revoke other access tokens in your database:</p>
<div class="overflow-auto"><p>| Event Name                                    |
| --------------------------------------------- |
| <code>Laravel\Passport\Events\AccessTokenCreated</code>  |
| <code>Laravel\Passport\Events\AccessTokenRevoked</code>  |
| <code>Laravel\Passport\Events\RefreshTokenCreated</code> |</p></div>
<a name="testing"></a>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>Passport&#x27;s <code>actingAs</code> method may be used to specify the currently authenticated user as well as its scopes. The first argument given to the <code>actingAs</code> method is the user instance and the second is an array of scopes that should be granted to the user&#x27;s token:</p>
<pre><code class="language-php">use App\Models\User;
use Laravel\Passport\Passport;

test(&#x27;orders can be created&#x27;, function () {
    Passport::actingAs(
        User::factory()-&gt;create(),
        [&#x27;orders:create&#x27;]
    );

    $response = $this-&gt;post(&#x27;/api/orders&#x27;);

    $response-&gt;assertStatus(201);
});
</code></pre>
<pre><code class="language-php">use App\Models\User;
use Laravel\Passport\Passport;

public function test_orders_can_be_created(): void
{
    Passport::actingAs(
        User::factory()-&gt;create(),
        [&#x27;orders:create&#x27;]
    );

    $response = $this-&gt;post(&#x27;/api/orders&#x27;);

    $response-&gt;assertStatus(201);
}
</code></pre>
<p>Passport&#x27;s <code>actingAsClient</code> method may be used to specify the currently authenticated client as well as its scopes. The first argument given to the <code>actingAsClient</code> method is the client instance and the second is an array of scopes that should be granted to the client&#x27;s token:</p>
<pre><code class="language-php">use Laravel\Passport\Client;
use Laravel\Passport\Passport;

test(&#x27;servers can be retrieved&#x27;, function () {
    Passport::actingAsClient(
        Client::factory()-&gt;create(),
        [&#x27;servers:read&#x27;]
    );

    $response = $this-&gt;get(&#x27;/api/servers&#x27;);

    $response-&gt;assertStatus(200);
});
</code></pre>
<pre><code class="language-php">use Laravel\Passport\Client;
use Laravel\Passport\Passport;

public function test_servers_can_be_retrieved(): void
{
    Passport::actingAsClient(
        Client::factory()-&gt;create(),
        [&#x27;servers:read&#x27;]
    );

    $response = $this-&gt;get(&#x27;/api/servers&#x27;);

    $response-&gt;assertStatus(200);
}
</code></pre></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/2b257daea29fbb42.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/bc6e94e20a39014e.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"kE5s4wNidqhVn8fA906WC\",\"c\":[\"\",\"docs\",\"passport\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"passport\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/bc6e94e20a39014e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/2b257daea29fbb42.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"Passport\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-muted-foreground mt-2\",\"children\":\"Laravel Passport 為你的應用程式提供完整的 OAuth2 伺服器實作\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"laravel-passport\",\"children\":[\"$\",\"a\",null,{\"href\":\"#laravel-passport\",\"children\":\"Laravel Passport\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#introduction\",\"children\":\"Introduction\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#passport-or-sanctum\",\"children\":\"Passport or Sanctum?\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#installation\",\"children\":\"Installation\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#deploying-passport\",\"children\":\"Deploying Passport\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#upgrading-passport\",\"children\":\"Upgrading Passport\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#configuration\",\"children\":\"Configuration\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#token-lifetimes\",\"children\":\"Token Lifetimes\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#overriding-default-models\",\"children\":\"Overriding Default Models\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#overriding-routes\",\"children\":\"Overriding Routes\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#authorization-code-grant\",\"children\":\"Authorization Code Grant\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-clients\",\"children\":\"Managing Clients\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-tokens\",\"children\":\"Requesting Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-tokens\",\"children\":\"Managing Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#refreshing-tokens\",\"children\":\"Refreshing Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#revoking-tokens\",\"children\":\"Revoking Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#purging-tokens\",\"children\":\"Purging Tokens\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#code-grant-pkce\",\"children\":\"Authorization Code Grant With PKCE\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-auth-pkce-grant-client\",\"children\":\"Creating the Client\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-auth-pkce-grant-tokens\",\"children\":\"Requesting Tokens\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#device-authorization-grant\",\"children\":\"Device Authorization Grant\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-device-authorization-grant-client\",\"children\":\"Creating a Device Code Grant Client\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-device-authorization-grant-tokens\",\"children\":\"Requesting Tokens\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#password-grant\",\"children\":\"Password Grant\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-password-grant-client\",\"children\":\"Creating a Password Grant Client\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-password-grant-tokens\",\"children\":\"Requesting Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-all-scopes\",\"children\":\"Requesting All Scopes\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider\",\"children\":\"Customizing the User Provider\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-username-field\",\"children\":\"Customizing the Username Field\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-password-validation\",\"children\":\"Customizing the Password Validation\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#implicit-grant\",\"children\":\"Implicit Grant\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#client-credentials-grant\",\"children\":\"Client Credentials Grant\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#personal-access-tokens\",\"children\":\"Personal Access Tokens\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-personal-access-client\",\"children\":\"Creating a Personal Access Client\"}]}],\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\"]}],\"\\n\"]}],\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\"]}],\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\",\"\\n\",\"$L71\",\"\\n\",\"$L72\",\"\\n\",\"$L73\",\"\\n\",\"$L74\",\"\\n\",\"$L75\",\"\\n\",\"$L76\",\"\\n\",\"$L77\",\"\\n\",\"$L78\",\"\\n\",\"$L79\",\"\\n\",\"$L7a\",\"\\n\",\"$L7b\",\"\\n\",\"$L7c\",\"\\n\",\"$L7d\",\"\\n\",\"$L7e\",\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\",\"\\n\",\"$L82\",\"\\n\",\"$L83\",\"\\n\",\"$L84\",\"\\n\",\"$L85\",\"\\n\",\"$L86\",\"\\n\",\"$L87\",\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\",\"\\n\",\"$L91\",\"\\n\",\"$L92\",\"\\n\",\"$L93\",\"\\n\",\"$L94\",\"\\n\",\"$L95\",\"\\n\",\"$L96\",\"\\n\",\"$L97\",\"\\n\",\"$L98\",\"\\n\",\"$L99\",\"\\n\",\"$L9a\",\"\\n\",\"$L9b\",\"\\n\",\"$L9c\",\"\\n\",\"$L9d\",\"\\n\",\"$L9e\",\"\\n\",\"$L9f\",\"\\n\",\"$La0\",\"\\n\",\"$La1\",\"\\n\",\"$La2\",\"\\n\",\"$La3\",\"\\n\",\"$La4\",\"\\n\",\"$La5\",\"\\n\",\"$La6\",\"\\n\",\"$La7\",\"\\n\",\"$La8\",\"\\n\",\"$La9\",\"\\n\",\"$Laa\",\"\\n\",\"$Lab\",\"\\n\",\"$Lac\",\"\\n\",\"$Lad\",\"\\n\",\"$Lae\",\"\\n\",\"$Laf\",\"\\n\",\"$Lb0\",\"\\n\",\"$Lb1\",\"\\n\",\"$Lb2\",\"\\n\",\"$Lb3\",\"\\n\",\"$Lb4\",\"\\n\",\"$Lb5\",\"\\n\",\"$Lb6\",\"\\n\",\"$Lb7\",\"\\n\",\"$Lb8\",\"\\n\",\"$Lb9\",\"\\n\",\"$Lba\",\"\\n\",\"$Lbb\",\"\\n\",\"$Lbc\",\"\\n\",\"$Lbd\",\"\\n\",\"$Lbe\",\"\\n\",\"$Lbf\",\"\\n\",\"$Lc0\",\"\\n\",\"$Lc1\",\"\\n\",\"$Lc2\",\"\\n\",\"$Lc3\",\"\\n\",\"$Lc4\",\"\\n\",\"$Lc5\",\"\\n\",\"$Lc6\",\"\\n\",\"$Lc7\",\"\\n\",\"$Lc8\",\"\\n\",\"$Lc9\",\"\\n\",\"$Lca\",\"\\n\",\"$Lcb\",\"\\n\",\"$Lcc\",\"\\n\",\"$Lcd\",\"\\n\",\"$Lce\",\"\\n\",\"$Lcf\",\"\\n\",\"$Ld0\",\"\\n\",\"$Ld1\",\"\\n\",\"$Ld2\",\"\\n\",\"$Ld3\",\"\\n\",\"$Ld4\",\"\\n\",\"$Ld5\",\"\\n\",\"$Ld6\",\"\\n\",\"$Ld7\",\"\\n\",\"$Ld8\",\"\\n\",\"$Ld9\",\"\\n\",\"$Lda\",\"\\n\",\"$Ldb\",\"\\n\",\"$Ldc\",\"\\n\",\"$Ldd\",\"\\n\",\"$Lde\",\"\\n\",\"$Ldf\",\"\\n\",\"$Le0\",\"\\n\",\"$Le1\",\"\\n\",\"$Le2\",\"\\n\",\"$Le3\",\"\\n\",\"$Le4\",\"\\n\",\"$Le5\",\"\\n\",\"$Le6\",\"\\n\",\"$Le7\",\"\\n\",\"$Le8\",\"\\n\",\"$Le9\",\"\\n\",\"$Lea\",\"\\n\",\"$Leb\",\"\\n\",\"$Lec\",\"\\n\",\"$Led\",\"\\n\",\"$Lee\",\"\\n\",\"$Lef\",\"\\n\",\"$Lf0\",\"\\n\",\"$Lf1\",\"\\n\",\"$Lf2\",\"\\n\",\"$Lf3\",\"\\n\",\"$Lf4\",\"\\n\",\"$Lf5\",\"\\n\",\"$Lf6\",\"\\n\",\"$Lf7\",\"\\n\",\"$Lf8\",\"\\n\",\"$Lf9\",\"\\n\",\"$Lfa\",\"\\n\",\"$Lfb\",\"\\n\",\"$Lfc\",\"\\n\",\"$Lfd\",\"\\n\",\"$Lfe\",\"\\n\",\"$Lff\",\"\\n\",\"$L100\",\"\\n\",\"$L101\",\"\\n\",\"$L102\",\"\\n\",\"$L103\",\"\\n\",\"$L104\",\"\\n\",\"$L105\",\"\\n\",\"$L106\",\"\\n\",\"$L107\",\"\\n\",\"$L108\",\"\\n\",\"$L109\",\"\\n\",\"$L10a\",\"\\n\",\"$L10b\",\"\\n\",\"$L10c\",\"\\n\",\"$L10d\",\"\\n\",\"$L10e\",\"\\n\",\"$L10f\",\"\\n\",\"$L110\",\"\\n\",\"$L111\",\"\\n\",\"$L112\",\"\\n\",\"$L113\",\"\\n\",\"$L114\",\"\\n\",\"$L115\",\"\\n\",\"$L116\",\"\\n\",\"$L117\",\"\\n\",\"$L118\",\"\\n\",\"$L119\",\"\\n\",\"$L11a\",\"\\n\",\"$L11b\",\"\\n\",\"$L11c\",\"\\n\",\"$L11d\",\"\\n\",\"$L11e\",\"\\n\",\"$L11f\",\"\\n\",\"$L120\",\"\\n\",\"$L121\",\"\\n\",\"$L122\",\"\\n\",\"$L123\",\"\\n\",\"$L124\",\"\\n\",\"$L125\",\"\\n\",\"$L126\",\"\\n\",\"$L127\",\"\\n\",\"$L128\",\"\\n\",\"$L129\",\"\\n\",\"$L12a\",\"\\n\",\"$L12b\",\"\\n\",\"$L12c\",\"\\n\",\"$L12d\",\"\\n\",\"$L12e\",\"\\n\",\"$L12f\",\"\\n\",\"$L130\",\"\\n\",\"$L131\",\"\\n\",\"$L132\",\"\\n\",\"$L133\",\"\\n\",\"$L134\",\"\\n\",\"$L135\",\"\\n\",\"$L136\",\"\\n\",\"$L137\",\"\\n\",\"$L138\",\"\\n\",\"$L139\",\"\\n\",\"$L13a\",\"\\n\",\"$L13b\",\"\\n\",\"$L13c\",\"\\n\",\"$L13d\",\"\\n\",\"$L13e\",\"\\n\",\"$L13f\",\"\\n\",\"$L140\",\"\\n\",\"$L141\",\"\\n\",\"$L142\",\"\\n\",\"$L143\",\"\\n\",\"$L144\",\"\\n\",\"$L145\",\"\\n\",\"$L146\",\"\\n\",\"$L147\",\"\\n\",\"$L148\",\"\\n\",\"$L149\",\"\\n\",\"$L14a\",\"\\n\",\"$L14b\",\"\\n\",\"$L14c\",\"\\n\",\"$L14d\",\"\\n\",\"$L14e\",\"\\n\",\"$L14f\",\"\\n\",\"$L150\",\"\\n\",\"$L151\",\"\\n\",\"$L152\",\"\\n\",\"$L153\",\"\\n\",\"$L154\",\"\\n\",\"$L155\",\"\\n\",\"$L156\",\"\\n\",\"$L157\",\"\\n\",\"$L158\",\"\\n\",\"$L159\",\"\\n\",\"$L15a\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider-for-pat\",\"children\":\"Customizing the User Provider\"}]}]\nf:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-personal-access-tokens\",\"children\":\"Managing Personal Access Tokens\"}]}]\n10:[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#protecting-routes\",\"children\":\"Protecting Routes\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#via-middleware\",\"children\":\"Via Middleware\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#passing-the-access-token\",\"children\":\"Passing the Access Token\"}]}],\"\\n\"]}],\"\\n\"]}]\n11:[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#token-scopes\",\"children\":\"Token Scopes\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-scopes\",\"children\":\"Defining Scopes\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#default-scope\",\"children\":\"Default Scope\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#assigning-scopes-to-tokens\",\"children\":\"Assigning Scopes to Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#checking-scopes\",\"children\":\"Checking Scopes\"}]}],\"\\n\"]}],\"\\n\"]}]\n12:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#spa-authentication\",\"children\":\"SPA Authentication\"}]}]\n13:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#events\",\"children\":\"Events\"}]}]\n14:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#testing\",\"children\":\"Testing\"}]}]\n15:[\"$\",\"a\",null,{\"name\":\"introduction\"}]\n16:[\"$\",\"h2\",null,{\"id\":\"簡介\",\"children\":[\"$\",\"a\",null,{\"href\":\"#簡介\",\"children\":\"簡介\"}]}]\n17:[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/laravel/passport\",\"children\":\"Laravel Passport\"}],\" provides a full OAuth2 server implementation for your Laravel application in a matter of minutes. Passport is built on top of the \",[\"$\",\"a\",null,{\"href\":\"https://github.com/thephpleague/oauth2-server\",\"children\":\"League OAuth2 server\"}],\" that is maintained by Andy Millington and Simon Hamp.\"]}]\n18:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nThis documentation assumes you are already familiar with OAuth2. If you do not know anything about OAuth2, consider familiarizing yourself with the general \",[\"$\",\"a\",null,{\"href\":\"https://oauth2.thephpleague.com/terminology/\",\"children\":\"terminology\"}],\" and features of OAuth2 before continuing.\"]}],\"\\n\"]}]\n19:[\"$\",\"a\",null,{\"name\":\"passport-or-sanctum\"}]\n1a:[\"$\",\"h3\",null,{\"id\":\"passport-or-sanctum\",\"children\":[\"$\",\"a\",null,{\"href\":\"#passport-or-sanctum\",\"children\":\"Passport or Sanctum?\"}]}]\n1b:[\"$\",\"p\",null,{\"children\":[\"Before getting started, you may wish to determine if your application would be better served by Laravel Passport or \",[\"$\",\"a\",null,{\"href\":\"/docs/sanctum\",\"children\":\"Laravel Sanctum\"}],\". If your application absolutely needs to support OAuth2, then you should use Laravel Passport.\"]}]\n1c:[\"$\",\"p\",null,{\"children\":[\"However, if you are attempting to authenticate a single-page application, mobile application, or issue API tokens, you should use \",[\"$\",\"a\",null,{\"href\":\"/docs/sanctum\",\"children\":\"Laravel Sanctum\"}],\". Laravel Sanctum does not support OAuth2; however, it provides a much simpler API authentication development experience.\"]}]\n1d:[\"$\",\"a\",null,{\"name\":\"installation\"}]\n1e:[\"$\",\"h2\",null,{\"id\":\"安裝\",\"children\":[\"$\",\"a\",null,{\"href\":\"#安裝\",\"children\":\"安裝\"}]}]\n1f:[\"$\",\"p\",null,{\"children\":[\"You may install Laravel Passport via the \",[\"$\",\"code\",null,{\"children\":\"install:api\"}],\" Artisan command:\"]}]\n20:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan install:api --passport\\n\"}]}]\n21:[\"$\",\"p\",null,{\"children\":\"This command will publish and run the database migrations necessary for creating the tables your application needs to store OAuth2 clients and access tokens. The command will also create the encryption keys required to generate secure access tokens.\"}]\n22:[\"$\",\"p\",null,{\"children\":[\"After running "])</script><script>self.__next_f.push([1,"the \",[\"$\",\"code\",null,{\"children\":\"install:api\"}],\" command, add the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\HasApiTokens\"}],\" trait and \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Contracts\\\\OAuthenticatable\"}],\" interface to your \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" model. This trait will provide a few helper methods to your model which allow you to inspect the authenticated user's token and scopes:\"]}]\n23:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Factories\\\\HasFactory;\\nuse Illuminate\\\\Foundation\\\\Auth\\\\User as Authenticatable;\\nuse Illuminate\\\\Notifications\\\\Notifiable;\\nuse Laravel\\\\Passport\\\\Contracts\\\\OAuthenticatable;\\nuse Laravel\\\\Passport\\\\HasApiTokens;\\n\\nclass User extends Authenticatable implements OAuthenticatable\\n{\\n    use HasApiTokens, HasFactory, Notifiable;\\n}\\n\"}]}]\n24:[\"$\",\"p\",null,{\"children\":[\"Finally, in your application's \",[\"$\",\"code\",null,{\"children\":\"config/auth.php\"}],\" configuration file, you should define an \",[\"$\",\"code\",null,{\"children\":\"api\"}],\" authentication guard and set the \",[\"$\",\"code\",null,{\"children\":\"driver\"}],\" option to \",[\"$\",\"code\",null,{\"children\":\"passport\"}],\". This will instruct your application to use Passport's \",[\"$\",\"code\",null,{\"children\":\"TokenGuard\"}],\" when authenticating incoming API requests:\"]}]\n25:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'guards' =\u003e [\\n    'web' =\u003e [\\n        'driver' =\u003e 'session',\\n        'provider' =\u003e 'users',\\n    ],\\n\\n    'api' =\u003e [\\n        'driver' =\u003e 'passport',\\n        'provider' =\u003e 'users',\\n    ],\\n],\\n\"}]}]\n26:[\"$\",\"a\",null,{\"name\":\"deploying-passport\"}]\n27:[\"$\",\"h3\",null,{\"id\":\"deploying-passport\",\"children\":[\"$\",\"a\",null,{\"href\":\"#deploying-passport\",\"children\":\"Deploying Passport\"}]}]\n28:[\"$\",\"p\",null,{\"children\":[\"When deploying Passport to your application's servers for the first time, you will likely need to run the \",[\"$\",\"code\",null,{\"children\":\"passport:keys\"}],\" command. This command generates the encryption keys Passport needs in order to generate access tokens. The generated keys are not typically kept in source control:\"]}]\n29:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:keys\\n\"}]}]\n2a:[\"$\",\"p\",null,{\"children\":[\"If necessary, you may define the path where Passport's keys should be loaded from. You may use the \",[\"$\",\"code\",null,{\"children\":\"Passport::loadKeysFrom\"}],\" method to accomplish this. Typically, this method should be called from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n2b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::loadKeysFrom(__DIR__.'/../secrets/oauth');\\n}\\n\"}]}]\n2c:[\"$\",\"a\",null,{\"name\":\"loading-keys-from-the-environment\"}]\n2d:[\"$\",\"h4\",null,{\"id\":\"loading-keys-from-the-environment\",\"children\":[\"$\",\"a\",null,{\"href\":\"#loading-keys-from-the-environment\",\"children\":\"Loading Keys From the Environment\"}]}]\n2e:[\"$\",\"p\",null,{\"children\":[\"Alternatively, you may publish Passport's configuration file using the \",[\"$\",\"code\",null,{\"children\":\"vendor:publish\"}],\" Artisan command:\"]}]\n2f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan vendor:publish --tag=passport-config\\n\"}]}]\n30:[\"$\",\"p\",null,{\"children\":\"After the configuration file has been published, you may load your application's encryption keys by defining them as environment variables:\"}]\n31:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-ini\",\"children\":\"PASSPORT_PRIVATE_KEY=\\\"-----BEGIN RSA PRIVATE KEY-----\\n\u003cprivate key here\u003e\\n-----END RSA PRIVATE KEY-----\\\"\\n\\nPASSPORT_PUBLIC_KEY=\\\"-----BEGIN PUBLIC KEY-----\\n\u003cpublic key here\u003e\\n-----END PUBLIC KEY-----\\\"\\n\"}]}]\n32:[\"$\",\"a\",nu"])</script><script>self.__next_f.push([1,"ll,{\"name\":\"upgrading-passport\"}]\n33:[\"$\",\"h3\",null,{\"id\":\"upgrading-passport\",\"children\":[\"$\",\"a\",null,{\"href\":\"#upgrading-passport\",\"children\":\"Upgrading Passport\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"When upgrading to a new major version of Passport, it's important that you carefully review \",[\"$\",\"a\",null,{\"href\":\"https://github.com/laravel/passport/blob/master/UPGRADE.md\",\"children\":\"the upgrade guide\"}],\".\"]}]\n35:[\"$\",\"a\",null,{\"name\":\"configuration\"}]\n36:[\"$\",\"h2\",null,{\"id\":\"設定\",\"children\":[\"$\",\"a\",null,{\"href\":\"#設定\",\"children\":\"設定\"}]}]\n37:[\"$\",\"a\",null,{\"name\":\"token-lifetimes\"}]\n38:[\"$\",\"h3\",null,{\"id\":\"token-lifetimes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#token-lifetimes\",\"children\":\"Token Lifetimes\"}]}]\n39:[\"$\",\"p\",null,{\"children\":[\"By default, Passport issues long-lived access tokens that expire after one year. If you would like to configure a longer / shorter token lifetime, you may use the \",[\"$\",\"code\",null,{\"children\":\"tokensExpireIn\"}],\", \",[\"$\",\"code\",null,{\"children\":\"refreshTokensExpireIn\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"personalAccessTokensExpireIn\"}],\" methods. These methods should be called from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n3a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Carbon\\\\CarbonInterval;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::tokensExpireIn(CarbonInterval::days(15));\\n    Passport::refreshTokensExpireIn(CarbonInterval::days(30));\\n    Passport::personalAccessTokensExpireIn(CarbonInterval::months(6));\\n}\\n\"}]}]\n3b:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nThe \",[\"$\",\"code\",null,{\"children\":\"expires_at\"}],\" columns on Passport's database tables are read-only and for display purposes only. When issuing tokens, Passport stores the expiration information within the signed and encrypted tokens. If you need to invalidate a token you should \",[\"$\",\"a\",null,{\"href\":\"#revoking-tokens\",\"children\":\"revoke it\"}],\".\"]}],\"\\n\"]}]\n3c:[\"$\",\"a\",null,{\"name\":\"overriding-default-models\"}]\n3d:[\"$\",\"h3\",null,{\"id\":\"overriding-default-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#overriding-default-models\",\"children\":\"Overriding Default Models\"}]}]\n3e:[\"$\",\"p\",null,{\"children\":\"You are free to extend the models used internally by Passport by defining your own model and extending the corresponding Passport model:\"}]\n3f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Client as PassportClient;\\n\\nclass Client extends PassportClient\\n{\\n    // ...\\n}\\n\"}]}]\n40:[\"$\",\"p\",null,{\"children\":[\"After defining your model, you may instruct Passport to use your custom model via the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Passport\"}],\" class. Typically, you should inform Passport about your custom models in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n41:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Passport\\\\AuthCode;\\nuse App\\\\Models\\\\Passport\\\\Client;\\nuse App\\\\Models\\\\Passport\\\\DeviceCode;\\nuse App\\\\Models\\\\Passport\\\\RefreshToken;\\nuse App\\\\Models\\\\Passport\\\\Token;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::useTokenModel(Token::class);\\n    Passport::useRefreshTokenModel(RefreshToken::class);\\n    Passport::useAuthCodeModel(AuthCode::class);\\n    Passport::useClientModel(Client::class);\\n    Passport::useDeviceCodeModel(DeviceCode::class);\\n}\\n\"}]}]\n42:[\"$\",\"a\",null,{\"name\":\"overriding-routes\"}]\n43:[\"$\",\"h3\",null,{\"id\":\"overriding-routes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#overriding-routes\",\"children\":\"Overriding Routes\"}]}]\n44:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may wish to customize the routes defined by Pass"])</script><script>self.__next_f.push([1,"port. To achieve this, you first need to ignore the routes registered by Passport by adding \",[\"$\",\"code\",null,{\"children\":\"Passport::ignoreRoutes\"}],\" to the \",[\"$\",\"code\",null,{\"children\":\"register\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\":\"]}]\n45:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Passport;\\n\\n/**\\n * Register any application services.\\n */\\npublic function register(): void\\n{\\n    Passport::ignoreRoutes();\\n}\\n\"}]}]\n46:[\"$\",\"p\",null,{\"children\":[\"Then, you may copy the routes defined by Passport in \",[\"$\",\"a\",null,{\"href\":\"https://github.com/laravel/passport/blob/master/routes/web.php\",\"children\":\"its routes file\"}],\" to your application's \",[\"$\",\"code\",null,{\"children\":\"routes/web.php\"}],\" file and modify them to your liking:\"]}]\n47:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Route::group([\\n    'as' =\u003e 'passport.',\\n    'prefix' =\u003e config('passport.path', 'oauth'),\\n    'namespace' =\u003e '\\\\Laravel\\\\Passport\\\\Http\\\\Controllers',\\n], function () {\\n    // Passport routes...\\n});\\n\"}]}]\n48:[\"$\",\"a\",null,{\"name\":\"authorization-code-grant\"}]\n49:[\"$\",\"h2\",null,{\"id\":\"authorization-code-grant\",\"children\":[\"$\",\"a\",null,{\"href\":\"#authorization-code-grant\",\"children\":\"Authorization Code Grant\"}]}]\n4a:[\"$\",\"p\",null,{\"children\":\"Using OAuth2 via authorization codes is how most developers are familiar with OAuth2. When using authorization codes, a client application will redirect a user to your server where they will either approve or deny the request to issue an access token to the client.\"}]\n4b:[\"$\",\"p\",null,{\"children\":\"To get started, we need to instruct Passport how to return our \\\"authorization\\\" view.\"}]\n4c:[\"$\",\"p\",null,{\"children\":[\"All the authorization view's rendering logic may be customized using the appropriate methods available via the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Passport\"}],\" class. Typically, you should call this method from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n4d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Inertia\\\\Inertia;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    // By providing a view name...\\n    Passport::authorizationView('auth.oauth.authorize');\\n\\n    // By providing a closure...\\n    Passport::authorizationView(\\n        fn ($parameters) =\u003e Inertia::render('Auth/OAuth/Authorize', [\\n            'request' =\u003e $parameters['request'],\\n            'authToken' =\u003e $parameters['authToken'],\\n            'client' =\u003e $parameters['client'],\\n            'user' =\u003e $parameters['user'],\\n            'scopes' =\u003e $parameters['scopes'],\\n        ])\\n    );\\n}\\n\"}]}]\n4e:[\"$\",\"p\",null,{\"children\":[\"Passport will automatically define the \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route that returns this view. Your \",[\"$\",\"code\",null,{\"children\":\"auth.oauth.authorize\"}],\" template should include a form that makes a POST request to the \",[\"$\",\"code\",null,{\"children\":\"passport.authorizations.approve\"}],\" route to approve the authorization and a form that makes a DELETE request to the \",[\"$\",\"code\",null,{\"children\":\"passport.authorizations.deny\"}],\" route to deny the authorization. The \",[\"$\",\"code\",null,{\"children\":\"passport.authorizations.approve\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"passport.authorizations.deny\"}],\" routes expect \",[\"$\",\"code\",null,{\"children\":\"state\"}],\", \",[\"$\",\"code\",null,{\"children\":\"client_id\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"auth_token\"}],\" fields.\"]}]\n4f:[\"$\",\"a\",null,{\"name\":\"managing-clients\"}]\n50:[\"$\",\"h3\",null,{\"id\":\"managing-clients\",\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-clients\",\"children\":\"Managing Clients\"}]}]\n51:[\"$\",\"p\",null,{\"children\":\"Developers building applications that need to interact with your application's API will need to regis"])</script><script>self.__next_f.push([1,"ter their application with yours by creating a \\\"client\\\". Typically, this consists of providing the name of their application and a URI that your application can redirect to after users approve their request for authorization.\"}]\n52:[\"$\",\"a\",null,{\"name\":\"managing-first-party-clients\"}]\n53:[\"$\",\"h4\",null,{\"id\":\"first-party-clients\",\"children\":[\"$\",\"a\",null,{\"href\":\"#first-party-clients\",\"children\":\"First-Party Clients\"}]}]\n54:[\"$\",\"p\",null,{\"children\":[\"The simplest way to create a client is using the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command. This command may be used to create first-party clients or testing your OAuth2 functionality. When you run the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" command, Passport will prompt you for more information about your client and will provide you with a client ID and secret:\"]}]\n55:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client\\n\"}]}]\n56:[\"$\",\"p\",null,{\"children\":[\"If you would like to allow multiple redirect URIs for your client, you may specify them using a comma-delimited list when prompted for the URI by the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" command. Any URIs which contain commas should be URI encoded:\"]}]\n57:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"https://third-party-app.com/callback,https://example.com/oauth/redirect\\n\"}]}]\n58:[\"$\",\"a\",null,{\"name\":\"managing-third-party-clients\"}]\n59:[\"$\",\"h4\",null,{\"id\":\"third-party-clients\",\"children\":[\"$\",\"a\",null,{\"href\":\"#third-party-clients\",\"children\":\"Third-Party Clients\"}]}]\n5a:[\"$\",\"p\",null,{\"children\":[\"Since your application's users will not be able to utilize the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" command, you may use \",[\"$\",\"code\",null,{\"children\":\"createAuthorizationCodeGrantClient\"}],\" method of the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\ClientRepository\"}],\" class to register a client for a given user:\"]}]\n5b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Laravel\\\\Passport\\\\ClientRepository;\\n\\n$user = User::find($userId);\\n\\n// Creating an OAuth app client that belongs to the given user...\\n$client = app(ClientRepository::class)-\u003ecreateAuthorizationCodeGrantClient(\\n    user: $user,\\n    name: 'Example App',\\n    redirectUris: ['https://third-party-app.com/callback'],\\n    confidential: false,\\n    enableDeviceFlow: true\\n);\\n\\n// Retrieving all the OAuth app clients that belong to the user...\\n$clients = $user-\u003eoauthApps()-\u003eget();\\n\"}]}]\n5c:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"createAuthorizationCodeGrantClient\"}],\" method returns an instance of \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Client\"}],\". You may display the \",[\"$\",\"code\",null,{\"children\":\"$$client-\u003eid\"}],\" as the client ID and \",[\"$\",\"code\",null,{\"children\":\"$$client-\u003eplainSecret\"}],\" as the client secret to the user.\"]}]\n5d:[\"$\",\"a\",null,{\"name\":\"requesting-tokens\"}]\n5e:[\"$\",\"h3\",null,{\"id\":\"requesting-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-tokens\",\"children\":\"Requesting Tokens\"}]}]\n5f:[\"$\",\"a\",null,{\"name\":\"requesting-tokens-redirecting-for-authorization\"}]\n60:[\"$\",\"h4\",null,{\"id\":\"redirecting-for-authorization\",\"children\":[\"$\",\"a\",null,{\"href\":\"#redirecting-for-authorization\",\"children\":\"Redirecting for Authorization\"}]}]\n61:[\"$\",\"p\",null,{\"children\":[\"Once a client has been created, developers may use their client ID and secret to request an authorization code and access token from your application. First, the consuming application should make a redirect request to your application's \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route like so:\"]}]\n62:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Support\\\\Str;\\n\\nRoute::get('/redirect', function (Request $request) {\\n    $request-\u003esession()-\u003eput('state', $state = Str::random(40));\\n\\n    $query = http_b"])</script><script>self.__next_f.push([1,"uild_query([\\n        'client_id' =\u003e 'your-client-id',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'response_type' =\u003e 'code',\\n        'scope' =\u003e 'user:read orders:create',\\n        'state' =\u003e $state,\\n        // 'prompt' =\u003e '', // \\\"none\\\", \\\"consent\\\", or \\\"login\\\"\\n    ]);\\n\\n    return redirect('https://passport-app.test/oauth/authorize?'.$query);\\n});\\n\"}]}]\n63:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"prompt\"}],\" parameter may be used to specify the authentication behavior of the Passport application.\"]}]\n64:[\"$\",\"p\",null,{\"children\":[\"If the \",[\"$\",\"code\",null,{\"children\":\"prompt\"}],\" value is \",[\"$\",\"code\",null,{\"children\":\"none\"}],\", Passport will always throw an authentication error if the user is not already authenticated with the Passport application. If the value is \",[\"$\",\"code\",null,{\"children\":\"consent\"}],\", Passport will always display the authorization approval screen, even if all scopes were previously granted to the consuming application. When the value is \",[\"$\",\"code\",null,{\"children\":\"login\"}],\", the Passport application will always prompt the user to re-login to the application, even if they already have an existing session.\"]}]\n65:[\"$\",\"p\",null,{\"children\":[\"If no \",[\"$\",\"code\",null,{\"children\":\"prompt\"}],\" value is provided, the user will be prompted for authorization only if they have not previously authorized access to the consuming application for the requested scopes.\"]}]\n66:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nRemember, the \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route is already defined by Passport. You do not need to manually define this route.\"]}],\"\\n\"]}]\n67:[\"$\",\"a\",null,{\"name\":\"approving-the-request\"}]\n68:[\"$\",\"h4\",null,{\"id\":\"approving-the-request\",\"children\":[\"$\",\"a\",null,{\"href\":\"#approving-the-request\",\"children\":\"Approving the Request\"}]}]\n69:[\"$\",\"p\",null,{\"children\":[\"When receiving authorization requests, Passport will automatically respond based on the value of \",[\"$\",\"code\",null,{\"children\":\"prompt\"}],\" parameter (if present) and may display a template to the user allowing them to approve or deny the authorization request. If they approve the request, they will be redirected back to the \",[\"$\",\"code\",null,{\"children\":\"redirect_uri\"}],\" that was specified by the consuming application. The \",[\"$\",\"code\",null,{\"children\":\"redirect_uri\"}],\" must match the \",[\"$\",\"code\",null,{\"children\":\"redirect\"}],\" URL that was specified when the client was created.\"]}]\n6a:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may wish to skip the authorization prompt, such as when authorizing a first-party client. You may accomplish this by \",[\"$\",\"a\",null,{\"href\":\"#overriding-default-models\",\"children\":[\"extending the \",[\"$\",\"code\",null,{\"children\":\"Client\"}],\" model\"]}],\" and defining a \",[\"$\",\"code\",null,{\"children\":\"skipsAuthorization\"}],\" method. If \",[\"$\",\"code\",null,{\"children\":\"skipsAuthorization\"}],\" returns \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" the client will be approved and the user will be redirected back to the \",[\"$\",\"code\",null,{\"children\":\"redirect_uri\"}],\" immediately, unless the consuming application has explicitly set the \",[\"$\",\"code\",null,{\"children\":\"prompt\"}],\" parameter when redirecting for authorization:\"]}]\n6b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models\\\\Passport;\\n\\nuse Illuminate\\\\Contracts\\\\Auth\\\\Authenticatable;\\nuse Laravel\\\\Passport\\\\Client as BaseClient;\\n\\nclass Client extends BaseClient\\n{\\n    /**\\n     * Determine if the client should skip the authorization prompt.\\n     *\\n     * @param  \\\\Laravel\\\\Passport\\\\Scope[]  $scopes\\n     */\\n    public function skipsAuthorization(Authenticatable $user, array $scopes): bool\\n    {\\n        return $this-\u003efirstParty();\\n    }\\n}\\n\"}]}]\n6c:[\"$\",\"a\",null,{\"name\":\"requesting-tokens-converting-authorization-codes-to-access-tokens\"}]\n6d:[\"$\",\"h4\",null,{\"id\":\"converting-authorization-codes-to-access-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#convertin"])</script><script>self.__next_f.push([1,"g-authorization-codes-to-access-tokens\",\"children\":\"Converting Authorization Codes to Access Tokens\"}]}]\n6e:[\"$\",\"p\",null,{\"children\":[\"If the user approves the authorization request, they will be redirected back to the consuming application. The consumer should first verify the \",[\"$\",\"code\",null,{\"children\":\"state\"}],\" parameter against the value that was stored prior to the redirect. If the state parameter matches then the consumer should issue a \",[\"$\",\"code\",null,{\"children\":\"POST\"}],\" request to your application to request an access token. The request should include the authorization code that was issued by your application when the user approved the authorization request:\"]}]\n6f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\nRoute::get('/callback', function (Request $request) {\\n    $state = $request-\u003esession()-\u003epull('state');\\n\\n    throw_unless(\\n        strlen($state) \u003e 0 \u0026\u0026 $state === $request-\u003estate,\\n        InvalidArgumentException::class,\\n        'Invalid state value.'\\n    );\\n\\n    $response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n        'grant_type' =\u003e 'authorization_code',\\n        'client_id' =\u003e 'your-client-id',\\n        'client_secret' =\u003e 'your-client-secret',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'code' =\u003e $request-\u003ecode,\\n    ]);\\n\\n    return $response-\u003ejson();\\n});\\n\"}]}]\n70:[\"$\",\"p\",null,{\"children\":[\"This \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route will return a JSON response containing \",[\"$\",\"code\",null,{\"children\":\"access_token\"}],\", \",[\"$\",\"code\",null,{\"children\":\"refresh_token\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attributes. The \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attribute contains the number of seconds until the access token expires.\"]}]\n71:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nLike the \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route, the \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route is defined for you by Passport. There is no need to manually define this route.\"]}],\"\\n\"]}]\n72:[\"$\",\"a\",null,{\"name\":\"managing-tokens\"}]\n73:[\"$\",\"h3\",null,{\"id\":\"managing-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-tokens\",\"children\":\"Managing Tokens\"}]}]\n74:[\"$\",\"p\",null,{\"children\":[\"You may retrieve user's authorized tokens using the \",[\"$\",\"code\",null,{\"children\":\"tokens\"}],\" method of the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\HasApiTokens\"}],\" trait. For example, this may be used to offer your users a dashboard to keep track of their connections with third-party applications:\"]}]\n75:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Collection;\\nuse Illuminate\\\\Support\\\\Facades\\\\Date;\\nuse Laravel\\\\Passport\\\\Token;\\n\\n$user = User::find($userId);\\n\\n// Retrieving all of the valid tokens for the user...\\n$tokens = $user-\u003etokens()\\n    -\u003ewhere('revoked', false)\\n    -\u003ewhere('expires_at', '\u003e', Date::now())\\n    -\u003eget();\\n\\n// Retrieving all the user's connections to third-party OAuth app clients...\\n$connections = $tokens-\u003eload('client')\\n    -\u003ereject(fn (Token $token) =\u003e $token-\u003eclient-\u003efirstParty())\\n    -\u003egroupBy('client_id')\\n    -\u003emap(fn (Collection $tokens) =\u003e [\\n        'client' =\u003e $tokens-\u003efirst()-\u003eclient,\\n        'scopes' =\u003e $tokens-\u003epluck('scopes')-\u003eflatten()-\u003eunique()-\u003evalues()-\u003eall(),\\n        'tokens_count' =\u003e $tokens-\u003ecount(),\\n    ])\\n    -\u003evalues();\\n\"}]}]\n76:[\"$\",\"a\",null,{\"name\":\"refreshing-tokens\"}]\n77:[\"$\",\"h3\",null,{\"id\":\"refreshing-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#refreshing-tokens\",\"children\":\"Refreshing Tokens\"}]}]\n78:[\"$\",\"p\",null,{\"children\":\"If your application issues short-lived access tokens, users will need to refresh their access tokens via the refresh token that was provided to them when the access token was issued:\"}]\n79:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\""])</script><script>self.__next_f.push([1,"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n    'grant_type' =\u003e 'refresh_token',\\n    'refresh_token' =\u003e 'the-refresh-token',\\n    'client_id' =\u003e 'your-client-id',\\n    'client_secret' =\u003e 'your-client-secret', // Required for confidential clients only...\\n    'scope' =\u003e 'user:read orders:create',\\n]);\\n\\nreturn $response-\u003ejson();\\n\"}]}]\n7a:[\"$\",\"p\",null,{\"children\":[\"This \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route will return a JSON response containing \",[\"$\",\"code\",null,{\"children\":\"access_token\"}],\", \",[\"$\",\"code\",null,{\"children\":\"refresh_token\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attributes. The \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attribute contains the number of seconds until the access token expires.\"]}]\n7b:[\"$\",\"a\",null,{\"name\":\"revoking-tokens\"}]\n7c:[\"$\",\"h3\",null,{\"id\":\"revoking-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#revoking-tokens\",\"children\":\"Revoking Tokens\"}]}]\n7d:[\"$\",\"p\",null,{\"children\":[\"You may revoke a token by using the \",[\"$\",\"code\",null,{\"children\":\"revoke\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Token\"}],\" model. You may revoke a token's refresh token using the \",[\"$\",\"code\",null,{\"children\":\"revoke\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\RefreshToken\"}],\" model:\"]}]\n7e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Passport;\\nuse Laravel\\\\Passport\\\\Token;\\n\\n$token = Passport::token()-\u003efind($tokenId);\\n\\n// Revoke an access token...\\n$token-\u003erevoke();\\n\\n// Revoke the token's refresh token...\\n$token-\u003erefreshToken?-\u003erevoke();\\n\\n// Revoke all of the user's tokens...\\nUser::find($userId)-\u003etokens()-\u003eeach(function (Token $token) {\\n    $token-\u003erevoke();\\n    $token-\u003erefreshToken?-\u003erevoke();\\n});\\n\"}]}]\n7f:[\"$\",\"a\",null,{\"name\":\"purging-tokens\"}]\n80:[\"$\",\"h3\",null,{\"id\":\"purging-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#purging-tokens\",\"children\":\"Purging Tokens\"}]}]\n81:[\"$\",\"p\",null,{\"children\":[\"When tokens have been revoked or expired, you might want to purge them from the database. Passport's included \",[\"$\",\"code\",null,{\"children\":\"passport:purge\"}],\" Artisan command can do this for you:\"]}]\n82:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"# Purge revoked and expired tokens, auth codes, and device codes...\\nphp artisan passport:purge\\n\\n# Only purge tokens expired for more than 6 hours...\\nphp artisan passport:purge --hours=6\\n\\n# Only purge revoked tokens, auth codes, and device codes...\\nphp artisan passport:purge --revoked\\n\\n# Only purge expired tokens, auth codes, and device codes...\\nphp artisan passport:purge --expired\\n\"}]}]\n83:[\"$\",\"p\",null,{\"children\":[\"You may also configure a \",[\"$\",\"a\",null,{\"href\":\"/docs/scheduling\",\"children\":\"scheduled job\"}],\" in your application's \",[\"$\",\"code\",null,{\"children\":\"routes/console.php\"}],\" file to automatically prune your tokens on a schedule:\"]}]\n84:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Schedule;\\n\\nSchedule::command('passport:purge')-\u003ehourly();\\n\"}]}]\n85:[\"$\",\"a\",null,{\"name\":\"code-grant-pkce\"}]\n86:[\"$\",\"h2\",null,{\"id\":\"authorization-code-grant-with-pkce\",\"children\":[\"$\",\"a\",null,{\"href\":\"#authorization-code-grant-with-pkce\",\"children\":\"Authorization Code Grant With PKCE\"}]}]\n87:[\"$\",\"p\",null,{\"children\":\"The Authorization Code grant with \\\"Proof Key for Code Exchange\\\" (PKCE) is a secure way to authenticate single page applications or mobile applications to access your API. This grant should be used when you can't guarantee that the client secret will be stored confidentially or in order to mitigate the threat of having the authorization code intercepted by an attacker. A combination of a \\\"code verifier\\\" and a \\\"code challenge\\\" replaces the client secret when exchanging the authorization code for an access token.\"}]\n88:[\"$\",\"a\",null,{\"name\":\"c"])</script><script>self.__next_f.push([1,"reating-a-auth-pkce-grant-client\"}]\n89:[\"$\",\"h3\",null,{\"id\":\"creating-the-client\",\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-the-client\",\"children\":\"Creating the Client\"}]}]\n8a:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue tokens via the authorization code grant with PKCE, you will need to create a PKCE-enabled client. You may do this using the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command with the \",[\"$\",\"code\",null,{\"children\":\"--public\"}],\" option:\"]}]\n8b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --public\\n\"}]}]\n8c:[\"$\",\"a\",null,{\"name\":\"requesting-auth-pkce-grant-tokens\"}]\n8d:[\"$\",\"h3\",null,{\"id\":\"requesting-tokens-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-tokens-1\",\"children\":\"Requesting Tokens\"}]}]\n8e:[\"$\",\"a\",null,{\"name\":\"code-verifier-code-challenge\"}]\n8f:[\"$\",\"h4\",null,{\"id\":\"code-verifier-and-code-challenge\",\"children\":[\"$\",\"a\",null,{\"href\":\"#code-verifier-and-code-challenge\",\"children\":\"Code Verifier and Code Challenge\"}]}]\n90:[\"$\",\"p\",null,{\"children\":\"As this authorization grant does not provide a client secret, developers will need to generate a combination of a code verifier and a code challenge in order to request a token.\"}]\n91:[\"$\",\"p\",null,{\"children\":[\"The code verifier should be a random string of between 43 and 128 characters containing letters, numbers, and  \",[\"$\",\"code\",null,{\"children\":\"\\\"-\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\".\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\"_\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\"~\\\"\"}],\" characters, as defined in the \",[\"$\",\"a\",null,{\"href\":\"https://tools.ietf.org/html/rfc7636\",\"children\":\"RFC 7636 specification\"}],\".\"]}]\n92:[\"$\",\"p\",null,{\"children\":[\"The code challenge should be a Base64 encoded string with URL and filename-safe characters. The trailing \",[\"$\",\"code\",null,{\"children\":\"'='\"}],\" characters should be removed and no line breaks, whitespace, or other additional characters should be present.\"]}]\n93:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$encoded = base64_encode(hash('sha256', $codeVerifier, true));\\n\\n$codeChallenge = strtr(rtrim($encoded, '='), '+/', '-_');\\n\"}]}]\n94:[\"$\",\"a\",null,{\"name\":\"code-grant-pkce-redirecting-for-authorization\"}]\n95:[\"$\",\"h4\",null,{\"id\":\"redirecting-for-authorization-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#redirecting-for-authorization-1\",\"children\":\"Redirecting for Authorization\"}]}]\n96:[\"$\",\"p\",null,{\"children\":[\"Once a client has been created, you may use the client ID and the generated code verifier and code challenge to request an authorization code and access token from your application. First, the consuming application should make a redirect request to your application's \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route:\"]}]\n97:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Support\\\\Str;\\n\\nRoute::get('/redirect', function (Request $request) {\\n    $request-\u003esession()-\u003eput('state', $state = Str::random(40));\\n\\n    $request-\u003esession()-\u003eput(\\n        'code_verifier', $codeVerifier = Str::random(128)\\n    );\\n\\n    $codeChallenge = strtr(rtrim(\\n        base64_encode(hash('sha256', $codeVerifier, true))\\n    , '='), '+/', '-_');\\n\\n    $query = http_build_query([\\n        'client_id' =\u003e 'your-client-id',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'response_type' =\u003e 'code',\\n        'scope' =\u003e 'user:read orders:create',\\n        'state' =\u003e $state,\\n        'code_challenge' =\u003e $codeChallenge,\\n        'code_challenge_method' =\u003e 'S256',\\n        // 'prompt' =\u003e '', // \\\"none\\\", \\\"consent\\\", or \\\"login\\\"\\n    ]);\\n\\n    return redirect('https://passport-app.test/oauth/authorize?'.$query);\\n});\\n\"}]}]\n98:[\"$\",\"a\",null,{\"name\":\"code-grant-pkce-converting-authorization-codes-to-access-tokens\"}]\n99:[\"$\",\"h4\",null,{\"id\":\"converting-authorization-codes-to-access-tokens-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#converting-authorization-cod"])</script><script>self.__next_f.push([1,"es-to-access-tokens-1\",\"children\":\"Converting Authorization Codes to Access Tokens\"}]}]\n9a:[\"$\",\"p\",null,{\"children\":[\"If the user approves the authorization request, they will be redirected back to the consuming application. The consumer should verify the \",[\"$\",\"code\",null,{\"children\":\"state\"}],\" parameter against the value that was stored prior to the redirect, as in the standard Authorization Code Grant.\"]}]\n9b:[\"$\",\"p\",null,{\"children\":[\"If the state parameter matches, the consumer should issue a \",[\"$\",\"code\",null,{\"children\":\"POST\"}],\" request to your application to request an access token. The request should include the authorization code that was issued by your application when the user approved the authorization request along with the originally generated code verifier:\"]}]\n9c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\nuse Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\nRoute::get('/callback', function (Request $request) {\\n    $state = $request-\u003esession()-\u003epull('state');\\n\\n    $codeVerifier = $request-\u003esession()-\u003epull('code_verifier');\\n\\n    throw_unless(\\n        strlen($state) \u003e 0 \u0026\u0026 $state === $request-\u003estate,\\n        InvalidArgumentException::class\\n    );\\n\\n    $response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n        'grant_type' =\u003e 'authorization_code',\\n        'client_id' =\u003e 'your-client-id',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'code_verifier' =\u003e $codeVerifier,\\n        'code' =\u003e $request-\u003ecode,\\n    ]);\\n\\n    return $response-\u003ejson();\\n});\\n\"}]}]\n9d:[\"$\",\"a\",null,{\"name\":\"device-authorization-grant\"}]\n9e:[\"$\",\"h2\",null,{\"id\":\"device-authorization-grant\",\"children\":[\"$\",\"a\",null,{\"href\":\"#device-authorization-grant\",\"children\":\"Device Authorization Grant\"}]}]\n9f:[\"$\",\"p\",null,{\"children\":\"The OAuth2 device authorization grant allows browserless or limited input devices, such as TVs and game consoles, to obtain an access token by exchanging a \\\"device code\\\". When using device flow, the device client will instruct the user to use a secondary device, such as a computer or a smartphone and connect to your server where they will enter the provided \\\"user code\\\" and either approve or deny the access request.\"}]\na0:[\"$\",\"p\",null,{\"children\":\"To get started, we need to instruct Passport how to return our \\\"user code\\\" and \\\"authorization\\\" views.\"}]\na1:[\"$\",\"p\",null,{\"children\":[\"All the authorization view's rendering logic may be customized using the appropriate methods available via the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Passport\"}],\" class. Typically, you should call this method from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class.\"]}]\na2:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Inertia\\\\Inertia;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    // By providing a view name...\\n    Passport::deviceUserCodeView('auth.oauth.device.user-code');\\n    Passport::deviceAuthorizationView('auth.oauth.device.authorize');\\n\\n    // By providing a closure...\\n    Passport::deviceUserCodeView(\\n        fn ($parameters) =\u003e Inertia::render('Auth/OAuth/Device/UserCode')\\n    );\\n\\n    Passport::deviceAuthorizationView(\\n        fn ($parameters) =\u003e Inertia::render('Auth/OAuth/Device/Authorize', [\\n            'request' =\u003e $parameters['request'],\\n            'authToken' =\u003e $parameters['authToken'],\\n            'client' =\u003e $parameters['client'],\\n            'user' =\u003e $parameters['user'],\\n            'scopes' =\u003e $parameters['scopes'],\\n        ])\\n    );\\n\\n    // ...\\n}\\n\"}]}]\na3:[\"$\",\"p\",null,{\"children\":[\"Passport will automatically define routes that return these views. Your \",[\"$\",\"code\",null,{\"children\":\"auth.oauth.device.user-code\"}],\" template should include a form that makes a GET request to the \",[\"$\",\"code\",null,{\"children\":\"passport.devi"])</script><script>self.__next_f.push([1,"ce.authorizations.authorize\"}],\" route. The \",[\"$\",\"code\",null,{\"children\":\"passport.device.authorizations.authorize\"}],\" route expects a \",[\"$\",\"code\",null,{\"children\":\"user_code\"}],\" query parameter.\"]}]\na4:[\"$\",\"p\",null,{\"children\":[\"Your \",[\"$\",\"code\",null,{\"children\":\"auth.oauth.device.authorize\"}],\" template should include a form that makes a POST request to the \",[\"$\",\"code\",null,{\"children\":\"passport.device.authorizations.approve\"}],\" route to approve the authorization and a form that makes a DELETE request to the \",[\"$\",\"code\",null,{\"children\":\"passport.device.authorizations.deny\"}],\" route to deny the authorization. The \",[\"$\",\"code\",null,{\"children\":\"passport.device.authorizations.approve\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"passport.device.authorizations.deny\"}],\" routes expect \",[\"$\",\"code\",null,{\"children\":\"state\"}],\", \",[\"$\",\"code\",null,{\"children\":\"client_id\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"auth_token\"}],\" fields.\"]}]\na5:[\"$\",\"a\",null,{\"name\":\"creating-a-device-authorization-grant-client\"}]\na6:[\"$\",\"h3\",null,{\"id\":\"creating-a-device-authorization-grant-client\",\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-device-authorization-grant-client\",\"children\":\"Creating a Device Authorization Grant Client\"}]}]\na7:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue tokens via the device authorization grant, you will need to create a device flow enabled client. You may do this using the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command with the \",[\"$\",\"code\",null,{\"children\":\"--device\"}],\" option. This command will create a first-party device flow enabled client and provide you with a client ID and secret:\"]}]\na8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --device\\n\"}]}]\na9:[\"$\",\"p\",null,{\"children\":[\"Additionally, you may use \",[\"$\",\"code\",null,{\"children\":\"createDeviceAuthorizationGrantClient\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"ClientRepository\"}],\" class to register a third-party client that belongs to the given user:\"]}]\naa:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Laravel\\\\Passport\\\\ClientRepository;\\n\\n$user = User::find($userId);\\n\\n$client = app(ClientRepository::class)-\u003ecreateDeviceAuthorizationGrantClient(\\n    user: $user,\\n    name: 'Example Device',\\n    confidential: false,\\n);\\n\"}]}]\nab:[\"$\",\"a\",null,{\"name\":\"requesting-device-authorization-grant-tokens\"}]\nac:[\"$\",\"h3\",null,{\"id\":\"requesting-tokens-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-tokens-2\",\"children\":\"Requesting Tokens\"}]}]\nad:[\"$\",\"a\",null,{\"name\":\"device-code\"}]\nae:[\"$\",\"h4\",null,{\"id\":\"requesting-a-device-code\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-a-device-code\",\"children\":\"Requesting a Device Code\"}]}]\naf:[\"$\",\"p\",null,{\"children\":[\"Once a client has been created, developers may use their client ID to request a device code from your application. First, the consuming device should make a \",[\"$\",\"code\",null,{\"children\":\"POST\"}],\" request to your application's \",[\"$\",\"code\",null,{\"children\":\"/oauth/device/code\"}],\" route to request a device code:\"]}]\nb0:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::asForm()-\u003epost('https://passport-app.test/oauth/device/code', [\\n    'client_id' =\u003e 'your-client-id',\\n    'scope' =\u003e 'user:read orders:create',\\n]);\\n\\nreturn $response-\u003ejson();\\n\"}]}]\nb1:[\"$\",\"p\",null,{\"children\":[\"This will return a JSON response containing \",[\"$\",\"code\",null,{\"children\":\"device_code\"}],\", \",[\"$\",\"code\",null,{\"children\":\"user_code\"}],\", \",[\"$\",\"code\",null,{\"children\":\"verification_uri\"}],\", \",[\"$\",\"code\",null,{\"children\":\"interval\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attributes. The \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attribute contains the number of seconds until the device code expires. The \",[\"$\",\"code\",null,{\"children\":\"interval\"}],\" attribute contains the number of seconds the con"])</script><script>self.__next_f.push([1,"suming device should wait between requests when polling \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route to avoid rate limit errors.\"]}]\nb2:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nRemember, the \",[\"$\",\"code\",null,{\"children\":\"/oauth/device/code\"}],\" route is already defined by Passport. You do not need to manually define this route.\"]}],\"\\n\"]}]\nb3:[\"$\",\"a\",null,{\"name\":\"user-code\"}]\nb4:[\"$\",\"h4\",null,{\"id\":\"displaying-the-verification-uri-and-user-code\",\"children\":[\"$\",\"a\",null,{\"href\":\"#displaying-the-verification-uri-and-user-code\",\"children\":\"Displaying the Verification URI and User Code\"}]}]\nb5:[\"$\",\"p\",null,{\"children\":[\"Once a device code request has been obtained, the consuming device should instruct the user to use another device and visit the provided \",[\"$\",\"code\",null,{\"children\":\"verification_uri\"}],\" and enter the \",[\"$\",\"code\",null,{\"children\":\"user_code\"}],\" in order to approve the authorization request.\"]}]\nb6:[\"$\",\"a\",null,{\"name\":\"polling-token-request\"}]\nb7:[\"$\",\"h4\",null,{\"id\":\"polling-token-request\",\"children\":[\"$\",\"a\",null,{\"href\":\"#polling-token-request\",\"children\":\"Polling Token Request\"}]}]\nb8:[\"$\",\"p\",null,{\"children\":[\"Since the user will be using a separate device to grant (or deny) access, the consuming device should poll your application's \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route to determine when the user has responded to the request. The consuming device should use the minimum polling \",[\"$\",\"code\",null,{\"children\":\"interval\"}],\" provided in the JSON response when requesting device code to avoid rate limit errors:\"]}]\nb9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\nuse Illuminate\\\\Support\\\\Sleep;\\n\\n$interval = 5;\\n\\ndo {\\n    Sleep::for($interval)-\u003eseconds();\\n\\n    $response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n        'grant_type' =\u003e 'urn:ietf:params:oauth:grant-type:device_code',\\n        'client_id' =\u003e 'your-client-id',\\n        'client_secret' =\u003e 'your-client-secret', // Required for confidential clients only...\\n        'device_code' =\u003e 'the-device-code',\\n    ]);\\n\\n    if ($response-\u003ejson('error') === 'slow_down') {\\n        $interval += 5;\\n    }\\n} while (in_array($response-\u003ejson('error'), ['authorization_pending', 'slow_down']));\\n\\nreturn $response-\u003ejson();\\n\"}]}]\nba:[\"$\",\"p\",null,{\"children\":[\"If the user has approved the authorization request, this will return a JSON response containing \",[\"$\",\"code\",null,{\"children\":\"access_token\"}],\", \",[\"$\",\"code\",null,{\"children\":\"refresh_token\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attributes. The \",[\"$\",\"code\",null,{\"children\":\"expires_in\"}],\" attribute contains the number of seconds until the access token expires.\"]}]\nbb:[\"$\",\"a\",null,{\"name\":\"password-grant\"}]\nbc:[\"$\",\"h2\",null,{\"id\":\"password-grant\",\"children\":[\"$\",\"a\",null,{\"href\":\"#password-grant\",\"children\":\"Password Grant\"}]}]\nbd:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nWe no longer recommend using password grant tokens. Instead, you should choose \",[\"$\",\"a\",null,{\"href\":\"https://oauth2.thephpleague.com/authorization-server/which-grant/\",\"children\":\"a grant type that is currently recommended by OAuth2 Server\"}],\".\"]}],\"\\n\"]}]\nbe:[\"$\",\"p\",null,{\"children\":\"The OAuth2 password grant allows your other first-party clients, such as a mobile application, to obtain an access token using an email address / username and password. This allows you to issue access tokens securely to your first-party clients without requiring your users to go through the entire OAuth2 authorization code redirect flow.\"}]\nbf:[\"$\",\"p\",null,{\"children\":[\"To enable the password grant, call the \",[\"$\",\"code\",null,{\"children\":\"enablePasswordGrant\"}],\" method in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\nc0:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-ph"])</script><script>self.__next_f.push([1,"p\",\"children\":\"/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::enablePasswordGrant();\\n}\\n\"}]}]\nc1:[\"$\",\"a\",null,{\"name\":\"creating-a-password-grant-client\"}]\nc2:[\"$\",\"h3\",null,{\"id\":\"creating-a-password-grant-client\",\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-password-grant-client\",\"children\":\"Creating a Password Grant Client\"}]}]\nc3:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue tokens via the password grant, you will need to create a password grant client. You may do this using the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command with the \",[\"$\",\"code\",null,{\"children\":\"--password\"}],\" option.\"]}]\nc4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --password\\n\"}]}]\nc5:[\"$\",\"a\",null,{\"name\":\"requesting-password-grant-tokens\"}]\nc6:[\"$\",\"h3\",null,{\"id\":\"requesting-tokens-3\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-tokens-3\",\"children\":\"Requesting Tokens\"}]}]\nc7:[\"$\",\"p\",null,{\"children\":[\"Once you have enabled the grant and have created a password grant client, you may request an access token by issuing a \",[\"$\",\"code\",null,{\"children\":\"POST\"}],\" request to the \",[\"$\",\"code\",null,{\"children\":\"/oauth/token\"}],\" route with the user's email address and password. Remember, this route is already registered by Passport so there is no need to define it manually. If the request is successful, you will receive an \",[\"$\",\"code\",null,{\"children\":\"access_token\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"refresh_token\"}],\" in the JSON response from the server:\"]}]\nc8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n    'grant_type' =\u003e 'password',\\n    'client_id' =\u003e 'your-client-id',\\n    'client_secret' =\u003e 'your-client-secret', // Required for confidential clients only...\\n    'username' =\u003e 'taylor@laravel.com',\\n    'password' =\u003e 'my-password',\\n    'scope' =\u003e 'user:read orders:create',\\n]);\\n\\nreturn $response-\u003ejson();\\n\"}]}]\nc9:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nRemember, access tokens are long-lived by default. However, you are free to \",[\"$\",\"a\",null,{\"href\":\"#configuration\",\"children\":\"configure your maximum access token lifetime\"}],\" if needed.\"]}],\"\\n\"]}]\nca:[\"$\",\"a\",null,{\"name\":\"requesting-all-scopes\"}]\ncb:[\"$\",\"h3\",null,{\"id\":\"requesting-all-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#requesting-all-scopes\",\"children\":\"Requesting All Scopes\"}]}]\ncc:[\"$\",\"p\",null,{\"children\":[\"When using the password grant or client credentials grant, you may wish to authorize the token for all of the scopes supported by your application. You can do this by requesting the \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" scope. If you request the \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" scope, the \",[\"$\",\"code\",null,{\"children\":\"can\"}],\" method on the token instance will always return \",[\"$\",\"code\",null,{\"children\":\"true\"}],\". This scope may only be assigned to a token that is issued using the \",[\"$\",\"code\",null,{\"children\":\"password\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"client_credentials\"}],\" grant:\"]}]\ncd:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n    'grant_type' =\u003e 'password',\\n    'client_id' =\u003e 'your-client-id',\\n    'client_secret' =\u003e 'your-client-secret', // Required for confidential clients only...\\n    'username' =\u003e 'taylor@laravel.com',\\n    'password' =\u003e 'my-password',\\n    'scope' =\u003e '*',\\n]);\\n\"}]}]\nce:[\"$\",\"a\",null,{\"name\":\"customizing-the-user-provider\"}]\ncf:[\"$\",\"h3\",null,{\"id\":\"customizing-the-user-provider\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider\",\"children\":\"Customizing the User Provider\"}]}]\nd0:[\"$\",\"p\",null,{\"children\":[\"If your application uses more than one \",[\"$\",\"a\",null,{\"href\":\"/docs/authenti"])</script><script>self.__next_f.push([1,"cation#introduction\",\"children\":\"authentication user provider\"}],\", you may specify which user provider the password grant client uses by providing a \",[\"$\",\"code\",null,{\"children\":\"--provider\"}],\" option when creating the client via the \",[\"$\",\"code\",null,{\"children\":\"artisan passport:client --password\"}],\" command. The given provider name should match a valid provider defined in your application's \",[\"$\",\"code\",null,{\"children\":\"config/auth.php\"}],\" configuration file. You can then \",[\"$\",\"a\",null,{\"href\":\"#multiple-authentication-guards\",\"children\":\"protect your route using middleware\"}],\" to ensure that only users from the guard's specified provider are authorized.\"]}]\nd1:[\"$\",\"a\",null,{\"name\":\"customizing-the-username-field\"}]\nd2:[\"$\",\"h3\",null,{\"id\":\"customizing-the-username-field\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-username-field\",\"children\":\"Customizing the Username Field\"}]}]\nd3:[\"$\",\"p\",null,{\"children\":[\"When authenticating using the password grant, Passport will use the \",[\"$\",\"code\",null,{\"children\":\"email\"}],\" attribute of your authenticatable model as the \\\"username\\\". However, you may customize this behavior by defining a \",[\"$\",\"code\",null,{\"children\":\"findForPassport\"}],\" method on your model:\"]}]\nd4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Foundation\\\\Auth\\\\User as Authenticatable;\\nuse Illuminate\\\\Notifications\\\\Notifiable;\\nuse Laravel\\\\Passport\\\\Bridge\\\\Client;\\nuse Laravel\\\\Passport\\\\Contracts\\\\OAuthenticatable;\\nuse Laravel\\\\Passport\\\\HasApiTokens;\\n\\nclass User extends Authenticatable implements OAuthenticatable\\n{\\n    use HasApiTokens, Notifiable;\\n\\n    /**\\n     * Find the user instance for the given username.\\n     */\\n    public function findForPassport(string $username, Client $client): User\\n    {\\n        return $this-\u003ewhere('username', $username)-\u003efirst();\\n    }\\n}\\n\"}]}]\nd5:[\"$\",\"a\",null,{\"name\":\"customizing-the-password-validation\"}]\nd6:[\"$\",\"h3\",null,{\"id\":\"customizing-the-password-validation\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-password-validation\",\"children\":\"Customizing the Password Validation\"}]}]\nd7:[\"$\",\"p\",null,{\"children\":[\"When authenticating using the password grant, Passport will use the \",[\"$\",\"code\",null,{\"children\":\"password\"}],\" attribute of your model to validate the given password. If your model does not have a \",[\"$\",\"code\",null,{\"children\":\"password\"}],\" attribute or you wish to customize the password validation logic, you can define a \",[\"$\",\"code\",null,{\"children\":\"validateForPassportPasswordGrant\"}],\" method on your model:\"]}]\nd8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Foundation\\\\Auth\\\\User as Authenticatable;\\nuse Illuminate\\\\Notifications\\\\Notifiable;\\nuse Illuminate\\\\Support\\\\Facades\\\\Hash;\\nuse Laravel\\\\Passport\\\\Contracts\\\\OAuthenticatable;\\nuse Laravel\\\\Passport\\\\HasApiTokens;\\n\\nclass User extends Authenticatable implements OAuthenticatable\\n{\\n    use HasApiTokens, Notifiable;\\n\\n    /**\\n     * Validate the password of the user for the Passport password grant.\\n     */\\n    public function validateForPassportPasswordGrant(string $password): bool\\n    {\\n        return Hash::check($password, $this-\u003epassword);\\n    }\\n}\\n\"}]}]\nd9:[\"$\",\"a\",null,{\"name\":\"implicit-grant\"}]\nda:[\"$\",\"h2\",null,{\"id\":\"implicit-grant\",\"children\":[\"$\",\"a\",null,{\"href\":\"#implicit-grant\",\"children\":\"Implicit Grant\"}]}]\ndb:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nWe no longer recommend using implicit grant tokens. Instead, you should choose \",[\"$\",\"a\",null,{\"href\":\"https://oauth2.thephpleague.com/authorization-server/which-grant/\",\"children\":\"a grant type that is currently recommended by OAuth2 Server\"}],\".\"]}],\"\\n\"]}]\ndc:[\"$\",\"p\",null,{\"children\":[\"The implicit grant is similar to the authorization code grant; however, the token is returned to the client without exchanging an authorization code. This grant is most commonly "])</script><script>self.__next_f.push([1,"used for JavaScript or mobile applications where the client credentials can't be securely stored. To enable the grant, call the \",[\"$\",\"code\",null,{\"children\":\"enableImplicitGrant\"}],\" method in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\ndd:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::enableImplicitGrant();\\n}\\n\"}]}]\nde:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue tokens via the implicit grant, you will need to create an implicit grant client. You may do this using the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command with the \",[\"$\",\"code\",null,{\"children\":\"--implicit\"}],\" option.\"]}]\ndf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --implicit\\n\"}]}]\ne0:[\"$\",\"p\",null,{\"children\":[\"Once the grant has been enabled and an implicit client has been created, developers may use their client ID to request an access token from your application. The consuming application should make a redirect request to your application's \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route like so:\"]}]\ne1:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\n\\nRoute::get('/redirect', function (Request $request) {\\n    $request-\u003esession()-\u003eput('state', $state = Str::random(40));\\n\\n    $query = http_build_query([\\n        'client_id' =\u003e 'your-client-id',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'response_type' =\u003e 'token',\\n        'scope' =\u003e 'user:read orders:create',\\n        'state' =\u003e $state,\\n        // 'prompt' =\u003e '', // \\\"none\\\", \\\"consent\\\", or \\\"login\\\"\\n    ]);\\n\\n    return redirect('https://passport-app.test/oauth/authorize?'.$query);\\n});\\n\"}]}]\ne2:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nRemember, the \",[\"$\",\"code\",null,{\"children\":\"/oauth/authorize\"}],\" route is already defined by Passport. You do not need to manually define this route.\"]}],\"\\n\"]}]\ne3:[\"$\",\"a\",null,{\"name\":\"client-credentials-grant\"}]\ne4:[\"$\",\"h2\",null,{\"id\":\"client-credentials-grant\",\"children\":[\"$\",\"a\",null,{\"href\":\"#client-credentials-grant\",\"children\":\"Client Credentials Grant\"}]}]\ne5:[\"$\",\"p\",null,{\"children\":\"The client credentials grant is suitable for machine-to-machine authentication. For example, you might use this grant in a scheduled job which is performing maintenance tasks over an API.\"}]\ne6:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue tokens via the client credentials grant, you will need to create a client credentials grant client. You may do this using the \",[\"$\",\"code\",null,{\"children\":\"--client\"}],\" option of the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command:\"]}]\ne7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --client\\n\"}]}]\ne8:[\"$\",\"p\",null,{\"children\":[\"Next, assign the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Http\\\\Middleware\\\\EnsureClientIsResourceOwner\"}],\" middleware to a route:\"]}]\ne9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Http\\\\Middleware\\\\EnsureClientIsResourceOwner;\\n\\nRoute::get('/orders', function (Request $request) {\\n    // Access token is valid and the client is resource owner...\\n})-\u003emiddleware(EnsureClientIsResourceOwner::class);\\n\"}]}]\nea:[\"$\",\"p\",null,{\"children\":[\"To restrict access to the route to specific scopes, you may provide a list of the required scopes to the \",[\"$\",\"code\",null,{\"children\":\"using\"}],\" method`:\"]}]\neb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Route::get('/orders', function (Request $request) {\\n    // Access token is valid, the client is resource owner, and has both \\\"servers:read\\\" an"])</script><script>self.__next_f.push([1,"d \\\"servers:create\\\" scopes...\\n})-\u003emiddleware(EnsureClientIsResourceOwner::using('servers:read', 'servers:create'));\\n\"}]}]\nec:[\"$\",\"a\",null,{\"name\":\"retrieving-tokens\"}]\ned:[\"$\",\"h3\",null,{\"id\":\"retrieving-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-tokens\",\"children\":\"Retrieving Tokens\"}]}]\nee:[\"$\",\"p\",null,{\"children\":[\"To retrieve a token using this grant type, make a request to the \",[\"$\",\"code\",null,{\"children\":\"oauth/token\"}],\" endpoint:\"]}]\nef:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::asForm()-\u003epost('https://passport-app.test/oauth/token', [\\n    'grant_type' =\u003e 'client_credentials',\\n    'client_id' =\u003e 'your-client-id',\\n    'client_secret' =\u003e 'your-client-secret',\\n    'scope' =\u003e 'servers:read servers:create',\\n]);\\n\\nreturn $response-\u003ejson()['access_token'];\\n\"}]}]\nf0:[\"$\",\"a\",null,{\"name\":\"personal-access-tokens\"}]\nf1:[\"$\",\"h2\",null,{\"id\":\"personal-access-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#personal-access-tokens\",\"children\":\"Personal Access Tokens\"}]}]\nf2:[\"$\",\"p\",null,{\"children\":\"Sometimes, your users may want to issue access tokens to themselves without going through the typical authorization code redirect flow. Allowing users to issue tokens to themselves via your application's UI can be useful for allowing users to experiment with your API or may serve as a simpler approach to issuing access tokens in general.\"}]\nf3:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nIf your application is using Passport primarily to issue personal access tokens, consider using \",[\"$\",\"a\",null,{\"href\":\"/docs/sanctum\",\"children\":\"Laravel Sanctum\"}],\", Laravel's light-weight first-party library for issuing API access tokens.\"]}],\"\\n\"]}]\nf4:[\"$\",\"a\",null,{\"name\":\"creating-a-personal-access-client\"}]\nf5:[\"$\",\"h3\",null,{\"id\":\"creating-a-personal-access-client\",\"children\":[\"$\",\"a\",null,{\"href\":\"#creating-a-personal-access-client\",\"children\":\"Creating a Personal Access Client\"}]}]\nf6:[\"$\",\"p\",null,{\"children\":[\"Before your application can issue personal access tokens, you will need to create a personal access client. You may do this by executing the \",[\"$\",\"code\",null,{\"children\":\"passport:client\"}],\" Artisan command with the \",[\"$\",\"code\",null,{\"children\":\"--personal\"}],\" option. If you have already run the \",[\"$\",\"code\",null,{\"children\":\"passport:install\"}],\" command, you do not need to run this command:\"]}]\nf7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan passport:client --personal\\n\"}]}]\nf8:[\"$\",\"a\",null,{\"name\":\"customizing-the-user-provider-for-pat\"}]\nf9:[\"$\",\"h3\",null,{\"id\":\"customizing-the-user-provider-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider-1\",\"children\":\"Customizing the User Provider\"}]}]\nfa:[\"$\",\"p\",null,{\"children\":[\"If your application uses more than one \",[\"$\",\"a\",null,{\"href\":\"/docs/authentication#introduction\",\"children\":\"authentication user provider\"}],\", you may specify which user provider the personal access grant client uses by providing a \",[\"$\",\"code\",null,{\"children\":\"--provider\"}],\" option when creating the client via the \",[\"$\",\"code\",null,{\"children\":\"artisan passport:client --personal\"}],\" command. The given provider name should match a valid provider defined in your application's \",[\"$\",\"code\",null,{\"children\":\"config/auth.php\"}],\" configuration file. You can then \",[\"$\",\"a\",null,{\"href\":\"#multiple-authentication-guards\",\"children\":\"protect your route using middleware\"}],\" to ensure that only users from the guard's specified provider are authorized.\"]}]\nfb:[\"$\",\"a\",null,{\"name\":\"managing-personal-access-tokens\"}]\nfc:[\"$\",\"h3\",null,{\"id\":\"managing-personal-access-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#managing-personal-access-tokens\",\"children\":\"Managing Personal Access Tokens\"}]}]\nfd:[\"$\",\"p\",null,{\"children\":[\"Once you have created a personal access client, you may issue tokens for a given user using the \",[\"$\",\"code\",null,{\"children\":\"createToken\"}],\" method on the \","])</script><script>self.__next_f.push([1,"[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" model instance. The \",[\"$\",\"code\",null,{\"children\":\"createToken\"}],\" method accepts the name of the token as its first argument and an optional array of \",[\"$\",\"a\",null,{\"href\":\"#token-scopes\",\"children\":\"scopes\"}],\" as its second argument:\"]}]\nfe:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Illuminate\\\\Support\\\\Facades\\\\Date;\\nuse Laravel\\\\Passport\\\\Token;\\n\\n$user = User::find($userId);\\n\\n// Creating a token without scopes...\\n$token = $user-\u003ecreateToken('My Token')-\u003eaccessToken;\\n\\n// Creating a token with scopes...\\n$token = $user-\u003ecreateToken('My Token', ['user:read', 'orders:create'])-\u003eaccessToken;\\n\\n// Creating a token with all scopes...\\n$token = $user-\u003ecreateToken('My Token', ['*'])-\u003eaccessToken;\\n\\n// Retrieving all the valid personal access tokens that belong to the user...\\n$tokens = $user-\u003etokens()\\n    -\u003ewith('client')\\n    -\u003ewhere('revoked', false)\\n    -\u003ewhere('expires_at', '\u003e', Date::now())\\n    -\u003eget()\\n    -\u003efilter(fn (Token $token) =\u003e $token-\u003eclient-\u003ehasGrantType('personal_access'));\\n\"}]}]\nff:[\"$\",\"a\",null,{\"name\":\"protecting-routes\"}]\n100:[\"$\",\"h2\",null,{\"id\":\"protecting-routes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#protecting-routes\",\"children\":\"Protecting Routes\"}]}]\n101:[\"$\",\"a\",null,{\"name\":\"via-middleware\"}]\n102:[\"$\",\"h3\",null,{\"id\":\"via-middleware\",\"children\":[\"$\",\"a\",null,{\"href\":\"#via-middleware\",\"children\":\"Via Middleware\"}]}]\n103:[\"$\",\"p\",null,{\"children\":[\"Passport includes an \",[\"$\",\"a\",null,{\"href\":\"/docs/authentication#adding-custom-guards\",\"children\":\"authentication guard\"}],\" that will validate access tokens on incoming requests. Once you have configured the \",[\"$\",\"code\",null,{\"children\":\"api\"}],\" guard to use the \",[\"$\",\"code\",null,{\"children\":\"passport\"}],\" driver, you only need to specify the \",[\"$\",\"code\",null,{\"children\":\"auth:api\"}],\" middleware on any routes that should require a valid access token:\"]}]\n104:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Route::get('/user', function () {\\n    // Only API authenticated users may access this route...\\n})-\u003emiddleware('auth:api');\\n\"}]}]\n105:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nIf you are using the \",[\"$\",\"a\",null,{\"href\":\"#client-credentials-grant\",\"children\":\"client credentials grant\"}],\", you should use \",[\"$\",\"a\",null,{\"href\":\"#client-credentials-grant\",\"children\":[\"the \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Http\\\\Middleware\\\\EnsureClientIsResourceOwner\"}],\" middleware\"]}],\" to protect your routes instead of the \",[\"$\",\"code\",null,{\"children\":\"auth:api\"}],\" middleware.\"]}],\"\\n\"]}]\n106:[\"$\",\"a\",null,{\"name\":\"multiple-authentication-guards\"}]\n107:[\"$\",\"h4\",null,{\"id\":\"multiple-authentication-guards\",\"children\":[\"$\",\"a\",null,{\"href\":\"#multiple-authentication-guards\",\"children\":\"Multiple Authentication Guards\"}]}]\n108:[\"$\",\"p\",null,{\"children\":[\"If your application authenticates different types of users that perhaps use entirely different Eloquent models, you will likely need to define a guard configuration for each user provider type in your application. This allows you to protect requests intended for specific user providers. For example, given the following guard configuration the \",[\"$\",\"code\",null,{\"children\":\"config/auth.php\"}],\" configuration file:\"]}]\n109:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"'guards' =\u003e [\\n    'api' =\u003e [\\n        'driver' =\u003e 'passport',\\n        'provider' =\u003e 'users',\\n    ],\\n\\n    'api-customers' =\u003e [\\n        'driver' =\u003e 'passport',\\n        'provider' =\u003e 'customers',\\n    ],\\n],\\n\"}]}]\n10a:[\"$\",\"p\",null,{\"children\":[\"The following route will utilize the \",[\"$\",\"code\",null,{\"children\":\"api-customers\"}],\" guard, which uses the \",[\"$\",\"code\",null,{\"children\":\"customers\"}],\" user provider, to authenticate incoming requests:\"]}]\n10b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Route::get('/customer', function ("])</script><script>self.__next_f.push([1,") {\\n    // ...\\n})-\u003emiddleware('auth:api-customers');\\n\"}]}]\n10c:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nFor more information on using multiple user providers with Passport, please consult the \",[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider-for-pat\",\"children\":\"personal access tokens documentation\"}],\" and \",[\"$\",\"a\",null,{\"href\":\"#customizing-the-user-provider\",\"children\":\"password grant documentation\"}],\".\"]}],\"\\n\"]}]\n10d:[\"$\",\"a\",null,{\"name\":\"passing-the-access-token\"}]\n10e:[\"$\",\"h3\",null,{\"id\":\"passing-the-access-token\",\"children\":[\"$\",\"a\",null,{\"href\":\"#passing-the-access-token\",\"children\":\"Passing the Access Token\"}]}]\n10f:[\"$\",\"p\",null,{\"children\":[\"When calling routes that are protected by Passport, your application's API consumers should specify their access token as a \",[\"$\",\"code\",null,{\"children\":\"Bearer\"}],\" token in the \",[\"$\",\"code\",null,{\"children\":\"Authorization\"}],\" header of their request. For example, when using the \",[\"$\",\"code\",null,{\"children\":\"Http\"}],\" Facade:\"]}]\n110:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Http;\\n\\n$response = Http::withHeaders([\\n    'Accept' =\u003e 'application/json',\\n    'Authorization' =\u003e \\\"Bearer $accessToken\\\",\\n])-\u003eget('https://passport-app.test/api/user');\\n\\nreturn $response-\u003ejson();\\n\"}]}]\n111:[\"$\",\"a\",null,{\"name\":\"token-scopes\"}]\n112:[\"$\",\"h2\",null,{\"id\":\"token-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#token-scopes\",\"children\":\"Token Scopes\"}]}]\n113:[\"$\",\"p\",null,{\"children\":\"Scopes allow your API clients to request a specific set of permissions when requesting authorization to access an account. For example, if you are building an e-commerce application, not all API consumers will need the ability to place orders. Instead, you may allow the consumers to only request authorization to access order shipment statuses. In other words, scopes allow your application's users to limit the actions a third-party application can perform on their behalf.\"}]\n114:[\"$\",\"a\",null,{\"name\":\"defining-scopes\"}]\n115:[\"$\",\"h3\",null,{\"id\":\"defining-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-scopes\",\"children\":\"Defining Scopes\"}]}]\n116:[\"$\",\"p\",null,{\"children\":[\"You may define your API's scopes using the \",[\"$\",\"code\",null,{\"children\":\"Passport::tokensCan\"}],\" method in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class. The \",[\"$\",\"code\",null,{\"children\":\"tokensCan\"}],\" method accepts an array of scope names and scope descriptions. The scope description may be anything you wish and will be displayed to users on the authorization approval screen:\"]}]\n117:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::tokensCan([\\n        'user:read' =\u003e 'Retrieve the user info',\\n        'orders:create' =\u003e 'Place orders',\\n        'orders:read:status' =\u003e 'Check order status',\\n    ]);\\n}\\n\"}]}]\n118:[\"$\",\"a\",null,{\"name\":\"default-scope\"}]\n119:[\"$\",\"h3\",null,{\"id\":\"default-scope\",\"children\":[\"$\",\"a\",null,{\"href\":\"#default-scope\",\"children\":\"Default Scope\"}]}]\n11a:[\"$\",\"p\",null,{\"children\":[\"If a client does not request any specific scopes, you may configure your Passport server to attach default scopes to the token using the \",[\"$\",\"code\",null,{\"children\":\"defaultScopes\"}],\" method. Typically, you should call this method from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n11b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Passport;\\n\\nPassport::tokensCan([\\n    'user:read' =\u003e 'Retrieve the user info',\\n    'orders:create' =\u003e 'Place orders',\\n    'orders:read:status' =\u003e 'Check order status',\\n]);\\n\\nPassport::defaultScopes([\\n    'user:read',\\n    'orders:create',\\n]);\\n\"}]}]\n11"])</script><script>self.__next_f.push([1,"c:[\"$\",\"a\",null,{\"name\":\"assigning-scopes-to-tokens\"}]\n11d:[\"$\",\"h3\",null,{\"id\":\"assigning-scopes-to-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#assigning-scopes-to-tokens\",\"children\":\"Assigning Scopes to Tokens\"}]}]\n11e:[\"$\",\"a\",null,{\"name\":\"when-requesting-authorization-codes\"}]\n11f:[\"$\",\"h4\",null,{\"id\":\"when-requesting-authorization-codes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#when-requesting-authorization-codes\",\"children\":\"When Requesting Authorization Codes\"}]}]\n120:[\"$\",\"p\",null,{\"children\":[\"When requesting an access token using the authorization code grant, consumers should specify their desired scopes as the \",[\"$\",\"code\",null,{\"children\":\"scope\"}],\" query string parameter. The \",[\"$\",\"code\",null,{\"children\":\"scope\"}],\" parameter should be a space-delimited list of scopes:\"]}]\n121:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Route::get('/redirect', function () {\\n    $query = http_build_query([\\n        'client_id' =\u003e 'your-client-id',\\n        'redirect_uri' =\u003e 'https://third-party-app.com/callback',\\n        'response_type' =\u003e 'code',\\n        'scope' =\u003e 'user:read orders:create',\\n    ]);\\n\\n    return redirect('https://passport-app.test/oauth/authorize?'.$query);\\n});\\n\"}]}]\n122:[\"$\",\"a\",null,{\"name\":\"when-issuing-personal-access-tokens\"}]\n123:[\"$\",\"h4\",null,{\"id\":\"when-issuing-personal-access-tokens\",\"children\":[\"$\",\"a\",null,{\"href\":\"#when-issuing-personal-access-tokens\",\"children\":\"When Issuing Personal Access Tokens\"}]}]\n124:[\"$\",\"p\",null,{\"children\":[\"If you are issuing personal access tokens using the \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" model's \",[\"$\",\"code\",null,{\"children\":\"createToken\"}],\" method, you may pass the array of desired scopes as the second argument to the method:\"]}]\n125:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$token = $user-\u003ecreateToken('My Token', ['orders:create'])-\u003eaccessToken;\\n\"}]}]\n126:[\"$\",\"a\",null,{\"name\":\"checking-scopes\"}]\n127:[\"$\",\"h3\",null,{\"id\":\"checking-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#checking-scopes\",\"children\":\"Checking Scopes\"}]}]\n128:[\"$\",\"p\",null,{\"children\":\"Passport includes two middleware that may be used to verify that an incoming request is authenticated with a token that has been granted a given scope.\"}]\n129:[\"$\",\"a\",null,{\"name\":\"check-for-all-scopes\"}]\n12a:[\"$\",\"h4\",null,{\"id\":\"check-for-all-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#check-for-all-scopes\",\"children\":\"Check For All Scopes\"}]}]\n12b:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Http\\\\Middleware\\\\CheckToken\"}],\" middleware may be assigned to a route to verify that the incoming request's access token has all the listed scopes:\"]}]\n12c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Http\\\\Middleware\\\\CheckToken;\\n\\nRoute::get('/orders', function () {\\n    // Access token has both \\\"orders:read\\\" and \\\"orders:create\\\" scopes...\\n})-\u003emiddleware(['auth:api', CheckToken::using('orders:read', 'orders:create')]);\\n\"}]}]\n12d:[\"$\",\"a\",null,{\"name\":\"check-for-any-scopes\"}]\n12e:[\"$\",\"h4\",null,{\"id\":\"check-for-any-scopes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#check-for-any-scopes\",\"children\":\"Check for Any Scopes\"}]}]\n12f:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Http\\\\Middleware\\\\CheckTokenForAnyScope\"}],\" middleware may be assigned to a route to verify that the incoming request's access token has \",[\"$\",\"em\",null,{\"children\":\"at least one\"}],\" of the listed scopes:\"]}]\n130:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Http\\\\Middleware\\\\CheckTokenForAnyScope;\\n\\nRoute::get('/orders', function () {\\n    // Access token has either \\\"orders:read\\\" or \\\"orders:create\\\" scope...\\n})-\u003emiddleware(['auth:api', CheckTokenForAnyScope::using('orders:read', 'orders:create')]);\\n\"}]}]\n131:[\"$\",\"a\",null,{\"name\":\"checking-scopes-on-a-token-instance\"}]\n132:[\"$\",\"h4\",null,{\"id\":\"checking-scopes-on-a-token-instance\",\"chil"])</script><script>self.__next_f.push([1,"dren\":[\"$\",\"a\",null,{\"href\":\"#checking-scopes-on-a-token-instance\",\"children\":\"Checking Scopes on a Token Instance\"}]}]\n133:[\"$\",\"p\",null,{\"children\":[\"Once an access token authenticated request has entered your application, you may still check if the token has a given scope using the \",[\"$\",\"code\",null,{\"children\":\"tokenCan\"}],\" method on the authenticated \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" instance:\"]}]\n134:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Http\\\\Request;\\n\\nRoute::get('/orders', function (Request $request) {\\n    if ($request-\u003euser()-\u003etokenCan('orders:create')) {\\n        // ...\\n    }\\n});\\n\"}]}]\n135:[\"$\",\"a\",null,{\"name\":\"additional-scope-methods\"}]\n136:[\"$\",\"h4\",null,{\"id\":\"additional-scope-methods\",\"children\":[\"$\",\"a\",null,{\"href\":\"#additional-scope-methods\",\"children\":\"Additional Scope Methods\"}]}]\n137:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"scopeIds\"}],\" method will return an array of all defined IDs / names:\"]}]\n138:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Passport;\\n\\nPassport::scopeIds();\\n\"}]}]\n139:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"scopes\"}],\" method will return an array of all defined scopes as instances of \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Scope\"}],\":\"]}]\n13a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Passport::scopes();\\n\"}]}]\n13b:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"scopesFor\"}],\" method will return an array of \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Scope\"}],\" instances matching the given IDs / names:\"]}]\n13c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Passport::scopesFor(['user:read', 'orders:create']);\\n\"}]}]\n13d:[\"$\",\"p\",null,{\"children\":[\"You may determine if a given scope has been defined using the \",[\"$\",\"code\",null,{\"children\":\"hasScope\"}],\" method:\"]}]\n13e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Passport::hasScope('orders:create');\\n\"}]}]\n13f:[\"$\",\"a\",null,{\"name\":\"spa-authentication\"}]\n140:[\"$\",\"h2\",null,{\"id\":\"spa-authentication\",\"children\":[\"$\",\"a\",null,{\"href\":\"#spa-authentication\",\"children\":\"SPA Authentication\"}]}]\n141:[\"$\",\"p\",null,{\"children\":\"When building an API, it can be extremely useful to be able to consume your own API from your JavaScript application. This approach to API development allows your own application to consume the same API that you are sharing with the world. The same API may be consumed by your web application, mobile applications, third-party applications, and any SDKs that you may publish on various package managers.\"}]\n142:[\"$\",\"p\",null,{\"children\":[\"Typically, if you want to consume your API from your JavaScript application, you would need to manually send an access token to the application and pass it with each request to your application. However, Passport includes a middleware that can handle this for you. All you need to do is append the \",[\"$\",\"code\",null,{\"children\":\"CreateFreshApiToken\"}],\" middleware to the \",[\"$\",\"code\",null,{\"children\":\"web\"}],\" middleware group in your application's \",[\"$\",\"code\",null,{\"children\":\"bootstrap/app.php\"}],\" file:\"]}]\n143:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Http\\\\Middleware\\\\CreateFreshApiToken;\\n\\n-\u003ewithMiddleware(function (Middleware $middleware): void {\\n    $middleware-\u003eweb(append: [\\n        CreateFreshApiToken::class,\\n    ]);\\n})\\n\"}]}]\n144:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nYou should ensure that the \",[\"$\",\"code\",null,{\"children\":\"CreateFreshApiToken\"}],\" middleware is the last middleware listed in your middleware stack.\"]}],\"\\n\"]}]\n145:[\"$\",\"p\",null,{\"children\":[\"This middleware will attach a \",[\"$\",\"code\",null,{\"children\":\"laravel_token\"}],\" cookie to your outgoing responses. This cookie contains an encrypted JWT "])</script><script>self.__next_f.push([1,"that Passport will use to authenticate API requests from your JavaScript application. The JWT has a lifetime equal to your \",[\"$\",\"code\",null,{\"children\":\"session.lifetime\"}],\" configuration value. Now, since the browser will automatically send the cookie with all subsequent requests, you may make requests to your application's API without explicitly passing an access token:\"]}]\n146:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"axios.get('/api/user')\\n    .then(response =\u003e {\\n        console.log(response.data);\\n    });\\n\"}]}]\n147:[\"$\",\"a\",null,{\"name\":\"customizing-the-cookie-name\"}]\n148:[\"$\",\"h4\",null,{\"id\":\"customizing-the-cookie-name\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-cookie-name\",\"children\":\"Customizing the Cookie Name\"}]}]\n149:[\"$\",\"p\",null,{\"children\":[\"If needed, you can customize the \",[\"$\",\"code\",null,{\"children\":\"laravel_token\"}],\" cookie's name using the \",[\"$\",\"code\",null,{\"children\":\"Passport::cookie\"}],\" method. Typically, this method should be called from the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class:\"]}]\n14a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Passport::cookie('custom_name');\\n}\\n\"}]}]\n14b:[\"$\",\"a\",null,{\"name\":\"csrf-protection\"}]\n14c:[\"$\",\"h4\",null,{\"id\":\"csrf-protection\",\"children\":[\"$\",\"a\",null,{\"href\":\"#csrf-protection\",\"children\":\"CSRF Protection\"}]}]\n14d:[\"$\",\"p\",null,{\"children\":[\"When using this method of authentication, you will need to ensure a valid CSRF token header is included in your requests. The default Laravel JavaScript scaffolding included with the skeleton application and all starter kits includes an \",[\"$\",\"a\",null,{\"href\":\"https://github.com/axios/axios\",\"children\":\"Axios\"}],\" instance, which will automatically use the encrypted \",[\"$\",\"code\",null,{\"children\":\"XSRF-TOKEN\"}],\" cookie value to send an \",[\"$\",\"code\",null,{\"children\":\"X-XSRF-TOKEN\"}],\" header on same-origin requests.\"]}]\n14e:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nIf you choose to send the \",[\"$\",\"code\",null,{\"children\":\"X-CSRF-TOKEN\"}],\" header instead of \",[\"$\",\"code\",null,{\"children\":\"X-XSRF-TOKEN\"}],\", you will need to use the unencrypted token provided by \",[\"$\",\"code\",null,{\"children\":\"csrf_token()\"}],\".\"]}],\"\\n\"]}]\n14f:[\"$\",\"a\",null,{\"name\":\"events\"}]\n150:[\"$\",\"h2\",null,{\"id\":\"events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#events\",\"children\":\"Events\"}]}]\n151:[\"$\",\"p\",null,{\"children\":[\"Passport raises events when issuing access tokens and refresh tokens. You may \",[\"$\",\"a\",null,{\"href\":\"/docs/events\",\"children\":\"listen for these events\"}],\" to prune or revoke other access tokens in your database:\"]}]\n152:[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[\"$\",\"p\",null,{\"children\":[\"| Event Name                                    |\\n| --------------------------------------------- |\\n| \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Events\\\\AccessTokenCreated\"}],\"  |\\n| \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Events\\\\AccessTokenRevoked\"}],\"  |\\n| \",[\"$\",\"code\",null,{\"children\":\"Laravel\\\\Passport\\\\Events\\\\RefreshTokenCreated\"}],\" |\"]}]}]\n153:[\"$\",\"a\",null,{\"name\":\"testing\"}]\n154:[\"$\",\"h2\",null,{\"id\":\"testing\",\"children\":[\"$\",\"a\",null,{\"href\":\"#testing\",\"children\":\"Testing\"}]}]\n155:[\"$\",\"p\",null,{\"children\":[\"Passport's \",[\"$\",\"code\",null,{\"children\":\"actingAs\"}],\" method may be used to specify the currently authenticated user as well as its scopes. The first argument given to the \",[\"$\",\"code\",null,{\"children\":\"actingAs\"}],\" method is the user instance and the second is an array of scopes that should be granted to the user's token:\"]}]\n156:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\ntest('orders can be created', function () {\\n    Passport::actingAs(\\n        User::factory("])</script><script>self.__next_f.push([1,")-\u003ecreate(),\\n        ['orders:create']\\n    );\\n\\n    $response = $this-\u003epost('/api/orders');\\n\\n    $response-\u003eassertStatus(201);\\n});\\n\"}]}]\n157:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\npublic function test_orders_can_be_created(): void\\n{\\n    Passport::actingAs(\\n        User::factory()-\u003ecreate(),\\n        ['orders:create']\\n    );\\n\\n    $response = $this-\u003epost('/api/orders');\\n\\n    $response-\u003eassertStatus(201);\\n}\\n\"}]}]\n158:[\"$\",\"p\",null,{\"children\":[\"Passport's \",[\"$\",\"code\",null,{\"children\":\"actingAsClient\"}],\" method may be used to specify the currently authenticated client as well as its scopes. The first argument given to the \",[\"$\",\"code\",null,{\"children\":\"actingAsClient\"}],\" method is the client instance and the second is an array of scopes that should be granted to the client's token:\"]}]\n159:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Client;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\ntest('servers can be retrieved', function () {\\n    Passport::actingAsClient(\\n        Client::factory()-\u003ecreate(),\\n        ['servers:read']\\n    );\\n\\n    $response = $this-\u003eget('/api/servers');\\n\\n    $response-\u003eassertStatus(200);\\n});\\n\"}]}]\n15a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Laravel\\\\Passport\\\\Client;\\nuse Laravel\\\\Passport\\\\Passport;\\n\\npublic function test_servers_can_be_retrieved(): void\\n{\\n    Passport::actingAsClient(\\n        Client::factory()-\u003ecreate(),\\n        ['servers:read']\\n    );\\n\\n    $response = $this-\u003eget('/api/servers');\\n\\n    $response-\u003eassertStatus(200);\\n}\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"15b:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L15b\",\"3\",{}]]\n8:null\n"])</script></body></html>