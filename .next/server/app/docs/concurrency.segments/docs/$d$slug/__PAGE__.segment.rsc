1:"$Sreact.fragment"
9:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"OutletBoundary"]
a:"$Sreact.suspense"
0:{"buildId":"2DrqUONp3UGGEsii_P-1z","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"container mx-auto py-10","children":["$","div",null,{"className":"mx-auto max-w-3xl","children":[["$","div",null,{"className":"mb-8","children":[["$","h1",null,{"className":"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl","children":"Concurrency"}],["$","p",null,{"className":"text-xl text-muted-foreground mt-2","children":"Laravel 的並行執行功能可讓你同時執行多個任務"}]]}],["$","article",null,{"className":"prose prose-slate dark:prose-invert max-w-none","children":[["$","h1",null,{"id":"concurrency","children":["$","a",null,{"href":"#concurrency","children":"Concurrency"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"#introduction","children":"Introduction"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"#running-concurrent-tasks","children":"Running Concurrent Tasks"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"#deferring-concurrent-tasks","children":"Deferring Concurrent Tasks"}]}],"\n"]}],"\n",["$","a",null,{"name":"introduction"}],"\n",["$","h2",null,{"id":"簡介","children":["$","a",null,{"href":"#簡介","children":"簡介"}]}],"\n",["$","p",null,{"children":["Sometimes you may need to execute several slow tasks which do not depend on one another. In many cases, significant performance improvements can be realized by executing the tasks concurrently. Laravel's ",["$","code",null,{"children":"Concurrency"}]," facade provides a simple, convenient API for executing closures concurrently."]}],"\n",["$","a",null,{"name":"how-it-works"}],"\n",["$","h4",null,{"id":"how-it-works","children":["$","a",null,{"href":"#how-it-works","children":"How it Works"}]}],"\n",["$","p",null,{"children":"Laravel achieves concurrency by serializing the given closures and dispatching them to a hidden Artisan CLI command, which unserializes the closures and invokes it within its own PHP process. After the closure has been invoked, the resulting value is serialized back to the parent process."}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"Concurrency"}]," facade supports three drivers: ",["$","code",null,{"children":"process"}]," (the default), ",["$","code",null,{"children":"fork"}],", and ",["$","code",null,{"children":"sync"}],"."]}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"fork"}]," driver offers improved performance compared to the default ",["$","code",null,{"children":"process"}]," driver, but it may only be used within PHP's CLI context, as PHP does not support forking during web requests. Before using the ",["$","code",null,{"children":"fork"}]," driver, you need to install the ",["$","code",null,{"children":"spatie/fork"}]," package:"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-shell","children":"composer require spatie/fork\n"}]}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"sync"}]," driver is primarily useful during testing when you want to disable all concurrency and simply execute the given closures in sequence within the parent process."]}],"\n",["$","a",null,{"name":"running-concurrent-tasks"}],"\n",["$","h2",null,{"id":"running-concurrent-tasks","children":["$","a",null,{"href":"#running-concurrent-tasks","children":"Running Concurrent Tasks"}]}],"\n",["$","p",null,{"children":["To run concurrent tasks, you may invoke the ",["$","code",null,{"children":"Concurrency"}]," facade's ",["$","code",null,{"children":"run"}]," method. The ",["$","code",null,{"children":"run"}]," method accepts an array of closures which should be executed simultaneously in child PHP processes:"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"use Illuminate\\Support\\Facades\\Concurrency;\nuse Illuminate\\Support\\Facades\\DB;\n\n[$userCount, $orderCount] = Concurrency::run([\n    fn () => DB::table('users')->count(),\n    fn () => DB::table('orders')->count(),\n]);\n"}]}],"\n",["$","p",null,{"children":["To use a specific driver, you may use the ",["$","code",null,{"children":"driver"}]," method:"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"$$results = Concurrency::driver('fork')->run(...);\n"}]}],"\n","$L2","\n","$L3","\n","$L4","\n","$L5","\n","$L6","\n","$L7"]}]]}]}],null,"$L8"]}],"loading":null,"isPartial":false}
2:["$","p",null,{"children":["Or, to change the default concurrency driver, you should publish the ",["$","code",null,{"children":"concurrency"}]," configuration file via the ",["$","code",null,{"children":"config:publish"}]," Artisan command and update the ",["$","code",null,{"children":"default"}]," option within the file:"]}]
3:["$","pre",null,{"children":["$","code",null,{"className":"language-shell","children":"php artisan config:publish concurrency\n"}]}]
4:["$","a",null,{"name":"deferring-concurrent-tasks"}]
5:["$","h2",null,{"id":"deferring-concurrent-tasks","children":["$","a",null,{"href":"#deferring-concurrent-tasks","children":"Deferring Concurrent Tasks"}]}]
6:["$","p",null,{"children":["If you would like to execute an array of closures concurrently, but are not interested in the results returned by those closures, you should consider using the ",["$","code",null,{"children":"defer"}]," method. When the ",["$","code",null,{"children":"defer"}]," method is invoked, the given closures are not executed immediately. Instead, Laravel will execute the closures concurrently after the HTTP response has been sent to the user:"]}]
7:["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"use App\\Services\\Metrics;\nuse Illuminate\\Support\\Facades\\Concurrency;\n\nConcurrency::defer([\n    fn () => Metrics::report('users'),\n    fn () => Metrics::report('orders'),\n]);\n"}]}]
8:["$","$L9",null,{"children":["$","$a",null,{"name":"Next.MetadataOutlet","children":"$@b"}]}]
b:null
