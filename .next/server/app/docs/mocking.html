<!DOCTYPE html><!--0lISzds8vnU9N34ubzJcA--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/bc6e94e20a39014e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/2b257daea29fbb42.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs（中文）</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a><a class="block" href="/docs/frontend"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">前端</button></a><a class="block" href="/docs/starter-kits"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">啟動套件</button></a><a class="block" href="/docs/deployment"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">部署</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl"></h1></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="mocking"><a href="#mocking">Mocking</a></h1>
<ul>
<li><a href="#introduction">介紹</a></li>
<li><a href="#mocking-objects">Mocking 物件</a></li>
<li><a href="#mocking-facades">Mocking Facades</a>
<ul>
<li><a href="#facade-spies">Facade Spies</a></li>
</ul>
</li>
<li><a href="#interacting-with-time">與時間互動</a></li>
</ul>
<a name="introduction"></a>
<h2 id="介紹"><a href="#介紹">介紹</a></h2>
<p>在測試 Laravel 應用程式時，你可能希望「模擬」應用程式的某些部分，以便它們在特定測試期間不會真正被執行。例如，在測試一個會派發事件的控制器時，你可能希望模擬事件監聽器，這樣它們在測試期間就不會真正被執行。這讓你可以只測試控制器的 HTTP 回應，而不用擔心事件監聽器的執行，因為事件監聽器可以在它們自己的測試案例中進行測試。</p>
<p>Laravel 提供了開箱即用的實用方法來模擬事件、任務和其他 facades。這些輔助方法主要提供了一個 Mockery 的便利層，因此你不必手動進行複雜的 Mockery 方法調用。</p>
<a name="mocking-objects"></a>
<h2 id="mocking-物件"><a href="#mocking-物件">Mocking 物件</a></h2>
<p>當模擬一個將透過 Laravel <a href="/docs/%7B%7Bversion%7D%7D/container">service container</a> 注入到你的應用程式的物件時，你需要將你模擬的實例作為 <code>instance</code> 綁定到容器中。這會指示容器使用你模擬的物件實例，而不是自己建構該物件：</p>
<pre><code class="language-php">use App\Service;
use Mockery;
use Mockery\MockInterface;

test(&#x27;something can be mocked&#x27;, function () {
    $this-&gt;instance(
        Service::class,
        Mockery::mock(Service::class, function (MockInterface $mock) {
            $mock-&gt;expects(&#x27;process&#x27;);
        })
    );
});
</code></pre>
<pre><code class="language-php">use App\Service;
use Mockery;
use Mockery\MockInterface;

public function test_something_can_be_mocked(): void
{
    $this-&gt;instance(
        Service::class,
        Mockery::mock(Service::class, function (MockInterface $mock) {
            $mock-&gt;expects(&#x27;process&#x27;);
        })
    );
}
</code></pre>
<p>為了讓這更加方便，你可以使用 Laravel 基礎測試案例類別提供的 <code>mock</code> 方法。例如，以下範例與上面的範例是等效的：</p>
<pre><code class="language-php">use App\Service;
use Mockery\MockInterface;

$mock = $this-&gt;mock(Service::class, function (MockInterface $mock) {
    $mock-&gt;expects(&#x27;process&#x27;);
});
</code></pre>
<p>當你只需要模擬物件的幾個方法時，你可以使用 <code>partialMock</code> 方法。未被模擬的方法在被呼叫時會正常執行：</p>
<pre><code class="language-php">use App\Service;
use Mockery\MockInterface;

$mock = $this-&gt;partialMock(Service::class, function (MockInterface $mock) {
    $mock-&gt;expects(&#x27;process&#x27;);
});
</code></pre>
<p>同樣地，如果你想要<a href="http://docs.mockery.io/en/latest/reference/spies.html">監視</a>一個物件，Laravel 的基礎測試案例類別提供了一個 <code>spy</code> 方法作為 <code>Mockery::spy</code> 方法的便利包裝器。Spies 類似於 mocks；然而，spies 會記錄 spy 與被測試程式碼之間的任何互動，讓你可以在程式碼執行後進行斷言：</p>
<pre><code class="language-php">use App\Service;

$spy = $this-&gt;spy(Service::class);

// ...

$spy-&gt;shouldHaveReceived(&#x27;process&#x27;);
</code></pre>
<a name="mocking-facades"></a>
<h2 id="mocking-facades"><a href="#mocking-facades">Mocking Facades</a></h2>
<p>與傳統的靜態方法調用不同，<a href="/docs/%7B%7Bversion%7D%7D/facades">facades</a>（包括<a href="/docs/%7B%7Bversion%7D%7D/facades#real-time-facades">即時 facades</a>）可以被模擬。這提供了相對於傳統靜態方法的巨大優勢，並賦予你與使用傳統依賴注入相同的可測試性。在測試時，你可能經常想要模擬在你的控制器中發生的 Laravel facade 調用。例如，考慮以下控制器動作：</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use Illuminate\Support\Facades\Cache;

class UserController extends Controller
{
    /**
     * Retrieve a list of all users of the application.
     */
    public function index(): array
    {
        $value = Cache::get(&#x27;key&#x27;);

        return [
            // ...
        ];
    }
}
</code></pre>
<p>我們可以使用 <code>expects</code> 方法來模擬對 <code>Cache</code> facade 的調用，這會回傳一個 <a href="https://github.com/padraic/mockery">Mockery</a> mock 的實例。由於 facades 實際上是由 Laravel <a href="/docs/%7B%7Bversion%7D%7D/container">service container</a> 解析和管理的，它們比典型的靜態類別具有更高的可測試性。例如，讓我們模擬對 <code>Cache</code> facade 的 <code>get</code> 方法的調用：</p>
<pre><code class="language-php">&lt;?php

use Illuminate\Support\Facades\Cache;

test(&#x27;get index&#x27;, function () {
    Cache::expects(&#x27;get&#x27;)
        -&gt;with(&#x27;key&#x27;)
        -&gt;andReturn(&#x27;value&#x27;);

    $response = $this-&gt;get(&#x27;/users&#x27;);

    // ...
});
</code></pre>
<pre><code class="language-php">&lt;?php

namespace Tests\Feature;

use Illuminate\Support\Facades\Cache;
use Tests\TestCase;

class UserControllerTest extends TestCase
{
    public function test_get_index(): void
    {
        Cache::expects(&#x27;get&#x27;)
            -&gt;with(&#x27;key&#x27;)
            -&gt;andReturn(&#x27;value&#x27;);

        $response = $this-&gt;get(&#x27;/users&#x27;);

        // ...
    }
}
</code></pre>
<blockquote>
<p>[!WARNING]
你不應該模擬 <code>Request</code> facade。相反地，在執行測試時，將你想要的輸入傳遞給 <a href="/docs/%7B%7Bversion%7D%7D/http-tests">HTTP 測試方法</a>，如 <code>get</code> 和 <code>post</code>。同樣地，與其模擬 <code>Config</code> facade，不如在測試中調用 <code>Config::set</code> 方法。</p>
</blockquote>
<a name="facade-spies"></a>
<h3 id="facade-spies"><a href="#facade-spies">Facade Spies</a></h3>
<p>如果你想要<a href="http://docs.mockery.io/en/latest/reference/spies.html">監視</a>一個 facade，你可以在對應的 facade 上調用 <code>spy</code> 方法。Spies 類似於 mocks；然而，spies 會記錄 spy 與被測試程式碼之間的任何互動，讓你可以在程式碼執行後進行斷言：</p>
<pre><code class="language-php">&lt;?php

use Illuminate\Support\Facades\Cache;

test(&#x27;values are stored in cache&#x27;, function () {
    Cache::spy();

    $response = $this-&gt;get(&#x27;/&#x27;);

    $response-&gt;assertStatus(200);

    Cache::shouldHaveReceived(&#x27;put&#x27;)-&gt;with(&#x27;name&#x27;, &#x27;Taylor&#x27;, 10);
});
</code></pre>
<pre><code class="language-php">use Illuminate\Support\Facades\Cache;

public function test_values_are_stored_in_cache(): void
{
    Cache::spy();

    $response = $this-&gt;get(&#x27;/&#x27;);

    $response-&gt;assertStatus(200);

    Cache::shouldHaveReceived(&#x27;put&#x27;)-&gt;with(&#x27;name&#x27;, &#x27;Taylor&#x27;, 10);
}
</code></pre>
<a name="interacting-with-time"></a>
<h2 id="與時間互動"><a href="#與時間互動">與時間互動</a></h2>
<p>在測試時，你可能偶爾需要修改像 <code>now</code> 或 <code>Illuminate\Support\Carbon::now()</code> 這類輔助函式回傳的時間。幸運的是，Laravel 的基礎功能測試類別包含了讓你能夠操作當前時間的輔助方法：</p>
<pre><code class="language-php">test(&#x27;time can be manipulated&#x27;, function () {
    // Travel into the future...
    $this-&gt;travel(5)-&gt;milliseconds();
    $this-&gt;travel(5)-&gt;seconds();
    $this-&gt;travel(5)-&gt;minutes();
    $this-&gt;travel(5)-&gt;hours();
    $this-&gt;travel(5)-&gt;days();
    $this-&gt;travel(5)-&gt;weeks();
    $this-&gt;travel(5)-&gt;years();

    // Travel into the past...
    $this-&gt;travel(-5)-&gt;hours();

    // Travel to an explicit time...
    $this-&gt;travelTo(now()-&gt;subHours(6));

    // Return back to the present time...
    $this-&gt;travelBack();
});
</code></pre>
<pre><code class="language-php">public function test_time_can_be_manipulated(): void
{
    // Travel into the future...
    $this-&gt;travel(5)-&gt;milliseconds();
    $this-&gt;travel(5)-&gt;seconds();
    $this-&gt;travel(5)-&gt;minutes();
    $this-&gt;travel(5)-&gt;hours();
    $this-&gt;travel(5)-&gt;days();
    $this-&gt;travel(5)-&gt;weeks();
    $this-&gt;travel(5)-&gt;years();

    // Travel into the past...
    $this-&gt;travel(-5)-&gt;hours();

    // Travel to an explicit time...
    $this-&gt;travelTo(now()-&gt;subHours(6));

    // Return back to the present time...
    $this-&gt;travelBack();
}
</code></pre>
<p>你也可以提供一個閉包給各種時間穿梭方法。閉包將在時間凍結於指定時間時被調用。一旦閉包執行完成，時間將恢復正常：</p>
<pre><code class="language-php">$this-&gt;travel(5)-&gt;days(function () {
    // Test something five days into the future...
});

$this-&gt;travelTo(now()-&gt;subDays(10), function () {
    // Test something during a given moment...
});
</code></pre>
<p><code>freezeTime</code> 方法可用於凍結當前時間。同樣地，<code>freezeSecond</code> 方法會凍結當前時間，但是是在當前秒的開始：</p>
<pre><code class="language-php">use Illuminate\Support\Carbon;

// Freeze time and resume normal time after executing closure...
$this-&gt;freezeTime(function (Carbon $time) {
    // ...
});

// Freeze time at the current second and resume normal time after executing closure...
$this-&gt;freezeSecond(function (Carbon $time) {
    // ...
})
</code></pre>
<p>如你所料，上面討論的所有方法主要用於測試對時間敏感的應用程式行為，例如鎖定討論論壇上的非活躍貼文：</p>
<pre><code class="language-php">use App\Models\Thread;

test(&#x27;forum threads lock after one week of inactivity&#x27;, function () {
    $thread = Thread::factory()-&gt;create();

    $this-&gt;travel(1)-&gt;week();

    expect($thread-&gt;isLockedByInactivity())-&gt;toBeTrue();
});
</code></pre>
<pre><code class="language-php">use App\Models\Thread;

public function test_forum_threads_lock_after_one_week_of_inactivity()
{
    $thread = Thread::factory()-&gt;create();

    $this-&gt;travel(1)-&gt;week();

    $this-&gt;assertTrue($thread-&gt;isLockedByInactivity());
}
</code></pre></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/2b257daea29fbb42.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/bc6e94e20a39014e.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"0lISzds8vnU9N34ubzJcA\",\"c\":[\"\",\"docs\",\"mocking\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"mocking\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/bc6e94e20a39014e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/2b257daea29fbb42.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"$undefined\"}],\"$undefined\"]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"mocking\",\"children\":[\"$\",\"a\",null,{\"href\":\"#mocking\",\"children\":\"Mocking\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#introduction\",\"children\":\"介紹\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#mocking-objects\",\"children\":\"Mocking 物件\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#mocking-facades\",\"children\":\"Mocking Facades\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#facade-spies\",\"children\":\"Facade Spies\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#interacting-with-time\",\"children\":\"與時間互動\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"introduction\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"介紹\",\"children\":[\"$\",\"a\",null,{\"href\":\"#介紹\",\"children\":\"介紹\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"在測試 Laravel 應用程式時，你可能希望「模擬」應用程式的某些部分，以便它們在特定測試期間不會真正被執行。例如，在測試一個會派發事件的控制器時，你可能希望模擬事件監聽器，這樣它們在測試期間就不會真正被執行。這讓你可以只測試控制器的 HTTP 回應，而不用擔心事件監聽器的執行，因為事件監聽器可以在它們自己的測試案例中進行測試。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Laravel 提供了開箱即用的實用方法來模擬事件、任務和其他 facades。這些輔助方法主要提供了一個 Mockery 的便利層，因此你不必手動進行複雜的 Mockery 方法調用。\"}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"mocking-objects\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"mocking-物件\",\"children\":[\"$\",\"a\",null,{\"href\":\"#mocking-物件\",\"children\":\"Mocking 物件\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"當模擬一個將透過 Laravel \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/container\",\"children\":\"service container\"}],\" 注入到你的應用程式的物件時，你需要將你模擬的實例作為 \",[\"$\",\"code\",null,{\"children\":\"instance\"}],\" 綁定到容器中。這會指示容器使用你模擬的物件實例，而不是自己建構該物件：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Service;\\nuse Mockery;\\nuse Mockery\\\\MockInterface;\\n\\ntest('something can be mocked', function () {\\n    $this-\u003einstance(\\n        Service::class,\\n        Mockery::mock(Service::class, function (MockInterface $mock) {\\n            $mock-\u003eexpects('process');\\n        })\\n    );\\n});\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Service;\\nuse Mockery;\\nuse Mockery\\\\MockInterface;\\n\\npublic function test_something_can_be_mocked(): void\\n{\\n    $this-\u003einstance(\\n        Service::class,\\n        Mockery::mock(Service::class, function (MockInterface $mock) {\\n            $mock-\u003eexpects('process');\\n        })\\n    );\\n}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"為了讓這更加方便，你可以使用 Laravel 基礎測試案例類別提供的 \",[\"$\",\"code\",null,{\"children\":\"mock\"}],\" 方法。例如，以下範例與上面的範例是等效的：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Service;\\nuse Mockery\\\\MockInterface;\\n\\n$mock = $this-\u003emock(Service::class, function (MockInterface $mock) {\\n    $mock-\u003eexpects('process');\\n});\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"當你只需要模擬物件的幾個方法時，你可以使用 \",[\"$\",\"code\",null,{\"children\":\"partialMock\"}],\" 方法。未被模擬的方法在被呼叫時會正常執行：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Service;\\nuse Mockery\\\\MockInterface;\\n\\n$mock = $this-\u003epartialMock(Service::class, function (MockInterface $mock) {\\n    $mock-\u003eexpects('process');\\n});\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"同樣地，如果你想要\",[\"$\",\"a\",null,{\"href\":\"http://docs.mockery.io/en/latest/reference/spies.html\",\"children\":\"監視\"}],\"一個物件，Laravel 的基礎測試案例類別提供了一個 \",[\"$\",\"code\",null,{\"children\":\"spy\"}],\" 方法作為 \",[\"$\",\"code\",null,{\"children\":\"Mockery::spy\"}],\" 方法的便利包裝器。Spies 類似於 mocks；然而，spies 會記錄 spy 與被測試程式碼之間的任何互動，讓你可以在程式碼執行後進行斷言：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Service;\\n\\n$spy = $this-\u003espy(Service::class);\\n\\n// ...\\n\\n$spy-\u003eshouldHaveReceived('process');\\n\"}]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"mocking-facades\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"mocking-facades\",\"children\":[\"$\",\"a\",null,{\"href\":\"#mocking-facades\",\"children\":\"Mocking Facades\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"與傳統的靜態方法調用不同，\",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/facades\",\"children\":\"facades\"}],\"（包括\",\"$Le\",\"）可以被模擬。這提供了相對於傳統靜態方法的巨大優勢，並賦予你與使用傳統依賴注入相同的可測試性。在測試時，你可能經常想要模擬在你的控制器中發生的 Laravel facade 調用。例如，考慮以下控制器動作：\"]}],\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/facades#real-time-facades\",\"children\":\"即時 facades\"}]\nf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Controllers;\\n\\nuse Illuminate\\\\Support\\\\Facades\\\\Cache;\\n\\nclass UserController extends Controller\\n{\\n    /**\\n     * Retrieve a list of all users of the application.\\n     */\\n    public function index(): array\\n    {\\n        $value = Cache::get('key');\\n\\n        return [\\n            // ...\\n        ];\\n    }\\n}\\n\"}]}]\n10:[\"$\",\"p\",null,{\"children\":[\"我們可以使用 \",[\"$\",\"code\",null,{\"children\":\"expects\"}],\" 方法來模擬對 \",[\"$\",\"code\",null,{\"children\":\"Cache\"}],\" facade 的調用，這會回傳一個 \",[\"$\",\"a\",null,{\"href\":\"https://github.com/padraic/mockery\",\"children\":\"Mockery\"}],\" mock 的實例。由於 facades 實際上是由 Laravel \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/container\",\"children\":\"service container\"}],\" 解析和管理的，它們比典型的靜態類別具有更高的可測試性。例如，讓我們模擬對 \",[\"$\",\"code\",null,{\"children\":\"Cache\"}],\" facade 的 \",[\"$\",\"code\",null,{\"children\":\"get\"}],\" 方法的調用：\"]}]\n11:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse Illuminate\\\\Support\\\\Facades\\\\Cache;\\n\\ntest('get index', function () {\\n    Cache::expects('get')\\n        -\u003ewith('key')\\n        -\u003eandReturn('value');\\n\\n    $response = $this-\u003eget('/users');\\n\\n    // ...\\n});\\n\"}]}]\n12:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace Tests\\\\Feature;\\n\\nuse Illuminate\\\\Support\\\\Facades\\\\Cache;\\nuse Tests\\\\TestCase;\\n\\nclass UserControllerTest extends TestCase\\n{\\n    public function test_get_index(): void\\n    {\\n        Cache::expects('get')\\n            -\u003ewith('key')\\n            -\u003eandReturn('value');\\n\\n        $response = $this-\u003eget('/users');\\n\\n        // ...\\n    }\\n}\\n\"}]}]\n13:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\n你不應該模擬 \",[\"$\",\"code\",null,{\"children\":\"Request\"}],\" facade。相反地，在執行測試時，將你想要的輸入傳遞給 \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B%7Bversion%7D%7D/http-tests\",\"children\":\"HTTP 測試方法\"}],\"，如 \",[\"$\",\"code\",null,{\"children\":\"get\"}],\" 和 \",[\"$\",\"code\",null,{\"children\":\"post\"}],\"。同樣地，與其模擬 \",[\"$\",\"code\",null,{\"children\":\"Config\"}],\" facade，不如在測試中調用 \",[\"$\",\"code\",null,{\"children\":\"Config::set\"}],\" 方法。\"]}],\"\\n\"]}]\n14:[\"$\",\"a\",null,{\"name\":\"facade-spies\"}]\n15:[\"$\",\"h3\",null,{\"id\":\"facade-spies\",\"children\":[\"$\",\"a\",null,{\"href\":\"#facade-spies\",\"children\":\"Facade Spies\"}]}]\n16:[\"$\",\"p\",null,{\"children\":[\"如果你想要\",[\"$\",\"a\",null,{\"href\":\"http://docs.mockery.io/en/latest/reference/spies.html\",\"children\":\"監視\"}],\"一個 facade，你可以在對應的 facade 上調用 \",[\"$\",\"code\",null,{\"children\":\"spy\"}],\" 方法。Spies 類似於 mocks；然而，spies 會記錄 spy 與被測試程式碼之間的任何互動，讓你可以在程式碼執行後進行斷言：\"]}]\n17:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse Illuminate\\\\Support\\\\Facades\\\\Cache;\\n\\ntest('values are stored in cache', function () {\\n    Cache::spy();\\n\\n    $response = $this-\u003eget('/');\\n\\n    $response-\u003eassertStatus(200);\\n\\n    Cache::shouldHaveReceived('put')-\u003ewith('name', 'Taylor', 10);\\n});\\n\"}]}]\n18:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Facades\\\\Cache;\\n\\npublic function test_values_are_stored_in_cache(): void\\n{\\n    Cache::spy();\\n\\n    $response = $this-\u003eget('/');\\n\\n    $response-\u003eassertStatus(200);\\n\\n    Cache::shouldHaveReceived('put')-\u003ewith('name', 'Taylor', 10);\\n}\\n\"}]}]\n19:[\"$\",\"a\",null,{\"name\":\"interacting-with-time\"}]\n1a:[\"$\",\"h2\",null,{\"id\":\"與時間互動\",\"children\":[\"$\",\"a\",null,{\"href\":\"#與時間互動\",\"children\":\"與時間互動\"}]}]\n1b:[\"$\",\"p\",null,{\"children\":[\"在測試時"])</script><script>self.__next_f.push([1,"，你可能偶爾需要修改像 \",[\"$\",\"code\",null,{\"children\":\"now\"}],\" 或 \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Support\\\\Carbon::now()\"}],\" 這類輔助函式回傳的時間。幸運的是，Laravel 的基礎功能測試類別包含了讓你能夠操作當前時間的輔助方法：\"]}]\n1c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"test('time can be manipulated', function () {\\n    // Travel into the future...\\n    $this-\u003etravel(5)-\u003emilliseconds();\\n    $this-\u003etravel(5)-\u003eseconds();\\n    $this-\u003etravel(5)-\u003eminutes();\\n    $this-\u003etravel(5)-\u003ehours();\\n    $this-\u003etravel(5)-\u003edays();\\n    $this-\u003etravel(5)-\u003eweeks();\\n    $this-\u003etravel(5)-\u003eyears();\\n\\n    // Travel into the past...\\n    $this-\u003etravel(-5)-\u003ehours();\\n\\n    // Travel to an explicit time...\\n    $this-\u003etravelTo(now()-\u003esubHours(6));\\n\\n    // Return back to the present time...\\n    $this-\u003etravelBack();\\n});\\n\"}]}]\n1d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"public function test_time_can_be_manipulated(): void\\n{\\n    // Travel into the future...\\n    $this-\u003etravel(5)-\u003emilliseconds();\\n    $this-\u003etravel(5)-\u003eseconds();\\n    $this-\u003etravel(5)-\u003eminutes();\\n    $this-\u003etravel(5)-\u003ehours();\\n    $this-\u003etravel(5)-\u003edays();\\n    $this-\u003etravel(5)-\u003eweeks();\\n    $this-\u003etravel(5)-\u003eyears();\\n\\n    // Travel into the past...\\n    $this-\u003etravel(-5)-\u003ehours();\\n\\n    // Travel to an explicit time...\\n    $this-\u003etravelTo(now()-\u003esubHours(6));\\n\\n    // Return back to the present time...\\n    $this-\u003etravelBack();\\n}\\n\"}]}]\n1e:[\"$\",\"p\",null,{\"children\":\"你也可以提供一個閉包給各種時間穿梭方法。閉包將在時間凍結於指定時間時被調用。一旦閉包執行完成，時間將恢復正常：\"}]\n1f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$this-\u003etravel(5)-\u003edays(function () {\\n    // Test something five days into the future...\\n});\\n\\n$this-\u003etravelTo(now()-\u003esubDays(10), function () {\\n    // Test something during a given moment...\\n});\\n\"}]}]\n20:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"freezeTime\"}],\" 方法可用於凍結當前時間。同樣地，\",[\"$\",\"code\",null,{\"children\":\"freezeSecond\"}],\" 方法會凍結當前時間，但是是在當前秒的開始：\"]}]\n21:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Support\\\\Carbon;\\n\\n// Freeze time and resume normal time after executing closure...\\n$this-\u003efreezeTime(function (Carbon $time) {\\n    // ...\\n});\\n\\n// Freeze time at the current second and resume normal time after executing closure...\\n$this-\u003efreezeSecond(function (Carbon $time) {\\n    // ...\\n})\\n\"}]}]\n22:[\"$\",\"p\",null,{\"children\":\"如你所料，上面討論的所有方法主要用於測試對時間敏感的應用程式行為，例如鎖定討論論壇上的非活躍貼文：\"}]\n23:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Thread;\\n\\ntest('forum threads lock after one week of inactivity', function () {\\n    $thread = Thread::factory()-\u003ecreate();\\n\\n    $this-\u003etravel(1)-\u003eweek();\\n\\n    expect($thread-\u003eisLockedByInactivity())-\u003etoBeTrue();\\n});\\n\"}]}]\n24:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Thread;\\n\\npublic function test_forum_threads_lock_after_one_week_of_inactivity()\\n{\\n    $thread = Thread::factory()-\u003ecreate();\\n\\n    $this-\u003etravel(1)-\u003eweek();\\n\\n    $this-\u003eassertTrue($thread-\u003eisLockedByInactivity());\\n}\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"25:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L25\",\"3\",{}]]\n8:null\n"])</script></body></html>