<!DOCTYPE html><!--oT9fkv1Rls7posDurDqoH--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/ce232d23a2a15dcf.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/2b257daea29fbb42.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs（中文）</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a><a class="block" href="/docs/frontend"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">前端</button></a><a class="block" href="/docs/starter-kits"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">啟動套件</button></a><a class="block" href="/docs/deployment"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">部署</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Eloquent Relationships</h1><p class="text-xl text-muted-foreground mt-2">Eloquent 關聯讓你輕鬆定義 model 之間的關聯</p></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="eloquent-relationships"><a href="#eloquent-relationships">Eloquent: Relationships</a></h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#defining-relationships">Defining Relationships</a>
<ul>
<li><a href="#one-to-one">One to One / Has One</a></li>
<li><a href="#one-to-many">One to Many / Has Many</a></li>
<li><a href="#one-to-many-inverse">One to Many (Inverse) / Belongs To</a></li>
<li><a href="#has-one-of-many">Has One of Many</a></li>
<li><a href="#has-one-through">Has One Through</a></li>
<li><a href="#has-many-through">Has Many Through</a></li>
</ul>
</li>
<li><a href="#scoped-relationships">Scoped Relationships</a></li>
<li><a href="#many-to-many">Many to Many Relationships</a>
<ul>
<li><a href="#retrieving-intermediate-table-columns">Retrieving Intermediate Table Columns</a></li>
<li><a href="#filtering-queries-via-intermediate-table-columns">Filtering Queries via Intermediate Table Columns</a></li>
<li><a href="#ordering-queries-via-intermediate-table-columns">Ordering Queries via Intermediate Table Columns</a></li>
<li><a href="#defining-custom-intermediate-table-models">Defining Custom Intermediate Table Models</a></li>
</ul>
</li>
<li><a href="#polymorphic-relationships">Polymorphic Relationships</a>
<ul>
<li><a href="#one-to-one-polymorphic-relations">One to One</a></li>
<li><a href="#one-to-many-polymorphic-relations">One to Many</a></li>
<li><a href="#one-of-many-polymorphic-relations">One of Many</a></li>
<li><a href="#many-to-many-polymorphic-relations">Many to Many</a></li>
<li><a href="#custom-polymorphic-types">Custom Polymorphic Types</a></li>
</ul>
</li>
<li><a href="#dynamic-relationships">Dynamic Relationships</a></li>
<li><a href="#querying-relations">Querying Relations</a>
<ul>
<li><a href="#relationship-methods-vs-dynamic-properties">Relationship Methods vs. Dynamic Properties</a></li>
<li><a href="#querying-relationship-existence">Querying Relationship Existence</a></li>
<li><a href="#querying-relationship-absence">Querying Relationship Absence</a></li>
<li><a href="#querying-morph-to-relationships">Querying Morph To Relationships</a></li>
</ul>
</li>
<li><a href="#aggregating-related-models">Aggregating Related Models</a>
<ul>
<li><a href="#counting-related-models">Counting Related Models</a></li>
<li><a href="#other-aggregate-functions">Other Aggregate Functions</a></li>
<li><a href="#counting-related-models-on-morph-to-relationships">Counting Related Models on Morph To Relationships</a></li>
</ul>
</li>
<li><a href="#eager-loading">Eager Loading</a>
<ul>
<li><a href="#constraining-eager-loads">Constraining Eager Loads</a></li>
<li><a href="#lazy-eager-loading">Lazy Eager Loading</a></li>
<li><a href="#automatic-eager-loading">Automatic Eager Loading</a></li>
<li><a href="#preventing-lazy-loading">Preventing Lazy Loading</a></li>
</ul>
</li>
<li><a href="#inserting-and-updating-related-models">Inserting and Updating Related Models</a>
<ul>
<li><a href="#the-save-method">The <code>save</code> Method</a></li>
<li><a href="#the-create-method">The <code>create</code> Method</a></li>
<li><a href="#updating-belongs-to-relationships">Belongs To Relationships</a></li>
<li><a href="#updating-many-to-many-relationships">Many to Many Relationships</a></li>
</ul>
</li>
<li><a href="#touching-parent-timestamps">Touching Parent Timestamps</a></li>
</ul>
<a name="introduction"></a>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p>Database tables are often related to one another. For example, a blog post may have many comments or an order could be related to the user who placed it. Eloquent makes managing and working with these relationships easy, and supports a variety of common relationships:</p>
<div class="content-list" markdown="1"><ul>
<li><a href="#one-to-one">One To One</a></li>
<li><a href="#one-to-many">One To Many</a></li>
<li><a href="#many-to-many">Many To Many</a></li>
<li><a href="#has-one-through">Has One Through</a></li>
<li><a href="#has-many-through">Has Many Through</a></li>
<li><a href="#one-to-one-polymorphic-relations">One To One (Polymorphic)</a></li>
<li><a href="#one-to-many-polymorphic-relations">One To Many (Polymorphic)</a></li>
<li><a href="#many-to-many-polymorphic-relations">Many To Many (Polymorphic)</a></li>
</ul></div>
<a name="defining-relationships"></a>
<h2 id="defining-relationships"><a href="#defining-relationships">Defining Relationships</a></h2>
<p>Eloquent relationships are defined as methods on your Eloquent model classes. Since relationships also serve as powerful <a href="/docs/queries">query builders</a>, defining relationships as methods provides powerful method chaining and querying capabilities. For example, we may chain additional query constraints on this <code>posts</code> relationship:</p>
<pre><code class="language-php">$user-&gt;posts()-&gt;where(&#x27;active&#x27;, 1)-&gt;get();
</code></pre>
<p>But, before diving too deep into using relationships, let&#x27;s learn how to define each type of relationship supported by Eloquent.</p>
<a name="one-to-one"></a>
<h3 id="one-to-one--has-one"><a href="#one-to-one--has-one">One to One / Has One</a></h3>
<p>A one-to-one relationship is a very basic type of database relationship. For example, a <code>User</code> model might be associated with one <code>Phone</code> model. To define this relationship, we will place a <code>phone</code> method on the <code>User</code> model. The <code>phone</code> method should call the <code>hasOne</code> method and return its result. The <code>hasOne</code> method is available to your model via the model&#x27;s <code>Illuminate\Database\Eloquent\Model</code> base class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasOne;

class User extends Model
{
    /**
     * Get the phone associated with the user.
     */
    public function phone(): HasOne
    {
        return $this-&gt;hasOne(Phone::class);
    }
}
</code></pre>
<p>The first argument passed to the <code>hasOne</code> method is the name of the related model class. Once the relationship is defined, we may retrieve the related record using Eloquent&#x27;s dynamic properties. Dynamic properties allow you to access relationship methods as if they were properties defined on the model:</p>
<pre><code class="language-php">$phone = User::find(1)-&gt;phone;
</code></pre>
<p>Eloquent determines the foreign key of the relationship based on the parent model name. In this case, the <code>Phone</code> model is automatically assumed to have a <code>user_id</code> foreign key. If you wish to override this convention, you may pass a second argument to the <code>hasOne</code> method:</p>
<pre><code class="language-php">return $this-&gt;hasOne(Phone::class, &#x27;foreign_key&#x27;);
</code></pre>
<p>Additionally, Eloquent assumes that the foreign key should have a value matching the primary key column of the parent. In other words, Eloquent will look for the value of the user&#x27;s <code>id</code> column in the <code>user_id</code> column of the <code>Phone</code> record. If you would like the relationship to use a primary key value other than <code>id</code> or your model&#x27;s <code>$primaryKey</code> property, you may pass a third argument to the <code>hasOne</code> method:</p>
<pre><code class="language-php">return $this-&gt;hasOne(Phone::class, &#x27;foreign_key&#x27;, &#x27;local_key&#x27;);
</code></pre>
<a name="one-to-one-defining-the-inverse-of-the-relationship"></a>
<h4 id="defining-the-inverse-of-the-relationship"><a href="#defining-the-inverse-of-the-relationship">Defining the Inverse of the Relationship</a></h4>
<p>So, we can access the <code>Phone</code> model from our <code>User</code> model. Next, let&#x27;s define a relationship on the <code>Phone</code> model that will let us access the user that owns the phone. We can define the inverse of a <code>hasOne</code> relationship using the <code>belongsTo</code> method:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Phone extends Model
{
    /**
     * Get the user that owns the phone.
     */
    public function user(): BelongsTo
    {
        return $this-&gt;belongsTo(User::class);
    }
}
</code></pre>
<p>When invoking the <code>user</code> method, Eloquent will attempt to find a <code>User</code> model that has an <code>id</code> which matches the <code>user_id</code> column on the <code>Phone</code> model.</p>
<p>Eloquent determines the foreign key name by examining the name of the relationship method and suffixing the method name with <code>_id</code>. So, in this case, Eloquent assumes that the <code>Phone</code> model has a <code>user_id</code> column. However, if the foreign key on the <code>Phone</code> model is not <code>user_id</code>, you may pass a custom key name as the second argument to the <code>belongsTo</code> method:</p>
<pre><code class="language-php">/**
 * Get the user that owns the phone.
 */
public function user(): BelongsTo
{
    return $this-&gt;belongsTo(User::class, &#x27;foreign_key&#x27;);
}
</code></pre>
<p>If the parent model does not use <code>id</code> as its primary key, or you wish to find the associated model using a different column, you may pass a third argument to the <code>belongsTo</code> method specifying the parent table&#x27;s custom key:</p>
<pre><code class="language-php">/**
 * Get the user that owns the phone.
 */
public function user(): BelongsTo
{
    return $this-&gt;belongsTo(User::class, &#x27;foreign_key&#x27;, &#x27;owner_key&#x27;);
}
</code></pre>
<a name="one-to-many"></a>
<h3 id="one-to-many--has-many"><a href="#one-to-many--has-many">One to Many / Has Many</a></h3>
<p>A one-to-many relationship is used to define relationships where a single model is the parent to one or more child models. For example, a blog post may have an infinite number of comments. Like all other Eloquent relationships, one-to-many relationships are defined by defining a method on your Eloquent model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class Post extends Model
{
    /**
     * Get the comments for the blog post.
     */
    public function comments(): HasMany
    {
        return $this-&gt;hasMany(Comment::class);
    }
}
</code></pre>
<p>Remember, Eloquent will automatically determine the proper foreign key column for the <code>Comment</code> model. By convention, Eloquent will take the &quot;snake case&quot; name of the parent model and suffix it with <code>_id</code>. So, in this example, Eloquent will assume the foreign key column on the <code>Comment</code> model is <code>post_id</code>.</p>
<p>Once the relationship method has been defined, we can access the <a href="/docs/eloquent-collections">collection</a> of related comments by accessing the <code>comments</code> property. Remember, since Eloquent provides &quot;dynamic relationship properties&quot;, we can access relationship methods as if they were defined as properties on the model:</p>
<pre><code class="language-php">use App\Models\Post;

$comments = Post::find(1)-&gt;comments;

foreach ($comments as $comment) {
    // ...
}
</code></pre>
<p>Since all relationships also serve as query builders, you may add further constraints to the relationship query by calling the <code>comments</code> method and continuing to chain conditions onto the query:</p>
<pre><code class="language-php">$comment = Post::find(1)-&gt;comments()
    -&gt;where(&#x27;title&#x27;, &#x27;foo&#x27;)
    -&gt;first();
</code></pre>
<p>Like the <code>hasOne</code> method, you may also override the foreign and local keys by passing additional arguments to the <code>hasMany</code> method:</p>
<pre><code class="language-php">return $this-&gt;hasMany(Comment::class, &#x27;foreign_key&#x27;);

return $this-&gt;hasMany(Comment::class, &#x27;foreign_key&#x27;, &#x27;local_key&#x27;);
</code></pre>
<a name="automatically-hydrating-parent-models-on-children"></a>
<h4 id="automatically-hydrating-parent-models-on-children"><a href="#automatically-hydrating-parent-models-on-children">Automatically Hydrating Parent Models on Children</a></h4>
<p>Even when utilizing Eloquent eager loading, &quot;N + 1&quot; query problems can arise if you try to access the parent model from a child model while looping through the child models:</p>
<pre><code class="language-php">$posts = Post::with(&#x27;comments&#x27;)-&gt;get();

foreach ($posts as $post) {
    foreach ($post-&gt;comments as $comment) {
        echo $comment-&gt;post-&gt;title;
    }
}
</code></pre>
<p>In the example above, an &quot;N + 1&quot; query problem has been introduced because, even though comments were eager loaded for every <code>Post</code> model, Eloquent does not automatically hydrate the parent <code>Post</code> on each child <code>Comment</code> model.</p>
<p>If you would like Eloquent to automatically hydrate parent models onto their children, you may invoke the <code>chaperone</code> method when defining a <code>hasMany</code> relationship:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class Post extends Model
{
    /**
     * Get the comments for the blog post.
     */
    public function comments(): HasMany
    {
        return $this-&gt;hasMany(Comment::class)-&gt;chaperone();
    }
}
</code></pre>
<p>Or, if you would like to opt-in to automatic parent hydration at run time, you may invoke the <code>chaperone</code> model when eager loading the relationship:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::with([
    &#x27;comments&#x27; =&gt; fn ($comments) =&gt; $comments-&gt;chaperone(),
])-&gt;get();
</code></pre>
<a name="one-to-many-inverse"></a>
<h3 id="one-to-many-inverse--belongs-to"><a href="#one-to-many-inverse--belongs-to">One to Many (Inverse) / Belongs To</a></h3>
<p>Now that we can access all of a post&#x27;s comments, let&#x27;s define a relationship to allow a comment to access its parent post. To define the inverse of a <code>hasMany</code> relationship, define a relationship method on the child model which calls the <code>belongsTo</code> method:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Comment extends Model
{
    /**
     * Get the post that owns the comment.
     */
    public function post(): BelongsTo
    {
        return $this-&gt;belongsTo(Post::class);
    }
}
</code></pre>
<p>Once the relationship has been defined, we can retrieve a comment&#x27;s parent post by accessing the <code>post</code> &quot;dynamic relationship property&quot;:</p>
<pre><code class="language-php">use App\Models\Comment;

$comment = Comment::find(1);

return $comment-&gt;post-&gt;title;
</code></pre>
<p>In the example above, Eloquent will attempt to find a <code>Post</code> model that has an <code>id</code> which matches the <code>post_id</code> column on the <code>Comment</code> model.</p>
<p>Eloquent determines the default foreign key name by examining the name of the relationship method and suffixing the method name with a <code>_</code> followed by the name of the parent model&#x27;s primary key column. So, in this example, Eloquent will assume the <code>Post</code> model&#x27;s foreign key on the <code>comments</code> table is <code>post_id</code>.</p>
<p>However, if the foreign key for your relationship does not follow these conventions, you may pass a custom foreign key name as the second argument to the <code>belongsTo</code> method:</p>
<pre><code class="language-php">/**
 * Get the post that owns the comment.
 */
public function post(): BelongsTo
{
    return $this-&gt;belongsTo(Post::class, &#x27;foreign_key&#x27;);
}
</code></pre>
<p>If your parent model does not use <code>id</code> as its primary key, or you wish to find the associated model using a different column, you may pass a third argument to the <code>belongsTo</code> method specifying your parent table&#x27;s custom key:</p>
<pre><code class="language-php">/**
 * Get the post that owns the comment.
 */
public function post(): BelongsTo
{
    return $this-&gt;belongsTo(Post::class, &#x27;foreign_key&#x27;, &#x27;owner_key&#x27;);
}
</code></pre>
<a name="default-models"></a>
<h4 id="default-models"><a href="#default-models">Default Models</a></h4>
<p>The <code>belongsTo</code>, <code>hasOne</code>, <code>hasOneThrough</code>, and <code>morphOne</code> relationships allow you to define a default model that will be returned if the given relationship is <code>null</code>. This pattern is often referred to as the <a href="https://en.wikipedia.org/wiki/Null_Object_pattern">Null Object pattern</a> and can help remove conditional checks in your code. In the following example, the <code>user</code> relation will return an empty <code>App\Models\User</code> model if no user is attached to the <code>Post</code> model:</p>
<pre><code class="language-php">/**
 * Get the author of the post.
 */
public function user(): BelongsTo
{
    return $this-&gt;belongsTo(User::class)-&gt;withDefault();
}
</code></pre>
<p>To populate the default model with attributes, you may pass an array or closure to the <code>withDefault</code> method:</p>
<pre><code class="language-php">/**
 * Get the author of the post.
 */
public function user(): BelongsTo
{
    return $this-&gt;belongsTo(User::class)-&gt;withDefault([
        &#x27;name&#x27; =&gt; &#x27;Guest Author&#x27;,
    ]);
}

/**
 * Get the author of the post.
 */
public function user(): BelongsTo
{
    return $this-&gt;belongsTo(User::class)-&gt;withDefault(function (User $user, Post $post) {
        $user-&gt;name = &#x27;Guest Author&#x27;;
    });
}
</code></pre>
<a name="querying-belongs-to-relationships"></a>
<h4 id="querying-belongs-to-relationships"><a href="#querying-belongs-to-relationships">Querying Belongs To Relationships</a></h4>
<p>When querying for the children of a &quot;belongs to&quot; relationship, you may manually build the <code>where</code> clause to retrieve the corresponding Eloquent models:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::where(&#x27;user_id&#x27;, $user-&gt;id)-&gt;get();
</code></pre>
<p>However, you may find it more convenient to use the <code>whereBelongsTo</code> method, which will automatically determine the proper relationship and foreign key for the given model:</p>
<pre><code class="language-php">$posts = Post::whereBelongsTo($user)-&gt;get();
</code></pre>
<p>You may also provide a <a href="/docs/eloquent-collections">collection</a> instance to the <code>whereBelongsTo</code> method. When doing so, Laravel will retrieve models that belong to any of the parent models within the collection:</p>
<pre><code class="language-php">$users = User::where(&#x27;vip&#x27;, true)-&gt;get();

$posts = Post::whereBelongsTo($users)-&gt;get();
</code></pre>
<p>By default, Laravel will determine the relationship associated with the given model based on the class name of the model; however, you may specify the relationship name manually by providing it as the second argument to the <code>whereBelongsTo</code> method:</p>
<pre><code class="language-php">$posts = Post::whereBelongsTo($user, &#x27;author&#x27;)-&gt;get();
</code></pre>
<a name="has-one-of-many"></a>
<h3 id="has-one-of-many"><a href="#has-one-of-many">Has One of Many</a></h3>
<p>Sometimes a model may have many related models, yet you want to easily retrieve the &quot;latest&quot; or &quot;oldest&quot; related model of the relationship. For example, a <code>User</code> model may be related to many <code>Order</code> models, but you want to define a convenient way to interact with the most recent order the user has placed. You may accomplish this using the <code>hasOne</code> relationship type combined with the <code>ofMany</code> methods:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s most recent order.
 */
public function latestOrder(): HasOne
{
    return $this-&gt;hasOne(Order::class)-&gt;latestOfMany();
}
</code></pre>
<p>Likewise, you may define a method to retrieve the &quot;oldest&quot;, or first, related model of a relationship:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s oldest order.
 */
public function oldestOrder(): HasOne
{
    return $this-&gt;hasOne(Order::class)-&gt;oldestOfMany();
}
</code></pre>
<p>By default, the <code>latestOfMany</code> and <code>oldestOfMany</code> methods will retrieve the latest or oldest related model based on the model&#x27;s primary key, which must be sortable. However, sometimes you may wish to retrieve a single model from a larger relationship using a different sorting criteria.</p>
<p>For example, using the <code>ofMany</code> method, you may retrieve the user&#x27;s most expensive order. The <code>ofMany</code> method accepts the sortable column as its first argument and which aggregate function (<code>min</code> or <code>max</code>) to apply when querying for the related model:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s largest order.
 */
public function largestOrder(): HasOne
{
    return $this-&gt;hasOne(Order::class)-&gt;ofMany(&#x27;price&#x27;, &#x27;max&#x27;);
}
</code></pre>
<blockquote>
<p>[!WARNING]
Because PostgreSQL does not support executing the <code>MAX</code> function against UUID columns, it is not currently possible to use one-of-many relationships in combination with PostgreSQL UUID columns.</p>
</blockquote>
<a name="converting-many-relationships-to-has-one-relationships"></a>
<h4 id="converting-many-relationships-to-has-one-relationships"><a href="#converting-many-relationships-to-has-one-relationships">Converting &quot;Many&quot; Relationships to Has One Relationships</a></h4>
<p>Often, when retrieving a single model using the <code>latestOfMany</code>, <code>oldestOfMany</code>, or <code>ofMany</code> methods, you already have a &quot;has many&quot; relationship defined for the same model. For convenience, Laravel allows you to easily convert this relationship into a &quot;has one&quot; relationship by invoking the <code>one</code> method on the relationship:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s orders.
 */
public function orders(): HasMany
{
    return $this-&gt;hasMany(Order::class);
}

/**
 * Get the user&#x27;s largest order.
 */
public function largestOrder(): HasOne
{
    return $this-&gt;orders()-&gt;one()-&gt;ofMany(&#x27;price&#x27;, &#x27;max&#x27;);
}
</code></pre>
<p>You may also use the <code>one</code> method to convert <code>HasManyThrough</code> relationships to <code>HasOneThrough</code> relationships:</p>
<pre><code class="language-php">public function latestDeployment(): HasOneThrough
{
    return $this-&gt;deployments()-&gt;one()-&gt;latestOfMany();
}
</code></pre>
<a name="advanced-has-one-of-many-relationships"></a>
<h4 id="advanced-has-one-of-many-relationships"><a href="#advanced-has-one-of-many-relationships">Advanced Has One of Many Relationships</a></h4>
<p>It is possible to construct more advanced &quot;has one of many&quot; relationships. For example, a <code>Product</code> model may have many associated <code>Price</code> models that are retained in the system even after new pricing is published. In addition, new pricing data for the product may be able to be published in advance to take effect at a future date via a <code>published_at</code> column.</p>
<p>So, in summary, we need to retrieve the latest published pricing where the published date is not in the future. In addition, if two prices have the same published date, we will prefer the price with the greatest ID. To accomplish this, we must pass an array to the <code>ofMany</code> method that contains the sortable columns which determine the latest price. In addition, a closure will be provided as the second argument to the <code>ofMany</code> method. This closure will be responsible for adding additional publish date constraints to the relationship query:</p>
<pre><code class="language-php">/**
 * Get the current pricing for the product.
 */
public function currentPricing(): HasOne
{
    return $this-&gt;hasOne(Price::class)-&gt;ofMany([
        &#x27;published_at&#x27; =&gt; &#x27;max&#x27;,
        &#x27;id&#x27; =&gt; &#x27;max&#x27;,
    ], function (Builder $query) {
        $query-&gt;where(&#x27;published_at&#x27;, &#x27;&lt;&#x27;, now());
    });
}
</code></pre>
<a name="has-one-through"></a>
<h3 id="has-one-through"><a href="#has-one-through">Has One Through</a></h3>
<p>The &quot;has-one-through&quot; relationship defines a one-to-one relationship with another model. However, this relationship indicates that the declaring model can be matched with one instance of another model by proceeding <em>through</em> a third model.</p>
<p>For example, in a vehicle repair shop application, each <code>Mechanic</code> model may be associated with one <code>Car</code> model, and each <code>Car</code> model may be associated with one <code>Owner</code> model. While the mechanic and the owner have no direct relationship within the database, the mechanic can access the owner <em>through</em> the <code>Car</code> model. Let&#x27;s look at the tables necessary to define this relationship:</p>
<pre><code class="language-text">mechanics
    id - integer
    name - string

cars
    id - integer
    model - string
    mechanic_id - integer

owners
    id - integer
    name - string
    car_id - integer
</code></pre>
<p>Now that we have examined the table structure for the relationship, let&#x27;s define the relationship on the <code>Mechanic</code> model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasOneThrough;

class Mechanic extends Model
{
    /**
     * Get the car&#x27;s owner.
     */
    public function carOwner(): HasOneThrough
    {
        return $this-&gt;hasOneThrough(Owner::class, Car::class);
    }
}
</code></pre>
<p>The first argument passed to the <code>hasOneThrough</code> method is the name of the final model we wish to access, while the second argument is the name of the intermediate model.</p>
<p>Or, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a &quot;has-one-through&quot; relationship by invoking the <code>through</code> method and supplying the names of those relationships. For example, if the <code>Mechanic</code> model has a <code>cars</code> relationship and the <code>Car</code> model has an <code>owner</code> relationship, you may define a &quot;has-one-through&quot; relationship connecting the mechanic and the owner like so:</p>
<pre><code class="language-php">// String based syntax...
return $this-&gt;through(&#x27;cars&#x27;)-&gt;has(&#x27;owner&#x27;);

// Dynamic syntax...
return $this-&gt;throughCars()-&gt;hasOwner();
</code></pre>
<a name="has-one-through-key-conventions"></a>
<h4 id="key-conventions"><a href="#key-conventions">Key Conventions</a></h4>
<p>Typical Eloquent foreign key conventions will be used when performing the relationship&#x27;s queries. If you would like to customize the keys of the relationship, you may pass them as the third and fourth arguments to the <code>hasOneThrough</code> method. The third argument is the name of the foreign key on the intermediate model. The fourth argument is the name of the foreign key on the final model. The fifth argument is the local key, while the sixth argument is the local key of the intermediate model:</p>
<pre><code class="language-php">class Mechanic extends Model
{
    /**
     * Get the car&#x27;s owner.
     */
    public function carOwner(): HasOneThrough
    {
        return $this-&gt;hasOneThrough(
            Owner::class,
            Car::class,
            &#x27;mechanic_id&#x27;, // Foreign key on the cars table...
            &#x27;car_id&#x27;, // Foreign key on the owners table...
            &#x27;id&#x27;, // Local key on the mechanics table...
            &#x27;id&#x27; // Local key on the cars table...
        );
    }
}
</code></pre>
<p>Or, as discussed earlier, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a &quot;has-one-through&quot; relationship by invoking the <code>through</code> method and supplying the names of those relationships. This approach offers the advantage of reusing the key conventions already defined on the existing relationships:</p>
<pre><code class="language-php">// String based syntax...
return $this-&gt;through(&#x27;cars&#x27;)-&gt;has(&#x27;owner&#x27;);

// Dynamic syntax...
return $this-&gt;throughCars()-&gt;hasOwner();
</code></pre>
<a name="has-many-through"></a>
<h3 id="has-many-through"><a href="#has-many-through">Has Many Through</a></h3>
<p>The &quot;has-many-through&quot; relationship provides a convenient way to access distant relations via an intermediate relation. For example, let&#x27;s assume we are building a deployment platform like <a href="https://cloud.laravel.com">Laravel Cloud</a>. An <code>Application</code> model might access many <code>Deployment</code> models through an intermediate <code>Environment</code> model. Using this example, you could easily gather all deployments for a given application. Let&#x27;s look at the tables required to define this relationship:</p>
<pre><code class="language-text">applications
    id - integer
    name - string

environments
    id - integer
    application_id - integer
    name - string

deployments
    id - integer
    environment_id - integer
    commit_hash - string
</code></pre>
<p>Now that we have examined the table structure for the relationship, let&#x27;s define the relationship on the <code>Application</code> model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasManyThrough;

class Application extends Model
{
    /**
     * Get all of the deployments for the application.
     */
    public function deployments(): HasManyThrough
    {
        return $this-&gt;hasManyThrough(Deployment::class, Environment::class);
    }
}
</code></pre>
<p>The first argument passed to the <code>hasManyThrough</code> method is the name of the final model we wish to access, while the second argument is the name of the intermediate model.</p>
<p>Or, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a &quot;has-many-through&quot; relationship by invoking the <code>through</code> method and supplying the names of those relationships. For example, if the <code>Application</code> model has a <code>environments</code> relationship and the <code>Environment</code> model has a <code>deployments</code> relationship, you may define a &quot;has-many-through&quot; relationship connecting the application and the deployments like so:</p>
<pre><code class="language-php">// String based syntax...
return $this-&gt;through(&#x27;environments&#x27;)-&gt;has(&#x27;deployments&#x27;);

// Dynamic syntax...
return $this-&gt;throughEnvironments()-&gt;hasDeployments();
</code></pre>
<p>Though the <code>Deployment</code> model&#x27;s table does not contain a <code>application_id</code> column, the <code>hasManyThrough</code> relation provides access to a application&#x27;s deployments via <code>$application-&gt;deployments</code>. To retrieve these models, Eloquent inspects the <code>application_id</code> column on the intermediate <code>Environment</code> model&#x27;s table. After finding the relevant environment IDs, they are used to query the <code>Deployment</code> model&#x27;s table.</p>
<a name="has-many-through-key-conventions"></a>
<h4 id="key-conventions-1"><a href="#key-conventions-1">Key Conventions</a></h4>
<p>Typical Eloquent foreign key conventions will be used when performing the relationship&#x27;s queries. If you would like to customize the keys of the relationship, you may pass them as the third and fourth arguments to the <code>hasManyThrough</code> method. The third argument is the name of the foreign key on the intermediate model. The fourth argument is the name of the foreign key on the final model. The fifth argument is the local key, while the sixth argument is the local key of the intermediate model:</p>
<pre><code class="language-php">class Application extends Model
{
    public function deployments(): HasManyThrough
    {
        return $this-&gt;hasManyThrough(
            Deployment::class,
            Environment::class,
            &#x27;application_id&#x27;, // Foreign key on the environments table...
            &#x27;environment_id&#x27;, // Foreign key on the deployments table...
            &#x27;id&#x27;, // Local key on the applications table...
            &#x27;id&#x27; // Local key on the environments table...
        );
    }
}
</code></pre>
<p>Or, as discussed earlier, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a &quot;has-many-through&quot; relationship by invoking the <code>through</code> method and supplying the names of those relationships. This approach offers the advantage of reusing the key conventions already defined on the existing relationships:</p>
<pre><code class="language-php">// String based syntax...
return $this-&gt;through(&#x27;environments&#x27;)-&gt;has(&#x27;deployments&#x27;);

// Dynamic syntax...
return $this-&gt;throughEnvironments()-&gt;hasDeployments();
</code></pre>
<a name="scoped-relationships"></a>
<h3 id="scoped-relationships"><a href="#scoped-relationships">Scoped Relationships</a></h3>
<p>It&#x27;s common to add additional methods to models that constrain relationships. For example, you might add a <code>featuredPosts</code> method to a <code>User</code> model which constrains the broader <code>posts</code> relationship with an additional <code>where</code> constraint:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class User extends Model
{
    /**
     * Get the user&#x27;s posts.
     */
    public function posts(): HasMany
    {
        return $this-&gt;hasMany(Post::class)-&gt;latest();
    }

    /**
     * Get the user&#x27;s featured posts.
     */
    public function featuredPosts(): HasMany
    {
        return $this-&gt;posts()-&gt;where(&#x27;featured&#x27;, true);
    }
}
</code></pre>
<p>However, if you attempt to create a model via the <code>featuredPosts</code> method, its <code>featured</code> attribute would not be set to <code>true</code>. If you would like to create models via relationship methods and also specify attributes that should be added to all models created via that relationship, you may use the <code>withAttributes</code> method when building the relationship query:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s featured posts.
 */
public function featuredPosts(): HasMany
{
    return $this-&gt;posts()-&gt;withAttributes([&#x27;featured&#x27; =&gt; true]);
}
</code></pre>
<p>The <code>withAttributes</code> method will add <code>where</code> conditions to the query using the given attributes, and it will also add the given attributes to any models created via the relationship method:</p>
<pre><code class="language-php">$post = $user-&gt;featuredPosts()-&gt;create([&#x27;title&#x27; =&gt; &#x27;Featured Post&#x27;]);

$post-&gt;featured; // true
</code></pre>
<p>To instruct the <code>withAttributes</code> method to not add <code>where</code> conditions to the query, you may set the <code>asConditions</code> argument to <code>false</code>:</p>
<pre><code class="language-php">return $this-&gt;posts()-&gt;withAttributes([&#x27;featured&#x27; =&gt; true], asConditions: false);
</code></pre>
<a name="many-to-many"></a>
<h2 id="many-to-many-relationships"><a href="#many-to-many-relationships">Many to Many Relationships</a></h2>
<p>Many-to-many relations are slightly more complicated than <code>hasOne</code> and <code>hasMany</code> relationships. An example of a many-to-many relationship is a user that has many roles and those roles are also shared by other users in the application. For example, a user may be assigned the role of &quot;Author&quot; and &quot;Editor&quot;; however, those roles may also be assigned to other users as well. So, a user has many roles and a role has many users.</p>
<a name="many-to-many-table-structure"></a>
<h4 id="table-structure"><a href="#table-structure">Table Structure</a></h4>
<p>To define this relationship, three database tables are needed: <code>users</code>, <code>roles</code>, and <code>role_user</code>. The <code>role_user</code> table is derived from the alphabetical order of the related model names and contains <code>user_id</code> and <code>role_id</code> columns. This table is used as an intermediate table linking the users and roles.</p>
<p>Remember, since a role can belong to many users, we cannot simply place a <code>user_id</code> column on the <code>roles</code> table. This would mean that a role could only belong to a single user. In order to provide support for roles being assigned to multiple users, the <code>role_user</code> table is needed. We can summarize the relationship&#x27;s table structure like so:</p>
<pre><code class="language-text">users
    id - integer
    name - string

roles
    id - integer
    name - string

role_user
    user_id - integer
    role_id - integer
</code></pre>
<a name="many-to-many-model-structure"></a>
<h4 id="model-structure"><a href="#model-structure">Model Structure</a></h4>
<p>Many-to-many relationships are defined by writing a method that returns the result of the <code>belongsToMany</code> method. The <code>belongsToMany</code> method is provided by the <code>Illuminate\Database\Eloquent\Model</code> base class that is used by all of your application&#x27;s Eloquent models. For example, let&#x27;s define a <code>roles</code> method on our <code>User</code> model. The first argument passed to this method is the name of the related model class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsToMany;

class User extends Model
{
    /**
     * The roles that belong to the user.
     */
    public function roles(): BelongsToMany
    {
        return $this-&gt;belongsToMany(Role::class);
    }
}
</code></pre>
<p>Once the relationship is defined, you may access the user&#x27;s roles using the <code>roles</code> dynamic relationship property:</p>
<pre><code class="language-php">use App\Models\User;

$user = User::find(1);

foreach ($user-&gt;roles as $role) {
    // ...
}
</code></pre>
<p>Since all relationships also serve as query builders, you may add further constraints to the relationship query by calling the <code>roles</code> method and continuing to chain conditions onto the query:</p>
<pre><code class="language-php">$roles = User::find(1)-&gt;roles()-&gt;orderBy(&#x27;name&#x27;)-&gt;get();
</code></pre>
<p>To determine the table name of the relationship&#x27;s intermediate table, Eloquent will join the two related model names in alphabetical order. However, you are free to override this convention. You may do so by passing a second argument to the <code>belongsToMany</code> method:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class, &#x27;role_user&#x27;);
</code></pre>
<p>In addition to customizing the name of the intermediate table, you may also customize the column names of the keys on the table by passing additional arguments to the <code>belongsToMany</code> method. The third argument is the foreign key name of the model on which you are defining the relationship, while the fourth argument is the foreign key name of the model that you are joining to:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class, &#x27;role_user&#x27;, &#x27;user_id&#x27;, &#x27;role_id&#x27;);
</code></pre>
<a name="many-to-many-defining-the-inverse-of-the-relationship"></a>
<h4 id="defining-the-inverse-of-the-relationship-1"><a href="#defining-the-inverse-of-the-relationship-1">Defining the Inverse of the Relationship</a></h4>
<p>To define the &quot;inverse&quot; of a many-to-many relationship, you should define a method on the related model which also returns the result of the <code>belongsToMany</code> method. To complete our user / role example, let&#x27;s define the <code>users</code> method on the <code>Role</code> model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsToMany;

class Role extends Model
{
    /**
     * The users that belong to the role.
     */
    public function users(): BelongsToMany
    {
        return $this-&gt;belongsToMany(User::class);
    }
}
</code></pre>
<p>As you can see, the relationship is defined exactly the same as its <code>User</code> model counterpart with the exception of referencing the <code>App\Models\User</code> model. Since we&#x27;re reusing the <code>belongsToMany</code> method, all of the usual table and key customization options are available when defining the &quot;inverse&quot; of many-to-many relationships.</p>
<a name="retrieving-intermediate-table-columns"></a>
<h3 id="retrieving-intermediate-table-columns"><a href="#retrieving-intermediate-table-columns">Retrieving Intermediate Table Columns</a></h3>
<p>As you have already learned, working with many-to-many relations requires the presence of an intermediate table. Eloquent provides some very helpful ways of interacting with this table. For example, let&#x27;s assume our <code>User</code> model has many <code>Role</code> models that it is related to. After accessing this relationship, we may access the intermediate table using the <code>pivot</code> attribute on the models:</p>
<pre><code class="language-php">use App\Models\User;

$user = User::find(1);

foreach ($user-&gt;roles as $role) {
    echo $role-&gt;pivot-&gt;created_at;
}
</code></pre>
<p>Notice that each <code>Role</code> model we retrieve is automatically assigned a <code>pivot</code> attribute. This attribute contains a model representing the intermediate table.</p>
<p>By default, only the model keys will be present on the <code>pivot</code> model. If your intermediate table contains extra attributes, you must specify them when defining the relationship:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class)-&gt;withPivot(&#x27;active&#x27;, &#x27;created_by&#x27;);
</code></pre>
<p>If you would like your intermediate table to have <code>created_at</code> and <code>updated_at</code> timestamps that are automatically maintained by Eloquent, call the <code>withTimestamps</code> method when defining the relationship:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class)-&gt;withTimestamps();
</code></pre>
<blockquote>
<p>[!WARNING]
Intermediate tables that utilize Eloquent&#x27;s automatically maintained timestamps are required to have both <code>created_at</code> and <code>updated_at</code> timestamp columns.</p>
</blockquote>
<a name="customizing-the-pivot-attribute-name"></a>
<h4 id="customizing-the-pivot-attribute-name"><a href="#customizing-the-pivot-attribute-name">Customizing the <code>pivot</code> Attribute Name</a></h4>
<p>As noted previously, attributes from the intermediate table may be accessed on models via the <code>pivot</code> attribute. However, you are free to customize the name of this attribute to better reflect its purpose within your application.</p>
<p>For example, if your application contains users that may subscribe to podcasts, you likely have a many-to-many relationship between users and podcasts. If this is the case, you may wish to rename your intermediate table attribute to <code>subscription</code> instead of <code>pivot</code>. This can be done using the <code>as</code> method when defining the relationship:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Podcast::class)
    -&gt;as(&#x27;subscription&#x27;)
    -&gt;withTimestamps();
</code></pre>
<p>Once the custom intermediate table attribute has been specified, you may access the intermediate table data using the customized name:</p>
<pre><code class="language-php">$users = User::with(&#x27;podcasts&#x27;)-&gt;get();

foreach ($users-&gt;flatMap-&gt;podcasts as $podcast) {
    echo $podcast-&gt;subscription-&gt;created_at;
}
</code></pre>
<a name="filtering-queries-via-intermediate-table-columns"></a>
<h3 id="filtering-queries-via-intermediate-table-columns"><a href="#filtering-queries-via-intermediate-table-columns">Filtering Queries via Intermediate Table Columns</a></h3>
<p>You can also filter the results returned by <code>belongsToMany</code> relationship queries using the <code>wherePivot</code>, <code>wherePivotIn</code>, <code>wherePivotNotIn</code>, <code>wherePivotBetween</code>, <code>wherePivotNotBetween</code>, <code>wherePivotNull</code>, and <code>wherePivotNotNull</code> methods when defining the relationship:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class)
    -&gt;wherePivot(&#x27;approved&#x27;, 1);

return $this-&gt;belongsToMany(Role::class)
    -&gt;wherePivotIn(&#x27;priority&#x27;, [1, 2]);

return $this-&gt;belongsToMany(Role::class)
    -&gt;wherePivotNotIn(&#x27;priority&#x27;, [1, 2]);

return $this-&gt;belongsToMany(Podcast::class)
    -&gt;as(&#x27;subscriptions&#x27;)
    -&gt;wherePivotBetween(&#x27;created_at&#x27;, [&#x27;2020-01-01 00:00:00&#x27;, &#x27;2020-12-31 00:00:00&#x27;]);

return $this-&gt;belongsToMany(Podcast::class)
    -&gt;as(&#x27;subscriptions&#x27;)
    -&gt;wherePivotNotBetween(&#x27;created_at&#x27;, [&#x27;2020-01-01 00:00:00&#x27;, &#x27;2020-12-31 00:00:00&#x27;]);

return $this-&gt;belongsToMany(Podcast::class)
    -&gt;as(&#x27;subscriptions&#x27;)
    -&gt;wherePivotNull(&#x27;expired_at&#x27;);

return $this-&gt;belongsToMany(Podcast::class)
    -&gt;as(&#x27;subscriptions&#x27;)
    -&gt;wherePivotNotNull(&#x27;expired_at&#x27;);
</code></pre>
<p>The <code>wherePivot</code> adds a where clause constraint to the query, but does not add the specified value when creating new models via the defined relationship. If you need to both query and create relationships with a particular pivot value, you may use the <code>withPivotValue</code> method:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Role::class)
    -&gt;withPivotValue(&#x27;approved&#x27;, 1);
</code></pre>
<a name="ordering-queries-via-intermediate-table-columns"></a>
<h3 id="ordering-queries-via-intermediate-table-columns"><a href="#ordering-queries-via-intermediate-table-columns">Ordering Queries via Intermediate Table Columns</a></h3>
<p>You can order the results returned by <code>belongsToMany</code> relationship queries using the <code>orderByPivot</code> method. In the following example, we will retrieve all of the latest badges for the user:</p>
<pre><code class="language-php">return $this-&gt;belongsToMany(Badge::class)
    -&gt;where(&#x27;rank&#x27;, &#x27;gold&#x27;)
    -&gt;orderByPivot(&#x27;created_at&#x27;, &#x27;desc&#x27;);
</code></pre>
<a name="defining-custom-intermediate-table-models"></a>
<h3 id="defining-custom-intermediate-table-models"><a href="#defining-custom-intermediate-table-models">Defining Custom Intermediate Table Models</a></h3>
<p>If you would like to define a custom model to represent the intermediate table of your many-to-many relationship, you may call the <code>using</code> method when defining the relationship. Custom pivot models give you the opportunity to define additional behavior on the pivot model, such as methods and casts.</p>
<p>Custom many-to-many pivot models should extend the <code>Illuminate\Database\Eloquent\Relations\Pivot</code> class while custom polymorphic many-to-many pivot models should extend the <code>Illuminate\Database\Eloquent\Relations\MorphPivot</code> class. For example, we may define a <code>Role</code> model which uses a custom <code>RoleUser</code> pivot model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsToMany;

class Role extends Model
{
    /**
     * The users that belong to the role.
     */
    public function users(): BelongsToMany
    {
        return $this-&gt;belongsToMany(User::class)-&gt;using(RoleUser::class);
    }
}
</code></pre>
<p>When defining the <code>RoleUser</code> model, you should extend the <code>Illuminate\Database\Eloquent\Relations\Pivot</code> class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Relations\Pivot;

class RoleUser extends Pivot
{
    // ...
}
</code></pre>
<blockquote>
<p>[!WARNING]
Pivot models may not use the <code>SoftDeletes</code> trait. If you need to soft delete pivot records consider converting your pivot model to an actual Eloquent model.</p>
</blockquote>
<a name="custom-pivot-models-and-incrementing-ids"></a>
<h4 id="custom-pivot-models-and-incrementing-ids"><a href="#custom-pivot-models-and-incrementing-ids">Custom Pivot Models and Incrementing IDs</a></h4>
<p>If you have defined a many-to-many relationship that uses a custom pivot model, and that pivot model has an auto-incrementing primary key, you should ensure your custom pivot model class defines an <code>incrementing</code> property that is set to <code>true</code>.</p>
<pre><code class="language-php">/**
 * Indicates if the IDs are auto-incrementing.
 *
 * @var bool
 */
public $incrementing = true;
</code></pre>
<a name="polymorphic-relationships"></a>
<h2 id="polymorphic-relationships"><a href="#polymorphic-relationships">Polymorphic Relationships</a></h2>
<p>A polymorphic relationship allows the child model to belong to more than one type of model using a single association. For example, imagine you are building an application that allows users to share blog posts and videos. In such an application, a <code>Comment</code> model might belong to both the <code>Post</code> and <code>Video</code> models.</p>
<a name="one-to-one-polymorphic-relations"></a>
<h3 id="one-to-one-polymorphic"><a href="#one-to-one-polymorphic">One to One (Polymorphic)</a></h3>
<a name="one-to-one-polymorphic-table-structure"></a>
<h4 id="table-structure-1"><a href="#table-structure-1">Table Structure</a></h4>
<p>A one-to-one polymorphic relation is similar to a typical one-to-one relation; however, the child model can belong to more than one type of model using a single association. For example, a blog <code>Post</code> and a <code>User</code> may share a polymorphic relation to an <code>Image</code> model. Using a one-to-one polymorphic relation allows you to have a single table of unique images that may be associated with posts and users. First, let&#x27;s examine the table structure:</p>
<pre><code class="language-text">posts
    id - integer
    name - string

users
    id - integer
    name - string

images
    id - integer
    url - string
    imageable_id - integer
    imageable_type - string
</code></pre>
<p>Note the <code>imageable_id</code> and <code>imageable_type</code> columns on the <code>images</code> table. The <code>imageable_id</code> column will contain the ID value of the post or user, while the <code>imageable_type</code> column will contain the class name of the parent model. The <code>imageable_type</code> column is used by Eloquent to determine which &quot;type&quot; of parent model to return when accessing the <code>imageable</code> relation. In this case, the column would contain either <code>App\Models\Post</code> or <code>App\Models\User</code>.</p>
<a name="one-to-one-polymorphic-model-structure"></a>
<h4 id="model-structure-1"><a href="#model-structure-1">Model Structure</a></h4>
<p>Next, let&#x27;s examine the model definitions needed to build this relationship:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphTo;

class Image extends Model
{
    /**
     * Get the parent imageable model (user or post).
     */
    public function imageable(): MorphTo
    {
        return $this-&gt;morphTo();
    }
}

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphOne;

class Post extends Model
{
    /**
     * Get the post&#x27;s image.
     */
    public function image(): MorphOne
    {
        return $this-&gt;morphOne(Image::class, &#x27;imageable&#x27;);
    }
}

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphOne;

class User extends Model
{
    /**
     * Get the user&#x27;s image.
     */
    public function image(): MorphOne
    {
        return $this-&gt;morphOne(Image::class, &#x27;imageable&#x27;);
    }
}
</code></pre>
<a name="one-to-one-polymorphic-retrieving-the-relationship"></a>
<h4 id="retrieving-the-relationship"><a href="#retrieving-the-relationship">Retrieving the Relationship</a></h4>
<p>Once your database table and models are defined, you may access the relationships via your models. For example, to retrieve the image for a post, we can access the <code>image</code> dynamic relationship property:</p>
<pre><code class="language-php">use App\Models\Post;

$post = Post::find(1);

$image = $post-&gt;image;
</code></pre>
<p>You may retrieve the parent of the polymorphic model by accessing the name of the method that performs the call to <code>morphTo</code>. In this case, that is the <code>imageable</code> method on the <code>Image</code> model. So, we will access that method as a dynamic relationship property:</p>
<pre><code class="language-php">use App\Models\Image;

$image = Image::find(1);

$imageable = $image-&gt;imageable;
</code></pre>
<p>The <code>imageable</code> relation on the <code>Image</code> model will return either a <code>Post</code> or <code>User</code> instance, depending on which type of model owns the image.</p>
<a name="morph-one-to-one-key-conventions"></a>
<h4 id="key-conventions-2"><a href="#key-conventions-2">Key Conventions</a></h4>
<p>If necessary, you may specify the name of the &quot;id&quot; and &quot;type&quot; columns utilized by your polymorphic child model. If you do so, ensure that you always pass the name of the relationship as the first argument to the <code>morphTo</code> method. Typically, this value should match the method name, so you may use PHP&#x27;s <code>__FUNCTION__</code> constant:</p>
<pre><code class="language-php">/**
 * Get the model that the image belongs to.
 */
public function imageable(): MorphTo
{
    return $this-&gt;morphTo(__FUNCTION__, &#x27;imageable_type&#x27;, &#x27;imageable_id&#x27;);
}
</code></pre>
<a name="one-to-many-polymorphic-relations"></a>
<h3 id="one-to-many-polymorphic"><a href="#one-to-many-polymorphic">One to Many (Polymorphic)</a></h3>
<a name="one-to-many-polymorphic-table-structure"></a>
<h4 id="table-structure-2"><a href="#table-structure-2">Table Structure</a></h4>
<p>A one-to-many polymorphic relation is similar to a typical one-to-many relation; however, the child model can belong to more than one type of model using a single association. For example, imagine users of your application can &quot;comment&quot; on posts and videos. Using polymorphic relationships, you may use a single <code>comments</code> table to contain comments for both posts and videos. First, let&#x27;s examine the table structure required to build this relationship:</p>
<pre><code class="language-text">posts
    id - integer
    title - string
    body - text

videos
    id - integer
    title - string
    url - string

comments
    id - integer
    body - text
    commentable_id - integer
    commentable_type - string
</code></pre>
<a name="one-to-many-polymorphic-model-structure"></a>
<h4 id="model-structure-2"><a href="#model-structure-2">Model Structure</a></h4>
<p>Next, let&#x27;s examine the model definitions needed to build this relationship:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphTo;

class Comment extends Model
{
    /**
     * Get the parent commentable model (post or video).
     */
    public function commentable(): MorphTo
    {
        return $this-&gt;morphTo();
    }
}

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphMany;

class Post extends Model
{
    /**
     * Get all of the post&#x27;s comments.
     */
    public function comments(): MorphMany
    {
        return $this-&gt;morphMany(Comment::class, &#x27;commentable&#x27;);
    }
}

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphMany;

class Video extends Model
{
    /**
     * Get all of the video&#x27;s comments.
     */
    public function comments(): MorphMany
    {
        return $this-&gt;morphMany(Comment::class, &#x27;commentable&#x27;);
    }
}
</code></pre>
<a name="one-to-many-polymorphic-retrieving-the-relationship"></a>
<h4 id="retrieving-the-relationship-1"><a href="#retrieving-the-relationship-1">Retrieving the Relationship</a></h4>
<p>Once your database table and models are defined, you may access the relationships via your model&#x27;s dynamic relationship properties. For example, to access all of the comments for a post, we can use the <code>comments</code> dynamic property:</p>
<pre><code class="language-php">use App\Models\Post;

$post = Post::find(1);

foreach ($post-&gt;comments as $comment) {
    // ...
}
</code></pre>
<p>You may also retrieve the parent of a polymorphic child model by accessing the name of the method that performs the call to <code>morphTo</code>. In this case, that is the <code>commentable</code> method on the <code>Comment</code> model. So, we will access that method as a dynamic relationship property in order to access the comment&#x27;s parent model:</p>
<pre><code class="language-php">use App\Models\Comment;

$comment = Comment::find(1);

$commentable = $comment-&gt;commentable;
</code></pre>
<p>The <code>commentable</code> relation on the <code>Comment</code> model will return either a <code>Post</code> or <code>Video</code> instance, depending on which type of model is the comment&#x27;s parent.</p>
<a name="polymorphic-automatically-hydrating-parent-models-on-children"></a>
<h4 id="automatically-hydrating-parent-models-on-children-1"><a href="#automatically-hydrating-parent-models-on-children-1">Automatically Hydrating Parent Models on Children</a></h4>
<p>Even when utilizing Eloquent eager loading, &quot;N + 1&quot; query problems can arise if you try to access the parent model from a child model while looping through the child models:</p>
<pre><code class="language-php">$posts = Post::with(&#x27;comments&#x27;)-&gt;get();

foreach ($posts as $post) {
    foreach ($post-&gt;comments as $comment) {
        echo $comment-&gt;commentable-&gt;title;
    }
}
</code></pre>
<p>In the example above, an &quot;N + 1&quot; query problem has been introduced because, even though comments were eager loaded for every <code>Post</code> model, Eloquent does not automatically hydrate the parent <code>Post</code> on each child <code>Comment</code> model.</p>
<p>If you would like Eloquent to automatically hydrate parent models onto their children, you may invoke the <code>chaperone</code> method when defining a <code>morphMany</code> relationship:</p>
<pre><code class="language-php">class Post extends Model
{
    /**
     * Get all of the post&#x27;s comments.
     */
    public function comments(): MorphMany
    {
        return $this-&gt;morphMany(Comment::class, &#x27;commentable&#x27;)-&gt;chaperone();
    }
}
</code></pre>
<p>Or, if you would like to opt-in to automatic parent hydration at run time, you may invoke the <code>chaperone</code> model when eager loading the relationship:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::with([
    &#x27;comments&#x27; =&gt; fn ($comments) =&gt; $comments-&gt;chaperone(),
])-&gt;get();
</code></pre>
<a name="one-of-many-polymorphic-relations"></a>
<h3 id="one-of-many-polymorphic"><a href="#one-of-many-polymorphic">One of Many (Polymorphic)</a></h3>
<p>Sometimes a model may have many related models, yet you want to easily retrieve the &quot;latest&quot; or &quot;oldest&quot; related model of the relationship. For example, a <code>User</code> model may be related to many <code>Image</code> models, but you want to define a convenient way to interact with the most recent image the user has uploaded. You may accomplish this using the <code>morphOne</code> relationship type combined with the <code>ofMany</code> methods:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s most recent image.
 */
public function latestImage(): MorphOne
{
    return $this-&gt;morphOne(Image::class, &#x27;imageable&#x27;)-&gt;latestOfMany();
}
</code></pre>
<p>Likewise, you may define a method to retrieve the &quot;oldest&quot;, or first, related model of a relationship:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s oldest image.
 */
public function oldestImage(): MorphOne
{
    return $this-&gt;morphOne(Image::class, &#x27;imageable&#x27;)-&gt;oldestOfMany();
}
</code></pre>
<p>By default, the <code>latestOfMany</code> and <code>oldestOfMany</code> methods will retrieve the latest or oldest related model based on the model&#x27;s primary key, which must be sortable. However, sometimes you may wish to retrieve a single model from a larger relationship using a different sorting criteria.</p>
<p>For example, using the <code>ofMany</code> method, you may retrieve the user&#x27;s most &quot;liked&quot; image. The <code>ofMany</code> method accepts the sortable column as its first argument and which aggregate function (<code>min</code> or <code>max</code>) to apply when querying for the related model:</p>
<pre><code class="language-php">/**
 * Get the user&#x27;s most popular image.
 */
public function bestImage(): MorphOne
{
    return $this-&gt;morphOne(Image::class, &#x27;imageable&#x27;)-&gt;ofMany(&#x27;likes&#x27;, &#x27;max&#x27;);
}
</code></pre>
<blockquote>
<p>[!NOTE]
It is possible to construct more advanced &quot;one of many&quot; relationships. For more information, please consult the <a href="#advanced-has-one-of-many-relationships">has one of many documentation</a>.</p>
</blockquote>
<a name="many-to-many-polymorphic-relations"></a>
<h3 id="many-to-many-polymorphic"><a href="#many-to-many-polymorphic">Many to Many (Polymorphic)</a></h3>
<a name="many-to-many-polymorphic-table-structure"></a>
<h4 id="table-structure-3"><a href="#table-structure-3">Table Structure</a></h4>
<p>Many-to-many polymorphic relations are slightly more complicated than &quot;morph one&quot; and &quot;morph many&quot; relationships. For example, a <code>Post</code> model and <code>Video</code> model could share a polymorphic relation to a <code>Tag</code> model. Using a many-to-many polymorphic relation in this situation would allow your application to have a single table of unique tags that may be associated with posts or videos. First, let&#x27;s examine the table structure required to build this relationship:</p>
<pre><code class="language-text">posts
    id - integer
    name - string

videos
    id - integer
    name - string

tags
    id - integer
    name - string

taggables
    tag_id - integer
    taggable_id - integer
    taggable_type - string
</code></pre>
<blockquote>
<p>[!NOTE]
Before diving into polymorphic many-to-many relationships, you may benefit from reading the documentation on typical <a href="#many-to-many">many-to-many relationships</a>.</p>
</blockquote>
<a name="many-to-many-polymorphic-model-structure"></a>
<h4 id="model-structure-3"><a href="#model-structure-3">Model Structure</a></h4>
<p>Next, we&#x27;re ready to define the relationships on the models. The <code>Post</code> and <code>Video</code> models will both contain a <code>tags</code> method that calls the <code>morphToMany</code> method provided by the base Eloquent model class.</p>
<p>The <code>morphToMany</code> method accepts the name of the related model as well as the &quot;relationship name&quot;. Based on the name we assigned to our intermediate table name and the keys it contains, we will refer to the relationship as &quot;taggable&quot;:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphToMany;

class Post extends Model
{
    /**
     * Get all of the tags for the post.
     */
    public function tags(): MorphToMany
    {
        return $this-&gt;morphToMany(Tag::class, &#x27;taggable&#x27;);
    }
}
</code></pre>
<a name="many-to-many-polymorphic-defining-the-inverse-of-the-relationship"></a>
<h4 id="defining-the-inverse-of-the-relationship-2"><a href="#defining-the-inverse-of-the-relationship-2">Defining the Inverse of the Relationship</a></h4>
<p>Next, on the <code>Tag</code> model, you should define a method for each of its possible parent models. So, in this example, we will define a <code>posts</code> method and a <code>videos</code> method. Both of these methods should return the result of the <code>morphedByMany</code> method.</p>
<p>The <code>morphedByMany</code> method accepts the name of the related model as well as the &quot;relationship name&quot;. Based on the name we assigned to our intermediate table name and the keys it contains, we will refer to the relationship as &quot;taggable&quot;:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphToMany;

class Tag extends Model
{
    /**
     * Get all of the posts that are assigned this tag.
     */
    public function posts(): MorphToMany
    {
        return $this-&gt;morphedByMany(Post::class, &#x27;taggable&#x27;);
    }

    /**
     * Get all of the videos that are assigned this tag.
     */
    public function videos(): MorphToMany
    {
        return $this-&gt;morphedByMany(Video::class, &#x27;taggable&#x27;);
    }
}
</code></pre>
<a name="many-to-many-polymorphic-retrieving-the-relationship"></a>
<h4 id="retrieving-the-relationship-2"><a href="#retrieving-the-relationship-2">Retrieving the Relationship</a></h4>
<p>Once your database table and models are defined, you may access the relationships via your models. For example, to access all of the tags for a post, you may use the <code>tags</code> dynamic relationship property:</p>
<pre><code class="language-php">use App\Models\Post;

$post = Post::find(1);

foreach ($post-&gt;tags as $tag) {
    // ...
}
</code></pre>
<p>You may retrieve the parent of a polymorphic relation from the polymorphic child model by accessing the name of the method that performs the call to <code>morphedByMany</code>. In this case, that is the <code>posts</code> or <code>videos</code> methods on the <code>Tag</code> model:</p>
<pre><code class="language-php">use App\Models\Tag;

$tag = Tag::find(1);

foreach ($tag-&gt;posts as $post) {
    // ...
}

foreach ($tag-&gt;videos as $video) {
    // ...
}
</code></pre>
<a name="custom-polymorphic-types"></a>
<h3 id="custom-polymorphic-types"><a href="#custom-polymorphic-types">Custom Polymorphic Types</a></h3>
<p>By default, Laravel will use the fully qualified class name to store the &quot;type&quot; of the related model. For instance, given the one-to-many relationship example above where a <code>Comment</code> model may belong to a <code>Post</code> or a <code>Video</code> model, the default <code>commentable_type</code> would be either <code>App\Models\Post</code> or <code>App\Models\Video</code>, respectively. However, you may wish to decouple these values from your application&#x27;s internal structure.</p>
<p>For example, instead of using the model names as the &quot;type&quot;, we may use simple strings such as <code>post</code> and <code>video</code>. By doing so, the polymorphic &quot;type&quot; column values in our database will remain valid even if the models are renamed:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Relations\Relation;

Relation::enforceMorphMap([
    &#x27;post&#x27; =&gt; &#x27;App\Models\Post&#x27;,
    &#x27;video&#x27; =&gt; &#x27;App\Models\Video&#x27;,
]);
</code></pre>
<p>You may call the <code>enforceMorphMap</code> method in the <code>boot</code> method of your <code>App\Providers\AppServiceProvider</code> class or create a separate service provider if you wish.</p>
<p>You may determine the morph alias of a given model at runtime using the model&#x27;s <code>getMorphClass</code> method. Conversely, you may determine the fully-qualified class name associated with a morph alias using the <code>Relation::getMorphedModel</code> method:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Relations\Relation;

$alias = $post-&gt;getMorphClass();

$class = Relation::getMorphedModel($alias);
</code></pre>
<blockquote>
<p>[!WARNING]
When adding a &quot;morph map&quot; to your existing application, every morphable <code>*_type</code> column value in your database that still contains a fully-qualified class will need to be converted to its &quot;map&quot; name.</p>
</blockquote>
<a name="dynamic-relationships"></a>
<h3 id="dynamic-relationships"><a href="#dynamic-relationships">Dynamic Relationships</a></h3>
<p>You may use the <code>resolveRelationUsing</code> method to define relations between Eloquent models at runtime. While not typically recommended for normal application development, this may occasionally be useful when developing Laravel packages.</p>
<p>The <code>resolveRelationUsing</code> method accepts the desired relationship name as its first argument. The second argument passed to the method should be a closure that accepts the model instance and returns a valid Eloquent relationship definition. Typically, you should configure dynamic relationships within the boot method of a <a href="/docs/providers">service provider</a>:</p>
<pre><code class="language-php">use App\Models\Order;
use App\Models\Customer;

Order::resolveRelationUsing(&#x27;customer&#x27;, function (Order $orderModel) {
    return $orderModel-&gt;belongsTo(Customer::class, &#x27;customer_id&#x27;);
});
</code></pre>
<blockquote>
<p>[!WARNING]
When defining dynamic relationships, always provide explicit key name arguments to the Eloquent relationship methods.</p>
</blockquote>
<a name="querying-relations"></a>
<h2 id="querying-relations"><a href="#querying-relations">Querying Relations</a></h2>
<p>Since all Eloquent relationships are defined via methods, you may call those methods to obtain an instance of the relationship without actually executing a query to load the related models. In addition, all types of Eloquent relationships also serve as <a href="/docs/queries">query builders</a>, allowing you to continue to chain constraints onto the relationship query before finally executing the SQL query against your database.</p>
<p>For example, imagine a blog application in which a <code>User</code> model has many associated <code>Post</code> models:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class User extends Model
{
    /**
     * Get all of the posts for the user.
     */
    public function posts(): HasMany
    {
        return $this-&gt;hasMany(Post::class);
    }
}
</code></pre>
<p>You may query the <code>posts</code> relationship and add additional constraints to the relationship like so:</p>
<pre><code class="language-php">use App\Models\User;

$user = User::find(1);

$user-&gt;posts()-&gt;where(&#x27;active&#x27;, 1)-&gt;get();
</code></pre>
<p>You are able to use any of the Laravel <a href="/docs/queries">query builder&#x27;s</a> methods on the relationship, so be sure to explore the query builder documentation to learn about all of the methods that are available to you.</p>
<a name="chaining-orwhere-clauses-after-relationships"></a>
<h4 id="chaining-orwhere-clauses-after-relationships"><a href="#chaining-orwhere-clauses-after-relationships">Chaining <code>orWhere</code> Clauses After Relationships</a></h4>
<p>As demonstrated in the example above, you are free to add additional constraints to relationships when querying them. However, use caution when chaining <code>orWhere</code> clauses onto a relationship, as the <code>orWhere</code> clauses will be logically grouped at the same level as the relationship constraint:</p>
<pre><code class="language-php">$user-&gt;posts()
    -&gt;where(&#x27;active&#x27;, 1)
    -&gt;orWhere(&#x27;votes&#x27;, &#x27;&gt;=&#x27;, 100)
    -&gt;get();
</code></pre>
<p>The example above will generate the following SQL. As you can see, the <code>or</code> clause instructs the query to return <em>any</em> post with greater than 100 votes. The query is no longer constrained to a specific user:</p>
<pre><code class="language-sql">select *
from posts
where user_id = ? and active = 1 or votes &gt;= 100
</code></pre>
<p>In most situations, you should use <a href="/docs/queries#logical-grouping">logical groups</a> to group the conditional checks between parentheses:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$user-&gt;posts()
    -&gt;where(function (Builder $query) {
        return $query-&gt;where(&#x27;active&#x27;, 1)
            -&gt;orWhere(&#x27;votes&#x27;, &#x27;&gt;=&#x27;, 100);
    })
    -&gt;get();
</code></pre>
<p>The example above will produce the following SQL. Note that the logical grouping has properly grouped the constraints and the query remains constrained to a specific user:</p>
<pre><code class="language-sql">select *
from posts
where user_id = ? and (active = 1 or votes &gt;= 100)
</code></pre>
<a name="relationship-methods-vs-dynamic-properties"></a>
<h3 id="relationship-methods-vs-dynamic-properties"><a href="#relationship-methods-vs-dynamic-properties">Relationship Methods vs. Dynamic Properties</a></h3>
<p>If you do not need to add additional constraints to an Eloquent relationship query, you may access the relationship as if it were a property. For example, continuing to use our <code>User</code> and <code>Post</code> example models, we may access all of a user&#x27;s posts like so:</p>
<pre><code class="language-php">use App\Models\User;

$user = User::find(1);

foreach ($user-&gt;posts as $post) {
    // ...
}
</code></pre>
<p>Dynamic relationship properties perform &quot;lazy loading&quot;, meaning they will only load their relationship data when you actually access them. Because of this, developers often use <a href="#eager-loading">eager loading</a> to pre-load relationships they know will be accessed after loading the model. Eager loading provides a significant reduction in SQL queries that must be executed to load a model&#x27;s relations.</p>
<a name="querying-relationship-existence"></a>
<h3 id="querying-relationship-existence"><a href="#querying-relationship-existence">Querying Relationship Existence</a></h3>
<p>When retrieving model records, you may wish to limit your results based on the existence of a relationship. For example, imagine you want to retrieve all blog posts that have at least one comment. To do so, you may pass the name of the relationship to the <code>has</code> and <code>orHas</code> methods:</p>
<pre><code class="language-php">use App\Models\Post;

// Retrieve all posts that have at least one comment...
$posts = Post::has(&#x27;comments&#x27;)-&gt;get();
</code></pre>
<p>You may also specify an operator and count value to further customize the query:</p>
<pre><code class="language-php">// Retrieve all posts that have three or more comments...
$posts = Post::has(&#x27;comments&#x27;, &#x27;&gt;=&#x27;, 3)-&gt;get();
</code></pre>
<p>Nested <code>has</code> statements may be constructed using &quot;dot&quot; notation. For example, you may retrieve all posts that have at least one comment that has at least one image:</p>
<pre><code class="language-php">// Retrieve posts that have at least one comment with images...
$posts = Post::has(&#x27;comments.images&#x27;)-&gt;get();
</code></pre>
<p>If you need even more power, you may use the <code>whereHas</code> and <code>orWhereHas</code> methods to define additional query constraints on your <code>has</code> queries, such as inspecting the content of a comment:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

// Retrieve posts with at least one comment containing words like code%...
$posts = Post::whereHas(&#x27;comments&#x27;, function (Builder $query) {
    $query-&gt;where(&#x27;content&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
})-&gt;get();

// Retrieve posts with at least ten comments containing words like code%...
$posts = Post::whereHas(&#x27;comments&#x27;, function (Builder $query) {
    $query-&gt;where(&#x27;content&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
}, &#x27;&gt;=&#x27;, 10)-&gt;get();
</code></pre>
<blockquote>
<p>[!WARNING]
Eloquent does not currently support querying for relationship existence across databases. The relationships must exist within the same database.</p>
</blockquote>
<a name="many-to-many-relationship-existence-queries"></a>
<h4 id="many-to-many-relationship-existence-queries"><a href="#many-to-many-relationship-existence-queries">Many to Many Relationship Existence Queries</a></h4>
<p>The <code>whereAttachedTo</code> method may be used to query for models that have a many to many attachment to a model or collection of models:</p>
<pre><code class="language-php">$users = User::whereAttachedTo($role)-&gt;get();
</code></pre>
<p>You may also provide a <a href="/docs/eloquent-collections">collection</a> instance to the <code>whereAttachedTo</code> method. When doing so, Laravel will retrieve models that are attached to any of the models within the collection:</p>
<pre><code class="language-php">$tags = Tag::whereLike(&#x27;name&#x27;, &#x27;%laravel%&#x27;)-&gt;get();

$posts = Post::whereAttachedTo($tags)-&gt;get();
</code></pre>
<a name="inline-relationship-existence-queries"></a>
<h4 id="inline-relationship-existence-queries"><a href="#inline-relationship-existence-queries">Inline Relationship Existence Queries</a></h4>
<p>If you would like to query for a relationship&#x27;s existence with a single, simple where condition attached to the relationship query, you may find it more convenient to use the <code>whereRelation</code>, <code>orWhereRelation</code>, <code>whereMorphRelation</code>, and <code>orWhereMorphRelation</code> methods. For example, we may query for all posts that have unapproved comments:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::whereRelation(&#x27;comments&#x27;, &#x27;is_approved&#x27;, false)-&gt;get();
</code></pre>
<p>Of course, like calls to the query builder&#x27;s <code>where</code> method, you may also specify an operator:</p>
<pre><code class="language-php">$posts = Post::whereRelation(
    &#x27;comments&#x27;, &#x27;created_at&#x27;, &#x27;&gt;=&#x27;, now()-&gt;subHour()
)-&gt;get();
</code></pre>
<a name="querying-relationship-absence"></a>
<h3 id="querying-relationship-absence"><a href="#querying-relationship-absence">Querying Relationship Absence</a></h3>
<p>When retrieving model records, you may wish to limit your results based on the absence of a relationship. For example, imagine you want to retrieve all blog posts that <strong>don&#x27;t</strong> have any comments. To do so, you may pass the name of the relationship to the <code>doesntHave</code> and <code>orDoesntHave</code> methods:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::doesntHave(&#x27;comments&#x27;)-&gt;get();
</code></pre>
<p>If you need even more power, you may use the <code>whereDoesntHave</code> and <code>orWhereDoesntHave</code> methods to add additional query constraints to your <code>doesntHave</code> queries, such as inspecting the content of a comment:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$posts = Post::whereDoesntHave(&#x27;comments&#x27;, function (Builder $query) {
    $query-&gt;where(&#x27;content&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
})-&gt;get();
</code></pre>
<p>You may use &quot;dot&quot; notation to execute a query against a nested relationship. For example, the following query will retrieve all posts that do not have comments as well as posts that have comments where none of the comments are from banned users:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$posts = Post::whereDoesntHave(&#x27;comments.author&#x27;, function (Builder $query) {
    $query-&gt;where(&#x27;banned&#x27;, 1);
})-&gt;get();
</code></pre>
<a name="querying-morph-to-relationships"></a>
<h3 id="querying-morph-to-relationships"><a href="#querying-morph-to-relationships">Querying Morph To Relationships</a></h3>
<p>To query the existence of &quot;morph to&quot; relationships, you may use the <code>whereHasMorph</code> and <code>whereDoesntHaveMorph</code> methods. These methods accept the name of the relationship as their first argument. Next, the methods accept the names of the related models that you wish to include in the query. Finally, you may provide a closure which customizes the relationship query:</p>
<pre><code class="language-php">use App\Models\Comment;
use App\Models\Post;
use App\Models\Video;
use Illuminate\Database\Eloquent\Builder;

// Retrieve comments associated to posts or videos with a title like code%...
$comments = Comment::whereHasMorph(
    &#x27;commentable&#x27;,
    [Post::class, Video::class],
    function (Builder $query) {
        $query-&gt;where(&#x27;title&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
    }
)-&gt;get();

// Retrieve comments associated to posts with a title not like code%...
$comments = Comment::whereDoesntHaveMorph(
    &#x27;commentable&#x27;,
    Post::class,
    function (Builder $query) {
        $query-&gt;where(&#x27;title&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
    }
)-&gt;get();
</code></pre>
<p>You may occasionally need to add query constraints based on the &quot;type&quot; of the related polymorphic model. The closure passed to the <code>whereHasMorph</code> method may receive a <code>$type</code> value as its second argument. This argument allows you to inspect the &quot;type&quot; of the query that is being built:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$comments = Comment::whereHasMorph(
    &#x27;commentable&#x27;,
    [Post::class, Video::class],
    function (Builder $query, string $type) {
        $column = $type === Post::class ? &#x27;content&#x27; : &#x27;title&#x27;;

        $query-&gt;where($column, &#x27;like&#x27;, &#x27;code%&#x27;);
    }
)-&gt;get();
</code></pre>
<p>Sometimes you may want to query for the children of a &quot;morph to&quot; relationship&#x27;s parent. You may accomplish this using the <code>whereMorphedTo</code> and <code>whereNotMorphedTo</code> methods, which will automatically determine the proper morph type mapping for the given model. These methods accept the name of the <code>morphTo</code> relationship as their first argument and the related parent model as their second argument:</p>
<pre><code class="language-php">$comments = Comment::whereMorphedTo(&#x27;commentable&#x27;, $post)
    -&gt;orWhereMorphedTo(&#x27;commentable&#x27;, $video)
    -&gt;get();
</code></pre>
<a name="querying-all-morph-to-related-models"></a>
<h4 id="querying-all-related-models"><a href="#querying-all-related-models">Querying All Related Models</a></h4>
<p>Instead of passing an array of possible polymorphic models, you may provide <code>*</code> as a wildcard value. This will instruct Laravel to retrieve all of the possible polymorphic types from the database. Laravel will execute an additional query in order to perform this operation:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$comments = Comment::whereHasMorph(&#x27;commentable&#x27;, &#x27;*&#x27;, function (Builder $query) {
    $query-&gt;where(&#x27;title&#x27;, &#x27;like&#x27;, &#x27;foo%&#x27;);
})-&gt;get();
</code></pre>
<a name="aggregating-related-models"></a>
<h2 id="aggregating-related-models"><a href="#aggregating-related-models">Aggregating Related Models</a></h2>
<a name="counting-related-models"></a>
<h3 id="counting-related-models"><a href="#counting-related-models">Counting Related Models</a></h3>
<p>Sometimes you may want to count the number of related models for a given relationship without actually loading the models. To accomplish this, you may use the <code>withCount</code> method. The <code>withCount</code> method will place a <code>{relation}_count</code> attribute on the resulting models:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::withCount(&#x27;comments&#x27;)-&gt;get();

foreach ($posts as $post) {
    echo $post-&gt;comments_count;
}
</code></pre>
<p>By passing an array to the <code>withCount</code> method, you may add the &quot;counts&quot; for multiple relations as well as add additional constraints to the queries:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$posts = Post::withCount([&#x27;votes&#x27;, &#x27;comments&#x27; =&gt; function (Builder $query) {
    $query-&gt;where(&#x27;content&#x27;, &#x27;like&#x27;, &#x27;code%&#x27;);
}])-&gt;get();

echo $posts[0]-&gt;votes_count;
echo $posts[0]-&gt;comments_count;
</code></pre>
<p>You may also alias the relationship count result, allowing multiple counts on the same relationship:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Builder;

$posts = Post::withCount([
    &#x27;comments&#x27;,
    &#x27;comments as pending_comments_count&#x27; =&gt; function (Builder $query) {
        $query-&gt;where(&#x27;approved&#x27;, false);
    },
])-&gt;get();

echo $posts[0]-&gt;comments_count;
echo $posts[0]-&gt;pending_comments_count;
</code></pre>
<a name="deferred-count-loading"></a>
<h4 id="deferred-count-loading"><a href="#deferred-count-loading">Deferred Count Loading</a></h4>
<p>Using the <code>loadCount</code> method, you may load a relationship count after the parent model has already been retrieved:</p>
<pre><code class="language-php">$book = Book::first();

$book-&gt;loadCount(&#x27;genres&#x27;);
</code></pre>
<p>If you need to set additional query constraints on the count query, you may pass an array keyed by the relationships you wish to count. The array values should be closures which receive the query builder instance:</p>
<pre><code class="language-php">$book-&gt;loadCount([&#x27;reviews&#x27; =&gt; function (Builder $query) {
    $query-&gt;where(&#x27;rating&#x27;, 5);
}])
</code></pre>
<a name="relationship-counting-and-custom-select-statements"></a>
<h4 id="relationship-counting-and-custom-select-statements"><a href="#relationship-counting-and-custom-select-statements">Relationship Counting and Custom Select Statements</a></h4>
<p>If you&#x27;re combining <code>withCount</code> with a <code>select</code> statement, ensure that you call <code>withCount</code> after the <code>select</code> method:</p>
<pre><code class="language-php">$posts = Post::select([&#x27;title&#x27;, &#x27;body&#x27;])
    -&gt;withCount(&#x27;comments&#x27;)
    -&gt;get();
</code></pre>
<a name="other-aggregate-functions"></a>
<h3 id="other-aggregate-functions"><a href="#other-aggregate-functions">Other Aggregate Functions</a></h3>
<p>In addition to the <code>withCount</code> method, Eloquent provides <code>withMin</code>, <code>withMax</code>, <code>withAvg</code>, <code>withSum</code>, and <code>withExists</code> methods. These methods will place a <code>{relation}_{function}_{column}</code> attribute on your resulting models:</p>
<pre><code class="language-php">use App\Models\Post;

$posts = Post::withSum(&#x27;comments&#x27;, &#x27;votes&#x27;)-&gt;get();

foreach ($posts as $post) {
    echo $post-&gt;comments_sum_votes;
}
</code></pre>
<p>If you wish to access the result of the aggregate function using another name, you may specify your own alias:</p>
<pre><code class="language-php">$posts = Post::withSum(&#x27;comments as total_comments&#x27;, &#x27;votes&#x27;)-&gt;get();

foreach ($posts as $post) {
    echo $post-&gt;total_comments;
}
</code></pre>
<p>Like the <code>loadCount</code> method, deferred versions of these methods are also available. These additional aggregate operations may be performed on Eloquent models that have already been retrieved:</p>
<pre><code class="language-php">$post = Post::first();

$post-&gt;loadSum(&#x27;comments&#x27;, &#x27;votes&#x27;);
</code></pre>
<p>If you&#x27;re combining these aggregate methods with a <code>select</code> statement, ensure that you call the aggregate methods after the <code>select</code> method:</p>
<pre><code class="language-php">$posts = Post::select([&#x27;title&#x27;, &#x27;body&#x27;])
    -&gt;withExists(&#x27;comments&#x27;)
    -&gt;get();
</code></pre>
<a name="counting-related-models-on-morph-to-relationships"></a>
<h3 id="counting-related-models-on-morph-to-relationships"><a href="#counting-related-models-on-morph-to-relationships">Counting Related Models on Morph To Relationships</a></h3>
<p>If you would like to eager load a &quot;morph to&quot; relationship, as well as related model counts for the various entities that may be returned by that relationship, you may utilize the <code>with</code> method in combination with the <code>morphTo</code> relationship&#x27;s <code>morphWithCount</code> method.</p>
<p>In this example, let&#x27;s assume that <code>Photo</code> and <code>Post</code> models may create <code>ActivityFeed</code> models. We will assume the <code>ActivityFeed</code> model defines a &quot;morph to&quot; relationship named <code>parentable</code> that allows us to retrieve the parent <code>Photo</code> or <code>Post</code> model for a given <code>ActivityFeed</code> instance. Additionally, let&#x27;s assume that <code>Photo</code> models &quot;have many&quot; <code>Tag</code> models and <code>Post</code> models &quot;have many&quot; <code>Comment</code> models.</p>
<p>Now, let&#x27;s imagine we want to retrieve <code>ActivityFeed</code> instances and eager load the <code>parentable</code> parent models for each <code>ActivityFeed</code> instance. In addition, we want to retrieve the number of tags that are associated with each parent photo and the number of comments that are associated with each parent post:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Relations\MorphTo;

$activities = ActivityFeed::with([
    &#x27;parentable&#x27; =&gt; function (MorphTo $morphTo) {
        $morphTo-&gt;morphWithCount([
            Photo::class =&gt; [&#x27;tags&#x27;],
            Post::class =&gt; [&#x27;comments&#x27;],
        ]);
    }])-&gt;get();
</code></pre>
<a name="morph-to-deferred-count-loading"></a>
<h4 id="deferred-count-loading-1"><a href="#deferred-count-loading-1">Deferred Count Loading</a></h4>
<p>Let&#x27;s assume we have already retrieved a set of <code>ActivityFeed</code> models and now we would like to load the nested relationship counts for the various <code>parentable</code> models associated with the activity feeds. You may use the <code>loadMorphCount</code> method to accomplish this:</p>
<pre><code class="language-php">$activities = ActivityFeed::with(&#x27;parentable&#x27;)-&gt;get();

$activities-&gt;loadMorphCount(&#x27;parentable&#x27;, [
    Photo::class =&gt; [&#x27;tags&#x27;],
    Post::class =&gt; [&#x27;comments&#x27;],
]);
</code></pre>
<a name="eager-loading"></a>
<h2 id="eager-loading"><a href="#eager-loading">Eager Loading</a></h2>
<p>When accessing Eloquent relationships as properties, the related models are &quot;lazy loaded&quot;. This means the relationship data is not actually loaded until you first access the property. However, Eloquent can &quot;eager load&quot; relationships at the time you query the parent model. Eager loading alleviates the &quot;N + 1&quot; query problem. To illustrate the N + 1 query problem, consider a <code>Book</code> model that &quot;belongs to&quot; to an <code>Author</code> model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Book extends Model
{
    /**
     * Get the author that wrote the book.
     */
    public function author(): BelongsTo
    {
        return $this-&gt;belongsTo(Author::class);
    }
}
</code></pre>
<p>Now, let&#x27;s retrieve all books and their authors:</p>
<pre><code class="language-php">use App\Models\Book;

$books = Book::all();

foreach ($books as $book) {
    echo $book-&gt;author-&gt;name;
}
</code></pre>
<p>This loop will execute one query to retrieve all of the books within the database table, then another query for each book in order to retrieve the book&#x27;s author. So, if we have 25 books, the code above would run 26 queries: one for the original book, and 25 additional queries to retrieve the author of each book.</p>
<p>Thankfully, we can use eager loading to reduce this operation to just two queries. When building a query, you may specify which relationships should be eager loaded using the <code>with</code> method:</p>
<pre><code class="language-php">$books = Book::with(&#x27;author&#x27;)-&gt;get();

foreach ($books as $book) {
    echo $book-&gt;author-&gt;name;
}
</code></pre>
<p>For this operation, only two queries will be executed - one query to retrieve all of the books and one query to retrieve all of the authors for all of the books:</p>
<pre><code class="language-sql">select * from books

select * from authors where id in (1, 2, 3, 4, 5, ...)
</code></pre>
<a name="eager-loading-multiple-relationships"></a>
<h4 id="eager-loading-multiple-relationships"><a href="#eager-loading-multiple-relationships">Eager Loading Multiple Relationships</a></h4>
<p>Sometimes you may need to eager load several different relationships. To do so, just pass an array of relationships to the <code>with</code> method:</p>
<pre><code class="language-php">$books = Book::with([&#x27;author&#x27;, &#x27;publisher&#x27;])-&gt;get();
</code></pre>
<a name="nested-eager-loading"></a>
<h4 id="nested-eager-loading"><a href="#nested-eager-loading">Nested Eager Loading</a></h4>
<p>To eager load a relationship&#x27;s relationships, you may use &quot;dot&quot; syntax. For example, let&#x27;s eager load all of the book&#x27;s authors and all of the author&#x27;s personal contacts:</p>
<pre><code class="language-php">$books = Book::with(&#x27;author.contacts&#x27;)-&gt;get();
</code></pre>
<p>Alternatively, you may specify nested eager loaded relationships by providing a nested array to the <code>with</code> method, which can be convenient when eager loading multiple nested relationships:</p>
<pre><code class="language-php">$books = Book::with([
    &#x27;author&#x27; =&gt; [
        &#x27;contacts&#x27;,
        &#x27;publisher&#x27;,
    ],
])-&gt;get();
</code></pre>
<a name="nested-eager-loading-morphto-relationships"></a>
<h4 id="nested-eager-loading-morphto-relationships"><a href="#nested-eager-loading-morphto-relationships">Nested Eager Loading <code>morphTo</code> Relationships</a></h4>
<p>If you would like to eager load a <code>morphTo</code> relationship, as well as nested relationships on the various entities that may be returned by that relationship, you may use the <code>with</code> method in combination with the <code>morphTo</code> relationship&#x27;s <code>morphWith</code> method. To help illustrate this method, let&#x27;s consider the following model:</p>
<pre><code class="language-php">&lt;?php

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphTo;

class ActivityFeed extends Model
{
    /**
     * Get the parent of the activity feed record.
     */
    public function parentable(): MorphTo
    {
        return $this-&gt;morphTo();
    }
}
</code></pre>
<p>In this example, let&#x27;s assume <code>Event</code>, <code>Photo</code>, and <code>Post</code> models may create <code>ActivityFeed</code> models. Additionally, let&#x27;s assume that <code>Event</code> models belong to a <code>Calendar</code> model, <code>Photo</code> models are associated with <code>Tag</code> models, and <code>Post</code> models belong to an <code>Author</code> model.</p>
<p>Using these model definitions and relationships, we may retrieve <code>ActivityFeed</code> model instances and eager load all <code>parentable</code> models and their respective nested relationships:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Relations\MorphTo;

$activities = ActivityFeed::query()
    -&gt;with([&#x27;parentable&#x27; =&gt; function (MorphTo $morphTo) {
        $morphTo-&gt;morphWith([
            Event::class =&gt; [&#x27;calendar&#x27;],
            Photo::class =&gt; [&#x27;tags&#x27;],
            Post::class =&gt; [&#x27;author&#x27;],
        ]);
    }])-&gt;get();
</code></pre>
<a name="eager-loading-specific-columns"></a>
<h4 id="eager-loading-specific-columns"><a href="#eager-loading-specific-columns">Eager Loading Specific Columns</a></h4>
<p>You may not always need every column from the relationships you are retrieving. For this reason, Eloquent allows you to specify which columns of the relationship you would like to retrieve:</p>
<pre><code class="language-php">$books = Book::with(&#x27;author:id,name,book_id&#x27;)-&gt;get();
</code></pre>
<blockquote>
<p>[!WARNING]
When using this feature, you should always include the <code>id</code> column and any relevant foreign key columns in the list of columns you wish to retrieve.</p>
</blockquote>
<a name="eager-loading-by-default"></a>
<h4 id="eager-loading-by-default"><a href="#eager-loading-by-default">Eager Loading by Default</a></h4>
<p>Sometimes you might want to always load some relationships when retrieving a model. To accomplish this, you may define a <code>$with</code> property on the model:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Book extends Model
{
    /**
     * The relationships that should always be loaded.
     *
     * @var array
     */
    protected $with = [&#x27;author&#x27;];

    /**
     * Get the author that wrote the book.
     */
    public function author(): BelongsTo
    {
        return $this-&gt;belongsTo(Author::class);
    }

    /**
     * Get the genre of the book.
     */
    public function genre(): BelongsTo
    {
        return $this-&gt;belongsTo(Genre::class);
    }
}
</code></pre>
<p>If you would like to remove an item from the <code>$with</code> property for a single query, you may use the <code>without</code> method:</p>
<pre><code class="language-php">$books = Book::without(&#x27;author&#x27;)-&gt;get();
</code></pre>
<p>If you would like to override all items within the <code>$with</code> property for a single query, you may use the <code>withOnly</code> method:</p>
<pre><code class="language-php">$books = Book::withOnly(&#x27;genre&#x27;)-&gt;get();
</code></pre>
<a name="constraining-eager-loads"></a>
<h3 id="constraining-eager-loads"><a href="#constraining-eager-loads">Constraining Eager Loads</a></h3>
<p>Sometimes you may wish to eager load a relationship but also specify additional query conditions for the eager loading query. You can accomplish this by passing an array of relationships to the <code>with</code> method where the array key is a relationship name and the array value is a closure that adds additional constraints to the eager loading query:</p>
<pre><code class="language-php">use App\Models\User;

$users = User::with([&#x27;posts&#x27; =&gt; function ($query) {
    $query-&gt;where(&#x27;title&#x27;, &#x27;like&#x27;, &#x27;%code%&#x27;);
}])-&gt;get();
</code></pre>
<p>In this example, Eloquent will only eager load posts where the post&#x27;s <code>title</code> column contains the word <code>code</code>. You may call other <a href="/docs/queries">query builder</a> methods to further customize the eager loading operation:</p>
<pre><code class="language-php">$users = User::with([&#x27;posts&#x27; =&gt; function ($query) {
    $query-&gt;orderBy(&#x27;created_at&#x27;, &#x27;desc&#x27;);
}])-&gt;get();
</code></pre>
<a name="constraining-eager-loading-of-morph-to-relationships"></a>
<h4 id="constraining-eager-loading-of-morphto-relationships"><a href="#constraining-eager-loading-of-morphto-relationships">Constraining Eager Loading of <code>morphTo</code> Relationships</a></h4>
<p>If you are eager loading a <code>morphTo</code> relationship, Eloquent will run multiple queries to fetch each type of related model. You may add additional constraints to each of these queries using the <code>MorphTo</code> relation&#x27;s <code>constrain</code> method:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Relations\MorphTo;

$comments = Comment::with([&#x27;commentable&#x27; =&gt; function (MorphTo $morphTo) {
    $morphTo-&gt;constrain([
        Post::class =&gt; function ($query) {
            $query-&gt;whereNull(&#x27;hidden_at&#x27;);
        },
        Video::class =&gt; function ($query) {
            $query-&gt;where(&#x27;type&#x27;, &#x27;educational&#x27;);
        },
    ]);
}])-&gt;get();
</code></pre>
<p>In this example, Eloquent will only eager load posts that have not been hidden and videos that have a <code>type</code> value of &quot;educational&quot;.</p>
<a name="constraining-eager-loads-with-relationship-existence"></a>
<h4 id="constraining-eager-loads-with-relationship-existence"><a href="#constraining-eager-loads-with-relationship-existence">Constraining Eager Loads With Relationship Existence</a></h4>
<p>You may sometimes find yourself needing to check for the existence of a relationship while simultaneously loading the relationship based on the same conditions. For example, you may wish to only retrieve <code>User</code> models that have child <code>Post</code> models matching a given query condition while also eager loading the matching posts. You may accomplish this using the <code>withWhereHas</code> method:</p>
<pre><code class="language-php">use App\Models\User;

$users = User::withWhereHas(&#x27;posts&#x27;, function ($query) {
    $query-&gt;where(&#x27;featured&#x27;, true);
})-&gt;get();
</code></pre>
<a name="lazy-eager-loading"></a>
<h3 id="lazy-eager-loading"><a href="#lazy-eager-loading">Lazy Eager Loading</a></h3>
<p>Sometimes you may need to eager load a relationship after the parent model has already been retrieved. For example, this may be useful if you need to dynamically decide whether to load related models:</p>
<pre><code class="language-php">use App\Models\Book;

$books = Book::all();

if ($condition) {
    $books-&gt;load(&#x27;author&#x27;, &#x27;publisher&#x27;);
}
</code></pre>
<p>If you need to set additional query constraints on the eager loading query, you may pass an array keyed by the relationships you wish to load. The array values should be closure instances which receive the query instance:</p>
<pre><code class="language-php">$author-&gt;load([&#x27;books&#x27; =&gt; function ($query) {
    $query-&gt;orderBy(&#x27;published_date&#x27;, &#x27;asc&#x27;);
}]);
</code></pre>
<p>To load a relationship only when it has not already been loaded, use the <code>loadMissing</code> method:</p>
<pre><code class="language-php">$book-&gt;loadMissing(&#x27;author&#x27;);
</code></pre>
<a name="nested-lazy-eager-loading-morphto"></a>
<h4 id="nested-lazy-eager-loading-and-morphto"><a href="#nested-lazy-eager-loading-and-morphto">Nested Lazy Eager Loading and <code>morphTo</code></a></h4>
<p>If you would like to eager load a <code>morphTo</code> relationship, as well as nested relationships on the various entities that may be returned by that relationship, you may use the <code>loadMorph</code> method.</p>
<p>This method accepts the name of the <code>morphTo</code> relationship as its first argument, and an array of model / relationship pairs as its second argument. To help illustrate this method, let&#x27;s consider the following model:</p>
<pre><code class="language-php">&lt;?php

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\MorphTo;

class ActivityFeed extends Model
{
    /**
     * Get the parent of the activity feed record.
     */
    public function parentable(): MorphTo
    {
        return $this-&gt;morphTo();
    }
}
</code></pre>
<p>In this example, let&#x27;s assume <code>Event</code>, <code>Photo</code>, and <code>Post</code> models may create <code>ActivityFeed</code> models. Additionally, let&#x27;s assume that <code>Event</code> models belong to a <code>Calendar</code> model, <code>Photo</code> models are associated with <code>Tag</code> models, and <code>Post</code> models belong to an <code>Author</code> model.</p>
<p>Using these model definitions and relationships, we may retrieve <code>ActivityFeed</code> model instances and eager load all <code>parentable</code> models and their respective nested relationships:</p>
<pre><code class="language-php">$activities = ActivityFeed::with(&#x27;parentable&#x27;)
    -&gt;get()
    -&gt;loadMorph(&#x27;parentable&#x27;, [
        Event::class =&gt; [&#x27;calendar&#x27;],
        Photo::class =&gt; [&#x27;tags&#x27;],
        Post::class =&gt; [&#x27;author&#x27;],
    ]);
</code></pre>
<a name="automatic-eager-loading"></a>
<h3 id="automatic-eager-loading"><a href="#automatic-eager-loading">Automatic Eager Loading</a></h3>
<blockquote>
<p>[!WARNING]
This feature is currently in beta in order to gather community feedback. The behavior and functionality of this feature may change even on patch releases.</p>
</blockquote>
<p>In many cases, Laravel can automatically eager load the relationships you access. To enable automatic eager loading, you should invoke the <code>Model::automaticallyEagerLoadRelationships</code> method within the <code>boot</code> method of your application&#x27;s <code>AppServiceProvider</code>:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Model;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Model::automaticallyEagerLoadRelationships();
}
</code></pre>
<p>When this feature is enabled, Laravel will attempt to automatically load any relationships you access that have not been previously loaded. For example, consider the following scenario:</p>
<pre><code class="language-php">use App\Models\User;

$users = User::all();

foreach ($users as $user) {
    foreach ($user-&gt;posts as $post) {
        foreach ($post-&gt;comments as $comment) {
            echo $comment-&gt;content;
        }
    }
}
</code></pre>
<p>Typically, the code above would execute a query for each user in order to retrieve their posts, as well as a query for each post to retrieve its comments. However, when the <code>automaticallyEagerLoadRelationships</code> feature has been enabled, Laravel will automatically <a href="#lazy-eager-loading">lazy eager load</a> the posts for all users in the user collection when you attempt to access the posts on any of the retrieved users. Likewise, when you attempt to access the comments for any retrieved post, all comments will be lazy eager loaded for all posts that were originally retrieved.</p>
<p>If you do not want to globally enable automatic eager loading, you can still enable this feature for a single Eloquent collection instance by invoking the <code>withRelationshipAutoloading</code> method on the collection:</p>
<pre><code class="language-php">$users = User::where(&#x27;vip&#x27;, true)-&gt;get();

return $users-&gt;withRelationshipAutoloading();
</code></pre>
<a name="preventing-lazy-loading"></a>
<h3 id="preventing-lazy-loading"><a href="#preventing-lazy-loading">Preventing Lazy Loading</a></h3>
<p>As previously discussed, eager loading relationships can often provide significant performance benefits to your application. Therefore, if you would like, you may instruct Laravel to always prevent the lazy loading of relationships. To accomplish this, you may invoke the <code>preventLazyLoading</code> method offered by the base Eloquent model class. Typically, you should call this method within the <code>boot</code> method of your application&#x27;s <code>AppServiceProvider</code> class.</p>
<p>The <code>preventLazyLoading</code> method accepts an optional boolean argument that indicates if lazy loading should be prevented. For example, you may wish to only disable lazy loading in non-production environments so that your production environment will continue to function normally even if a lazy loaded relationship is accidentally present in production code:</p>
<pre><code class="language-php">use Illuminate\Database\Eloquent\Model;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Model::preventLazyLoading(! $this-&gt;app-&gt;isProduction());
}
</code></pre>
<p>After preventing lazy loading, Eloquent will throw a <code>Illuminate\Database\LazyLoadingViolationException</code> exception when your application attempts to lazy load any Eloquent relationship.</p>
<p>You may customize the behavior of lazy loading violations using the <code>handleLazyLoadingViolationsUsing</code> method. For example, using this method, you may instruct lazy loading violations to only be logged instead of interrupting the application&#x27;s execution with exceptions:</p>
<pre><code class="language-php">Model::handleLazyLoadingViolationUsing(function (Model $model, string $relation) {
    $class = $model::class;

    info(&quot;Attempted to lazy load [{$relation}] on model [{$class}].&quot;);
});
</code></pre>
<a name="inserting-and-updating-related-models"></a>
<h2 id="inserting-and-updating-related-models"><a href="#inserting-and-updating-related-models">Inserting and Updating Related Models</a></h2>
<a name="the-save-method"></a>
<h3 id="the-save-method"><a href="#the-save-method">The <code>save</code> Method</a></h3>
<p>Eloquent provides convenient methods for adding new models to relationships. For example, perhaps you need to add a new comment to a post. Instead of manually setting the <code>post_id</code> attribute on the <code>Comment</code> model you may insert the comment using the relationship&#x27;s <code>save</code> method:</p>
<pre><code class="language-php">use App\Models\Comment;
use App\Models\Post;

$comment = new Comment([&#x27;message&#x27; =&gt; &#x27;A new comment.&#x27;]);

$post = Post::find(1);

$post-&gt;comments()-&gt;save($comment);
</code></pre>
<p>Note that we did not access the <code>comments</code> relationship as a dynamic property. Instead, we called the <code>comments</code> method to obtain an instance of the relationship. The <code>save</code> method will automatically add the appropriate <code>post_id</code> value to the new <code>Comment</code> model.</p>
<p>If you need to save multiple related models, you may use the <code>saveMany</code> method:</p>
<pre><code class="language-php">$post = Post::find(1);

$post-&gt;comments()-&gt;saveMany([
    new Comment([&#x27;message&#x27; =&gt; &#x27;A new comment.&#x27;]),
    new Comment([&#x27;message&#x27; =&gt; &#x27;Another new comment.&#x27;]),
]);
</code></pre>
<p>The <code>save</code> and <code>saveMany</code> methods will persist the given model instances, but will not add the newly persisted models to any in-memory relationships that are already loaded onto the parent model. If you plan on accessing the relationship after using the <code>save</code> or <code>saveMany</code> methods, you may wish to use the <code>refresh</code> method to reload the model and its relationships:</p>
<pre><code class="language-php">$post-&gt;comments()-&gt;save($comment);

$post-&gt;refresh();

// All comments, including the newly saved comment...
$post-&gt;comments;
</code></pre>
<a name="the-push-method"></a>
<h4 id="recursively-saving-models-and-relationships"><a href="#recursively-saving-models-and-relationships">Recursively Saving Models and Relationships</a></h4>
<p>If you would like to <code>save</code> your model and all of its associated relationships, you may use the <code>push</code> method. In this example, the <code>Post</code> model will be saved as well as its comments and the comment&#x27;s authors:</p>
<pre><code class="language-php">$post = Post::find(1);

$post-&gt;comments[0]-&gt;message = &#x27;Message&#x27;;
$post-&gt;comments[0]-&gt;author-&gt;name = &#x27;Author Name&#x27;;

$post-&gt;push();
</code></pre>
<p>The <code>pushQuietly</code> method may be used to save a model and its associated relationships without raising any events:</p>
<pre><code class="language-php">$post-&gt;pushQuietly();
</code></pre>
<a name="the-create-method"></a>
<h3 id="the-create-method"><a href="#the-create-method">The <code>create</code> Method</a></h3>
<p>In addition to the <code>save</code> and <code>saveMany</code> methods, you may also use the <code>create</code> method, which accepts an array of attributes, creates a model, and inserts it into the database. The difference between <code>save</code> and <code>create</code> is that <code>save</code> accepts a full Eloquent model instance while <code>create</code> accepts a plain PHP <code>array</code>. The newly created model will be returned by the <code>create</code> method:</p>
<pre><code class="language-php">use App\Models\Post;

$post = Post::find(1);

$comment = $post-&gt;comments()-&gt;create([
    &#x27;message&#x27; =&gt; &#x27;A new comment.&#x27;,
]);
</code></pre>
<p>You may use the <code>createMany</code> method to create multiple related models:</p>
<pre><code class="language-php">$post = Post::find(1);

$post-&gt;comments()-&gt;createMany([
    [&#x27;message&#x27; =&gt; &#x27;A new comment.&#x27;],
    [&#x27;message&#x27; =&gt; &#x27;Another new comment.&#x27;],
]);
</code></pre>
<p>The <code>createQuietly</code> and <code>createManyQuietly</code> methods may be used to create a model(s) without dispatching any events:</p>
<pre><code class="language-php">$user = User::find(1);

$user-&gt;posts()-&gt;createQuietly([
    &#x27;title&#x27; =&gt; &#x27;Post title.&#x27;,
]);

$user-&gt;posts()-&gt;createManyQuietly([
    [&#x27;title&#x27; =&gt; &#x27;First post.&#x27;],
    [&#x27;title&#x27; =&gt; &#x27;Second post.&#x27;],
]);
</code></pre>
<p>You may also use the <code>findOrNew</code>, <code>firstOrNew</code>, <code>firstOrCreate</code>, and <code>updateOrCreate</code> methods to <a href="/docs/eloquent#upserts">create and update models on relationships</a>.</p>
<blockquote>
<p>[!NOTE]
Before using the <code>create</code> method, be sure to review the <a href="/docs/eloquent#mass-assignment">mass assignment</a> documentation.</p>
</blockquote>
<a name="updating-belongs-to-relationships"></a>
<h3 id="belongs-to-relationships"><a href="#belongs-to-relationships">Belongs To Relationships</a></h3>
<p>If you would like to assign a child model to a new parent model, you may use the <code>associate</code> method. In this example, the <code>User</code> model defines a <code>belongsTo</code> relationship to the <code>Account</code> model. This <code>associate</code> method will set the foreign key on the child model:</p>
<pre><code class="language-php">use App\Models\Account;

$account = Account::find(10);

$user-&gt;account()-&gt;associate($account);

$user-&gt;save();
</code></pre>
<p>To remove a parent model from a child model, you may use the <code>dissociate</code> method. This method will set the relationship&#x27;s foreign key to <code>null</code>:</p>
<pre><code class="language-php">$user-&gt;account()-&gt;dissociate();

$user-&gt;save();
</code></pre>
<a name="updating-many-to-many-relationships"></a>
<h3 id="many-to-many-relationships-1"><a href="#many-to-many-relationships-1">Many to Many Relationships</a></h3>
<a name="attaching-detaching"></a>
<h4 id="attaching--detaching"><a href="#attaching--detaching">Attaching / Detaching</a></h4>
<p>Eloquent also provides methods to make working with many-to-many relationships more convenient. For example, let&#x27;s imagine a user can have many roles and a role can have many users. You may use the <code>attach</code> method to attach a role to a user by inserting a record in the relationship&#x27;s intermediate table:</p>
<pre><code class="language-php">use App\Models\User;

$user = User::find(1);

$user-&gt;roles()-&gt;attach($roleId);
</code></pre>
<p>When attaching a relationship to a model, you may also pass an array of additional data to be inserted into the intermediate table:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;attach($roleId, [&#x27;expires&#x27; =&gt; $expires]);
</code></pre>
<p>Sometimes it may be necessary to remove a role from a user. To remove a many-to-many relationship record, use the <code>detach</code> method. The <code>detach</code> method will delete the appropriate record out of the intermediate table; however, both models will remain in the database:</p>
<pre><code class="language-php">// Detach a single role from the user...
$user-&gt;roles()-&gt;detach($roleId);

// Detach all roles from the user...
$user-&gt;roles()-&gt;detach();
</code></pre>
<p>For convenience, <code>attach</code> and <code>detach</code> also accept arrays of IDs as input:</p>
<pre><code class="language-php">$user = User::find(1);

$user-&gt;roles()-&gt;detach([1, 2, 3]);

$user-&gt;roles()-&gt;attach([
    1 =&gt; [&#x27;expires&#x27; =&gt; $expires],
    2 =&gt; [&#x27;expires&#x27; =&gt; $expires],
]);
</code></pre>
<a name="syncing-associations"></a>
<h4 id="syncing-associations"><a href="#syncing-associations">Syncing Associations</a></h4>
<p>You may also use the <code>sync</code> method to construct many-to-many associations. The <code>sync</code> method accepts an array of IDs to place on the intermediate table. Any IDs that are not in the given array will be removed from the intermediate table. So, after this operation is complete, only the IDs in the given array will exist in the intermediate table:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;sync([1, 2, 3]);
</code></pre>
<p>You may also pass additional intermediate table values with the IDs:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;sync([1 =&gt; [&#x27;expires&#x27; =&gt; true], 2, 3]);
</code></pre>
<p>If you would like to insert the same intermediate table values with each of the synced model IDs, you may use the <code>syncWithPivotValues</code> method:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;syncWithPivotValues([1, 2, 3], [&#x27;active&#x27; =&gt; true]);
</code></pre>
<p>If you do not want to detach existing IDs that are missing from the given array, you may use the <code>syncWithoutDetaching</code> method:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;syncWithoutDetaching([1, 2, 3]);
</code></pre>
<a name="toggling-associations"></a>
<h4 id="toggling-associations"><a href="#toggling-associations">Toggling Associations</a></h4>
<p>The many-to-many relationship also provides a <code>toggle</code> method which &quot;toggles&quot; the attachment status of the given related model IDs. If the given ID is currently attached, it will be detached. Likewise, if it is currently detached, it will be attached:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;toggle([1, 2, 3]);
</code></pre>
<p>You may also pass additional intermediate table values with the IDs:</p>
<pre><code class="language-php">$user-&gt;roles()-&gt;toggle([
    1 =&gt; [&#x27;expires&#x27; =&gt; true],
    2 =&gt; [&#x27;expires&#x27; =&gt; true],
]);
</code></pre>
<a name="updating-a-record-on-the-intermediate-table"></a>
<h4 id="updating-a-record-on-the-intermediate-table"><a href="#updating-a-record-on-the-intermediate-table">Updating a Record on the Intermediate Table</a></h4>
<p>If you need to update an existing row in your relationship&#x27;s intermediate table, you may use the <code>updateExistingPivot</code> method. This method accepts the intermediate record foreign key and an array of attributes to update:</p>
<pre><code class="language-php">$user = User::find(1);

$user-&gt;roles()-&gt;updateExistingPivot($roleId, [
    &#x27;active&#x27; =&gt; false,
]);
</code></pre>
<a name="touching-parent-timestamps"></a>
<h2 id="touching-parent-timestamps"><a href="#touching-parent-timestamps">Touching Parent Timestamps</a></h2>
<p>When a model defines a <code>belongsTo</code> or <code>belongsToMany</code> relationship to another model, such as a <code>Comment</code> which belongs to a <code>Post</code>, it is sometimes helpful to update the parent&#x27;s timestamp when the child model is updated.</p>
<p>For example, when a <code>Comment</code> model is updated, you may want to automatically &quot;touch&quot; the <code>updated_at</code> timestamp of the owning <code>Post</code> so that it is set to the current date and time. To accomplish this, you may add a <code>touches</code> property to your child model containing the names of the relationships that should have their <code>updated_at</code> timestamps updated when the child model is updated:</p>
<pre><code class="language-php">&lt;?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\BelongsTo;

class Comment extends Model
{
    /**
     * All of the relationships to be touched.
     *
     * @var array
     */
    protected $touches = [&#x27;post&#x27;];

    /**
     * Get the post that the comment belongs to.
     */
    public function post(): BelongsTo
    {
        return $this-&gt;belongsTo(Post::class);
    }
}
</code></pre>
<blockquote>
<p>[!WARNING]
Parent model timestamps will only be updated if the child model is updated using Eloquent&#x27;s <code>save</code> method.</p>
</blockquote></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/2b257daea29fbb42.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/ce232d23a2a15dcf.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"oT9fkv1Rls7posDurDqoH\",\"c\":[\"\",\"docs\",\"eloquent-relationships\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"eloquent-relationships\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/ce232d23a2a15dcf.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/2b257daea29fbb42.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"Eloquent Relationships\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-muted-foreground mt-2\",\"children\":\"Eloquent 關聯讓你輕鬆定義 model 之間的關聯\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"eloquent-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eloquent-relationships\",\"children\":\"Eloquent: Relationships\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#introduction\",\"children\":\"Introduction\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#defining-relationships\",\"children\":\"Defining Relationships\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one\",\"children\":\"One to One / Has One\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many\",\"children\":\"One to Many / Has Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many-inverse\",\"children\":\"One to Many (Inverse) / Belongs To\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#has-one-of-many\",\"children\":\"Has One of Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#has-one-through\",\"children\":\"Has One Through\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#has-many-through\",\"children\":\"Has Many Through\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#scoped-relationships\",\"children\":\"Scoped Relationships\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#many-to-many\",\"children\":\"Many to Many Relationships\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-intermediate-table-columns\",\"children\":\"Retrieving Intermediate Table Columns\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#filtering-queries-via-intermediate-table-columns\",\"children\":\"Filtering Queries via Intermediate Table Columns\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#ordering-queries-via-intermediate-table-columns\",\"children\":\"Ordering Queries via Intermediate Table Columns\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-custom-intermediate-table-models\",\"children\":\"Defining Custom Intermediate Table Models\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#polymorphic-relationships\",\"children\":\"Polymorphic Relationships\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one-polymorphic-relations\",\"children\":\"One to One\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many-polymorphic-relations\",\"children\":\"One to Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-of-many-polymorphic-relations\",\"children\":\"One of Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-polymorphic-relations\",\"children\":\"Many to Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#custom-polymorphic-types\",\"children\":\"Custom Polymorphic Types\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#dynamic-relationships\",\"children\":\"Dynamic Relationships\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#querying-relations\",\"children\":\"Querying Relations\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#relationship-methods-vs-dynamic-properties\",\"children\":\"Relationship Methods vs. Dynamic Properties\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-relationship-existence\",\"children\":\"Querying Relationship Existence\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-relationship-absence\",\"children\":\"Querying Relationship Absence\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-morph-to-relationships\",\"children\":\"Querying Morph To Relationships\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#aggregating-related-models\",\"children\":\"Aggregating Related Models\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#counting-related-models\",\"children\":\"Counting Related Models\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#other-aggregate-functions\",\"children\":\"Other Aggregate Functions\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#counting-related-models-on-morph-to-relationships\",\"children\":\"Counting Related Models on Morph To Relationships\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\"]}],\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\",\"\\n\",\"$L71\",\"\\n\",\"$L72\",\"\\n\",\"$L73\",\"\\n\",\"$L74\",\"\\n\",\"$L75\",\"\\n\",\"$L76\",\"\\n\",\"$L77\",\"\\n\",\"$L78\",\"\\n\",\"$L79\",\"\\n\",\"$L7a\",\"\\n\",\"$L7b\",\"\\n\",\"$L7c\",\"\\n\",\"$L7d\",\"\\n\",\"$L7e\",\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\",\"\\n\",\"$L82\",\"\\n\",\"$L83\",\"\\n\",\"$L84\",\"\\n\",\"$L85\",\"\\n\",\"$L86\",\"\\n\",\"$L87\",\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\",\"\\n\",\"$L91\",\"\\n\",\"$L92\",\"\\n\",\"$L93\",\"\\n\",\"$L94\",\"\\n\",\"$L95\",\"\\n\",\"$L96\",\"\\n\",\"$L97\",\"\\n\",\"$L98\",\"\\n\",\"$L99\",\"\\n\",\"$L9a\",\"\\n\",\"$L9b\",\"\\n\",\"$L9c\",\"\\n\",\"$L9d\",\"\\n\",\"$L9e\",\"\\n\",\"$L9f\",\"\\n\",\"$La0\",\"\\n\",\"$La1\",\"\\n\",\"$La2\",\"\\n\",\"$La3\",\"\\n\",\"$La4\",\"\\n\",\"$La5\",\"\\n\",\"$La6\",\"\\n\",\"$La7\",\"\\n\",\"$La8\",\"\\n\",\"$La9\",\"\\n\",\"$Laa\",\"\\n\",\"$Lab\",\"\\n\",\"$Lac\",\"\\n\",\"$Lad\",\"\\n\",\"$Lae\",\"\\n\",\"$Laf\",\"\\n\",\"$Lb0\",\"\\n\",\"$Lb1\",\"\\n\",\"$Lb2\",\"\\n\",\"$Lb3\",\"\\n\",\"$Lb4\",\"\\n\",\"$Lb5\",\"\\n\",\"$Lb6\",\"\\n\",\"$Lb7\",\"\\n\",\"$Lb8\",\"\\n\",\"$Lb9\",\"\\n\",\"$Lba\",\"\\n\",\"$Lbb\",\"\\n\",\"$Lbc\",\"\\n\",\"$Lbd\",\"\\n\",\"$Lbe\",\"\\n\",\"$Lbf\",\"\\n\",\"$Lc0\",\"\\n\",\"$Lc1\",\"\\n\",\"$Lc2\",\"\\n\",\"$Lc3\",\"\\n\",\"$Lc4\",\"\\n\",\"$Lc5\",\"\\n\",\"$Lc6\",\"\\n\",\"$Lc7\",\"\\n\",\"$Lc8\",\"\\n\",\"$Lc9\",\"\\n\",\"$Lca\",\"\\n\",\"$Lcb\",\"\\n\",\"$Lcc\",\"\\n\",\"$Lcd\",\"\\n\",\"$Lce\",\"\\n\",\"$Lcf\",\"\\n\",\"$Ld0\",\"\\n\",\"$Ld1\",\"\\n\",\"$Ld2\",\"\\n\",\"$Ld3\",\"\\n\",\"$Ld4\",\"\\n\",\"$Ld5\",\"\\n\",\"$Ld6\",\"\\n\",\"$Ld7\",\"\\n\",\"$Ld8\",\"\\n\",\"$Ld9\",\"\\n\",\"$Lda\",\"\\n\",\"$Ldb\",\"\\n\",\"$Ldc\",\"\\n\",\"$Ldd\",\"\\n\",\"$Lde\",\"\\n\",\"$Ldf\",\"\\n\",\"$Le0\",\"\\n\",\"$Le1\",\"\\n\",\"$Le2\",\"\\n\",\"$Le3\",\"\\n\",\"$Le4\",\"\\n\",\"$Le5\",\"\\n\",\"$Le6\",\"\\n\",\"$Le7\",\"\\n\",\"$Le8\",\"\\n\",\"$Le9\",\"\\n\",\"$Lea\",\"\\n\",\"$Leb\",\"\\n\",\"$Lec\",\"\\n\",\"$Led\",\"\\n\",\"$Lee\",\"\\n\",\"$Lef\",\"\\n\",\"$Lf0\",\"\\n\",\"$Lf1\",\"\\n\",\"$Lf2\",\"\\n\",\"$Lf3\",\"\\n\",\"$Lf4\",\"\\n\",\"$Lf5\",\"\\n\",\"$Lf6\",\"\\n\",\"$Lf7\",\"\\n\",\"$Lf8\",\"\\n\",\"$Lf9\",\"\\n\",\"$Lfa\",\"\\n\",\"$Lfb\",\"\\n\",\"$Lfc\",\"\\n\",\"$Lfd\",\"\\n\",\"$Lfe\",\"\\n\",\"$Lff\",\"\\n\",\"$L100\",\"\\n\",\"$L101\",\"\\n\",\"$L102\",\"\\n\",\"$L103\",\"\\n\",\"$L104\",\"\\n\",\"$L105\",\"\\n\",\"$L106\",\"\\n\",\"$L107\",\"\\n\",\"$L108\",\"\\n\",\"$L109\",\"\\n\",\"$L10a\",\"\\n\",\"$L10b\",\"\\n\",\"$L10c\",\"\\n\",\"$L10d\",\"\\n\",\"$L10e\",\"\\n\",\"$L10f\",\"\\n\",\"$L110\",\"\\n\",\"$L111\",\"\\n\",\"$L112\",\"\\n\",\"$L113\",\"\\n\",\"$L114\",\"\\n\",\"$L115\",\"\\n\",\"$L116\",\"\\n\",\"$L117\",\"\\n\",\"$L118\",\"\\n\",\"$L119\",\"\\n\",\"$L11a\",\"\\n\",\"$L11b\",\"\\n\",\"$L11c\",\"\\n\",\"$L11d\",\"\\n\",\"$L11e\",\"\\n\",\"$L11f\",\"\\n\",\"$L120\",\"\\n\",\"$L121\",\"\\n\",\"$L122\",\"\\n\",\"$L123\",\"\\n\",\"$L124\",\"\\n\",\"$L125\",\"\\n\",\"$L126\",\"\\n\",\"$L127\",\"\\n\",\"$L128\",\"\\n\",\"$L129\",\"\\n\",\"$L12a\",\"\\n\",\"$L12b\",\"\\n\",\"$L12c\",\"\\n\",\"$L12d\",\"\\n\",\"$L12e\",\"\\n\",\"$L12f\",\"\\n\",\"$L130\",\"\\n\",\"$L131\",\"\\n\",\"$L132\",\"\\n\",\"$L133\",\"\\n\",\"$L134\",\"\\n\",\"$L135\",\"\\n\",\"$L136\",\"\\n\",\"$L137\",\"\\n\",\"$L138\",\"\\n\",\"$L139\",\"\\n\",\"$L13a\",\"\\n\",\"$L13b\",\"\\n\",\"$L13c\",\"\\n\",\"$L13d\",\"\\n\",\"$L13e\",\"\\n\",\"$L13f\",\"\\n\",\"$L140\",\"\\n\",\"$L141\",\"\\n\",\"$L142\",\"\\n\",\"$L143\",\"\\n\",\"$L144\",\"\\n\",\"$L145\",\"\\n\",\"$L146\",\"\\n\",\"$L147\",\"\\n\",\"$L148\",\"\\n\",\"$L149\",\"\\n\",\"$L14a\",\"\\n\",\"$L14b\",\"\\n\",\"$L14c\",\"\\n\",\"$L14d\",\"\\n\",\"$L14e\",\"\\n\",\"$L14f\",\"\\n\",\"$L150\",\"\\n\",\"$L151\",\"\\n\",\"$L152\",\"\\n\",\"$L153\",\"\\n\",\"$L154\",\"\\n\",\"$L155\",\"\\n\",\"$L156\",\"\\n\",\"$L157\",\"\\n\",\"$L158\",\"\\n\",\"$L159\",\"\\n\",\"$L15a\",\"\\n\",\"$L15b\",\"\\n\",\"$L15c\",\"\\n\",\"$L15d\",\"\\n\",\"$L15e\",\"\\n\",\"$L15f\",\"\\n\",\"$L160\",\"\\n\",\"$L161\",\"\\n\",\"$L162\",\"\\n\",\"$L163\",\"\\n\",\"$L164\",\"\\n\",\"$L165\",\"\\n\",\"$L166\",\"\\n\",\"$L167\",\"\\n\",\"$L168\",\"\\n\",\"$L169\",\"\\n\",\"$L16a\",\"\\n\",\"$L16b\",\"\\n\",\"$L16c\",\"\\n\",\"$L16d\",\"\\n\",\"$L16e\",\"\\n\",\"$L16f\",\"\\n\",\"$L170\",\"\\n\",\"$L171\",\"\\n\",\"$L172\",\"\\n\",\"$L173\",\"\\n\",\"$L174\",\"\\n\",\"$L175\",\"\\n\",\"$L176\",\"\\n\",\"$L177\",\"\\n\",\"$L178\",\"\\n\",\"$L179\",\"\\n\",\"$L17a\",\"\\n\",\"$L17b\",\"\\n\",\"$L17c\",\"\\n\",\"$L17d\",\"\\n\",\"$L17e\",\"\\n\",\"$L17f\",\"\\n\",\"$L180\",\"\\n\",\"$L181\",\"\\n\",\"$L182\",\"\\n\",\"$L183\",\"\\n\",\"$L184\",\"\\n\",\"$L185\",\"\\n\",\"$L186\",\"\\n\",\"$L187\",\"\\n\",\"$L188\",\"\\n\",\"$L189\",\"\\n\",\"$L18a\",\"\\n\",\"$L18b\",\"\\n\",\"$L18c\",\"\\n\",\"$L18d\",\"\\n\",\"$L18e\",\"\\n\",\"$L18f\",\"\\n\",\"$L190\",\"\\n\",\"$L191\",\"\\n\",\"$L192\",\"\\n\",\"$L193\",\"\\n\",\"$L194\",\"\\n\",\"$L195\",\"\\n\",\"$L196\",\"\\n\",\"$L197\",\"\\n\",\"$L198\",\"\\n\",\"$L199\",\"\\n\",\"$L19a\",\"\\n\",\"$L19b\",\"\\n\",\"$L19c\",\"\\n\",\"$L19d\",\"\\n\",\"$L19e\",\"\\n\",\"$L19f\",\"\\n\",\"$L1a0\",\"\\n\",\"$L1a1\",\"\\n\",\"$L1a2\",\"\\n\",\"$L1a3\",\"\\n\",\"$L1a4\",\"\\n\",\"$L1a5\",\"\\n\",\"$L1a6\",\"\\n\",\"$L1a7\",\"\\n\",\"$L1a8\",\"\\n\",\"$L1a9\",\"\\n\",\"$L1aa\",\"\\n\",\"$L1ab\",\"\\n\",\"$L1ac\",\"\\n\",\"$L1ad\",\"\\n\",\"$L1ae\",\"\\n\",\"$L1af\",\"\\n\",\"$L1b0\",\"\\n\",\"$L1b1\",\"\\n\",\"$L1b2\",\"\\n\",\"$L1b3\",\"\\n\",\"$L1b4\",\"\\n\",\"$L1b5\",\"\\n\",\"$L1b6\",\"\\n\",\"$L1b7\",\"\\n\",\"$L1b8\",\"\\n\",\"$L1b9\",\"\\n\",\"$L1ba\",\"\\n\",\"$L1bb\",\"\\n\",\"$L1bc\",\"\\n\",\"$L1bd\",\"\\n\",\"$L1be\",\"\\n\",\"$L1bf\",\"\\n\",\"$L1c0\",\"\\n\",\"$L1c1\",\"\\n\",\"$L1c2\",\"\\n\",\"$L1c3\",\"\\n\",\"$L1c4\",\"\\n\",\"$L1c5\",\"\\n\",\"$L1c6\",\"\\n\",\"$L1c7\",\"\\n\",\"$L1c8\",\"\\n\",\"$L1c9\",\"\\n\",\"$L1ca\",\"\\n\",\"$L1cb\",\"\\n\",\"$L1cc\",\"\\n\",\"$L1cd\",\"\\n\",\"$L1ce\",\"\\n\",\"$L1cf\",\"\\n\",\"$L1d0\",\"\\n\",\"$L1d1\",\"\\n\",\"$L1d2\",\"\\n\",\"$L1d3\",\"\\n\",\"$L1d4\",\"\\n\",\"$L1d5\",\"\\n\",\"$L1d6\",\"\\n\",\"$L1d7\",\"\\n\",\"$L1d8\",\"\\n\",\"$L1d9\",\"\\n\",\"$L1da\",\"\\n\",\"$L1db\",\"\\n\",\"$L1dc\",\"\\n\",\"$L1dd\",\"\\n\",\"$L1de\",\"\\n\",\"$L1df\",\"\\n\",\"$L1e0\",\"\\n\",\"$L1e1\",\"\\n\",\"$L1e2\",\"\\n\",\"$L1e3\",\"\\n\",\"$L1e4\",\"\\n\",\"$L1e5\",\"\\n\",\"$L1e6\",\"\\n\",\"$L1e7\",\"\\n\",\"$L1e8\",\"\\n\",\"$L1e9\",\"\\n\",\"$L1ea\",\"\\n\",\"$L1eb\",\"\\n\",\"$L1ec\",\"\\n\",\"$L1ed\",\"\\n\",\"$L1ee\",\"\\n\",\"$L1ef\",\"\\n\",\"$L1f0\",\"\\n\",\"$L1f1\",\"\\n\",\"$L1f2\",\"\\n\",\"$L1f3\",\"\\n\",\"$L1f4\",\"\\n\",\"$L1f5\",\"\\n\",\"$L1f6\",\"\\n\",\"$L1f7\",\"\\n\",\"$L1f8\",\"\\n\",\"$L1f9\",\"\\n\",\"$L1fa\",\"\\n\",\"$L1fb\",\"\\n\",\"$L1fc\",\"\\n\",\"$L1fd\",\"\\n\",\"$L1fe\",\"\\n\",\"$L1ff\",\"\\n\",\"$L200\",\"\\n\",\"$L201\",\"\\n\",\"$L202\",\"\\n\",\"$L203\",\"\\n\",\"$L204\",\"\\n\",\"$L205\",\"\\n\",\"$L206\",\"\\n\",\"$L207\",\"\\n\",\"$L208\",\"\\n\",\"$L209\",\"\\n\",\"$L20a\",\"\\n\",\"$L20b\",\"\\n\",\"$L20c\",\"\\n\",\"$L20d\",\"\\n\",\"$L20e\",\"\\n\",\"$L20f\",\"\\n\",\"$L210\",\"\\n\",\"$L211\",\"\\n\",\"$L212\",\"\\n\",\"$L213\",\"\\n\",\"$L214\",\"\\n\",\"$L215\",\"\\n\",\"$L216\",\"\\n\",\"$L217\",\"\\n\",\"$L218\",\"\\n\",\"$L219\",\"\\n\",\"$L21a\",\"\\n\",\"$L21b\",\"\\n\",\"$L21c\",\"\\n\",\"$L21d\",\"\\n\",\"$L21e\",\"\\n\",\"$L21f\",\"\\n\",\"$L220\",\"\\n\",\"$L221\",\"\\n\",\"$L222\",\"\\n\",\"$L223\",\"\\n\",\"$L224\",\"\\n\",\"$L225\",\"\\n\",\"$L226\",\"\\n\",\"$L227\",\"\\n\",\"$L228\",\"\\n\",\"$L229\",\"\\n\",\"$L22a\",\"\\n\",\"$L22b\",\"\\n\",\"$L22c\",\"\\n\",\"$L22d\",\"\\n\",\"$L22e\",\"\\n\",\"$L22f\",\"\\n\",\"$L230\",\"\\n\",\"$L231\",\"\\n\",\"$L232\",\"\\n\",\"$L233\",\"\\n\",\"$L234\",\"\\n\",\"$L235\",\"\\n\",\"$L236\",\"\\n\",\"$L237\",\"\\n\",\"$L238\",\"\\n\",\"$L239\",\"\\n\",\"$L23a\",\"\\n\",\"$L23b\",\"\\n\",\"$L23c\",\"\\n\",\"$L23d\",\"\\n\",\"$L23e\",\"\\n\",\"$L23f\",\"\\n\",\"$L240\",\"\\n\",\"$L241\",\"\\n\",\"$L242\",\"\\n\",\"$L243\",\"\\n\",\"$L244\",\"\\n\",\"$L245\",\"\\n\",\"$L246\",\"\\n\",\"$L247\",\"\\n\",\"$L248\",\"\\n\",\"$L249\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#eager-loading\",\"children\":\"Eager Loading\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#constraining-eager-loads\",\"children\":\"Constraining Eager Loads\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#lazy-eager-loading\",\"children\":\"Lazy Eager Loading\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#automatic-eager-loading\",\"children\":\"Automatic Eager Loading\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#preventing-lazy-loading\",\"children\":\"Preventing Lazy Loading\"}]}],\"\\n\"]}],\"\\n\"]}]\nf:[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#inserting-and-updating-related-models\",\"children\":\"Inserting and Updating Related Models\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#the-save-method\",\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" Method\"]}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#the-create-method\",\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" Method\"]}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#updating-belongs-to-relationships\",\"children\":\"Belongs To Relationships\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#updating-many-to-many-relationships\",\"children\":\"Many to Many Relationships\"}]}],\"\\n\"]}],\"\\n\"]}]\n10:[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#touching-parent-timestamps\",\"children\":\"Touching Parent Timestamps\"}]}]\n11:[\"$\",\"a\",null,{\"name\":\"introduction\"}]\n12:[\"$\",\"h2\",null,{\"id\":\"簡介\",\"children\":[\"$\",\"a\",null,{\"href\":\"#簡介\",\"children\":\"簡介\"}]}]\n13:[\"$\",\"p\",null,{\"children\":\"Database tables are often related to one another. For example, a blog post may have many comments or an order could be related to the user who placed it. Eloquent makes managing and working with these relationships easy, and supports a variety of common relationships:\"}]\n14:[\"$\",\"div\",null,{\"className\":\"content-list\",\"markdown\":\"1\",\"children\":[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one\",\"children\":\"One To One\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many\",\"children\":\"One To Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many\",\"children\":\"Many To Many\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#has-one-through\",\"children\":\"Has One Through\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#has-many-through\",\"children\":\"Has Many Through\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one-polymorphic-relations\",\"children\":\"One To One (Polymorphic)\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many-polymorphic-relations\",\"children\":\"One To Many (Polymorphic)\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-polymorphic-relations\",\"children\":\"Many To Many (Polymorphic)\"}]}],\"\\n\"]}]}]\n15:[\"$\",\"a\",null,{\"name\":\"defining-relationships\"}]\n16:[\"$\",\"h2\",null,{\"id\":\"defining-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-relationships\",\"children\":\"Defining Relationships\"}]}]\n17:[\"$\",\"p\",null,{\"children\":[\"Eloquent relationships are defined as methods on your Eloquent model classes. Since relationships also serve as powerful \",[\"$\",\"a\",null,{\"href\":\"/docs/queries\",\"children\":\"query builders\"}],\", defining relationships as methods provides powerful method chaining and querying capabilities. For example, we may chain additional query constraints on this \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" relationship:\"]}]\n18:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eposts()-\u003ewhere('active', 1)-\u003eget();\\n\"}]}]\n19:[\"$\",\"p\",null,{\"children\":\"But, before diving too deep into using relationships, let's learn how to define each type of relationship supported by Eloquent.\"}]\n1a:[\"$\",\"a\",null,{\"name\":\"one-to-one\"}]\n1b:[\"$\",\"h3\",null,{\"id\":\"one-to-one--has-one\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one--has-one\",\"children\":\"One to One / Has One"])</script><script>self.__next_f.push([1,"\"}]}]\n1c:[\"$\",\"p\",null,{\"children\":[\"A one-to-one relationship is a very basic type of database relationship. For example, a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model might be associated with one \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model. To define this relationship, we will place a \",[\"$\",\"code\",null,{\"children\":\"phone\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model. The \",[\"$\",\"code\",null,{\"children\":\"phone\"}],\" method should call the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method and return its result. The \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method is available to your model via the model's \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\Eloquent\\\\Model\"}],\" base class:\"]}]\n1d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasOne;\\n\\nclass User extends Model\\n{\\n    /**\\n     * Get the phone associated with the user.\\n     */\\n    public function phone(): HasOne\\n    {\\n        return $this-\u003ehasOne(Phone::class);\\n    }\\n}\\n\"}]}]\n1e:[\"$\",\"p\",null,{\"children\":[\"The first argument passed to the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method is the name of the related model class. Once the relationship is defined, we may retrieve the related record using Eloquent's dynamic properties. Dynamic properties allow you to access relationship methods as if they were properties defined on the model:\"]}]\n1f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$phone = User::find(1)-\u003ephone;\\n\"}]}]\n20:[\"$\",\"p\",null,{\"children\":[\"Eloquent determines the foreign key of the relationship based on the parent model name. In this case, the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model is automatically assumed to have a \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" foreign key. If you wish to override this convention, you may pass a second argument to the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method:\"]}]\n21:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ehasOne(Phone::class, 'foreign_key');\\n\"}]}]\n22:[\"$\",\"p\",null,{\"children\":[\"Additionally, Eloquent assumes that the foreign key should have a value matching the primary key column of the parent. In other words, Eloquent will look for the value of the user's \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" column in the \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" column of the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" record. If you would like the relationship to use a primary key value other than \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" or your model's \",[\"$\",\"code\",null,{\"children\":\"$$primaryKey\"}],\" property, you may pass a third argument to the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method:\"]}]\n23:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ehasOne(Phone::class, 'foreign_key', 'local_key');\\n\"}]}]\n24:[\"$\",\"a\",null,{\"name\":\"one-to-one-defining-the-inverse-of-the-relationship\"}]\n25:[\"$\",\"h4\",null,{\"id\":\"defining-the-inverse-of-the-relationship\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-the-inverse-of-the-relationship\",\"children\":\"Defining the Inverse of the Relationship\"}]}]\n26:[\"$\",\"p\",null,{\"children\":[\"So, we can access the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model from our \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model. Next, let's define a relationship on the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model that will let us access the user that owns the phone. We can define the inverse of a \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" relationship using the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method:\"]}]\n27:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsTo;\\n\\nclass Phone extends Model\\n{\\n    /**\\n     * Get the user that owns the phone.\\n   "])</script><script>self.__next_f.push([1,"  */\\n    public function user(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(User::class);\\n    }\\n}\\n\"}]}]\n28:[\"$\",\"p\",null,{\"children\":[\"When invoking the \",[\"$\",\"code\",null,{\"children\":\"user\"}],\" method, Eloquent will attempt to find a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model that has an \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" which matches the \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" column on the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model.\"]}]\n29:[\"$\",\"p\",null,{\"children\":[\"Eloquent determines the foreign key name by examining the name of the relationship method and suffixing the method name with \",[\"$\",\"code\",null,{\"children\":\"_id\"}],\". So, in this case, Eloquent assumes that the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model has a \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" column. However, if the foreign key on the \",[\"$\",\"code\",null,{\"children\":\"Phone\"}],\" model is not \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\", you may pass a custom key name as the second argument to the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method:\"]}]\n2a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user that owns the phone.\\n */\\npublic function user(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(User::class, 'foreign_key');\\n}\\n\"}]}]\n2b:[\"$\",\"p\",null,{\"children\":[\"If the parent model does not use \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" as its primary key, or you wish to find the associated model using a different column, you may pass a third argument to the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method specifying the parent table's custom key:\"]}]\n2c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user that owns the phone.\\n */\\npublic function user(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(User::class, 'foreign_key', 'owner_key');\\n}\\n\"}]}]\n2d:[\"$\",\"a\",null,{\"name\":\"one-to-many\"}]\n2e:[\"$\",\"h3\",null,{\"id\":\"one-to-many--has-many\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many--has-many\",\"children\":\"One to Many / Has Many\"}]}]\n2f:[\"$\",\"p\",null,{\"children\":\"A one-to-many relationship is used to define relationships where a single model is the parent to one or more child models. For example, a blog post may have an infinite number of comments. Like all other Eloquent relationships, one-to-many relationships are defined by defining a method on your Eloquent model:\"}]\n30:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasMany;\\n\\nclass Post extends Model\\n{\\n    /**\\n     * Get the comments for the blog post.\\n     */\\n    public function comments(): HasMany\\n    {\\n        return $this-\u003ehasMany(Comment::class);\\n    }\\n}\\n\"}]}]\n31:[\"$\",\"p\",null,{\"children\":[\"Remember, Eloquent will automatically determine the proper foreign key column for the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model. By convention, Eloquent will take the \\\"snake case\\\" name of the parent model and suffix it with \",[\"$\",\"code\",null,{\"children\":\"_id\"}],\". So, in this example, Eloquent will assume the foreign key column on the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model is \",[\"$\",\"code\",null,{\"children\":\"post_id\"}],\".\"]}]\n32:[\"$\",\"p\",null,{\"children\":[\"Once the relationship method has been defined, we can access the \",[\"$\",\"a\",null,{\"href\":\"/docs/eloquent-collections\",\"children\":\"collection\"}],\" of related comments by accessing the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" property. Remember, since Eloquent provides \\\"dynamic relationship properties\\\", we can access relationship methods as if they were defined as properties on the model:\"]}]\n33:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$comments = Post::find(1)-\u003ecomments;\\n\\nforeach ($comments as $comment) {\\n    // ...\\n}\\n\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"Since all relationships also serve as query builders, you may add furthe"])</script><script>self.__next_f.push([1,"r constraints to the relationship query by calling the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" method and continuing to chain conditions onto the query:\"]}]\n35:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$comment = Post::find(1)-\u003ecomments()\\n    -\u003ewhere('title', 'foo')\\n    -\u003efirst();\\n\"}]}]\n36:[\"$\",\"p\",null,{\"children\":[\"Like the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" method, you may also override the foreign and local keys by passing additional arguments to the \",[\"$\",\"code\",null,{\"children\":\"hasMany\"}],\" method:\"]}]\n37:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ehasMany(Comment::class, 'foreign_key');\\n\\nreturn $this-\u003ehasMany(Comment::class, 'foreign_key', 'local_key');\\n\"}]}]\n38:[\"$\",\"a\",null,{\"name\":\"automatically-hydrating-parent-models-on-children\"}]\n39:[\"$\",\"h4\",null,{\"id\":\"automatically-hydrating-parent-models-on-children\",\"children\":[\"$\",\"a\",null,{\"href\":\"#automatically-hydrating-parent-models-on-children\",\"children\":\"Automatically Hydrating Parent Models on Children\"}]}]\n3a:[\"$\",\"p\",null,{\"children\":\"Even when utilizing Eloquent eager loading, \\\"N + 1\\\" query problems can arise if you try to access the parent model from a child model while looping through the child models:\"}]\n3b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::with('comments')-\u003eget();\\n\\nforeach ($posts as $post) {\\n    foreach ($post-\u003ecomments as $comment) {\\n        echo $comment-\u003epost-\u003etitle;\\n    }\\n}\\n\"}]}]\n3c:[\"$\",\"p\",null,{\"children\":[\"In the example above, an \\\"N + 1\\\" query problem has been introduced because, even though comments were eager loaded for every \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model, Eloquent does not automatically hydrate the parent \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" on each child \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model.\"]}]\n3d:[\"$\",\"p\",null,{\"children\":[\"If you would like Eloquent to automatically hydrate parent models onto their children, you may invoke the \",[\"$\",\"code\",null,{\"children\":\"chaperone\"}],\" method when defining a \",[\"$\",\"code\",null,{\"children\":\"hasMany\"}],\" relationship:\"]}]\n3e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasMany;\\n\\nclass Post extends Model\\n{\\n    /**\\n     * Get the comments for the blog post.\\n     */\\n    public function comments(): HasMany\\n    {\\n        return $this-\u003ehasMany(Comment::class)-\u003echaperone();\\n    }\\n}\\n\"}]}]\n3f:[\"$\",\"p\",null,{\"children\":[\"Or, if you would like to opt-in to automatic parent hydration at run time, you may invoke the \",[\"$\",\"code\",null,{\"children\":\"chaperone\"}],\" model when eager loading the relationship:\"]}]\n40:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::with([\\n    'comments' =\u003e fn ($comments) =\u003e $comments-\u003echaperone(),\\n])-\u003eget();\\n\"}]}]\n41:[\"$\",\"a\",null,{\"name\":\"one-to-many-inverse\"}]\n42:[\"$\",\"h3\",null,{\"id\":\"one-to-many-inverse--belongs-to\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many-inverse--belongs-to\",\"children\":\"One to Many (Inverse) / Belongs To\"}]}]\n43:[\"$\",\"p\",null,{\"children\":[\"Now that we can access all of a post's comments, let's define a relationship to allow a comment to access its parent post. To define the inverse of a \",[\"$\",\"code\",null,{\"children\":\"hasMany\"}],\" relationship, define a relationship method on the child model which calls the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method:\"]}]\n44:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsTo;\\n\\nclass Comment extends Model\\n{\\n    /**\\n     * Get the post that owns the comment.\\n     */\\n    public function post(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(Post::class);\\n "])</script><script>self.__next_f.push([1,"   }\\n}\\n\"}]}]\n45:[\"$\",\"p\",null,{\"children\":[\"Once the relationship has been defined, we can retrieve a comment's parent post by accessing the \",[\"$\",\"code\",null,{\"children\":\"post\"}],\" \\\"dynamic relationship property\\\":\"]}]\n46:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Comment;\\n\\n$comment = Comment::find(1);\\n\\nreturn $comment-\u003epost-\u003etitle;\\n\"}]}]\n47:[\"$\",\"p\",null,{\"children\":[\"In the example above, Eloquent will attempt to find a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model that has an \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" which matches the \",[\"$\",\"code\",null,{\"children\":\"post_id\"}],\" column on the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model.\"]}]\n48:[\"$\",\"p\",null,{\"children\":[\"Eloquent determines the default foreign key name by examining the name of the relationship method and suffixing the method name with a \",[\"$\",\"code\",null,{\"children\":\"_\"}],\" followed by the name of the parent model's primary key column. So, in this example, Eloquent will assume the \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model's foreign key on the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" table is \",[\"$\",\"code\",null,{\"children\":\"post_id\"}],\".\"]}]\n49:[\"$\",\"p\",null,{\"children\":[\"However, if the foreign key for your relationship does not follow these conventions, you may pass a custom foreign key name as the second argument to the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method:\"]}]\n4a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the post that owns the comment.\\n */\\npublic function post(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(Post::class, 'foreign_key');\\n}\\n\"}]}]\n4b:[\"$\",\"p\",null,{\"children\":[\"If your parent model does not use \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" as its primary key, or you wish to find the associated model using a different column, you may pass a third argument to the \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" method specifying your parent table's custom key:\"]}]\n4c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the post that owns the comment.\\n */\\npublic function post(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(Post::class, 'foreign_key', 'owner_key');\\n}\\n\"}]}]\n4d:[\"$\",\"a\",null,{\"name\":\"default-models\"}]\n4e:[\"$\",\"h4\",null,{\"id\":\"default-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#default-models\",\"children\":\"Default Models\"}]}]\n4f:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\", \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\", \",[\"$\",\"code\",null,{\"children\":\"hasOneThrough\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"morphOne\"}],\" relationships allow you to define a default model that will be returned if the given relationship is \",[\"$\",\"code\",null,{\"children\":\"null\"}],\". This pattern is often referred to as the \",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Null_Object_pattern\",\"children\":\"Null Object pattern\"}],\" and can help remove conditional checks in your code. In the following example, the \",[\"$\",\"code\",null,{\"children\":\"user\"}],\" relation will return an empty \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" model if no user is attached to the \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model:\"]}]\n50:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the author of the post.\\n */\\npublic function user(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(User::class)-\u003ewithDefault();\\n}\\n\"}]}]\n51:[\"$\",\"p\",null,{\"children\":[\"To populate the default model with attributes, you may pass an array or closure to the \",[\"$\",\"code\",null,{\"children\":\"withDefault\"}],\" method:\"]}]\n52:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the author of the post.\\n */\\npublic function user(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(User::class)-\u003ewithDefault([\\n        'name' =\u003e 'Guest Author',\\n    ]);\\n}\\n\\n/**\\n * Get the author of the post.\\n */\\npublic function user(): BelongsTo\\n{\\n    return $this-\u003ebelongsTo(User::class)-\u003ewi"])</script><script>self.__next_f.push([1,"thDefault(function (User $user, Post $post) {\\n        $user-\u003ename = 'Guest Author';\\n    });\\n}\\n\"}]}]\n53:[\"$\",\"a\",null,{\"name\":\"querying-belongs-to-relationships\"}]\n54:[\"$\",\"h4\",null,{\"id\":\"querying-belongs-to-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-belongs-to-relationships\",\"children\":\"Querying Belongs To Relationships\"}]}]\n55:[\"$\",\"p\",null,{\"children\":[\"When querying for the children of a \\\"belongs to\\\" relationship, you may manually build the \",[\"$\",\"code\",null,{\"children\":\"where\"}],\" clause to retrieve the corresponding Eloquent models:\"]}]\n56:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::where('user_id', $user-\u003eid)-\u003eget();\\n\"}]}]\n57:[\"$\",\"p\",null,{\"children\":[\"However, you may find it more convenient to use the \",[\"$\",\"code\",null,{\"children\":\"whereBelongsTo\"}],\" method, which will automatically determine the proper relationship and foreign key for the given model:\"]}]\n58:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::whereBelongsTo($user)-\u003eget();\\n\"}]}]\n59:[\"$\",\"p\",null,{\"children\":[\"You may also provide a \",[\"$\",\"a\",null,{\"href\":\"/docs/eloquent-collections\",\"children\":\"collection\"}],\" instance to the \",[\"$\",\"code\",null,{\"children\":\"whereBelongsTo\"}],\" method. When doing so, Laravel will retrieve models that belong to any of the parent models within the collection:\"]}]\n5a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$users = User::where('vip', true)-\u003eget();\\n\\n$posts = Post::whereBelongsTo($users)-\u003eget();\\n\"}]}]\n5b:[\"$\",\"p\",null,{\"children\":[\"By default, Laravel will determine the relationship associated with the given model based on the class name of the model; however, you may specify the relationship name manually by providing it as the second argument to the \",[\"$\",\"code\",null,{\"children\":\"whereBelongsTo\"}],\" method:\"]}]\n5c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::whereBelongsTo($user, 'author')-\u003eget();\\n\"}]}]\n5d:[\"$\",\"a\",null,{\"name\":\"has-one-of-many\"}]\n5e:[\"$\",\"h3\",null,{\"id\":\"has-one-of-many\",\"children\":[\"$\",\"a\",null,{\"href\":\"#has-one-of-many\",\"children\":\"Has One of Many\"}]}]\n5f:[\"$\",\"p\",null,{\"children\":[\"Sometimes a model may have many related models, yet you want to easily retrieve the \\\"latest\\\" or \\\"oldest\\\" related model of the relationship. For example, a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model may be related to many \",[\"$\",\"code\",null,{\"children\":\"Order\"}],\" models, but you want to define a convenient way to interact with the most recent order the user has placed. You may accomplish this using the \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" relationship type combined with the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" methods:\"]}]\n60:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's most recent order.\\n */\\npublic function latestOrder(): HasOne\\n{\\n    return $this-\u003ehasOne(Order::class)-\u003elatestOfMany();\\n}\\n\"}]}]\n61:[\"$\",\"p\",null,{\"children\":\"Likewise, you may define a method to retrieve the \\\"oldest\\\", or first, related model of a relationship:\"}]\n62:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's oldest order.\\n */\\npublic function oldestOrder(): HasOne\\n{\\n    return $this-\u003ehasOne(Order::class)-\u003eoldestOfMany();\\n}\\n\"}]}]\n63:[\"$\",\"p\",null,{\"children\":[\"By default, the \",[\"$\",\"code\",null,{\"children\":\"latestOfMany\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"oldestOfMany\"}],\" methods will retrieve the latest or oldest related model based on the model's primary key, which must be sortable. However, sometimes you may wish to retrieve a single model from a larger relationship using a different sorting criteria.\"]}]\n64:[\"$\",\"p\",null,{\"children\":[\"For example, using the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method, you may retrieve the user's most expensive order. The \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method accepts th"])</script><script>self.__next_f.push([1,"e sortable column as its first argument and which aggregate function (\",[\"$\",\"code\",null,{\"children\":\"min\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"max\"}],\") to apply when querying for the related model:\"]}]\n65:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's largest order.\\n */\\npublic function largestOrder(): HasOne\\n{\\n    return $this-\u003ehasOne(Order::class)-\u003eofMany('price', 'max');\\n}\\n\"}]}]\n66:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nBecause PostgreSQL does not support executing the \",[\"$\",\"code\",null,{\"children\":\"MAX\"}],\" function against UUID columns, it is not currently possible to use one-of-many relationships in combination with PostgreSQL UUID columns.\"]}],\"\\n\"]}]\n67:[\"$\",\"a\",null,{\"name\":\"converting-many-relationships-to-has-one-relationships\"}]\n68:[\"$\",\"h4\",null,{\"id\":\"converting-many-relationships-to-has-one-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#converting-many-relationships-to-has-one-relationships\",\"children\":\"Converting \\\"Many\\\" Relationships to Has One Relationships\"}]}]\n69:[\"$\",\"p\",null,{\"children\":[\"Often, when retrieving a single model using the \",[\"$\",\"code\",null,{\"children\":\"latestOfMany\"}],\", \",[\"$\",\"code\",null,{\"children\":\"oldestOfMany\"}],\", or \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" methods, you already have a \\\"has many\\\" relationship defined for the same model. For convenience, Laravel allows you to easily convert this relationship into a \\\"has one\\\" relationship by invoking the \",[\"$\",\"code\",null,{\"children\":\"one\"}],\" method on the relationship:\"]}]\n6a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's orders.\\n */\\npublic function orders(): HasMany\\n{\\n    return $this-\u003ehasMany(Order::class);\\n}\\n\\n/**\\n * Get the user's largest order.\\n */\\npublic function largestOrder(): HasOne\\n{\\n    return $this-\u003eorders()-\u003eone()-\u003eofMany('price', 'max');\\n}\\n\"}]}]\n6b:[\"$\",\"p\",null,{\"children\":[\"You may also use the \",[\"$\",\"code\",null,{\"children\":\"one\"}],\" method to convert \",[\"$\",\"code\",null,{\"children\":\"HasManyThrough\"}],\" relationships to \",[\"$\",\"code\",null,{\"children\":\"HasOneThrough\"}],\" relationships:\"]}]\n6c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"public function latestDeployment(): HasOneThrough\\n{\\n    return $this-\u003edeployments()-\u003eone()-\u003elatestOfMany();\\n}\\n\"}]}]\n6d:[\"$\",\"a\",null,{\"name\":\"advanced-has-one-of-many-relationships\"}]\n6e:[\"$\",\"h4\",null,{\"id\":\"advanced-has-one-of-many-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#advanced-has-one-of-many-relationships\",\"children\":\"Advanced Has One of Many Relationships\"}]}]\n6f:[\"$\",\"p\",null,{\"children\":[\"It is possible to construct more advanced \\\"has one of many\\\" relationships. For example, a \",[\"$\",\"code\",null,{\"children\":\"Product\"}],\" model may have many associated \",[\"$\",\"code\",null,{\"children\":\"Price\"}],\" models that are retained in the system even after new pricing is published. In addition, new pricing data for the product may be able to be published in advance to take effect at a future date via a \",[\"$\",\"code\",null,{\"children\":\"published_at\"}],\" column.\"]}]\n70:[\"$\",\"p\",null,{\"children\":[\"So, in summary, we need to retrieve the latest published pricing where the published date is not in the future. In addition, if two prices have the same published date, we will prefer the price with the greatest ID. To accomplish this, we must pass an array to the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method that contains the sortable columns which determine the latest price. In addition, a closure will be provided as the second argument to the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method. This closure will be responsible for adding additional publish date constraints to the relationship query:\"]}]\n71:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the current pricing for the product.\\n */\\npublic function currentPricing(): HasOne\\n{\\n    return $this-\u003ehasOne(Price::class)-\u003eofMany([\\n   "])</script><script>self.__next_f.push([1,"     'published_at' =\u003e 'max',\\n        'id' =\u003e 'max',\\n    ], function (Builder $query) {\\n        $query-\u003ewhere('published_at', '\u003c', now());\\n    });\\n}\\n\"}]}]\n72:[\"$\",\"a\",null,{\"name\":\"has-one-through\"}]\n73:[\"$\",\"h3\",null,{\"id\":\"has-one-through\",\"children\":[\"$\",\"a\",null,{\"href\":\"#has-one-through\",\"children\":\"Has One Through\"}]}]\n74:[\"$\",\"p\",null,{\"children\":[\"The \\\"has-one-through\\\" relationship defines a one-to-one relationship with another model. However, this relationship indicates that the declaring model can be matched with one instance of another model by proceeding \",[\"$\",\"em\",null,{\"children\":\"through\"}],\" a third model.\"]}]\n75:[\"$\",\"p\",null,{\"children\":[\"For example, in a vehicle repair shop application, each \",[\"$\",\"code\",null,{\"children\":\"Mechanic\"}],\" model may be associated with one \",[\"$\",\"code\",null,{\"children\":\"Car\"}],\" model, and each \",[\"$\",\"code\",null,{\"children\":\"Car\"}],\" model may be associated with one \",[\"$\",\"code\",null,{\"children\":\"Owner\"}],\" model. While the mechanic and the owner have no direct relationship within the database, the mechanic can access the owner \",[\"$\",\"em\",null,{\"children\":\"through\"}],\" the \",[\"$\",\"code\",null,{\"children\":\"Car\"}],\" model. Let's look at the tables necessary to define this relationship:\"]}]\n76:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"mechanics\\n    id - integer\\n    name - string\\n\\ncars\\n    id - integer\\n    model - string\\n    mechanic_id - integer\\n\\nowners\\n    id - integer\\n    name - string\\n    car_id - integer\\n\"}]}]\n77:[\"$\",\"p\",null,{\"children\":[\"Now that we have examined the table structure for the relationship, let's define the relationship on the \",[\"$\",\"code\",null,{\"children\":\"Mechanic\"}],\" model:\"]}]\n78:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasOneThrough;\\n\\nclass Mechanic extends Model\\n{\\n    /**\\n     * Get the car's owner.\\n     */\\n    public function carOwner(): HasOneThrough\\n    {\\n        return $this-\u003ehasOneThrough(Owner::class, Car::class);\\n    }\\n}\\n\"}]}]\n79:[\"$\",\"p\",null,{\"children\":[\"The first argument passed to the \",[\"$\",\"code\",null,{\"children\":\"hasOneThrough\"}],\" method is the name of the final model we wish to access, while the second argument is the name of the intermediate model.\"]}]\n7a:[\"$\",\"p\",null,{\"children\":[\"Or, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a \\\"has-one-through\\\" relationship by invoking the \",[\"$\",\"code\",null,{\"children\":\"through\"}],\" method and supplying the names of those relationships. For example, if the \",[\"$\",\"code\",null,{\"children\":\"Mechanic\"}],\" model has a \",[\"$\",\"code\",null,{\"children\":\"cars\"}],\" relationship and the \",[\"$\",\"code\",null,{\"children\":\"Car\"}],\" model has an \",[\"$\",\"code\",null,{\"children\":\"owner\"}],\" relationship, you may define a \\\"has-one-through\\\" relationship connecting the mechanic and the owner like so:\"]}]\n7b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// String based syntax...\\nreturn $this-\u003ethrough('cars')-\u003ehas('owner');\\n\\n// Dynamic syntax...\\nreturn $this-\u003ethroughCars()-\u003ehasOwner();\\n\"}]}]\n7c:[\"$\",\"a\",null,{\"name\":\"has-one-through-key-conventions\"}]\n7d:[\"$\",\"h4\",null,{\"id\":\"key-conventions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#key-conventions\",\"children\":\"Key Conventions\"}]}]\n7e:[\"$\",\"p\",null,{\"children\":[\"Typical Eloquent foreign key conventions will be used when performing the relationship's queries. If you would like to customize the keys of the relationship, you may pass them as the third and fourth arguments to the \",[\"$\",\"code\",null,{\"children\":\"hasOneThrough\"}],\" method. The third argument is the name of the foreign key on the intermediate model. The fourth argument is the name of the foreign key on the final model. The fifth argument is the local key, while the sixth argument is the local key of the intermediate model:\"]}]\n7f:[\""])</script><script>self.__next_f.push([1,"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"class Mechanic extends Model\\n{\\n    /**\\n     * Get the car's owner.\\n     */\\n    public function carOwner(): HasOneThrough\\n    {\\n        return $this-\u003ehasOneThrough(\\n            Owner::class,\\n            Car::class,\\n            'mechanic_id', // Foreign key on the cars table...\\n            'car_id', // Foreign key on the owners table...\\n            'id', // Local key on the mechanics table...\\n            'id' // Local key on the cars table...\\n        );\\n    }\\n}\\n\"}]}]\n80:[\"$\",\"p\",null,{\"children\":[\"Or, as discussed earlier, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a \\\"has-one-through\\\" relationship by invoking the \",[\"$\",\"code\",null,{\"children\":\"through\"}],\" method and supplying the names of those relationships. This approach offers the advantage of reusing the key conventions already defined on the existing relationships:\"]}]\n81:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// String based syntax...\\nreturn $this-\u003ethrough('cars')-\u003ehas('owner');\\n\\n// Dynamic syntax...\\nreturn $this-\u003ethroughCars()-\u003ehasOwner();\\n\"}]}]\n82:[\"$\",\"a\",null,{\"name\":\"has-many-through\"}]\n83:[\"$\",\"h3\",null,{\"id\":\"has-many-through\",\"children\":[\"$\",\"a\",null,{\"href\":\"#has-many-through\",\"children\":\"Has Many Through\"}]}]\n84:[\"$\",\"p\",null,{\"children\":[\"The \\\"has-many-through\\\" relationship provides a convenient way to access distant relations via an intermediate relation. For example, let's assume we are building a deployment platform like \",[\"$\",\"a\",null,{\"href\":\"https://cloud.laravel.com\",\"children\":\"Laravel Cloud\"}],\". An \",[\"$\",\"code\",null,{\"children\":\"Application\"}],\" model might access many \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" models through an intermediate \",[\"$\",\"code\",null,{\"children\":\"Environment\"}],\" model. Using this example, you could easily gather all deployments for a given application. Let's look at the tables required to define this relationship:\"]}]\n85:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"applications\\n    id - integer\\n    name - string\\n\\nenvironments\\n    id - integer\\n    application_id - integer\\n    name - string\\n\\ndeployments\\n    id - integer\\n    environment_id - integer\\n    commit_hash - string\\n\"}]}]\n86:[\"$\",\"p\",null,{\"children\":[\"Now that we have examined the table structure for the relationship, let's define the relationship on the \",[\"$\",\"code\",null,{\"children\":\"Application\"}],\" model:\"]}]\n87:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasManyThrough;\\n\\nclass Application extends Model\\n{\\n    /**\\n     * Get all of the deployments for the application.\\n     */\\n    public function deployments(): HasManyThrough\\n    {\\n        return $this-\u003ehasManyThrough(Deployment::class, Environment::class);\\n    }\\n}\\n\"}]}]\n88:[\"$\",\"p\",null,{\"children\":[\"The first argument passed to the \",[\"$\",\"code\",null,{\"children\":\"hasManyThrough\"}],\" method is the name of the final model we wish to access, while the second argument is the name of the intermediate model.\"]}]\n89:[\"$\",\"p\",null,{\"children\":[\"Or, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a \\\"has-many-through\\\" relationship by invoking the \",[\"$\",\"code\",null,{\"children\":\"through\"}],\" method and supplying the names of those relationships. For example, if the \",[\"$\",\"code\",null,{\"children\":\"Application\"}],\" model has a \",[\"$\",\"code\",null,{\"children\":\"environments\"}],\" relationship and the \",[\"$\",\"code\",null,{\"children\":\"Environment\"}],\" model has a \",[\"$\",\"code\",null,{\"children\":\"deployments\"}],\" relationship, you may define a \\\"has-many-through\\\" relationship connecting the application and the deployments like so:\"]}]\n8a:[\"$\",\"pre\",null,{\"children\":[\"$\","])</script><script>self.__next_f.push([1,"\"code\",null,{\"className\":\"language-php\",\"children\":\"// String based syntax...\\nreturn $this-\u003ethrough('environments')-\u003ehas('deployments');\\n\\n// Dynamic syntax...\\nreturn $this-\u003ethroughEnvironments()-\u003ehasDeployments();\\n\"}]}]\n8b:[\"$\",\"p\",null,{\"children\":[\"Though the \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" model's table does not contain a \",[\"$\",\"code\",null,{\"children\":\"application_id\"}],\" column, the \",[\"$\",\"code\",null,{\"children\":\"hasManyThrough\"}],\" relation provides access to a application's deployments via \",[\"$\",\"code\",null,{\"children\":\"$$application-\u003edeployments\"}],\". To retrieve these models, Eloquent inspects the \",[\"$\",\"code\",null,{\"children\":\"application_id\"}],\" column on the intermediate \",[\"$\",\"code\",null,{\"children\":\"Environment\"}],\" model's table. After finding the relevant environment IDs, they are used to query the \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" model's table.\"]}]\n8c:[\"$\",\"a\",null,{\"name\":\"has-many-through-key-conventions\"}]\n8d:[\"$\",\"h4\",null,{\"id\":\"key-conventions-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#key-conventions-1\",\"children\":\"Key Conventions\"}]}]\n8e:[\"$\",\"p\",null,{\"children\":[\"Typical Eloquent foreign key conventions will be used when performing the relationship's queries. If you would like to customize the keys of the relationship, you may pass them as the third and fourth arguments to the \",[\"$\",\"code\",null,{\"children\":\"hasManyThrough\"}],\" method. The third argument is the name of the foreign key on the intermediate model. The fourth argument is the name of the foreign key on the final model. The fifth argument is the local key, while the sixth argument is the local key of the intermediate model:\"]}]\n8f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"class Application extends Model\\n{\\n    public function deployments(): HasManyThrough\\n    {\\n        return $this-\u003ehasManyThrough(\\n            Deployment::class,\\n            Environment::class,\\n            'application_id', // Foreign key on the environments table...\\n            'environment_id', // Foreign key on the deployments table...\\n            'id', // Local key on the applications table...\\n            'id' // Local key on the environments table...\\n        );\\n    }\\n}\\n\"}]}]\n90:[\"$\",\"p\",null,{\"children\":[\"Or, as discussed earlier, if the relevant relationships have already been defined on all of the models involved in the relationship, you may fluently define a \\\"has-many-through\\\" relationship by invoking the \",[\"$\",\"code\",null,{\"children\":\"through\"}],\" method and supplying the names of those relationships. This approach offers the advantage of reusing the key conventions already defined on the existing relationships:\"]}]\n91:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// String based syntax...\\nreturn $this-\u003ethrough('environments')-\u003ehas('deployments');\\n\\n// Dynamic syntax...\\nreturn $this-\u003ethroughEnvironments()-\u003ehasDeployments();\\n\"}]}]\n92:[\"$\",\"a\",null,{\"name\":\"scoped-relationships\"}]\n93:[\"$\",\"h3\",null,{\"id\":\"scoped-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#scoped-relationships\",\"children\":\"Scoped Relationships\"}]}]\n94:[\"$\",\"p\",null,{\"children\":[\"It's common to add additional methods to models that constrain relationships. For example, you might add a \",[\"$\",\"code\",null,{\"children\":\"featuredPosts\"}],\" method to a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model which constrains the broader \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" relationship with an additional \",[\"$\",\"code\",null,{\"children\":\"where\"}],\" constraint:\"]}]\n95:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasMany;\\n\\nclass User extends Model\\n{\\n    /**\\n     * Get the user's posts.\\n     */\\n    public function posts(): HasMany\\n    {\\n        return $this-\u003ehasMany(Post::class)-\u003elatest();\\n    }\\n\\n    /**\\n     * Get the user's featured posts.\\n     */\\n    public function featuredPosts(): HasMan"])</script><script>self.__next_f.push([1,"y\\n    {\\n        return $this-\u003eposts()-\u003ewhere('featured', true);\\n    }\\n}\\n\"}]}]\n96:[\"$\",\"p\",null,{\"children\":[\"However, if you attempt to create a model via the \",[\"$\",\"code\",null,{\"children\":\"featuredPosts\"}],\" method, its \",[\"$\",\"code\",null,{\"children\":\"featured\"}],\" attribute would not be set to \",[\"$\",\"code\",null,{\"children\":\"true\"}],\". If you would like to create models via relationship methods and also specify attributes that should be added to all models created via that relationship, you may use the \",[\"$\",\"code\",null,{\"children\":\"withAttributes\"}],\" method when building the relationship query:\"]}]\n97:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's featured posts.\\n */\\npublic function featuredPosts(): HasMany\\n{\\n    return $this-\u003eposts()-\u003ewithAttributes(['featured' =\u003e true]);\\n}\\n\"}]}]\n98:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"withAttributes\"}],\" method will add \",[\"$\",\"code\",null,{\"children\":\"where\"}],\" conditions to the query using the given attributes, and it will also add the given attributes to any models created via the relationship method:\"]}]\n99:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post = $user-\u003efeaturedPosts()-\u003ecreate(['title' =\u003e 'Featured Post']);\\n\\n$post-\u003efeatured; // true\\n\"}]}]\n9a:[\"$\",\"p\",null,{\"children\":[\"To instruct the \",[\"$\",\"code\",null,{\"children\":\"withAttributes\"}],\" method to not add \",[\"$\",\"code\",null,{\"children\":\"where\"}],\" conditions to the query, you may set the \",[\"$\",\"code\",null,{\"children\":\"asConditions\"}],\" argument to \",[\"$\",\"code\",null,{\"children\":\"false\"}],\":\"]}]\n9b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003eposts()-\u003ewithAttributes(['featured' =\u003e true], asConditions: false);\\n\"}]}]\n9c:[\"$\",\"a\",null,{\"name\":\"many-to-many\"}]\n9d:[\"$\",\"h2\",null,{\"id\":\"many-to-many-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-relationships\",\"children\":\"Many to Many Relationships\"}]}]\n9e:[\"$\",\"p\",null,{\"children\":[\"Many-to-many relations are slightly more complicated than \",[\"$\",\"code\",null,{\"children\":\"hasOne\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"hasMany\"}],\" relationships. An example of a many-to-many relationship is a user that has many roles and those roles are also shared by other users in the application. For example, a user may be assigned the role of \\\"Author\\\" and \\\"Editor\\\"; however, those roles may also be assigned to other users as well. So, a user has many roles and a role has many users.\"]}]\n9f:[\"$\",\"a\",null,{\"name\":\"many-to-many-table-structure\"}]\na0:[\"$\",\"h4\",null,{\"id\":\"table-structure\",\"children\":[\"$\",\"a\",null,{\"href\":\"#table-structure\",\"children\":\"Table Structure\"}]}]\na1:[\"$\",\"p\",null,{\"children\":[\"To define this relationship, three database tables are needed: \",[\"$\",\"code\",null,{\"children\":\"users\"}],\", \",[\"$\",\"code\",null,{\"children\":\"roles\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"role_user\"}],\". The \",[\"$\",\"code\",null,{\"children\":\"role_user\"}],\" table is derived from the alphabetical order of the related model names and contains \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"role_id\"}],\" columns. This table is used as an intermediate table linking the users and roles.\"]}]\na2:[\"$\",\"p\",null,{\"children\":[\"Remember, since a role can belong to many users, we cannot simply place a \",[\"$\",\"code\",null,{\"children\":\"user_id\"}],\" column on the \",[\"$\",\"code\",null,{\"children\":\"roles\"}],\" table. This would mean that a role could only belong to a single user. In order to provide support for roles being assigned to multiple users, the \",[\"$\",\"code\",null,{\"children\":\"role_user\"}],\" table is needed. We can summarize the relationship's table structure like so:\"]}]\na3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"users\\n    id - integer\\n    name - string\\n\\nroles\\n    id - integer\\n    name - string\\n\\nrole_user\\n    user_id - integer\\n    role_id - integer\\n\"}]}]\na4:[\"$\",\"a\",null,{\"name\":\"many-to-many-model-struct"])</script><script>self.__next_f.push([1,"ure\"}]\na5:[\"$\",\"h4\",null,{\"id\":\"model-structure\",\"children\":[\"$\",\"a\",null,{\"href\":\"#model-structure\",\"children\":\"Model Structure\"}]}]\na6:[\"$\",\"p\",null,{\"children\":[\"Many-to-many relationships are defined by writing a method that returns the result of the \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method. The \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method is provided by the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\Eloquent\\\\Model\"}],\" base class that is used by all of your application's Eloquent models. For example, let's define a \",[\"$\",\"code\",null,{\"children\":\"roles\"}],\" method on our \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model. The first argument passed to this method is the name of the related model class:\"]}]\na7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsToMany;\\n\\nclass User extends Model\\n{\\n    /**\\n     * The roles that belong to the user.\\n     */\\n    public function roles(): BelongsToMany\\n    {\\n        return $this-\u003ebelongsToMany(Role::class);\\n    }\\n}\\n\"}]}]\na8:[\"$\",\"p\",null,{\"children\":[\"Once the relationship is defined, you may access the user's roles using the \",[\"$\",\"code\",null,{\"children\":\"roles\"}],\" dynamic relationship property:\"]}]\na9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$user = User::find(1);\\n\\nforeach ($user-\u003eroles as $role) {\\n    // ...\\n}\\n\"}]}]\naa:[\"$\",\"p\",null,{\"children\":[\"Since all relationships also serve as query builders, you may add further constraints to the relationship query by calling the \",[\"$\",\"code\",null,{\"children\":\"roles\"}],\" method and continuing to chain conditions onto the query:\"]}]\nab:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$roles = User::find(1)-\u003eroles()-\u003eorderBy('name')-\u003eget();\\n\"}]}]\nac:[\"$\",\"p\",null,{\"children\":[\"To determine the table name of the relationship's intermediate table, Eloquent will join the two related model names in alphabetical order. However, you are free to override this convention. You may do so by passing a second argument to the \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method:\"]}]\nad:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class, 'role_user');\\n\"}]}]\nae:[\"$\",\"p\",null,{\"children\":[\"In addition to customizing the name of the intermediate table, you may also customize the column names of the keys on the table by passing additional arguments to the \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method. The third argument is the foreign key name of the model on which you are defining the relationship, while the fourth argument is the foreign key name of the model that you are joining to:\"]}]\naf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class, 'role_user', 'user_id', 'role_id');\\n\"}]}]\nb0:[\"$\",\"a\",null,{\"name\":\"many-to-many-defining-the-inverse-of-the-relationship\"}]\nb1:[\"$\",\"h4\",null,{\"id\":\"defining-the-inverse-of-the-relationship-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-the-inverse-of-the-relationship-1\",\"children\":\"Defining the Inverse of the Relationship\"}]}]\nb2:[\"$\",\"p\",null,{\"children\":[\"To define the \\\"inverse\\\" of a many-to-many relationship, you should define a method on the related model which also returns the result of the \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method. To complete our user / role example, let's define the \",[\"$\",\"code\",null,{\"children\":\"users\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"Role\"}],\" model:\"]}]\nb3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsToMany;\\n\\nclass Role extends Model\\n{\\n    /**\\n     * The users that belong to the ro"])</script><script>self.__next_f.push([1,"le.\\n     */\\n    public function users(): BelongsToMany\\n    {\\n        return $this-\u003ebelongsToMany(User::class);\\n    }\\n}\\n\"}]}]\nb4:[\"$\",\"p\",null,{\"children\":[\"As you can see, the relationship is defined exactly the same as its \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model counterpart with the exception of referencing the \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\" model. Since we're reusing the \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" method, all of the usual table and key customization options are available when defining the \\\"inverse\\\" of many-to-many relationships.\"]}]\nb5:[\"$\",\"a\",null,{\"name\":\"retrieving-intermediate-table-columns\"}]\nb6:[\"$\",\"h3\",null,{\"id\":\"retrieving-intermediate-table-columns\",\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-intermediate-table-columns\",\"children\":\"Retrieving Intermediate Table Columns\"}]}]\nb7:[\"$\",\"p\",null,{\"children\":[\"As you have already learned, working with many-to-many relations requires the presence of an intermediate table. Eloquent provides some very helpful ways of interacting with this table. For example, let's assume our \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model has many \",[\"$\",\"code\",null,{\"children\":\"Role\"}],\" models that it is related to. After accessing this relationship, we may access the intermediate table using the \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\" attribute on the models:\"]}]\nb8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$user = User::find(1);\\n\\nforeach ($user-\u003eroles as $role) {\\n    echo $role-\u003epivot-\u003ecreated_at;\\n}\\n\"}]}]\nb9:[\"$\",\"p\",null,{\"children\":[\"Notice that each \",[\"$\",\"code\",null,{\"children\":\"Role\"}],\" model we retrieve is automatically assigned a \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\" attribute. This attribute contains a model representing the intermediate table.\"]}]\nba:[\"$\",\"p\",null,{\"children\":[\"By default, only the model keys will be present on the \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\" model. If your intermediate table contains extra attributes, you must specify them when defining the relationship:\"]}]\nbb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class)-\u003ewithPivot('active', 'created_by');\\n\"}]}]\nbc:[\"$\",\"p\",null,{\"children\":[\"If you would like your intermediate table to have \",[\"$\",\"code\",null,{\"children\":\"created_at\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"updated_at\"}],\" timestamps that are automatically maintained by Eloquent, call the \",[\"$\",\"code\",null,{\"children\":\"withTimestamps\"}],\" method when defining the relationship:\"]}]\nbd:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class)-\u003ewithTimestamps();\\n\"}]}]\nbe:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nIntermediate tables that utilize Eloquent's automatically maintained timestamps are required to have both \",[\"$\",\"code\",null,{\"children\":\"created_at\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"updated_at\"}],\" timestamp columns.\"]}],\"\\n\"]}]\nbf:[\"$\",\"a\",null,{\"name\":\"customizing-the-pivot-attribute-name\"}]\nc0:[\"$\",\"h4\",null,{\"id\":\"customizing-the-pivot-attribute-name\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-pivot-attribute-name\",\"children\":[\"Customizing the \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\" Attribute Name\"]}]}]\nc1:[\"$\",\"p\",null,{\"children\":[\"As noted previously, attributes from the intermediate table may be accessed on models via the \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\" attribute. However, you are free to customize the name of this attribute to better reflect its purpose within your application.\"]}]\nc2:[\"$\",\"p\",null,{\"children\":[\"For example, if your application contains users that may subscribe to podcasts, you likely have a many-to-many relationship between users and podcasts. If this is the case, you may wish to rename your intermediate table attribute to \",[\"$\",\"code\",null,{\"children\":\"subscription\"}],\" instead of \",[\"$\",\"code\",null,{\"children\":\"pivot\"}],\". This can be do"])</script><script>self.__next_f.push([1,"ne using the \",[\"$\",\"code\",null,{\"children\":\"as\"}],\" method when defining the relationship:\"]}]\nc3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Podcast::class)\\n    -\u003eas('subscription')\\n    -\u003ewithTimestamps();\\n\"}]}]\nc4:[\"$\",\"p\",null,{\"children\":\"Once the custom intermediate table attribute has been specified, you may access the intermediate table data using the customized name:\"}]\nc5:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$users = User::with('podcasts')-\u003eget();\\n\\nforeach ($users-\u003eflatMap-\u003epodcasts as $podcast) {\\n    echo $podcast-\u003esubscription-\u003ecreated_at;\\n}\\n\"}]}]\nc6:[\"$\",\"a\",null,{\"name\":\"filtering-queries-via-intermediate-table-columns\"}]\nc7:[\"$\",\"h3\",null,{\"id\":\"filtering-queries-via-intermediate-table-columns\",\"children\":[\"$\",\"a\",null,{\"href\":\"#filtering-queries-via-intermediate-table-columns\",\"children\":\"Filtering Queries via Intermediate Table Columns\"}]}]\nc8:[\"$\",\"p\",null,{\"children\":[\"You can also filter the results returned by \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" relationship queries using the \",[\"$\",\"code\",null,{\"children\":\"wherePivot\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wherePivotIn\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wherePivotNotIn\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wherePivotBetween\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wherePivotNotBetween\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wherePivotNull\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"wherePivotNotNull\"}],\" methods when defining the relationship:\"]}]\nc9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class)\\n    -\u003ewherePivot('approved', 1);\\n\\nreturn $this-\u003ebelongsToMany(Role::class)\\n    -\u003ewherePivotIn('priority', [1, 2]);\\n\\nreturn $this-\u003ebelongsToMany(Role::class)\\n    -\u003ewherePivotNotIn('priority', [1, 2]);\\n\\nreturn $this-\u003ebelongsToMany(Podcast::class)\\n    -\u003eas('subscriptions')\\n    -\u003ewherePivotBetween('created_at', ['2020-01-01 00:00:00', '2020-12-31 00:00:00']);\\n\\nreturn $this-\u003ebelongsToMany(Podcast::class)\\n    -\u003eas('subscriptions')\\n    -\u003ewherePivotNotBetween('created_at', ['2020-01-01 00:00:00', '2020-12-31 00:00:00']);\\n\\nreturn $this-\u003ebelongsToMany(Podcast::class)\\n    -\u003eas('subscriptions')\\n    -\u003ewherePivotNull('expired_at');\\n\\nreturn $this-\u003ebelongsToMany(Podcast::class)\\n    -\u003eas('subscriptions')\\n    -\u003ewherePivotNotNull('expired_at');\\n\"}]}]\nca:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"wherePivot\"}],\" adds a where clause constraint to the query, but does not add the specified value when creating new models via the defined relationship. If you need to both query and create relationships with a particular pivot value, you may use the \",[\"$\",\"code\",null,{\"children\":\"withPivotValue\"}],\" method:\"]}]\ncb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Role::class)\\n    -\u003ewithPivotValue('approved', 1);\\n\"}]}]\ncc:[\"$\",\"a\",null,{\"name\":\"ordering-queries-via-intermediate-table-columns\"}]\ncd:[\"$\",\"h3\",null,{\"id\":\"ordering-queries-via-intermediate-table-columns\",\"children\":[\"$\",\"a\",null,{\"href\":\"#ordering-queries-via-intermediate-table-columns\",\"children\":\"Ordering Queries via Intermediate Table Columns\"}]}]\nce:[\"$\",\"p\",null,{\"children\":[\"You can order the results returned by \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" relationship queries using the \",[\"$\",\"code\",null,{\"children\":\"orderByPivot\"}],\" method. In the following example, we will retrieve all of the latest badges for the user:\"]}]\ncf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"return $this-\u003ebelongsToMany(Badge::class)\\n    -\u003ewhere('rank', 'gold')\\n    -\u003eorderByPivot('created_at', 'desc');\\n\"}]}]\nd0:[\"$\",\"a\",null,{\"name\":\"defining-custom-intermediate-table-models\"}]\nd1:[\"$\",\"h3\",null,{\"id\":\"defining-custom-intermediate-table-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-custom-intermediate-table-models\",\"children\":\"Defining Custom Intermediate Table"])</script><script>self.__next_f.push([1," Models\"}]}]\nd2:[\"$\",\"p\",null,{\"children\":[\"If you would like to define a custom model to represent the intermediate table of your many-to-many relationship, you may call the \",[\"$\",\"code\",null,{\"children\":\"using\"}],\" method when defining the relationship. Custom pivot models give you the opportunity to define additional behavior on the pivot model, such as methods and casts.\"]}]\nd3:[\"$\",\"p\",null,{\"children\":[\"Custom many-to-many pivot models should extend the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\Pivot\"}],\" class while custom polymorphic many-to-many pivot models should extend the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphPivot\"}],\" class. For example, we may define a \",[\"$\",\"code\",null,{\"children\":\"Role\"}],\" model which uses a custom \",[\"$\",\"code\",null,{\"children\":\"RoleUser\"}],\" pivot model:\"]}]\nd4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsToMany;\\n\\nclass Role extends Model\\n{\\n    /**\\n     * The users that belong to the role.\\n     */\\n    public function users(): BelongsToMany\\n    {\\n        return $this-\u003ebelongsToMany(User::class)-\u003eusing(RoleUser::class);\\n    }\\n}\\n\"}]}]\nd5:[\"$\",\"p\",null,{\"children\":[\"When defining the \",[\"$\",\"code\",null,{\"children\":\"RoleUser\"}],\" model, you should extend the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\Pivot\"}],\" class:\"]}]\nd6:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\Pivot;\\n\\nclass RoleUser extends Pivot\\n{\\n    // ...\\n}\\n\"}]}]\nd7:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nPivot models may not use the \",[\"$\",\"code\",null,{\"children\":\"SoftDeletes\"}],\" trait. If you need to soft delete pivot records consider converting your pivot model to an actual Eloquent model.\"]}],\"\\n\"]}]\nd8:[\"$\",\"a\",null,{\"name\":\"custom-pivot-models-and-incrementing-ids\"}]\nd9:[\"$\",\"h4\",null,{\"id\":\"custom-pivot-models-and-incrementing-ids\",\"children\":[\"$\",\"a\",null,{\"href\":\"#custom-pivot-models-and-incrementing-ids\",\"children\":\"Custom Pivot Models and Incrementing IDs\"}]}]\nda:[\"$\",\"p\",null,{\"children\":[\"If you have defined a many-to-many relationship that uses a custom pivot model, and that pivot model has an auto-incrementing primary key, you should ensure your custom pivot model class defines an \",[\"$\",\"code\",null,{\"children\":\"incrementing\"}],\" property that is set to \",[\"$\",\"code\",null,{\"children\":\"true\"}],\".\"]}]\ndb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Indicates if the IDs are auto-incrementing.\\n *\\n * @var bool\\n */\\npublic $incrementing = true;\\n\"}]}]\ndc:[\"$\",\"a\",null,{\"name\":\"polymorphic-relationships\"}]\ndd:[\"$\",\"h2\",null,{\"id\":\"polymorphic-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#polymorphic-relationships\",\"children\":\"Polymorphic Relationships\"}]}]\nde:[\"$\",\"p\",null,{\"children\":[\"A polymorphic relationship allows the child model to belong to more than one type of model using a single association. For example, imagine you are building an application that allows users to share blog posts and videos. In such an application, a \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model might belong to both the \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"Video\"}],\" models.\"]}]\ndf:[\"$\",\"a\",null,{\"name\":\"one-to-one-polymorphic-relations\"}]\ne0:[\"$\",\"h3\",null,{\"id\":\"one-to-one-polymorphic\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-one-polymorphic\",\"children\":\"One to One (Polymorphic)\"}]}]\ne1:[\"$\",\"a\",null,{\"name\":\"one-to-one-polymorphic-table-structure\"}]\ne2:[\"$\",\"h4\",null,{\"id\":\"table-structure-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#table-structure-1\",\"children\":\"Table Structure\"}]}]\ne3:[\"$\",\"p\",null,{\"children\":[\"A one-to-one polymorphic relation is similar to a typical one-to-one rela"])</script><script>self.__next_f.push([1,"tion; however, the child model can belong to more than one type of model using a single association. For example, a blog \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" and a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" may share a polymorphic relation to an \",[\"$\",\"code\",null,{\"children\":\"Image\"}],\" model. Using a one-to-one polymorphic relation allows you to have a single table of unique images that may be associated with posts and users. First, let's examine the table structure:\"]}]\ne4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"posts\\n    id - integer\\n    name - string\\n\\nusers\\n    id - integer\\n    name - string\\n\\nimages\\n    id - integer\\n    url - string\\n    imageable_id - integer\\n    imageable_type - string\\n\"}]}]\ne5:[\"$\",\"p\",null,{\"children\":[\"Note the \",[\"$\",\"code\",null,{\"children\":\"imageable_id\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"imageable_type\"}],\" columns on the \",[\"$\",\"code\",null,{\"children\":\"images\"}],\" table. The \",[\"$\",\"code\",null,{\"children\":\"imageable_id\"}],\" column will contain the ID value of the post or user, while the \",[\"$\",\"code\",null,{\"children\":\"imageable_type\"}],\" column will contain the class name of the parent model. The \",[\"$\",\"code\",null,{\"children\":\"imageable_type\"}],\" column is used by Eloquent to determine which \\\"type\\\" of parent model to return when accessing the \",[\"$\",\"code\",null,{\"children\":\"imageable\"}],\" relation. In this case, the column would contain either \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\Post\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\User\"}],\".\"]}]\ne6:[\"$\",\"a\",null,{\"name\":\"one-to-one-polymorphic-model-structure\"}]\ne7:[\"$\",\"h4\",null,{\"id\":\"model-structure-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#model-structure-1\",\"children\":\"Model Structure\"}]}]\ne8:[\"$\",\"p\",null,{\"children\":\"Next, let's examine the model definitions needed to build this relationship:\"}]\ne9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\nclass Image extends Model\\n{\\n    /**\\n     * Get the parent imageable model (user or post).\\n     */\\n    public function imageable(): MorphTo\\n    {\\n        return $this-\u003emorphTo();\\n    }\\n}\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphOne;\\n\\nclass Post extends Model\\n{\\n    /**\\n     * Get the post's image.\\n     */\\n    public function image(): MorphOne\\n    {\\n        return $this-\u003emorphOne(Image::class, 'imageable');\\n    }\\n}\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphOne;\\n\\nclass User extends Model\\n{\\n    /**\\n     * Get the user's image.\\n     */\\n    public function image(): MorphOne\\n    {\\n        return $this-\u003emorphOne(Image::class, 'imageable');\\n    }\\n}\\n\"}]}]\nea:[\"$\",\"a\",null,{\"name\":\"one-to-one-polymorphic-retrieving-the-relationship\"}]\neb:[\"$\",\"h4\",null,{\"id\":\"retrieving-the-relationship\",\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-the-relationship\",\"children\":\"Retrieving the Relationship\"}]}]\nec:[\"$\",\"p\",null,{\"children\":[\"Once your database table and models are defined, you may access the relationships via your models. For example, to retrieve the image for a post, we can access the \",[\"$\",\"code\",null,{\"children\":\"image\"}],\" dynamic relationship property:\"]}]\ned:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$post = Post::find(1);\\n\\n$image = $post-\u003eimage;\\n\"}]}]\nee:[\"$\",\"p\",null,{\"children\":[\"You may retrieve the parent of the polymorphic model by accessing the name of the method that performs the call to \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\". In this case, that is the \",[\"$\",\"code\",null,{\"children\":\"imageable\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"Image\"}],\" model. So, we will access that method as a dynamic relationship property:\"]}]\nef:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"us"])</script><script>self.__next_f.push([1,"e App\\\\Models\\\\Image;\\n\\n$image = Image::find(1);\\n\\n$imageable = $image-\u003eimageable;\\n\"}]}]\nf0:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"imageable\"}],\" relation on the \",[\"$\",\"code\",null,{\"children\":\"Image\"}],\" model will return either a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" instance, depending on which type of model owns the image.\"]}]\nf1:[\"$\",\"a\",null,{\"name\":\"morph-one-to-one-key-conventions\"}]\nf2:[\"$\",\"h4\",null,{\"id\":\"key-conventions-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#key-conventions-2\",\"children\":\"Key Conventions\"}]}]\nf3:[\"$\",\"p\",null,{\"children\":[\"If necessary, you may specify the name of the \\\"id\\\" and \\\"type\\\" columns utilized by your polymorphic child model. If you do so, ensure that you always pass the name of the relationship as the first argument to the \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" method. Typically, this value should match the method name, so you may use PHP's \",[\"$\",\"code\",null,{\"children\":\"__FUNCTION__\"}],\" constant:\"]}]\nf4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the model that the image belongs to.\\n */\\npublic function imageable(): MorphTo\\n{\\n    return $this-\u003emorphTo(__FUNCTION__, 'imageable_type', 'imageable_id');\\n}\\n\"}]}]\nf5:[\"$\",\"a\",null,{\"name\":\"one-to-many-polymorphic-relations\"}]\nf6:[\"$\",\"h3\",null,{\"id\":\"one-to-many-polymorphic\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-to-many-polymorphic\",\"children\":\"One to Many (Polymorphic)\"}]}]\nf7:[\"$\",\"a\",null,{\"name\":\"one-to-many-polymorphic-table-structure\"}]\nf8:[\"$\",\"h4\",null,{\"id\":\"table-structure-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#table-structure-2\",\"children\":\"Table Structure\"}]}]\nf9:[\"$\",\"p\",null,{\"children\":[\"A one-to-many polymorphic relation is similar to a typical one-to-many relation; however, the child model can belong to more than one type of model using a single association. For example, imagine users of your application can \\\"comment\\\" on posts and videos. Using polymorphic relationships, you may use a single \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" table to contain comments for both posts and videos. First, let's examine the table structure required to build this relationship:\"]}]\nfa:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"posts\\n    id - integer\\n    title - string\\n    body - text\\n\\nvideos\\n    id - integer\\n    title - string\\n    url - string\\n\\ncomments\\n    id - integer\\n    body - text\\n    commentable_id - integer\\n    commentable_type - string\\n\"}]}]\nfb:[\"$\",\"a\",null,{\"name\":\"one-to-many-polymorphic-model-structure\"}]\nfc:[\"$\",\"h4\",null,{\"id\":\"model-structure-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#model-structure-2\",\"children\":\"Model Structure\"}]}]\nfd:[\"$\",\"p\",null,{\"children\":\"Next, let's examine the model definitions needed to build this relationship:\"}]\nfe:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\nclass Comment extends Model\\n{\\n    /**\\n     * Get the parent commentable model (post or video).\\n     */\\n    public function commentable(): MorphTo\\n    {\\n        return $this-\u003emorphTo();\\n    }\\n}\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphMany;\\n\\nclass Post extends Model\\n{\\n    /**\\n     * Get all of the post's comments.\\n     */\\n    public function comments(): MorphMany\\n    {\\n        return $this-\u003emorphMany(Comment::class, 'commentable');\\n    }\\n}\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphMany;\\n\\nclass Video extends Model\\n{\\n    /**\\n     * Get all of the video's comments.\\n     */\\n    public function comments(): MorphMany\\n    {\\n        return $this-\u003emorphMany(Comment::class, 'commentable');\\n    }\\n}\\n\"}]}]\nff:[\"$\",\"a\",null,{\"name\":\"one-to-many-polymorphic-retrieving-the-relationship\"}]\n100:[\"$\",\"h4\",null,{\"id\":\"retrieving-the-relatio"])</script><script>self.__next_f.push([1,"nship-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-the-relationship-1\",\"children\":\"Retrieving the Relationship\"}]}]\n101:[\"$\",\"p\",null,{\"children\":[\"Once your database table and models are defined, you may access the relationships via your model's dynamic relationship properties. For example, to access all of the comments for a post, we can use the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" dynamic property:\"]}]\n102:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$post = Post::find(1);\\n\\nforeach ($post-\u003ecomments as $comment) {\\n    // ...\\n}\\n\"}]}]\n103:[\"$\",\"p\",null,{\"children\":[\"You may also retrieve the parent of a polymorphic child model by accessing the name of the method that performs the call to \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\". In this case, that is the \",[\"$\",\"code\",null,{\"children\":\"commentable\"}],\" method on the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model. So, we will access that method as a dynamic relationship property in order to access the comment's parent model:\"]}]\n104:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Comment;\\n\\n$comment = Comment::find(1);\\n\\n$commentable = $comment-\u003ecommentable;\\n\"}]}]\n105:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"commentable\"}],\" relation on the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model will return either a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"Video\"}],\" instance, depending on which type of model is the comment's parent.\"]}]\n106:[\"$\",\"a\",null,{\"name\":\"polymorphic-automatically-hydrating-parent-models-on-children\"}]\n107:[\"$\",\"h4\",null,{\"id\":\"automatically-hydrating-parent-models-on-children-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#automatically-hydrating-parent-models-on-children-1\",\"children\":\"Automatically Hydrating Parent Models on Children\"}]}]\n108:[\"$\",\"p\",null,{\"children\":\"Even when utilizing Eloquent eager loading, \\\"N + 1\\\" query problems can arise if you try to access the parent model from a child model while looping through the child models:\"}]\n109:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::with('comments')-\u003eget();\\n\\nforeach ($posts as $post) {\\n    foreach ($post-\u003ecomments as $comment) {\\n        echo $comment-\u003ecommentable-\u003etitle;\\n    }\\n}\\n\"}]}]\n10a:[\"$\",\"p\",null,{\"children\":[\"In the example above, an \\\"N + 1\\\" query problem has been introduced because, even though comments were eager loaded for every \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model, Eloquent does not automatically hydrate the parent \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" on each child \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model.\"]}]\n10b:[\"$\",\"p\",null,{\"children\":[\"If you would like Eloquent to automatically hydrate parent models onto their children, you may invoke the \",[\"$\",\"code\",null,{\"children\":\"chaperone\"}],\" method when defining a \",[\"$\",\"code\",null,{\"children\":\"morphMany\"}],\" relationship:\"]}]\n10c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"class Post extends Model\\n{\\n    /**\\n     * Get all of the post's comments.\\n     */\\n    public function comments(): MorphMany\\n    {\\n        return $this-\u003emorphMany(Comment::class, 'commentable')-\u003echaperone();\\n    }\\n}\\n\"}]}]\n10d:[\"$\",\"p\",null,{\"children\":[\"Or, if you would like to opt-in to automatic parent hydration at run time, you may invoke the \",[\"$\",\"code\",null,{\"children\":\"chaperone\"}],\" model when eager loading the relationship:\"]}]\n10e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::with([\\n    'comments' =\u003e fn ($comments) =\u003e $comments-\u003echaperone(),\\n])-\u003eget();\\n\"}]}]\n10f:[\"$\",\"a\",null,{\"name\":\"one-of-many-polymorphic-relations\"}]\n110:[\"$\",\"h3\",null,{\"id\":\"one-of-many-polymorphic\",\"children\":[\"$\",\"a\",null,{\"href\":\"#one-of-many-polymorphic\",\"children\":\"One of Many (Polymorphic)\"}]}]\n111:[\"$\",\"p\",null,{\"children\":[\"Sometimes a model may have ma"])</script><script>self.__next_f.push([1,"ny related models, yet you want to easily retrieve the \\\"latest\\\" or \\\"oldest\\\" related model of the relationship. For example, a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model may be related to many \",[\"$\",\"code\",null,{\"children\":\"Image\"}],\" models, but you want to define a convenient way to interact with the most recent image the user has uploaded. You may accomplish this using the \",[\"$\",\"code\",null,{\"children\":\"morphOne\"}],\" relationship type combined with the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" methods:\"]}]\n112:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's most recent image.\\n */\\npublic function latestImage(): MorphOne\\n{\\n    return $this-\u003emorphOne(Image::class, 'imageable')-\u003elatestOfMany();\\n}\\n\"}]}]\n113:[\"$\",\"p\",null,{\"children\":\"Likewise, you may define a method to retrieve the \\\"oldest\\\", or first, related model of a relationship:\"}]\n114:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's oldest image.\\n */\\npublic function oldestImage(): MorphOne\\n{\\n    return $this-\u003emorphOne(Image::class, 'imageable')-\u003eoldestOfMany();\\n}\\n\"}]}]\n115:[\"$\",\"p\",null,{\"children\":[\"By default, the \",[\"$\",\"code\",null,{\"children\":\"latestOfMany\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"oldestOfMany\"}],\" methods will retrieve the latest or oldest related model based on the model's primary key, which must be sortable. However, sometimes you may wish to retrieve a single model from a larger relationship using a different sorting criteria.\"]}]\n116:[\"$\",\"p\",null,{\"children\":[\"For example, using the \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method, you may retrieve the user's most \\\"liked\\\" image. The \",[\"$\",\"code\",null,{\"children\":\"ofMany\"}],\" method accepts the sortable column as its first argument and which aggregate function (\",[\"$\",\"code\",null,{\"children\":\"min\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"max\"}],\") to apply when querying for the related model:\"]}]\n117:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the user's most popular image.\\n */\\npublic function bestImage(): MorphOne\\n{\\n    return $this-\u003emorphOne(Image::class, 'imageable')-\u003eofMany('likes', 'max');\\n}\\n\"}]}]\n118:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nIt is possible to construct more advanced \\\"one of many\\\" relationships. For more information, please consult the \",[\"$\",\"a\",null,{\"href\":\"#advanced-has-one-of-many-relationships\",\"children\":\"has one of many documentation\"}],\".\"]}],\"\\n\"]}]\n119:[\"$\",\"a\",null,{\"name\":\"many-to-many-polymorphic-relations\"}]\n11a:[\"$\",\"h3\",null,{\"id\":\"many-to-many-polymorphic\",\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-polymorphic\",\"children\":\"Many to Many (Polymorphic)\"}]}]\n11b:[\"$\",\"a\",null,{\"name\":\"many-to-many-polymorphic-table-structure\"}]\n11c:[\"$\",\"h4\",null,{\"id\":\"table-structure-3\",\"children\":[\"$\",\"a\",null,{\"href\":\"#table-structure-3\",\"children\":\"Table Structure\"}]}]\n11d:[\"$\",\"p\",null,{\"children\":[\"Many-to-many polymorphic relations are slightly more complicated than \\\"morph one\\\" and \\\"morph many\\\" relationships. For example, a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model and \",[\"$\",\"code\",null,{\"children\":\"Video\"}],\" model could share a polymorphic relation to a \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" model. Using a many-to-many polymorphic relation in this situation would allow your application to have a single table of unique tags that may be associated with posts or videos. First, let's examine the table structure required to build this relationship:\"]}]\n11e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"children\":\"posts\\n    id - integer\\n    name - string\\n\\nvideos\\n    id - integer\\n    name - string\\n\\ntags\\n    id - integer\\n    name - string\\n\\ntaggables\\n    tag_id - integer\\n    taggable_id - integer\\n    taggable_type - string\\n\"}]}]\n11f:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nBefore diving into polymorphic many-to-many relationships, you"])</script><script>self.__next_f.push([1," may benefit from reading the documentation on typical \",[\"$\",\"a\",null,{\"href\":\"#many-to-many\",\"children\":\"many-to-many relationships\"}],\".\"]}],\"\\n\"]}]\n120:[\"$\",\"a\",null,{\"name\":\"many-to-many-polymorphic-model-structure\"}]\n121:[\"$\",\"h4\",null,{\"id\":\"model-structure-3\",\"children\":[\"$\",\"a\",null,{\"href\":\"#model-structure-3\",\"children\":\"Model Structure\"}]}]\n122:[\"$\",\"p\",null,{\"children\":[\"Next, we're ready to define the relationships on the models. The \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"Video\"}],\" models will both contain a \",[\"$\",\"code\",null,{\"children\":\"tags\"}],\" method that calls the \",[\"$\",\"code\",null,{\"children\":\"morphToMany\"}],\" method provided by the base Eloquent model class.\"]}]\n123:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"morphToMany\"}],\" method accepts the name of the related model as well as the \\\"relationship name\\\". Based on the name we assigned to our intermediate table name and the keys it contains, we will refer to the relationship as \\\"taggable\\\":\"]}]\n124:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphToMany;\\n\\nclass Post extends Model\\n{\\n    /**\\n     * Get all of the tags for the post.\\n     */\\n    public function tags(): MorphToMany\\n    {\\n        return $this-\u003emorphToMany(Tag::class, 'taggable');\\n    }\\n}\\n\"}]}]\n125:[\"$\",\"a\",null,{\"name\":\"many-to-many-polymorphic-defining-the-inverse-of-the-relationship\"}]\n126:[\"$\",\"h4\",null,{\"id\":\"defining-the-inverse-of-the-relationship-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-the-inverse-of-the-relationship-2\",\"children\":\"Defining the Inverse of the Relationship\"}]}]\n127:[\"$\",\"p\",null,{\"children\":[\"Next, on the \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" model, you should define a method for each of its possible parent models. So, in this example, we will define a \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" method and a \",[\"$\",\"code\",null,{\"children\":\"videos\"}],\" method. Both of these methods should return the result of the \",[\"$\",\"code\",null,{\"children\":\"morphedByMany\"}],\" method.\"]}]\n128:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"morphedByMany\"}],\" method accepts the name of the related model as well as the \\\"relationship name\\\". Based on the name we assigned to our intermediate table name and the keys it contains, we will refer to the relationship as \\\"taggable\\\":\"]}]\n129:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphToMany;\\n\\nclass Tag extends Model\\n{\\n    /**\\n     * Get all of the posts that are assigned this tag.\\n     */\\n    public function posts(): MorphToMany\\n    {\\n        return $this-\u003emorphedByMany(Post::class, 'taggable');\\n    }\\n\\n    /**\\n     * Get all of the videos that are assigned this tag.\\n     */\\n    public function videos(): MorphToMany\\n    {\\n        return $this-\u003emorphedByMany(Video::class, 'taggable');\\n    }\\n}\\n\"}]}]\n12a:[\"$\",\"a\",null,{\"name\":\"many-to-many-polymorphic-retrieving-the-relationship\"}]\n12b:[\"$\",\"h4\",null,{\"id\":\"retrieving-the-relationship-2\",\"children\":[\"$\",\"a\",null,{\"href\":\"#retrieving-the-relationship-2\",\"children\":\"Retrieving the Relationship\"}]}]\n12c:[\"$\",\"p\",null,{\"children\":[\"Once your database table and models are defined, you may access the relationships via your models. For example, to access all of the tags for a post, you may use the \",[\"$\",\"code\",null,{\"children\":\"tags\"}],\" dynamic relationship property:\"]}]\n12d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$post = Post::find(1);\\n\\nforeach ($post-\u003etags as $tag) {\\n    // ...\\n}\\n\"}]}]\n12e:[\"$\",\"p\",null,{\"children\":[\"You may retrieve the parent of a polymorphic relation from the polymorphic child model by accessing the name of the method that performs the call to \",[\"$\""])</script><script>self.__next_f.push([1,",\"code\",null,{\"children\":\"morphedByMany\"}],\". In this case, that is the \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"videos\"}],\" methods on the \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" model:\"]}]\n12f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Tag;\\n\\n$tag = Tag::find(1);\\n\\nforeach ($tag-\u003eposts as $post) {\\n    // ...\\n}\\n\\nforeach ($tag-\u003evideos as $video) {\\n    // ...\\n}\\n\"}]}]\n130:[\"$\",\"a\",null,{\"name\":\"custom-polymorphic-types\"}]\n131:[\"$\",\"h3\",null,{\"id\":\"custom-polymorphic-types\",\"children\":[\"$\",\"a\",null,{\"href\":\"#custom-polymorphic-types\",\"children\":\"Custom Polymorphic Types\"}]}]\n132:[\"$\",\"p\",null,{\"children\":[\"By default, Laravel will use the fully qualified class name to store the \\\"type\\\" of the related model. For instance, given the one-to-many relationship example above where a \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model may belong to a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" or a \",[\"$\",\"code\",null,{\"children\":\"Video\"}],\" model, the default \",[\"$\",\"code\",null,{\"children\":\"commentable_type\"}],\" would be either \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\Post\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\Video\"}],\", respectively. However, you may wish to decouple these values from your application's internal structure.\"]}]\n133:[\"$\",\"p\",null,{\"children\":[\"For example, instead of using the model names as the \\\"type\\\", we may use simple strings such as \",[\"$\",\"code\",null,{\"children\":\"post\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"video\"}],\". By doing so, the polymorphic \\\"type\\\" column values in our database will remain valid even if the models are renamed:\"]}]\n134:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\Relation;\\n\\nRelation::enforceMorphMap([\\n    'post' =\u003e 'App\\\\Models\\\\Post',\\n    'video' =\u003e 'App\\\\Models\\\\Video',\\n]);\\n\"}]}]\n135:[\"$\",\"p\",null,{\"children\":[\"You may call the \",[\"$\",\"code\",null,{\"children\":\"enforceMorphMap\"}],\" method in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your \",[\"$\",\"code\",null,{\"children\":\"App\\\\Providers\\\\AppServiceProvider\"}],\" class or create a separate service provider if you wish.\"]}]\n136:[\"$\",\"p\",null,{\"children\":[\"You may determine the morph alias of a given model at runtime using the model's \",[\"$\",\"code\",null,{\"children\":\"getMorphClass\"}],\" method. Conversely, you may determine the fully-qualified class name associated with a morph alias using the \",[\"$\",\"code\",null,{\"children\":\"Relation::getMorphedModel\"}],\" method:\"]}]\n137:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\Relation;\\n\\n$alias = $post-\u003egetMorphClass();\\n\\n$class = Relation::getMorphedModel($alias);\\n\"}]}]\n138:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nWhen adding a \\\"morph map\\\" to your existing application, every morphable \",[\"$\",\"code\",null,{\"children\":\"*_type\"}],\" column value in your database that still contains a fully-qualified class will need to be converted to its \\\"map\\\" name.\"]}],\"\\n\"]}]\n139:[\"$\",\"a\",null,{\"name\":\"dynamic-relationships\"}]\n13a:[\"$\",\"h3\",null,{\"id\":\"dynamic-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#dynamic-relationships\",\"children\":\"Dynamic Relationships\"}]}]\n13b:[\"$\",\"p\",null,{\"children\":[\"You may use the \",[\"$\",\"code\",null,{\"children\":\"resolveRelationUsing\"}],\" method to define relations between Eloquent models at runtime. While not typically recommended for normal application development, this may occasionally be useful when developing Laravel packages.\"]}]\n13c:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"resolveRelationUsing\"}],\" method accepts the desired relationship name as its first argument. The second argument passed to the method should be a closure that accepts the model instance and returns a valid Eloquent relationship definition. Typically, you should configure dynamic relationships within the boot method of a \",[\"$\",\"a"])</script><script>self.__next_f.push([1,"\",null,{\"href\":\"/docs/providers\",\"children\":\"service provider\"}],\":\"]}]\n13d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Order;\\nuse App\\\\Models\\\\Customer;\\n\\nOrder::resolveRelationUsing('customer', function (Order $orderModel) {\\n    return $orderModel-\u003ebelongsTo(Customer::class, 'customer_id');\\n});\\n\"}]}]\n13e:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"[!WARNING]\\nWhen defining dynamic relationships, always provide explicit key name arguments to the Eloquent relationship methods.\"}],\"\\n\"]}]\n13f:[\"$\",\"a\",null,{\"name\":\"querying-relations\"}]\n140:[\"$\",\"h2\",null,{\"id\":\"querying-relations\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-relations\",\"children\":\"Querying Relations\"}]}]\n141:[\"$\",\"p\",null,{\"children\":[\"Since all Eloquent relationships are defined via methods, you may call those methods to obtain an instance of the relationship without actually executing a query to load the related models. In addition, all types of Eloquent relationships also serve as \",[\"$\",\"a\",null,{\"href\":\"/docs/queries\",\"children\":\"query builders\"}],\", allowing you to continue to chain constraints onto the relationship query before finally executing the SQL query against your database.\"]}]\n142:[\"$\",\"p\",null,{\"children\":[\"For example, imagine a blog application in which a \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model has many associated \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models:\"]}]\n143:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\HasMany;\\n\\nclass User extends Model\\n{\\n    /**\\n     * Get all of the posts for the user.\\n     */\\n    public function posts(): HasMany\\n    {\\n        return $this-\u003ehasMany(Post::class);\\n    }\\n}\\n\"}]}]\n144:[\"$\",\"p\",null,{\"children\":[\"You may query the \",[\"$\",\"code\",null,{\"children\":\"posts\"}],\" relationship and add additional constraints to the relationship like so:\"]}]\n145:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$user = User::find(1);\\n\\n$user-\u003eposts()-\u003ewhere('active', 1)-\u003eget();\\n\"}]}]\n146:[\"$\",\"p\",null,{\"children\":[\"You are able to use any of the Laravel \",[\"$\",\"a\",null,{\"href\":\"/docs/queries\",\"children\":\"query builder's\"}],\" methods on the relationship, so be sure to explore the query builder documentation to learn about all of the methods that are available to you.\"]}]\n147:[\"$\",\"a\",null,{\"name\":\"chaining-orwhere-clauses-after-relationships\"}]\n148:[\"$\",\"h4\",null,{\"id\":\"chaining-orwhere-clauses-after-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#chaining-orwhere-clauses-after-relationships\",\"children\":[\"Chaining \",[\"$\",\"code\",null,{\"children\":\"orWhere\"}],\" Clauses After Relationships\"]}]}]\n149:[\"$\",\"p\",null,{\"children\":[\"As demonstrated in the example above, you are free to add additional constraints to relationships when querying them. However, use caution when chaining \",[\"$\",\"code\",null,{\"children\":\"orWhere\"}],\" clauses onto a relationship, as the \",[\"$\",\"code\",null,{\"children\":\"orWhere\"}],\" clauses will be logically grouped at the same level as the relationship constraint:\"]}]\n14a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eposts()\\n    -\u003ewhere('active', 1)\\n    -\u003eorWhere('votes', '\u003e=', 100)\\n    -\u003eget();\\n\"}]}]\n14b:[\"$\",\"p\",null,{\"children\":[\"The example above will generate the following SQL. As you can see, the \",[\"$\",\"code\",null,{\"children\":\"or\"}],\" clause instructs the query to return \",[\"$\",\"em\",null,{\"children\":\"any\"}],\" post with greater than 100 votes. The query is no longer constrained to a specific user:\"]}]\n14c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"select *\\nfrom posts\\nwhere user_id = ? and active = 1 or votes \u003e= 100\\n\"}]}]\n14d:[\"$\",\"p\",null,{\"children\":[\"In most situations, you should use \",[\"$\",\"a\",null,{\"href\":\"/docs/queries#logical-grouping\",\"children\":\"logical groups\"}],\" t"])</script><script>self.__next_f.push([1,"o group the conditional checks between parentheses:\"]}]\n14e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$user-\u003eposts()\\n    -\u003ewhere(function (Builder $query) {\\n        return $query-\u003ewhere('active', 1)\\n            -\u003eorWhere('votes', '\u003e=', 100);\\n    })\\n    -\u003eget();\\n\"}]}]\n14f:[\"$\",\"p\",null,{\"children\":\"The example above will produce the following SQL. Note that the logical grouping has properly grouped the constraints and the query remains constrained to a specific user:\"}]\n150:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"select *\\nfrom posts\\nwhere user_id = ? and (active = 1 or votes \u003e= 100)\\n\"}]}]\n151:[\"$\",\"a\",null,{\"name\":\"relationship-methods-vs-dynamic-properties\"}]\n152:[\"$\",\"h3\",null,{\"id\":\"relationship-methods-vs-dynamic-properties\",\"children\":[\"$\",\"a\",null,{\"href\":\"#relationship-methods-vs-dynamic-properties\",\"children\":\"Relationship Methods vs. Dynamic Properties\"}]}]\n153:[\"$\",\"p\",null,{\"children\":[\"If you do not need to add additional constraints to an Eloquent relationship query, you may access the relationship as if it were a property. For example, continuing to use our \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" example models, we may access all of a user's posts like so:\"]}]\n154:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$user = User::find(1);\\n\\nforeach ($user-\u003eposts as $post) {\\n    // ...\\n}\\n\"}]}]\n155:[\"$\",\"p\",null,{\"children\":[\"Dynamic relationship properties perform \\\"lazy loading\\\", meaning they will only load their relationship data when you actually access them. Because of this, developers often use \",[\"$\",\"a\",null,{\"href\":\"#eager-loading\",\"children\":\"eager loading\"}],\" to pre-load relationships they know will be accessed after loading the model. Eager loading provides a significant reduction in SQL queries that must be executed to load a model's relations.\"]}]\n156:[\"$\",\"a\",null,{\"name\":\"querying-relationship-existence\"}]\n157:[\"$\",\"h3\",null,{\"id\":\"querying-relationship-existence\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-relationship-existence\",\"children\":\"Querying Relationship Existence\"}]}]\n158:[\"$\",\"p\",null,{\"children\":[\"When retrieving model records, you may wish to limit your results based on the existence of a relationship. For example, imagine you want to retrieve all blog posts that have at least one comment. To do so, you may pass the name of the relationship to the \",[\"$\",\"code\",null,{\"children\":\"has\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"orHas\"}],\" methods:\"]}]\n159:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n// Retrieve all posts that have at least one comment...\\n$posts = Post::has('comments')-\u003eget();\\n\"}]}]\n15a:[\"$\",\"p\",null,{\"children\":\"You may also specify an operator and count value to further customize the query:\"}]\n15b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// Retrieve all posts that have three or more comments...\\n$posts = Post::has('comments', '\u003e=', 3)-\u003eget();\\n\"}]}]\n15c:[\"$\",\"p\",null,{\"children\":[\"Nested \",[\"$\",\"code\",null,{\"children\":\"has\"}],\" statements may be constructed using \\\"dot\\\" notation. For example, you may retrieve all posts that have at least one comment that has at least one image:\"]}]\n15d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// Retrieve posts that have at least one comment with images...\\n$posts = Post::has('comments.images')-\u003eget();\\n\"}]}]\n15e:[\"$\",\"p\",null,{\"children\":[\"If you need even more power, you may use the \",[\"$\",\"code\",null,{\"children\":\"whereHas\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"orWhereHas\"}],\" methods to define additional query constraints on your \",[\"$\",\"code\",null,{\"children\":\"has\"}],\" queries, such as inspecting the content of a comment:\"]}]\n15f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illumi"])</script><script>self.__next_f.push([1,"nate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n// Retrieve posts with at least one comment containing words like code%...\\n$posts = Post::whereHas('comments', function (Builder $query) {\\n    $query-\u003ewhere('content', 'like', 'code%');\\n})-\u003eget();\\n\\n// Retrieve posts with at least ten comments containing words like code%...\\n$posts = Post::whereHas('comments', function (Builder $query) {\\n    $query-\u003ewhere('content', 'like', 'code%');\\n}, '\u003e=', 10)-\u003eget();\\n\"}]}]\n160:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"[!WARNING]\\nEloquent does not currently support querying for relationship existence across databases. The relationships must exist within the same database.\"}],\"\\n\"]}]\n161:[\"$\",\"a\",null,{\"name\":\"many-to-many-relationship-existence-queries\"}]\n162:[\"$\",\"h4\",null,{\"id\":\"many-to-many-relationship-existence-queries\",\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-relationship-existence-queries\",\"children\":\"Many to Many Relationship Existence Queries\"}]}]\n163:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"whereAttachedTo\"}],\" method may be used to query for models that have a many to many attachment to a model or collection of models:\"]}]\n164:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$users = User::whereAttachedTo($role)-\u003eget();\\n\"}]}]\n165:[\"$\",\"p\",null,{\"children\":[\"You may also provide a \",[\"$\",\"a\",null,{\"href\":\"/docs/eloquent-collections\",\"children\":\"collection\"}],\" instance to the \",[\"$\",\"code\",null,{\"children\":\"whereAttachedTo\"}],\" method. When doing so, Laravel will retrieve models that are attached to any of the models within the collection:\"]}]\n166:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$tags = Tag::whereLike('name', '%laravel%')-\u003eget();\\n\\n$posts = Post::whereAttachedTo($tags)-\u003eget();\\n\"}]}]\n167:[\"$\",\"a\",null,{\"name\":\"inline-relationship-existence-queries\"}]\n168:[\"$\",\"h4\",null,{\"id\":\"inline-relationship-existence-queries\",\"children\":[\"$\",\"a\",null,{\"href\":\"#inline-relationship-existence-queries\",\"children\":\"Inline Relationship Existence Queries\"}]}]\n169:[\"$\",\"p\",null,{\"children\":[\"If you would like to query for a relationship's existence with a single, simple where condition attached to the relationship query, you may find it more convenient to use the \",[\"$\",\"code\",null,{\"children\":\"whereRelation\"}],\", \",[\"$\",\"code\",null,{\"children\":\"orWhereRelation\"}],\", \",[\"$\",\"code\",null,{\"children\":\"whereMorphRelation\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"orWhereMorphRelation\"}],\" methods. For example, we may query for all posts that have unapproved comments:\"]}]\n16a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::whereRelation('comments', 'is_approved', false)-\u003eget();\\n\"}]}]\n16b:[\"$\",\"p\",null,{\"children\":[\"Of course, like calls to the query builder's \",[\"$\",\"code\",null,{\"children\":\"where\"}],\" method, you may also specify an operator:\"]}]\n16c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::whereRelation(\\n    'comments', 'created_at', '\u003e=', now()-\u003esubHour()\\n)-\u003eget();\\n\"}]}]\n16d:[\"$\",\"a\",null,{\"name\":\"querying-relationship-absence\"}]\n16e:[\"$\",\"h3\",null,{\"id\":\"querying-relationship-absence\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-relationship-absence\",\"children\":\"Querying Relationship Absence\"}]}]\n16f:[\"$\",\"p\",null,{\"children\":[\"When retrieving model records, you may wish to limit your results based on the absence of a relationship. For example, imagine you want to retrieve all blog posts that \",[\"$\",\"strong\",null,{\"children\":\"don't\"}],\" have any comments. To do so, you may pass the name of the relationship to the \",[\"$\",\"code\",null,{\"children\":\"doesntHave\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"orDoesntHave\"}],\" methods:\"]}]\n170:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::doesntHave('comments')-\u003eget();\\n\"}]}]\n171:[\"$\",\"p\",null,{\"children\":[\"If you need even more power, you may use the \""])</script><script>self.__next_f.push([1,",[\"$\",\"code\",null,{\"children\":\"whereDoesntHave\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"orWhereDoesntHave\"}],\" methods to add additional query constraints to your \",[\"$\",\"code\",null,{\"children\":\"doesntHave\"}],\" queries, such as inspecting the content of a comment:\"]}]\n172:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$posts = Post::whereDoesntHave('comments', function (Builder $query) {\\n    $query-\u003ewhere('content', 'like', 'code%');\\n})-\u003eget();\\n\"}]}]\n173:[\"$\",\"p\",null,{\"children\":\"You may use \\\"dot\\\" notation to execute a query against a nested relationship. For example, the following query will retrieve all posts that do not have comments as well as posts that have comments where none of the comments are from banned users:\"}]\n174:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$posts = Post::whereDoesntHave('comments.author', function (Builder $query) {\\n    $query-\u003ewhere('banned', 1);\\n})-\u003eget();\\n\"}]}]\n175:[\"$\",\"a\",null,{\"name\":\"querying-morph-to-relationships\"}]\n176:[\"$\",\"h3\",null,{\"id\":\"querying-morph-to-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-morph-to-relationships\",\"children\":\"Querying Morph To Relationships\"}]}]\n177:[\"$\",\"p\",null,{\"children\":[\"To query the existence of \\\"morph to\\\" relationships, you may use the \",[\"$\",\"code\",null,{\"children\":\"whereHasMorph\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"whereDoesntHaveMorph\"}],\" methods. These methods accept the name of the relationship as their first argument. Next, the methods accept the names of the related models that you wish to include in the query. Finally, you may provide a closure which customizes the relationship query:\"]}]\n178:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Comment;\\nuse App\\\\Models\\\\Post;\\nuse App\\\\Models\\\\Video;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n// Retrieve comments associated to posts or videos with a title like code%...\\n$comments = Comment::whereHasMorph(\\n    'commentable',\\n    [Post::class, Video::class],\\n    function (Builder $query) {\\n        $query-\u003ewhere('title', 'like', 'code%');\\n    }\\n)-\u003eget();\\n\\n// Retrieve comments associated to posts with a title not like code%...\\n$comments = Comment::whereDoesntHaveMorph(\\n    'commentable',\\n    Post::class,\\n    function (Builder $query) {\\n        $query-\u003ewhere('title', 'like', 'code%');\\n    }\\n)-\u003eget();\\n\"}]}]\n179:[\"$\",\"p\",null,{\"children\":[\"You may occasionally need to add query constraints based on the \\\"type\\\" of the related polymorphic model. The closure passed to the \",[\"$\",\"code\",null,{\"children\":\"whereHasMorph\"}],\" method may receive a \",[\"$\",\"code\",null,{\"children\":\"$$type\"}],\" value as its second argument. This argument allows you to inspect the \\\"type\\\" of the query that is being built:\"]}]\n17a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$comments = Comment::whereHasMorph(\\n    'commentable',\\n    [Post::class, Video::class],\\n    function (Builder $query, string $type) {\\n        $column = $type === Post::class ? 'content' : 'title';\\n\\n        $query-\u003ewhere($column, 'like', 'code%');\\n    }\\n)-\u003eget();\\n\"}]}]\n17b:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may want to query for the children of a \\\"morph to\\\" relationship's parent. You may accomplish this using the \",[\"$\",\"code\",null,{\"children\":\"whereMorphedTo\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"whereNotMorphedTo\"}],\" methods, which will automatically determine the proper morph type mapping for the given model. These methods accept the name of the \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship as their first argument and the related parent model as their second argument:\"]}]\n17c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$comments = Comment::whereMorphedTo('commentable', $post)\\n    -\u003eorWhereMorphedTo('commentable', $v"])</script><script>self.__next_f.push([1,"ideo)\\n    -\u003eget();\\n\"}]}]\n17d:[\"$\",\"a\",null,{\"name\":\"querying-all-morph-to-related-models\"}]\n17e:[\"$\",\"h4\",null,{\"id\":\"querying-all-related-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#querying-all-related-models\",\"children\":\"Querying All Related Models\"}]}]\n17f:[\"$\",\"p\",null,{\"children\":[\"Instead of passing an array of possible polymorphic models, you may provide \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" as a wildcard value. This will instruct Laravel to retrieve all of the possible polymorphic types from the database. Laravel will execute an additional query in order to perform this operation:\"]}]\n180:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$comments = Comment::whereHasMorph('commentable', '*', function (Builder $query) {\\n    $query-\u003ewhere('title', 'like', 'foo%');\\n})-\u003eget();\\n\"}]}]\n181:[\"$\",\"a\",null,{\"name\":\"aggregating-related-models\"}]\n182:[\"$\",\"h2\",null,{\"id\":\"aggregating-related-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#aggregating-related-models\",\"children\":\"Aggregating Related Models\"}]}]\n183:[\"$\",\"a\",null,{\"name\":\"counting-related-models\"}]\n184:[\"$\",\"h3\",null,{\"id\":\"counting-related-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#counting-related-models\",\"children\":\"Counting Related Models\"}]}]\n185:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may want to count the number of related models for a given relationship without actually loading the models. To accomplish this, you may use the \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" method. The \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" method will place a \",[\"$\",\"code\",null,{\"children\":\"{relation}_count\"}],\" attribute on the resulting models:\"]}]\n186:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::withCount('comments')-\u003eget();\\n\\nforeach ($posts as $post) {\\n    echo $post-\u003ecomments_count;\\n}\\n\"}]}]\n187:[\"$\",\"p\",null,{\"children\":[\"By passing an array to the \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" method, you may add the \\\"counts\\\" for multiple relations as well as add additional constraints to the queries:\"]}]\n188:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$posts = Post::withCount(['votes', 'comments' =\u003e function (Builder $query) {\\n    $query-\u003ewhere('content', 'like', 'code%');\\n}])-\u003eget();\\n\\necho $posts[0]-\u003evotes_count;\\necho $posts[0]-\u003ecomments_count;\\n\"}]}]\n189:[\"$\",\"p\",null,{\"children\":\"You may also alias the relationship count result, allowing multiple counts on the same relationship:\"}]\n18a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Builder;\\n\\n$posts = Post::withCount([\\n    'comments',\\n    'comments as pending_comments_count' =\u003e function (Builder $query) {\\n        $query-\u003ewhere('approved', false);\\n    },\\n])-\u003eget();\\n\\necho $posts[0]-\u003ecomments_count;\\necho $posts[0]-\u003epending_comments_count;\\n\"}]}]\n18b:[\"$\",\"a\",null,{\"name\":\"deferred-count-loading\"}]\n18c:[\"$\",\"h4\",null,{\"id\":\"deferred-count-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#deferred-count-loading\",\"children\":\"Deferred Count Loading\"}]}]\n18d:[\"$\",\"p\",null,{\"children\":[\"Using the \",[\"$\",\"code\",null,{\"children\":\"loadCount\"}],\" method, you may load a relationship count after the parent model has already been retrieved:\"]}]\n18e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$book = Book::first();\\n\\n$book-\u003eloadCount('genres');\\n\"}]}]\n18f:[\"$\",\"p\",null,{\"children\":\"If you need to set additional query constraints on the count query, you may pass an array keyed by the relationships you wish to count. The array values should be closures which receive the query builder instance:\"}]\n190:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$book-\u003eloadCount(['reviews' =\u003e function (Builder $query) {\\n    $query-\u003ewhere('rating', 5);\\n}])\\n\"}]}]\n191:[\"$\",\"a\",null,{\"name\":\"relationship-counting-and-cus"])</script><script>self.__next_f.push([1,"tom-select-statements\"}]\n192:[\"$\",\"h4\",null,{\"id\":\"relationship-counting-and-custom-select-statements\",\"children\":[\"$\",\"a\",null,{\"href\":\"#relationship-counting-and-custom-select-statements\",\"children\":\"Relationship Counting and Custom Select Statements\"}]}]\n193:[\"$\",\"p\",null,{\"children\":[\"If you're combining \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" with a \",[\"$\",\"code\",null,{\"children\":\"select\"}],\" statement, ensure that you call \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" after the \",[\"$\",\"code\",null,{\"children\":\"select\"}],\" method:\"]}]\n194:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::select(['title', 'body'])\\n    -\u003ewithCount('comments')\\n    -\u003eget();\\n\"}]}]\n195:[\"$\",\"a\",null,{\"name\":\"other-aggregate-functions\"}]\n196:[\"$\",\"h3\",null,{\"id\":\"other-aggregate-functions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#other-aggregate-functions\",\"children\":\"Other Aggregate Functions\"}]}]\n197:[\"$\",\"p\",null,{\"children\":[\"In addition to the \",[\"$\",\"code\",null,{\"children\":\"withCount\"}],\" method, Eloquent provides \",[\"$\",\"code\",null,{\"children\":\"withMin\"}],\", \",[\"$\",\"code\",null,{\"children\":\"withMax\"}],\", \",[\"$\",\"code\",null,{\"children\":\"withAvg\"}],\", \",[\"$\",\"code\",null,{\"children\":\"withSum\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"withExists\"}],\" methods. These methods will place a \",[\"$\",\"code\",null,{\"children\":\"{relation}_{function}_{column}\"}],\" attribute on your resulting models:\"]}]\n198:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$posts = Post::withSum('comments', 'votes')-\u003eget();\\n\\nforeach ($posts as $post) {\\n    echo $post-\u003ecomments_sum_votes;\\n}\\n\"}]}]\n199:[\"$\",\"p\",null,{\"children\":\"If you wish to access the result of the aggregate function using another name, you may specify your own alias:\"}]\n19a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::withSum('comments as total_comments', 'votes')-\u003eget();\\n\\nforeach ($posts as $post) {\\n    echo $post-\u003etotal_comments;\\n}\\n\"}]}]\n19b:[\"$\",\"p\",null,{\"children\":[\"Like the \",[\"$\",\"code\",null,{\"children\":\"loadCount\"}],\" method, deferred versions of these methods are also available. These additional aggregate operations may be performed on Eloquent models that have already been retrieved:\"]}]\n19c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post = Post::first();\\n\\n$post-\u003eloadSum('comments', 'votes');\\n\"}]}]\n19d:[\"$\",\"p\",null,{\"children\":[\"If you're combining these aggregate methods with a \",[\"$\",\"code\",null,{\"children\":\"select\"}],\" statement, ensure that you call the aggregate methods after the \",[\"$\",\"code\",null,{\"children\":\"select\"}],\" method:\"]}]\n19e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$posts = Post::select(['title', 'body'])\\n    -\u003ewithExists('comments')\\n    -\u003eget();\\n\"}]}]\n19f:[\"$\",\"a\",null,{\"name\":\"counting-related-models-on-morph-to-relationships\"}]\n1a0:[\"$\",\"h3\",null,{\"id\":\"counting-related-models-on-morph-to-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#counting-related-models-on-morph-to-relationships\",\"children\":\"Counting Related Models on Morph To Relationships\"}]}]\n1a1:[\"$\",\"p\",null,{\"children\":[\"If you would like to eager load a \\\"morph to\\\" relationship, as well as related model counts for the various entities that may be returned by that relationship, you may utilize the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method in combination with the \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship's \",[\"$\",\"code\",null,{\"children\":\"morphWithCount\"}],\" method.\"]}]\n1a2:[\"$\",\"p\",null,{\"children\":[\"In this example, let's assume that \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models may create \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" models. We will assume the \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" model defines a \\\"morph to\\\" relationship named \",[\"$\",\"code\",null,{\"children\":\"parentable\"}],\" that allows us to retrieve the parent \",[\"$\",\"code\""])</script><script>self.__next_f.push([1,",null,{\"children\":\"Photo\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model for a given \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" instance. Additionally, let's assume that \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\" models \\\"have many\\\" \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" models and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models \\\"have many\\\" \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" models.\"]}]\n1a3:[\"$\",\"p\",null,{\"children\":[\"Now, let's imagine we want to retrieve \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" instances and eager load the \",[\"$\",\"code\",null,{\"children\":\"parentable\"}],\" parent models for each \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" instance. In addition, we want to retrieve the number of tags that are associated with each parent photo and the number of comments that are associated with each parent post:\"]}]\n1a4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\n$activities = ActivityFeed::with([\\n    'parentable' =\u003e function (MorphTo $morphTo) {\\n        $morphTo-\u003emorphWithCount([\\n            Photo::class =\u003e ['tags'],\\n            Post::class =\u003e ['comments'],\\n        ]);\\n    }])-\u003eget();\\n\"}]}]\n1a5:[\"$\",\"a\",null,{\"name\":\"morph-to-deferred-count-loading\"}]\n1a6:[\"$\",\"h4\",null,{\"id\":\"deferred-count-loading-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#deferred-count-loading-1\",\"children\":\"Deferred Count Loading\"}]}]\n1a7:[\"$\",\"p\",null,{\"children\":[\"Let's assume we have already retrieved a set of \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" models and now we would like to load the nested relationship counts for the various \",[\"$\",\"code\",null,{\"children\":\"parentable\"}],\" models associated with the activity feeds. You may use the \",[\"$\",\"code\",null,{\"children\":\"loadMorphCount\"}],\" method to accomplish this:\"]}]\n1a8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$activities = ActivityFeed::with('parentable')-\u003eget();\\n\\n$activities-\u003eloadMorphCount('parentable', [\\n    Photo::class =\u003e ['tags'],\\n    Post::class =\u003e ['comments'],\\n]);\\n\"}]}]\n1a9:[\"$\",\"a\",null,{\"name\":\"eager-loading\"}]\n1aa:[\"$\",\"h2\",null,{\"id\":\"eager-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eager-loading\",\"children\":\"Eager Loading\"}]}]\n1ab:[\"$\",\"p\",null,{\"children\":[\"When accessing Eloquent relationships as properties, the related models are \\\"lazy loaded\\\". This means the relationship data is not actually loaded until you first access the property. However, Eloquent can \\\"eager load\\\" relationships at the time you query the parent model. Eager loading alleviates the \\\"N + 1\\\" query problem. To illustrate the N + 1 query problem, consider a \",[\"$\",\"code\",null,{\"children\":\"Book\"}],\" model that \\\"belongs to\\\" to an \",[\"$\",\"code\",null,{\"children\":\"Author\"}],\" model:\"]}]\n1ac:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsTo;\\n\\nclass Book extends Model\\n{\\n    /**\\n     * Get the author that wrote the book.\\n     */\\n    public function author(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(Author::class);\\n    }\\n}\\n\"}]}]\n1ad:[\"$\",\"p\",null,{\"children\":\"Now, let's retrieve all books and their authors:\"}]\n1ae:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Book;\\n\\n$books = Book::all();\\n\\nforeach ($books as $book) {\\n    echo $book-\u003eauthor-\u003ename;\\n}\\n\"}]}]\n1af:[\"$\",\"p\",null,{\"children\":\"This loop will execute one query to retrieve all of the books within the database table, then another query for each book in order to retrieve the book's author. So, if we have 25 books, the code above would run 26 queries: one for the original book, and 25 additional queries to retrieve the author of each book.\"}]\n1b0:[\"$\",\"p\",null,{\"children\":[\"Thankfully, we can use eager loading to reduce this operation to just two queries. When building a query, you may specify which relation"])</script><script>self.__next_f.push([1,"ships should be eager loaded using the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method:\"]}]\n1b1:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::with('author')-\u003eget();\\n\\nforeach ($books as $book) {\\n    echo $book-\u003eauthor-\u003ename;\\n}\\n\"}]}]\n1b2:[\"$\",\"p\",null,{\"children\":\"For this operation, only two queries will be executed - one query to retrieve all of the books and one query to retrieve all of the authors for all of the books:\"}]\n1b3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"select * from books\\n\\nselect * from authors where id in (1, 2, 3, 4, 5, ...)\\n\"}]}]\n1b4:[\"$\",\"a\",null,{\"name\":\"eager-loading-multiple-relationships\"}]\n1b5:[\"$\",\"h4\",null,{\"id\":\"eager-loading-multiple-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eager-loading-multiple-relationships\",\"children\":\"Eager Loading Multiple Relationships\"}]}]\n1b6:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may need to eager load several different relationships. To do so, just pass an array of relationships to the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method:\"]}]\n1b7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::with(['author', 'publisher'])-\u003eget();\\n\"}]}]\n1b8:[\"$\",\"a\",null,{\"name\":\"nested-eager-loading\"}]\n1b9:[\"$\",\"h4\",null,{\"id\":\"nested-eager-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#nested-eager-loading\",\"children\":\"Nested Eager Loading\"}]}]\n1ba:[\"$\",\"p\",null,{\"children\":\"To eager load a relationship's relationships, you may use \\\"dot\\\" syntax. For example, let's eager load all of the book's authors and all of the author's personal contacts:\"}]\n1bb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::with('author.contacts')-\u003eget();\\n\"}]}]\n1bc:[\"$\",\"p\",null,{\"children\":[\"Alternatively, you may specify nested eager loaded relationships by providing a nested array to the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method, which can be convenient when eager loading multiple nested relationships:\"]}]\n1bd:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::with([\\n    'author' =\u003e [\\n        'contacts',\\n        'publisher',\\n    ],\\n])-\u003eget();\\n\"}]}]\n1be:[\"$\",\"a\",null,{\"name\":\"nested-eager-loading-morphto-relationships\"}]\n1bf:[\"$\",\"h4\",null,{\"id\":\"nested-eager-loading-morphto-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#nested-eager-loading-morphto-relationships\",\"children\":[\"Nested Eager Loading \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" Relationships\"]}]}]\n1c0:[\"$\",\"p\",null,{\"children\":[\"If you would like to eager load a \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship, as well as nested relationships on the various entities that may be returned by that relationship, you may use the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method in combination with the \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship's \",[\"$\",\"code\",null,{\"children\":\"morphWith\"}],\" method. To help illustrate this method, let's consider the following model:\"]}]\n1c1:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\nclass ActivityFeed extends Model\\n{\\n    /**\\n     * Get the parent of the activity feed record.\\n     */\\n    public function parentable(): MorphTo\\n    {\\n        return $this-\u003emorphTo();\\n    }\\n}\\n\"}]}]\n1c2:[\"$\",\"p\",null,{\"children\":[\"In this example, let's assume \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\", \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models may create \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" models. Additionally, let's assume that \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\" models belong to a \",[\"$\",\"code\",null,{\"children\":\"Calendar\"}],\" model, \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\" models are associated with \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" models, and \",[\"$\",\"code\",null,{\"children\":\"Post\"}]"])</script><script>self.__next_f.push([1,",\" models belong to an \",[\"$\",\"code\",null,{\"children\":\"Author\"}],\" model.\"]}]\n1c3:[\"$\",\"p\",null,{\"children\":[\"Using these model definitions and relationships, we may retrieve \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" model instances and eager load all \",[\"$\",\"code\",null,{\"children\":\"parentable\"}],\" models and their respective nested relationships:\"]}]\n1c4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\n$activities = ActivityFeed::query()\\n    -\u003ewith(['parentable' =\u003e function (MorphTo $morphTo) {\\n        $morphTo-\u003emorphWith([\\n            Event::class =\u003e ['calendar'],\\n            Photo::class =\u003e ['tags'],\\n            Post::class =\u003e ['author'],\\n        ]);\\n    }])-\u003eget();\\n\"}]}]\n1c5:[\"$\",\"a\",null,{\"name\":\"eager-loading-specific-columns\"}]\n1c6:[\"$\",\"h4\",null,{\"id\":\"eager-loading-specific-columns\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eager-loading-specific-columns\",\"children\":\"Eager Loading Specific Columns\"}]}]\n1c7:[\"$\",\"p\",null,{\"children\":\"You may not always need every column from the relationships you are retrieving. For this reason, Eloquent allows you to specify which columns of the relationship you would like to retrieve:\"}]\n1c8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::with('author:id,name,book_id')-\u003eget();\\n\"}]}]\n1c9:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nWhen using this feature, you should always include the \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" column and any relevant foreign key columns in the list of columns you wish to retrieve.\"]}],\"\\n\"]}]\n1ca:[\"$\",\"a\",null,{\"name\":\"eager-loading-by-default\"}]\n1cb:[\"$\",\"h4\",null,{\"id\":\"eager-loading-by-default\",\"children\":[\"$\",\"a\",null,{\"href\":\"#eager-loading-by-default\",\"children\":\"Eager Loading by Default\"}]}]\n1cc:[\"$\",\"p\",null,{\"children\":[\"Sometimes you might want to always load some relationships when retrieving a model. To accomplish this, you may define a \",[\"$\",\"code\",null,{\"children\":\"$$with\"}],\" property on the model:\"]}]\n1cd:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsTo;\\n\\nclass Book extends Model\\n{\\n    /**\\n     * The relationships that should always be loaded.\\n     *\\n     * @var array\\n     */\\n    protected $with = ['author'];\\n\\n    /**\\n     * Get the author that wrote the book.\\n     */\\n    public function author(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(Author::class);\\n    }\\n\\n    /**\\n     * Get the genre of the book.\\n     */\\n    public function genre(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(Genre::class);\\n    }\\n}\\n\"}]}]\n1ce:[\"$\",\"p\",null,{\"children\":[\"If you would like to remove an item from the \",[\"$\",\"code\",null,{\"children\":\"$$with\"}],\" property for a single query, you may use the \",[\"$\",\"code\",null,{\"children\":\"without\"}],\" method:\"]}]\n1cf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::without('author')-\u003eget();\\n\"}]}]\n1d0:[\"$\",\"p\",null,{\"children\":[\"If you would like to override all items within the \",[\"$\",\"code\",null,{\"children\":\"$$with\"}],\" property for a single query, you may use the \",[\"$\",\"code\",null,{\"children\":\"withOnly\"}],\" method:\"]}]\n1d1:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$books = Book::withOnly('genre')-\u003eget();\\n\"}]}]\n1d2:[\"$\",\"a\",null,{\"name\":\"constraining-eager-loads\"}]\n1d3:[\"$\",\"h3\",null,{\"id\":\"constraining-eager-loads\",\"children\":[\"$\",\"a\",null,{\"href\":\"#constraining-eager-loads\",\"children\":\"Constraining Eager Loads\"}]}]\n1d4:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may wish to eager load a relationship but also specify additional query conditions for the eager loading query. You can accomplish this by passing an array of relationships to the \",[\"$\",\"code\",null,{\"children\":\"with\"}],\" method where the array key is a relationsh"])</script><script>self.__next_f.push([1,"ip name and the array value is a closure that adds additional constraints to the eager loading query:\"]}]\n1d5:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$users = User::with(['posts' =\u003e function ($query) {\\n    $query-\u003ewhere('title', 'like', '%code%');\\n}])-\u003eget();\\n\"}]}]\n1d6:[\"$\",\"p\",null,{\"children\":[\"In this example, Eloquent will only eager load posts where the post's \",[\"$\",\"code\",null,{\"children\":\"title\"}],\" column contains the word \",[\"$\",\"code\",null,{\"children\":\"code\"}],\". You may call other \",[\"$\",\"a\",null,{\"href\":\"/docs/queries\",\"children\":\"query builder\"}],\" methods to further customize the eager loading operation:\"]}]\n1d7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$users = User::with(['posts' =\u003e function ($query) {\\n    $query-\u003eorderBy('created_at', 'desc');\\n}])-\u003eget();\\n\"}]}]\n1d8:[\"$\",\"a\",null,{\"name\":\"constraining-eager-loading-of-morph-to-relationships\"}]\n1d9:[\"$\",\"h4\",null,{\"id\":\"constraining-eager-loading-of-morphto-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#constraining-eager-loading-of-morphto-relationships\",\"children\":[\"Constraining Eager Loading of \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" Relationships\"]}]}]\n1da:[\"$\",\"p\",null,{\"children\":[\"If you are eager loading a \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship, Eloquent will run multiple queries to fetch each type of related model. You may add additional constraints to each of these queries using the \",[\"$\",\"code\",null,{\"children\":\"MorphTo\"}],\" relation's \",[\"$\",\"code\",null,{\"children\":\"constrain\"}],\" method:\"]}]\n1db:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\n$comments = Comment::with(['commentable' =\u003e function (MorphTo $morphTo) {\\n    $morphTo-\u003econstrain([\\n        Post::class =\u003e function ($query) {\\n            $query-\u003ewhereNull('hidden_at');\\n        },\\n        Video::class =\u003e function ($query) {\\n            $query-\u003ewhere('type', 'educational');\\n        },\\n    ]);\\n}])-\u003eget();\\n\"}]}]\n1dc:[\"$\",\"p\",null,{\"children\":[\"In this example, Eloquent will only eager load posts that have not been hidden and videos that have a \",[\"$\",\"code\",null,{\"children\":\"type\"}],\" value of \\\"educational\\\".\"]}]\n1dd:[\"$\",\"a\",null,{\"name\":\"constraining-eager-loads-with-relationship-existence\"}]\n1de:[\"$\",\"h4\",null,{\"id\":\"constraining-eager-loads-with-relationship-existence\",\"children\":[\"$\",\"a\",null,{\"href\":\"#constraining-eager-loads-with-relationship-existence\",\"children\":\"Constraining Eager Loads With Relationship Existence\"}]}]\n1df:[\"$\",\"p\",null,{\"children\":[\"You may sometimes find yourself needing to check for the existence of a relationship while simultaneously loading the relationship based on the same conditions. For example, you may wish to only retrieve \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" models that have child \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models matching a given query condition while also eager loading the matching posts. You may accomplish this using the \",[\"$\",\"code\",null,{\"children\":\"withWhereHas\"}],\" method:\"]}]\n1e0:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$users = User::withWhereHas('posts', function ($query) {\\n    $query-\u003ewhere('featured', true);\\n})-\u003eget();\\n\"}]}]\n1e1:[\"$\",\"a\",null,{\"name\":\"lazy-eager-loading\"}]\n1e2:[\"$\",\"h3\",null,{\"id\":\"lazy-eager-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#lazy-eager-loading\",\"children\":\"Lazy Eager Loading\"}]}]\n1e3:[\"$\",\"p\",null,{\"children\":\"Sometimes you may need to eager load a relationship after the parent model has already been retrieved. For example, this may be useful if you need to dynamically decide whether to load related models:\"}]\n1e4:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Book;\\n\\n$books = Book::all();\\n\\nif ($condition) {\\n    $books-\u003eload('author', 'publisher');\\n}\\n\"}]}]\n1e5:[\"$\",\"p\",null,{\"children\":\"If you need to set add"])</script><script>self.__next_f.push([1,"itional query constraints on the eager loading query, you may pass an array keyed by the relationships you wish to load. The array values should be closure instances which receive the query instance:\"}]\n1e6:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$author-\u003eload(['books' =\u003e function ($query) {\\n    $query-\u003eorderBy('published_date', 'asc');\\n}]);\\n\"}]}]\n1e7:[\"$\",\"p\",null,{\"children\":[\"To load a relationship only when it has not already been loaded, use the \",[\"$\",\"code\",null,{\"children\":\"loadMissing\"}],\" method:\"]}]\n1e8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$book-\u003eloadMissing('author');\\n\"}]}]\n1e9:[\"$\",\"a\",null,{\"name\":\"nested-lazy-eager-loading-morphto\"}]\n1ea:[\"$\",\"h4\",null,{\"id\":\"nested-lazy-eager-loading-and-morphto\",\"children\":[\"$\",\"a\",null,{\"href\":\"#nested-lazy-eager-loading-and-morphto\",\"children\":[\"Nested Lazy Eager Loading and \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}]]}]}]\n1eb:[\"$\",\"p\",null,{\"children\":[\"If you would like to eager load a \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship, as well as nested relationships on the various entities that may be returned by that relationship, you may use the \",[\"$\",\"code\",null,{\"children\":\"loadMorph\"}],\" method.\"]}]\n1ec:[\"$\",\"p\",null,{\"children\":[\"This method accepts the name of the \",[\"$\",\"code\",null,{\"children\":\"morphTo\"}],\" relationship as its first argument, and an array of model / relationship pairs as its second argument. To help illustrate this method, let's consider the following model:\"]}]\n1ed:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\MorphTo;\\n\\nclass ActivityFeed extends Model\\n{\\n    /**\\n     * Get the parent of the activity feed record.\\n     */\\n    public function parentable(): MorphTo\\n    {\\n        return $this-\u003emorphTo();\\n    }\\n}\\n\"}]}]\n1ee:[\"$\",\"p\",null,{\"children\":[\"In this example, let's assume \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\", \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models may create \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" models. Additionally, let's assume that \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\" models belong to a \",[\"$\",\"code\",null,{\"children\":\"Calendar\"}],\" model, \",[\"$\",\"code\",null,{\"children\":\"Photo\"}],\" models are associated with \",[\"$\",\"code\",null,{\"children\":\"Tag\"}],\" models, and \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" models belong to an \",[\"$\",\"code\",null,{\"children\":\"Author\"}],\" model.\"]}]\n1ef:[\"$\",\"p\",null,{\"children\":[\"Using these model definitions and relationships, we may retrieve \",[\"$\",\"code\",null,{\"children\":\"ActivityFeed\"}],\" model instances and eager load all \",[\"$\",\"code\",null,{\"children\":\"parentable\"}],\" models and their respective nested relationships:\"]}]\n1f0:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$activities = ActivityFeed::with('parentable')\\n    -\u003eget()\\n    -\u003eloadMorph('parentable', [\\n        Event::class =\u003e ['calendar'],\\n        Photo::class =\u003e ['tags'],\\n        Post::class =\u003e ['author'],\\n    ]);\\n\"}]}]\n1f1:[\"$\",\"a\",null,{\"name\":\"automatic-eager-loading\"}]\n1f2:[\"$\",\"h3\",null,{\"id\":\"automatic-eager-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#automatic-eager-loading\",\"children\":\"Automatic Eager Loading\"}]}]\n1f3:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"[!WARNING]\\nThis feature is currently in beta in order to gather community feedback. The behavior and functionality of this feature may change even on patch releases.\"}],\"\\n\"]}]\n1f4:[\"$\",\"p\",null,{\"children\":[\"In many cases, Laravel can automatically eager load the relationships you access. To enable automatic eager loading, you should invoke the \",[\"$\",\"code\",null,{\"children\":\"Model::automaticallyEagerLoadRelationships\"}],\" method within the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\":\"]}]\n1f5:[\""])</script><script>self.__next_f.push([1,"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Model;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Model::automaticallyEagerLoadRelationships();\\n}\\n\"}]}]\n1f6:[\"$\",\"p\",null,{\"children\":\"When this feature is enabled, Laravel will attempt to automatically load any relationships you access that have not been previously loaded. For example, consider the following scenario:\"}]\n1f7:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$users = User::all();\\n\\nforeach ($users as $user) {\\n    foreach ($user-\u003eposts as $post) {\\n        foreach ($post-\u003ecomments as $comment) {\\n            echo $comment-\u003econtent;\\n        }\\n    }\\n}\\n\"}]}]\n1f8:[\"$\",\"p\",null,{\"children\":[\"Typically, the code above would execute a query for each user in order to retrieve their posts, as well as a query for each post to retrieve its comments. However, when the \",[\"$\",\"code\",null,{\"children\":\"automaticallyEagerLoadRelationships\"}],\" feature has been enabled, Laravel will automatically \",[\"$\",\"a\",null,{\"href\":\"#lazy-eager-loading\",\"children\":\"lazy eager load\"}],\" the posts for all users in the user collection when you attempt to access the posts on any of the retrieved users. Likewise, when you attempt to access the comments for any retrieved post, all comments will be lazy eager loaded for all posts that were originally retrieved.\"]}]\n1f9:[\"$\",\"p\",null,{\"children\":[\"If you do not want to globally enable automatic eager loading, you can still enable this feature for a single Eloquent collection instance by invoking the \",[\"$\",\"code\",null,{\"children\":\"withRelationshipAutoloading\"}],\" method on the collection:\"]}]\n1fa:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$users = User::where('vip', true)-\u003eget();\\n\\nreturn $users-\u003ewithRelationshipAutoloading();\\n\"}]}]\n1fb:[\"$\",\"a\",null,{\"name\":\"preventing-lazy-loading\"}]\n1fc:[\"$\",\"h3\",null,{\"id\":\"preventing-lazy-loading\",\"children\":[\"$\",\"a\",null,{\"href\":\"#preventing-lazy-loading\",\"children\":\"Preventing Lazy Loading\"}]}]\n1fd:[\"$\",\"p\",null,{\"children\":[\"As previously discussed, eager loading relationships can often provide significant performance benefits to your application. Therefore, if you would like, you may instruct Laravel to always prevent the lazy loading of relationships. To accomplish this, you may invoke the \",[\"$\",\"code\",null,{\"children\":\"preventLazyLoading\"}],\" method offered by the base Eloquent model class. Typically, you should call this method within the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\" class.\"]}]\n1fe:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"preventLazyLoading\"}],\" method accepts an optional boolean argument that indicates if lazy loading should be prevented. For example, you may wish to only disable lazy loading in non-production environments so that your production environment will continue to function normally even if a lazy loaded relationship is accidentally present in production code:\"]}]\n1ff:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use Illuminate\\\\Database\\\\Eloquent\\\\Model;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Model::preventLazyLoading(! $this-\u003eapp-\u003eisProduction());\\n}\\n\"}]}]\n200:[\"$\",\"p\",null,{\"children\":[\"After preventing lazy loading, Eloquent will throw a \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Database\\\\LazyLoadingViolationException\"}],\" exception when your application attempts to lazy load any Eloquent relationship.\"]}]\n201:[\"$\",\"p\",null,{\"children\":[\"You may customize the behavior of lazy loading violations using the \",[\"$\",\"code\",null,{\"children\":\"handleLazyLoadingViolationsUsing\"}],\" method. For example, using this method, you may instruct lazy loading violations to only be logged instead of interrupting the application's execution with exceptions:\"]}]\n202:"])</script><script>self.__next_f.push([1,"[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Model::handleLazyLoadingViolationUsing(function (Model $model, string $relation) {\\n    $class = $model::class;\\n\\n    info(\\\"Attempted to lazy load [{$relation}] on model [{$class}].\\\");\\n});\\n\"}]}]\n203:[\"$\",\"a\",null,{\"name\":\"inserting-and-updating-related-models\"}]\n204:[\"$\",\"h2\",null,{\"id\":\"inserting-and-updating-related-models\",\"children\":[\"$\",\"a\",null,{\"href\":\"#inserting-and-updating-related-models\",\"children\":\"Inserting and Updating Related Models\"}]}]\n205:[\"$\",\"a\",null,{\"name\":\"the-save-method\"}]\n206:[\"$\",\"h3\",null,{\"id\":\"the-save-method\",\"children\":[\"$\",\"a\",null,{\"href\":\"#the-save-method\",\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" Method\"]}]}]\n207:[\"$\",\"p\",null,{\"children\":[\"Eloquent provides convenient methods for adding new models to relationships. For example, perhaps you need to add a new comment to a post. Instead of manually setting the \",[\"$\",\"code\",null,{\"children\":\"post_id\"}],\" attribute on the \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model you may insert the comment using the relationship's \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" method:\"]}]\n208:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Comment;\\nuse App\\\\Models\\\\Post;\\n\\n$comment = new Comment(['message' =\u003e 'A new comment.']);\\n\\n$post = Post::find(1);\\n\\n$post-\u003ecomments()-\u003esave($comment);\\n\"}]}]\n209:[\"$\",\"p\",null,{\"children\":[\"Note that we did not access the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" relationship as a dynamic property. Instead, we called the \",[\"$\",\"code\",null,{\"children\":\"comments\"}],\" method to obtain an instance of the relationship. The \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" method will automatically add the appropriate \",[\"$\",\"code\",null,{\"children\":\"post_id\"}],\" value to the new \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model.\"]}]\n20a:[\"$\",\"p\",null,{\"children\":[\"If you need to save multiple related models, you may use the \",[\"$\",\"code\",null,{\"children\":\"saveMany\"}],\" method:\"]}]\n20b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post = Post::find(1);\\n\\n$post-\u003ecomments()-\u003esaveMany([\\n    new Comment(['message' =\u003e 'A new comment.']),\\n    new Comment(['message' =\u003e 'Another new comment.']),\\n]);\\n\"}]}]\n20c:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"saveMany\"}],\" methods will persist the given model instances, but will not add the newly persisted models to any in-memory relationships that are already loaded onto the parent model. If you plan on accessing the relationship after using the \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"saveMany\"}],\" methods, you may wish to use the \",[\"$\",\"code\",null,{\"children\":\"refresh\"}],\" method to reload the model and its relationships:\"]}]\n20d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post-\u003ecomments()-\u003esave($comment);\\n\\n$post-\u003erefresh();\\n\\n// All comments, including the newly saved comment...\\n$post-\u003ecomments;\\n\"}]}]\n20e:[\"$\",\"a\",null,{\"name\":\"the-push-method\"}]\n20f:[\"$\",\"h4\",null,{\"id\":\"recursively-saving-models-and-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#recursively-saving-models-and-relationships\",\"children\":\"Recursively Saving Models and Relationships\"}]}]\n210:[\"$\",\"p\",null,{\"children\":[\"If you would like to \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" your model and all of its associated relationships, you may use the \",[\"$\",\"code\",null,{\"children\":\"push\"}],\" method. In this example, the \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" model will be saved as well as its comments and the comment's authors:\"]}]\n211:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post = Post::find(1);\\n\\n$post-\u003ecomments[0]-\u003emessage = 'Message';\\n$post-\u003ecomments[0]-\u003eauthor-\u003ename = 'Author Name';\\n\\n$post-\u003epush();\\n\"}]}]\n212:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"pushQuietly\"}],\" method may be used"])</script><script>self.__next_f.push([1," to save a model and its associated relationships without raising any events:\"]}]\n213:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post-\u003epushQuietly();\\n\"}]}]\n214:[\"$\",\"a\",null,{\"name\":\"the-create-method\"}]\n215:[\"$\",\"h3\",null,{\"id\":\"the-create-method\",\"children\":[\"$\",\"a\",null,{\"href\":\"#the-create-method\",\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" Method\"]}]}]\n216:[\"$\",\"p\",null,{\"children\":[\"In addition to the \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"saveMany\"}],\" methods, you may also use the \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" method, which accepts an array of attributes, creates a model, and inserts it into the database. The difference between \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" is that \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" accepts a full Eloquent model instance while \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" accepts a plain PHP \",[\"$\",\"code\",null,{\"children\":\"array\"}],\". The newly created model will be returned by the \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" method:\"]}]\n217:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Post;\\n\\n$post = Post::find(1);\\n\\n$comment = $post-\u003ecomments()-\u003ecreate([\\n    'message' =\u003e 'A new comment.',\\n]);\\n\"}]}]\n218:[\"$\",\"p\",null,{\"children\":[\"You may use the \",[\"$\",\"code\",null,{\"children\":\"createMany\"}],\" method to create multiple related models:\"]}]\n219:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$post = Post::find(1);\\n\\n$post-\u003ecomments()-\u003ecreateMany([\\n    ['message' =\u003e 'A new comment.'],\\n    ['message' =\u003e 'Another new comment.'],\\n]);\\n\"}]}]\n21a:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"createQuietly\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"createManyQuietly\"}],\" methods may be used to create a model(s) without dispatching any events:\"]}]\n21b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user = User::find(1);\\n\\n$user-\u003eposts()-\u003ecreateQuietly([\\n    'title' =\u003e 'Post title.',\\n]);\\n\\n$user-\u003eposts()-\u003ecreateManyQuietly([\\n    ['title' =\u003e 'First post.'],\\n    ['title' =\u003e 'Second post.'],\\n]);\\n\"}]}]\n21c:[\"$\",\"p\",null,{\"children\":[\"You may also use the \",[\"$\",\"code\",null,{\"children\":\"findOrNew\"}],\", \",[\"$\",\"code\",null,{\"children\":\"firstOrNew\"}],\", \",[\"$\",\"code\",null,{\"children\":\"firstOrCreate\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"updateOrCreate\"}],\" methods to \",[\"$\",\"a\",null,{\"href\":\"/docs/eloquent#upserts\",\"children\":\"create and update models on relationships\"}],\".\"]}]\n21d:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nBefore using the \",[\"$\",\"code\",null,{\"children\":\"create\"}],\" method, be sure to review the \",[\"$\",\"a\",null,{\"href\":\"/docs/eloquent#mass-assignment\",\"children\":\"mass assignment\"}],\" documentation.\"]}],\"\\n\"]}]\n21e:[\"$\",\"a\",null,{\"name\":\"updating-belongs-to-relationships\"}]\n21f:[\"$\",\"h3\",null,{\"id\":\"belongs-to-relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#belongs-to-relationships\",\"children\":\"Belongs To Relationships\"}]}]\n220:[\"$\",\"p\",null,{\"children\":[\"If you would like to assign a child model to a new parent model, you may use the \",[\"$\",\"code\",null,{\"children\":\"associate\"}],\" method. In this example, the \",[\"$\",\"code\",null,{\"children\":\"User\"}],\" model defines a \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" relationship to the \",[\"$\",\"code\",null,{\"children\":\"Account\"}],\" model. This \",[\"$\",\"code\",null,{\"children\":\"associate\"}],\" method will set the foreign key on the child model:\"]}]\n221:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\Account;\\n\\n$account = Account::find(10);\\n\\n$user-\u003eaccount()-\u003eassociate($account);\\n\\n$user-\u003esave();\\n\"}]}]\n222:[\"$\",\"p\",null,{\"children\":[\"To remove a parent model from a child model, you may use the \",[\"$\",\"code\",null,{\"children\":\"dissociate\"}],\" method. This method will set the relationship's foreign key to \",[\"$\",\"code\",null,"])</script><script>self.__next_f.push([1,"{\"children\":\"null\"}],\":\"]}]\n223:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eaccount()-\u003edissociate();\\n\\n$user-\u003esave();\\n\"}]}]\n224:[\"$\",\"a\",null,{\"name\":\"updating-many-to-many-relationships\"}]\n225:[\"$\",\"h3\",null,{\"id\":\"many-to-many-relationships-1\",\"children\":[\"$\",\"a\",null,{\"href\":\"#many-to-many-relationships-1\",\"children\":\"Many to Many Relationships\"}]}]\n226:[\"$\",\"a\",null,{\"name\":\"attaching-detaching\"}]\n227:[\"$\",\"h4\",null,{\"id\":\"attaching--detaching\",\"children\":[\"$\",\"a\",null,{\"href\":\"#attaching--detaching\",\"children\":\"Attaching / Detaching\"}]}]\n228:[\"$\",\"p\",null,{\"children\":[\"Eloquent also provides methods to make working with many-to-many relationships more convenient. For example, let's imagine a user can have many roles and a role can have many users. You may use the \",[\"$\",\"code\",null,{\"children\":\"attach\"}],\" method to attach a role to a user by inserting a record in the relationship's intermediate table:\"]}]\n229:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\n\\n$user = User::find(1);\\n\\n$user-\u003eroles()-\u003eattach($roleId);\\n\"}]}]\n22a:[\"$\",\"p\",null,{\"children\":\"When attaching a relationship to a model, you may also pass an array of additional data to be inserted into the intermediate table:\"}]\n22b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003eattach($roleId, ['expires' =\u003e $expires]);\\n\"}]}]\n22c:[\"$\",\"p\",null,{\"children\":[\"Sometimes it may be necessary to remove a role from a user. To remove a many-to-many relationship record, use the \",[\"$\",\"code\",null,{\"children\":\"detach\"}],\" method. The \",[\"$\",\"code\",null,{\"children\":\"detach\"}],\" method will delete the appropriate record out of the intermediate table; however, both models will remain in the database:\"]}]\n22d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"// Detach a single role from the user...\\n$user-\u003eroles()-\u003edetach($roleId);\\n\\n// Detach all roles from the user...\\n$user-\u003eroles()-\u003edetach();\\n\"}]}]\n22e:[\"$\",\"p\",null,{\"children\":[\"For convenience, \",[\"$\",\"code\",null,{\"children\":\"attach\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"detach\"}],\" also accept arrays of IDs as input:\"]}]\n22f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user = User::find(1);\\n\\n$user-\u003eroles()-\u003edetach([1, 2, 3]);\\n\\n$user-\u003eroles()-\u003eattach([\\n    1 =\u003e ['expires' =\u003e $expires],\\n    2 =\u003e ['expires' =\u003e $expires],\\n]);\\n\"}]}]\n230:[\"$\",\"a\",null,{\"name\":\"syncing-associations\"}]\n231:[\"$\",\"h4\",null,{\"id\":\"syncing-associations\",\"children\":[\"$\",\"a\",null,{\"href\":\"#syncing-associations\",\"children\":\"Syncing Associations\"}]}]\n232:[\"$\",\"p\",null,{\"children\":[\"You may also use the \",[\"$\",\"code\",null,{\"children\":\"sync\"}],\" method to construct many-to-many associations. The \",[\"$\",\"code\",null,{\"children\":\"sync\"}],\" method accepts an array of IDs to place on the intermediate table. Any IDs that are not in the given array will be removed from the intermediate table. So, after this operation is complete, only the IDs in the given array will exist in the intermediate table:\"]}]\n233:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003esync([1, 2, 3]);\\n\"}]}]\n234:[\"$\",\"p\",null,{\"children\":\"You may also pass additional intermediate table values with the IDs:\"}]\n235:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003esync([1 =\u003e ['expires' =\u003e true], 2, 3]);\\n\"}]}]\n236:[\"$\",\"p\",null,{\"children\":[\"If you would like to insert the same intermediate table values with each of the synced model IDs, you may use the \",[\"$\",\"code\",null,{\"children\":\"syncWithPivotValues\"}],\" method:\"]}]\n237:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003esyncWithPivotValues([1, 2, 3], ['active' =\u003e true]);\\n\"}]}]\n238:[\"$\",\"p\",null,{\"children\":[\"If you do not want to detach existing IDs that are missing from the given array, you may use the \",[\"$\",\"code\",null,{\"chi"])</script><script>self.__next_f.push([1,"ldren\":\"syncWithoutDetaching\"}],\" method:\"]}]\n239:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003esyncWithoutDetaching([1, 2, 3]);\\n\"}]}]\n23a:[\"$\",\"a\",null,{\"name\":\"toggling-associations\"}]\n23b:[\"$\",\"h4\",null,{\"id\":\"toggling-associations\",\"children\":[\"$\",\"a\",null,{\"href\":\"#toggling-associations\",\"children\":\"Toggling Associations\"}]}]\n23c:[\"$\",\"p\",null,{\"children\":[\"The many-to-many relationship also provides a \",[\"$\",\"code\",null,{\"children\":\"toggle\"}],\" method which \\\"toggles\\\" the attachment status of the given related model IDs. If the given ID is currently attached, it will be detached. Likewise, if it is currently detached, it will be attached:\"]}]\n23d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003etoggle([1, 2, 3]);\\n\"}]}]\n23e:[\"$\",\"p\",null,{\"children\":\"You may also pass additional intermediate table values with the IDs:\"}]\n23f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user-\u003eroles()-\u003etoggle([\\n    1 =\u003e ['expires' =\u003e true],\\n    2 =\u003e ['expires' =\u003e true],\\n]);\\n\"}]}]\n240:[\"$\",\"a\",null,{\"name\":\"updating-a-record-on-the-intermediate-table\"}]\n241:[\"$\",\"h4\",null,{\"id\":\"updating-a-record-on-the-intermediate-table\",\"children\":[\"$\",\"a\",null,{\"href\":\"#updating-a-record-on-the-intermediate-table\",\"children\":\"Updating a Record on the Intermediate Table\"}]}]\n242:[\"$\",\"p\",null,{\"children\":[\"If you need to update an existing row in your relationship's intermediate table, you may use the \",[\"$\",\"code\",null,{\"children\":\"updateExistingPivot\"}],\" method. This method accepts the intermediate record foreign key and an array of attributes to update:\"]}]\n243:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"$$user = User::find(1);\\n\\n$user-\u003eroles()-\u003eupdateExistingPivot($roleId, [\\n    'active' =\u003e false,\\n]);\\n\"}]}]\n244:[\"$\",\"a\",null,{\"name\":\"touching-parent-timestamps\"}]\n245:[\"$\",\"h2\",null,{\"id\":\"touching-parent-timestamps\",\"children\":[\"$\",\"a\",null,{\"href\":\"#touching-parent-timestamps\",\"children\":\"Touching Parent Timestamps\"}]}]\n246:[\"$\",\"p\",null,{\"children\":[\"When a model defines a \",[\"$\",\"code\",null,{\"children\":\"belongsTo\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"belongsToMany\"}],\" relationship to another model, such as a \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" which belongs to a \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\", it is sometimes helpful to update the parent's timestamp when the child model is updated.\"]}]\n247:[\"$\",\"p\",null,{\"children\":[\"For example, when a \",[\"$\",\"code\",null,{\"children\":\"Comment\"}],\" model is updated, you may want to automatically \\\"touch\\\" the \",[\"$\",\"code\",null,{\"children\":\"updated_at\"}],\" timestamp of the owning \",[\"$\",\"code\",null,{\"children\":\"Post\"}],\" so that it is set to the current date and time. To accomplish this, you may add a \",[\"$\",\"code\",null,{\"children\":\"touches\"}],\" property to your child model containing the names of the relationships that should have their \",[\"$\",\"code\",null,{\"children\":\"updated_at\"}],\" timestamps updated when the child model is updated:\"]}]\n248:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Models;\\n\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Model;\\nuse Illuminate\\\\Database\\\\Eloquent\\\\Relations\\\\BelongsTo;\\n\\nclass Comment extends Model\\n{\\n    /**\\n     * All of the relationships to be touched.\\n     *\\n     * @var array\\n     */\\n    protected $touches = ['post'];\\n\\n    /**\\n     * Get the post that the comment belongs to.\\n     */\\n    public function post(): BelongsTo\\n    {\\n        return $this-\u003ebelongsTo(Post::class);\\n    }\\n}\\n\"}]}]\n249:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nParent model timestamps will only be updated if the child model is updated using Eloquent's \",[\"$\",\"code\",null,{\"children\":\"save\"}],\" method.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"24a:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L24a\",\"3\",{}]]\n8:null\n"])</script></body></html>