<!DOCTYPE html><!--064VbOcPM65IQylKQ_S9h--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/8d8bfdb8c7183f74.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/87a939617be2fa8c.js" async=""></script><script src="/_next/static/chunks/8368f298651cbd89.js" async=""></script><script src="/_next/static/chunks/6740f161f60c6ab5.js" async=""></script><script src="/_next/static/chunks/turbopack-929fc2ce3ca903db.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/16ad486f9df855f5.js" async=""></script><meta name="next-size-adjust" content=""/><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen bg-background"><div class="w-64 border-r bg-background h-screen sticky top-0 hidden md:block"><div class="p-6 font-bold text-xl border-b flex items-center gap-2"><span class="text-red-600">Laravel</span> Docs（中文）</div><div dir="ltr" data-slot="scroll-area" class="relative h-[calc(100vh-65px)]" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-4 space-y-2"><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>前言</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">發行說明</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>入門</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><div class="ml-4 mt-1 space-y-1"><a class="block" href="/docs/installation"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">安裝</button></a><a class="block" href="/docs/configuration"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">配置</button></a><a class="block" href="/docs/structure"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">目錄結構</button></a><a class="block" href="/docs/lifecycle"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">生命週期</button></a><a class="block" href="/docs/frontend"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">前端</button></a><a class="block" href="/docs/starter-kits"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">啟動套件</button></a><a class="block" href="/docs/deployment"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">部署</button></a></div></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>架構</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>基礎功能</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>深入探討</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>安全性</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>資料庫</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>Eloquent ORM</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>測試</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>其他</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div><button class="w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors"><span>官方套件</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-4 w-4" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="border-t pt-4 space-y-2"><a class="block" href="/docs/api"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">API 文件</button></a><a class="block" href="/docs/releases"><button data-slot="button" class="inline-flex items-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full justify-start font-normal text-sm">更新日誌</button></a></div></div></div></div></div></div><main class="flex-1 relative"><div class="container mx-auto py-10"><div class="mx-auto max-w-3xl"><div class="mb-8"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Events</h1><p class="text-xl text-muted-foreground mt-2">Laravel events 提供簡單的觀察者模式實作</p></div><article class="prose prose-slate dark:prose-invert max-w-none"><h1 id="events"><a href="#events">Events</a></h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#generating-events-and-listeners">Generating Events and Listeners</a></li>
<li><a href="#registering-events-and-listeners">Registering Events and Listeners</a>
<ul>
<li><a href="#event-discovery">Event Discovery</a></li>
<li><a href="#manually-registering-events">Manually Registering Events</a></li>
<li><a href="#closure-listeners">Closure Listeners</a></li>
</ul>
</li>
<li><a href="#defining-events">Defining Events</a></li>
<li><a href="#defining-listeners">Defining Listeners</a></li>
<li><a href="#queued-event-listeners">Queued Event Listeners</a>
<ul>
<li><a href="#manually-interacting-with-the-queue">Manually Interacting With the Queue</a></li>
<li><a href="#queued-event-listeners-and-database-transactions">Queued Event Listeners and Database Transactions</a></li>
<li><a href="#queued-listener-middleware">Queued Listener Middleware</a></li>
<li><a href="#encrypted-queued-listeners">Encrypted Queued Listeners</a></li>
<li><a href="#handling-failed-jobs">Handling Failed Jobs</a></li>
</ul>
</li>
<li><a href="#dispatching-events">Dispatching Events</a>
<ul>
<li><a href="#dispatching-events-after-database-transactions">Dispatching Events After Database Transactions</a></li>
<li><a href="#deferring-events">Deferring Events</a></li>
</ul>
</li>
<li><a href="#event-subscribers">Event Subscribers</a>
<ul>
<li><a href="#writing-event-subscribers">Writing Event Subscribers</a></li>
<li><a href="#registering-event-subscribers">Registering Event Subscribers</a></li>
</ul>
</li>
<li><a href="#testing">Testing</a>
<ul>
<li><a href="#faking-a-subset-of-events">Faking a Subset of Events</a></li>
<li><a href="#scoped-event-fakes">Scoped Events Fakes</a></li>
</ul>
</li>
</ul>
<a name="introduction"></a>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p>Laravel&#x27;s events provide a simple observer pattern implementation, allowing you to subscribe and listen for various events that occur within your application. Event classes are typically stored in the <code>app/Events</code> directory, while their listeners are stored in <code>app/Listeners</code>. Don&#x27;t worry if you don&#x27;t see these directories in your application as they will be created for you as you generate events and listeners using Artisan console commands.</p>
<p>Events serve as a great way to decouple various aspects of your application, since a single event can have multiple listeners that do not depend on each other. For example, you may wish to send a Slack notification to your user each time an order has shipped. Instead of coupling your order processing code to your Slack notification code, you can raise an <code>App\Events\OrderShipped</code> event which a listener can receive and use to dispatch a Slack notification.</p>
<a name="generating-events-and-listeners"></a>
<h2 id="generating-events-and-listeners"><a href="#generating-events-and-listeners">Generating Events and Listeners</a></h2>
<p>To quickly generate events and listeners, you may use the <code>make:event</code> and <code>make:listener</code> Artisan commands:</p>
<pre><code class="language-shell">php artisan make:event PodcastProcessed

php artisan make:listener SendPodcastNotification --event=PodcastProcessed
</code></pre>
<p>For convenience, you may also invoke the <code>make:event</code> and <code>make:listener</code> Artisan commands without additional arguments. When you do so, Laravel will automatically prompt you for the class name and, when creating a listener, the event it should listen to:</p>
<pre><code class="language-shell">php artisan make:event

php artisan make:listener
</code></pre>
<a name="registering-events-and-listeners"></a>
<h2 id="registering-events-and-listeners"><a href="#registering-events-and-listeners">Registering Events and Listeners</a></h2>
<a name="event-discovery"></a>
<h3 id="event-discovery"><a href="#event-discovery">Event Discovery</a></h3>
<p>By default, Laravel will automatically find and register your event listeners by scanning your application&#x27;s <code>Listeners</code> directory. When Laravel finds any listener class method that begins with <code>handle</code> or <code>__invoke</code>, Laravel will register those methods as event listeners for the event that is type-hinted in the method&#x27;s signature:</p>
<pre><code class="language-php">use App\Events\PodcastProcessed;

class SendPodcastNotification
{
    /**
     * Handle the event.
     */
    public function handle(PodcastProcessed $event): void
    {
        // ...
    }
}
</code></pre>
<p>You may listen to multiple events using PHP&#x27;s union types:</p>
<pre><code class="language-php">/**
 * Handle the event.
 */
public function handle(PodcastProcessed|PodcastPublished $event): void
{
    // ...
}
</code></pre>
<p>If you plan to store your listeners in a different directory or within multiple directories, you may instruct Laravel to scan those directories using the <code>withEvents</code> method in your application&#x27;s <code>bootstrap/app.php</code> file:</p>
<pre><code class="language-php">-&gt;withEvents(discover: [
    __DIR__.&#x27;/../app/Domain/Orders/Listeners&#x27;,
])
</code></pre>
<p>You may scan for listeners in multiple similar directories using the <code>*</code> character as a wildcard:</p>
<pre><code class="language-php">-&gt;withEvents(discover: [
    __DIR__.&#x27;/../app/Domain/*/Listeners&#x27;,
])
</code></pre>
<p>The <code>event:list</code> command may be used to list all of the listeners registered within your application:</p>
<pre><code class="language-shell">php artisan event:list
</code></pre>
<a name="event-discovery-in-production"></a>
<h4 id="event-discovery-in-production"><a href="#event-discovery-in-production">Event Discovery in Production</a></h4>
<p>To give your application a speed boost, you should cache a manifest of all of your application&#x27;s listeners using the <code>optimize</code> or <code>event:cache</code> Artisan commands. Typically, this command should be run as part of your application&#x27;s <a href="/docs/%7B&#x27;12.x&#x27;%7D/deployment#optimization">deployment process</a>. This manifest will be used by the framework to speed up the event registration process. The <code>event:clear</code> command may be used to destroy the event cache.</p>
<a name="manually-registering-events"></a>
<h3 id="manually-registering-events"><a href="#manually-registering-events">Manually Registering Events</a></h3>
<p>Using the <code>Event</code> facade, you may manually register events and their corresponding listeners within the <code>boot</code> method of your application&#x27;s <code>AppServiceProvider</code>:</p>
<pre><code class="language-php">use App\Domain\Orders\Events\PodcastProcessed;
use App\Domain\Orders\Listeners\SendPodcastNotification;
use Illuminate\Support\Facades\Event;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Event::listen(
        PodcastProcessed::class,
        SendPodcastNotification::class,
    );
}
</code></pre>
<p>The <code>event:list</code> command may be used to list all of the listeners registered within your application:</p>
<pre><code class="language-shell">php artisan event:list
</code></pre>
<a name="closure-listeners"></a>
<h3 id="closure-listeners"><a href="#closure-listeners">Closure Listeners</a></h3>
<p>Typically, listeners are defined as classes; however, you may also manually register closure-based event listeners in the <code>boot</code> method of your application&#x27;s <code>AppServiceProvider</code>:</p>
<pre><code class="language-php">use App\Events\PodcastProcessed;
use Illuminate\Support\Facades\Event;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Event::listen(function (PodcastProcessed $event) {
        // ...
    });
}
</code></pre>
<a name="queuable-anonymous-event-listeners"></a>
<h4 id="queueable-anonymous-event-listeners"><a href="#queueable-anonymous-event-listeners">Queueable Anonymous Event Listeners</a></h4>
<p>When registering closure-based event listeners, you may wrap the listener closure within the <code>Illuminate\Events\queueable</code> function to instruct Laravel to execute the listener using the <a href="/docs/%7B&#x27;12.x&#x27;%7D/queues">queue</a>:</p>
<pre><code class="language-php">use App\Events\PodcastProcessed;
use function Illuminate\Events\queueable;
use Illuminate\Support\Facades\Event;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Event::listen(queueable(function (PodcastProcessed $event) {
        // ...
    }));
}
</code></pre>
<p>Like queued jobs, you may use the <code>onConnection</code>, <code>onQueue</code>, and <code>delay</code> methods to customize the execution of the queued listener:</p>
<pre><code class="language-php">Event::listen(queueable(function (PodcastProcessed $event) {
    // ...
})-&gt;onConnection(&#x27;redis&#x27;)-&gt;onQueue(&#x27;podcasts&#x27;)-&gt;delay(now()-&gt;addSeconds(10)));
</code></pre>
<p>If you would like to handle anonymous queued listener failures, you may provide a closure to the <code>catch</code> method while defining the <code>queueable</code> listener. This closure will receive the event instance and the <code>Throwable</code> instance that caused the listener&#x27;s failure:</p>
<pre><code class="language-php">use App\Events\PodcastProcessed;
use function Illuminate\Events\queueable;
use Illuminate\Support\Facades\Event;
use Throwable;

Event::listen(queueable(function (PodcastProcessed $event) {
    // ...
})-&gt;catch(function (PodcastProcessed $event, Throwable $e) {
    // The queued listener failed...
}));
</code></pre>
<a name="wildcard-event-listeners"></a>
<h4 id="wildcard-event-listeners"><a href="#wildcard-event-listeners">Wildcard Event Listeners</a></h4>
<p>You may also register listeners using the <code>*</code> character as a wildcard parameter, allowing you to catch multiple events on the same listener. Wildcard listeners receive the event name as their first argument and the entire event data array as their second argument:</p>
<pre><code class="language-php">Event::listen(&#x27;event.*&#x27;, function (string $eventName, array $data) {
    // ...
});
</code></pre>
<a name="defining-events"></a>
<h2 id="defining-events"><a href="#defining-events">Defining Events</a></h2>
<p>An event class is essentially a data container which holds the information related to the event. For example, let&#x27;s assume an <code>App\Events\OrderShipped</code> event receives an <a href="/docs/%7B&#x27;12.x&#x27;%7D/eloquent">Eloquent ORM</a> object:</p>
<pre><code class="language-php">&lt;?php

namespace App\Events;

use App\Models\Order;
use Illuminate\Broadcasting\InteractsWithSockets;
use Illuminate\Foundation\Events\Dispatchable;
use Illuminate\Queue\SerializesModels;

class OrderShipped
{
    use Dispatchable, InteractsWithSockets, SerializesModels;

    /**
     * Create a new event instance.
     */
    public function __construct(
        public Order $order,
    ) {}
}
</code></pre>
<p>As you can see, this event class contains no logic. It is a container for the <code>App\Models\Order</code> instance that was purchased. The <code>SerializesModels</code> trait used by the event will gracefully serialize any Eloquent models if the event object is serialized using PHP&#x27;s <code>serialize</code> function, such as when utilizing <a href="#queued-event-listeners">queued listeners</a>.</p>
<a name="defining-listeners"></a>
<h2 id="defining-listeners"><a href="#defining-listeners">Defining Listeners</a></h2>
<p>Next, let&#x27;s take a look at the listener for our example event. Event listeners receive event instances in their <code>handle</code> method. The <code>make:listener</code> Artisan command, when invoked with the <code>--event</code> option, will automatically import the proper event class and type-hint the event in the <code>handle</code> method. Within the <code>handle</code> method, you may perform any actions necessary to respond to the event:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;

class SendShipmentNotification
{
    /**
     * Create the event listener.
     */
    public function __construct() {}

    /**
     * Handle the event.
     */
    public function handle(OrderShipped $event): void
    {
        // Access the order using $event-&gt;order...
    }
}
</code></pre>
<blockquote>
<p>[!NOTE]
Your event listeners may also type-hint any dependencies they need on their constructors. All event listeners are resolved via the Laravel <a href="/docs/%7B&#x27;12.x&#x27;%7D/container">service container</a>, so dependencies will be injected automatically.</p>
</blockquote>
<a name="stopping-the-propagation-of-an-event"></a>
<h4 id="stopping-the-propagation-of-an-event"><a href="#stopping-the-propagation-of-an-event">Stopping The Propagation Of An Event</a></h4>
<p>Sometimes, you may wish to stop the propagation of an event to other listeners. You may do so by returning <code>false</code> from your listener&#x27;s <code>handle</code> method.</p>
<a name="queued-event-listeners"></a>
<h2 id="queued-event-listeners"><a href="#queued-event-listeners">Queued Event Listeners</a></h2>
<p>Queueing listeners can be beneficial if your listener is going to perform a slow task such as sending an email or making an HTTP request. Before using queued listeners, make sure to <a href="/docs/%7B&#x27;12.x&#x27;%7D/queues">configure your queue</a> and start a queue worker on your server or local development environment.</p>
<p>To specify that a listener should be queued, add the <code>ShouldQueue</code> interface to the listener class. Listeners generated by the <code>make:listener</code> Artisan commands already have this interface imported into the current namespace so you can use it immediately:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue
{
    // ...
}
</code></pre>
<p>That&#x27;s it! Now, when an event handled by this listener is dispatched, the listener will automatically be queued by the event dispatcher using Laravel&#x27;s <a href="/docs/%7B&#x27;12.x&#x27;%7D/queues">queue system</a>. If no exceptions are thrown when the listener is executed by the queue, the queued job will automatically be deleted after it has finished processing.</p>
<a name="customizing-the-queue-connection-queue-name"></a>
<h4 id="customizing-the-queue-connection-name--delay"><a href="#customizing-the-queue-connection-name--delay">Customizing The Queue Connection, Name, &amp; Delay</a></h4>
<p>If you would like to customize the queue connection, queue name, or queue delay time of an event listener, you may define the <code>$connection</code>, <code>$queue</code>, or <code>$delay</code> properties on your listener class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue
{
    /**
     * The name of the connection the job should be sent to.
     *
     * @var string|null
     */
    public $connection = &#x27;sqs&#x27;;

    /**
     * The name of the queue the job should be sent to.
     *
     * @var string|null
     */
    public $queue = &#x27;listeners&#x27;;

    /**
     * The time (seconds) before the job should be processed.
     *
     * @var int
     */
    public $delay = 60;
}
</code></pre>
<p>If you would like to define the listener&#x27;s queue connection, queue name, or delay at runtime, you may define <code>viaConnection</code>, <code>viaQueue</code>, or <code>withDelay</code> methods on the listener:</p>
<pre><code class="language-php">/**
 * Get the name of the listener&#x27;s queue connection.
 */
public function viaConnection(): string
{
    return &#x27;sqs&#x27;;
}

/**
 * Get the name of the listener&#x27;s queue.
 */
public function viaQueue(): string
{
    return &#x27;listeners&#x27;;
}

/**
 * Get the number of seconds before the job should be processed.
 */
public function withDelay(OrderShipped $event): int
{
    return $event-&gt;highPriority ? 0 : 60;
}
</code></pre>
<a name="conditionally-queueing-listeners"></a>
<h4 id="conditionally-queueing-listeners"><a href="#conditionally-queueing-listeners">Conditionally Queueing Listeners</a></h4>
<p>Sometimes, you may need to determine whether a listener should be queued based on some data that are only available at runtime. To accomplish this, a <code>shouldQueue</code> method may be added to a listener to determine whether the listener should be queued. If the <code>shouldQueue</code> method returns <code>false</code>, the listener will not be queued:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderCreated;
use Illuminate\Contracts\Queue\ShouldQueue;

class RewardGiftCard implements ShouldQueue
{
    /**
     * Reward a gift card to the customer.
     */
    public function handle(OrderCreated $event): void
    {
        // ...
    }

    /**
     * Determine whether the listener should be queued.
     */
    public function shouldQueue(OrderCreated $event): bool
    {
        return $event-&gt;order-&gt;subtotal &gt;= 5000;
    }
}
</code></pre>
<a name="manually-interacting-with-the-queue"></a>
<h3 id="manually-interacting-with-the-queue"><a href="#manually-interacting-with-the-queue">Manually Interacting With the Queue</a></h3>
<p>If you need to manually access the listener&#x27;s underlying queue job&#x27;s <code>delete</code> and <code>release</code> methods, you may do so using the <code>Illuminate\Queue\InteractsWithQueue</code> trait. This trait is imported by default on generated listeners and provides access to these methods:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Queue\InteractsWithQueue;

class SendShipmentNotification implements ShouldQueue
{
    use InteractsWithQueue;

    /**
     * Handle the event.
     */
    public function handle(OrderShipped $event): void
    {
        if ($condition) {
            $this-&gt;release(30);
        }
    }
}
</code></pre>
<a name="queued-event-listeners-and-database-transactions"></a>
<h3 id="queued-event-listeners-and-database-transactions"><a href="#queued-event-listeners-and-database-transactions">Queued Event Listeners and Database Transactions</a></h3>
<p>When queued listeners are dispatched within database transactions, they may be processed by the queue before the database transaction has committed. When this happens, any updates you have made to models or database records during the database transaction may not yet be reflected in the database. In addition, any models or database records created within the transaction may not exist in the database. If your listener depends on these models, unexpected errors can occur when the job that dispatches the queued listener is processed.</p>
<p>If your queue connection&#x27;s <code>after_commit</code> configuration option is set to <code>false</code>, you may still indicate that a particular queued listener should be dispatched after all open database transactions have been committed by implementing the <code>ShouldQueueAfterCommit</code> interface on the listener class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use Illuminate\Contracts\Queue\ShouldQueueAfterCommit;
use Illuminate\Queue\InteractsWithQueue;

class SendShipmentNotification implements ShouldQueueAfterCommit
{
    use InteractsWithQueue;
}
</code></pre>
<blockquote>
<p>[!NOTE]
To learn more about working around these issues, please review the documentation regarding <a href="/docs/%7B&#x27;12.x&#x27;%7D/queues#jobs-and-database-transactions">queued jobs and database transactions</a>.</p>
</blockquote>
<a name="queued-listener-middleware"></a>
<h3 id="queued-listener-middleware"><a href="#queued-listener-middleware">Queued Listener Middleware</a></h3>
<p>Queued listeners can also utilize <a href="/docs/%7B&#x27;12.x&#x27;%7D/queues#job-middleware">job middleware</a>. Job middleware allow you to wrap custom logic around the execution of queued listeners, reducing boilerplate in the listeners themselves. After creating job middleware, they may be attached to a listener by returning them from the listener&#x27;s <code>middleware</code> method:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use App\Jobs\Middleware\RateLimited;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue
{
    /**
     * Handle the event.
     */
    public function handle(OrderShipped $event): void
    {
        // Process the event...
    }

    /**
     * Get the middleware the listener should pass through.
     *
     * @return array&lt;int, object&gt;
     */
    public function middleware(OrderShipped $event): array
    {
        return [new RateLimited];
    }
}
</code></pre>
<a name="encrypted-queued-listeners"></a>
<h4 id="encrypted-queued-listeners"><a href="#encrypted-queued-listeners">Encrypted Queued Listeners</a></h4>
<p>Laravel allows you to ensure the privacy and integrity of a queued listener&#x27;s data via <a href="/docs/%7B&#x27;12.x&#x27;%7D/encryption">encryption</a>. To get started, simply add the <code>ShouldBeEncrypted</code> interface to the listener class. Once this interface has been added to the class, Laravel will automatically encrypt your listener before pushing it onto a queue:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldBeEncrypted;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue, ShouldBeEncrypted
{
    // ...
}
</code></pre>
<a name="handling-failed-jobs"></a>
<h3 id="handling-failed-jobs"><a href="#handling-failed-jobs">Handling Failed Jobs</a></h3>
<p>Sometimes your queued event listeners may fail. If the queued listener exceeds the maximum number of attempts as defined by your queue worker, the <code>failed</code> method will be called on your listener. The <code>failed</code> method receives the event instance and the <code>Throwable</code> that caused the failure:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Queue\InteractsWithQueue;
use Throwable;

class SendShipmentNotification implements ShouldQueue
{
    use InteractsWithQueue;

    /**
     * Handle the event.
     */
    public function handle(OrderShipped $event): void
    {
        // ...
    }

    /**
     * Handle a job failure.
     */
    public function failed(OrderShipped $event, Throwable $exception): void
    {
        // ...
    }
}
</code></pre>
<a name="specifying-queued-listener-maximum-attempts"></a>
<h4 id="specifying-queued-listener-maximum-attempts"><a href="#specifying-queued-listener-maximum-attempts">Specifying Queued Listener Maximum Attempts</a></h4>
<p>If one of your queued listeners is encountering an error, you likely do not want it to keep retrying indefinitely. Therefore, Laravel provides various ways to specify how many times or for how long a listener may be attempted.</p>
<p>You may define a <code>tries</code> property or method on your listener class to specify how many times the listener may be attempted before it is considered to have failed:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Queue\InteractsWithQueue;

class SendShipmentNotification implements ShouldQueue
{
    use InteractsWithQueue;

    /**
     * The number of times the queued listener may be attempted.
     *
     * @var int
     */
    public $tries = 5;
}
</code></pre>
<p>As an alternative to defining how many times a listener may be attempted before it fails, you may define a time at which the listener should no longer be attempted. This allows a listener to be attempted any number of times within a given time frame. To define the time at which a listener should no longer be attempted, add a <code>retryUntil</code> method to your listener class. This method should return a <code>DateTime</code> instance:</p>
<pre><code class="language-php">use DateTime;

/**
 * Determine the time at which the listener should timeout.
 */
public function retryUntil(): DateTime
{
    return now()-&gt;addMinutes(5);
}
</code></pre>
<p>If both <code>retryUntil</code> and <code>tries</code> are defined, Laravel gives precedence to the <code>retryUntil</code> method.</p>
<a name="specifying-queued-listener-backoff"></a>
<h4 id="specifying-queued-listener-backoff"><a href="#specifying-queued-listener-backoff">Specifying Queued Listener Backoff</a></h4>
<p>If you would like to configure how many seconds Laravel should wait before retrying a listener that has encountered an exception, you may do so by defining a <code>backoff</code> property on your listener class:</p>
<pre><code class="language-php">/**
 * The number of seconds to wait before retrying the queued listener.
 *
 * @var int
 */
public $backoff = 3;
</code></pre>
<p>If you require more complex logic for determining the listeners&#x27;s backoff time, you may define a <code>backoff</code> method on your listener class:</p>
<pre><code class="language-php">/**
 * Calculate the number of seconds to wait before retrying the queued listener.
 */
public function backoff(OrderShipped $event): int
{
    return 3;
}
</code></pre>
<p>You may easily configure &quot;exponential&quot; backoffs by returning an array of backoff values from the <code>backoff</code> method. In this example, the retry delay will be 1 second for the first retry, 5 seconds for the second retry, 10 seconds for the third retry, and 10 seconds for every subsequent retry if there are more attempts remaining:</p>
<pre><code class="language-php">/**
 * Calculate the number of seconds to wait before retrying the queued listener.
 *
 * @return list&lt;int&gt;
 */
public function backoff(OrderShipped $event): array
{
    return [1, 5, 10];
}
</code></pre>
<a name="specifying-queued-listener-max-exceptions"></a>
<h4 id="specifying-queued-listener-max-exceptions"><a href="#specifying-queued-listener-max-exceptions">Specifying Queued Listener Max Exceptions</a></h4>
<p>Sometimes you may wish to specify that a queued listener may be attempted many times, but should fail if the retries are triggered by a given number of unhandled exceptions (as opposed to being released by the <code>release</code> method directly). To accomplish this, you may define a <code>maxExceptions</code> property on your listener class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Queue\InteractsWithQueue;

class SendShipmentNotification implements ShouldQueue
{
    use InteractsWithQueue;

    /**
     * The number of times the queued listener may be attempted.
     *
     * @var int
     */
    public $tries = 25;

    /**
     * The maximum number of unhandled exceptions to allow before failing.
     *
     * @var int
     */
    public $maxExceptions = 3;

    /**
     * Handle the event.
     */
    public function handle(OrderShipped $event): void
    {
        // Process the event...
    }
}
</code></pre>
<p>In this example, the listener will be retried up to 25 times. However, the listener will fail if three unhandled exceptions are thrown by the listener.</p>
<a name="specifying-queued-listener-timeout"></a>
<h4 id="specifying-queued-listener-timeout"><a href="#specifying-queued-listener-timeout">Specifying Queued Listener Timeout</a></h4>
<p>Often, you know roughly how long you expect your queued listeners to take. For this reason, Laravel allows you to specify a &quot;timeout&quot; value. If a listener is processing for longer than the number of seconds specified by the timeout value, the worker processing the listener will exit with an error. You may define the maximum number of seconds a listener should be allowed to run by defining a <code>timeout</code> property on your listener class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue
{
    /**
     * The number of seconds the listener can run before timing out.
     *
     * @var int
     */
    public $timeout = 120;
}
</code></pre>
<p>If you would like to indicate that a listener should be marked as failed on timeout, you may define the <code>failOnTimeout</code> property on the listener class:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use App\Events\OrderShipped;
use Illuminate\Contracts\Queue\ShouldQueue;

class SendShipmentNotification implements ShouldQueue
{
    /**
     * Indicate if the listener should be marked as failed on timeout.
     *
     * @var bool
     */
    public $failOnTimeout = true;
}
</code></pre>
<a name="dispatching-events"></a>
<h2 id="dispatching-events"><a href="#dispatching-events">Dispatching Events</a></h2>
<p>To dispatch an event, you may call the static <code>dispatch</code> method on the event. This method is made available on the event by the <code>Illuminate\Foundation\Events\Dispatchable</code> trait. Any arguments passed to the <code>dispatch</code> method will be passed to the event&#x27;s constructor:</p>
<pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use App\Events\OrderShipped;
use App\Models\Order;
use Illuminate\Http\RedirectResponse;
use Illuminate\Http\Request;

class OrderShipmentController extends Controller
{
    /**
     * Ship the given order.
     */
    public function store(Request $request): RedirectResponse
    {
        $order = Order::findOrFail($request-&gt;order_id);

        // Order shipment logic...

        OrderShipped::dispatch($order);

        return redirect(&#x27;/orders&#x27;);
    }
}
</code></pre>
<p>If you would like to conditionally dispatch an event, you may use the <code>dispatchIf</code> and <code>dispatchUnless</code> methods:</p>
<pre><code class="language-php">OrderShipped::dispatchIf($condition, $order);

OrderShipped::dispatchUnless($condition, $order);
</code></pre>
<blockquote>
<p>[!NOTE]
When testing, it can be helpful to assert that certain events were dispatched without actually triggering their listeners. Laravel&#x27;s <a href="#testing">built-in testing helpers</a> make it a cinch.</p>
</blockquote>
<a name="dispatching-events-after-database-transactions"></a>
<h3 id="dispatching-events-after-database-transactions"><a href="#dispatching-events-after-database-transactions">Dispatching Events After Database Transactions</a></h3>
<p>Sometimes, you may want to instruct Laravel to only dispatch an event after the active database transaction has committed. To do so, you may implement the <code>ShouldDispatchAfterCommit</code> interface on the event class.</p>
<p>This interface instructs Laravel to not dispatch the event until the current database transaction is committed. If the transaction fails, the event will be discarded. If no database transaction is in progress when the event is dispatched, the event will be dispatched immediately:</p>
<pre><code class="language-php">&lt;?php

namespace App\Events;

use App\Models\Order;
use Illuminate\Broadcasting\InteractsWithSockets;
use Illuminate\Contracts\Events\ShouldDispatchAfterCommit;
use Illuminate\Foundation\Events\Dispatchable;
use Illuminate\Queue\SerializesModels;

class OrderShipped implements ShouldDispatchAfterCommit
{
    use Dispatchable, InteractsWithSockets, SerializesModels;

    /**
     * Create a new event instance.
     */
    public function __construct(
        public Order $order,
    ) {}
}
</code></pre>
<a name="deferring-events"></a>
<h3 id="deferring-events"><a href="#deferring-events">Deferring Events</a></h3>
<p>Deferred events allow you to delay the dispatching of model events and execution of event listeners until after a specific block of code has completed. This is particularly useful when you need to ensure that all related records are created before event listeners are triggered.</p>
<p>To defer events, provide a closure to the <code>Event::defer()</code> method:</p>
<pre><code class="language-php">use App\Models\User;
use Illuminate\Support\Facades\Event;

Event::defer(function () {
    $user = User::create([&#x27;name&#x27; =&gt; &#x27;Victoria Otwell&#x27;]);

    $user-&gt;posts()-&gt;create([&#x27;title&#x27; =&gt; &#x27;My first post!&#x27;]);
});
</code></pre>
<p>All events triggered within the closure will be dispatched after the closure is executed. This ensures that event listeners have access to all related records that were created during the deferred execution. If an exception occurs within the closure, the deferred events will not be dispatched.</p>
<p>To defer only specific events, pass an array of events as the second argument to the <code>defer</code> method:</p>
<pre><code class="language-php">use App\Models\User;
use Illuminate\Support\Facades\Event;

Event::defer(function () {
    $user = User::create([&#x27;name&#x27; =&gt; &#x27;Victoria Otwell&#x27;]);

    $user-&gt;posts()-&gt;create([&#x27;title&#x27; =&gt; &#x27;My first post!&#x27;]);
}, [&#x27;eloquent.created: &#x27;.User::class]);
</code></pre>
<a name="event-subscribers"></a>
<h2 id="event-subscribers"><a href="#event-subscribers">Event Subscribers</a></h2>
<a name="writing-event-subscribers"></a>
<h3 id="writing-event-subscribers"><a href="#writing-event-subscribers">Writing Event Subscribers</a></h3>
<p>Event subscribers are classes that may subscribe to multiple events from within the subscriber class itself, allowing you to define several event handlers within a single class. Subscribers should define a <code>subscribe</code> method, which receives an event dispatcher instance. You may call the <code>listen</code> method on the given dispatcher to register event listeners:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use Illuminate\Auth\Events\Login;
use Illuminate\Auth\Events\Logout;
use Illuminate\Events\Dispatcher;

class UserEventSubscriber
{
    /**
     * Handle user login events.
     */
    public function handleUserLogin(Login $event): void {}

    /**
     * Handle user logout events.
     */
    public function handleUserLogout(Logout $event): void {}

    /**
     * Register the listeners for the subscriber.
     */
    public function subscribe(Dispatcher $events): void
    {
        $events-&gt;listen(
            Login::class,
            [UserEventSubscriber::class, &#x27;handleUserLogin&#x27;]
        );

        $events-&gt;listen(
            Logout::class,
            [UserEventSubscriber::class, &#x27;handleUserLogout&#x27;]
        );
    }
}
</code></pre>
<p>If your event listener methods are defined within the subscriber itself, you may find it more convenient to return an array of events and method names from the subscriber&#x27;s <code>subscribe</code> method. Laravel will automatically determine the subscriber&#x27;s class name when registering the event listeners:</p>
<pre><code class="language-php">&lt;?php

namespace App\Listeners;

use Illuminate\Auth\Events\Login;
use Illuminate\Auth\Events\Logout;
use Illuminate\Events\Dispatcher;

class UserEventSubscriber
{
    /**
     * Handle user login events.
     */
    public function handleUserLogin(Login $event): void {}

    /**
     * Handle user logout events.
     */
    public function handleUserLogout(Logout $event): void {}

    /**
     * Register the listeners for the subscriber.
     *
     * @return array&lt;string, string&gt;
     */
    public function subscribe(Dispatcher $events): array
    {
        return [
            Login::class =&gt; &#x27;handleUserLogin&#x27;,
            Logout::class =&gt; &#x27;handleUserLogout&#x27;,
        ];
    }
}
</code></pre>
<a name="registering-event-subscribers"></a>
<h3 id="registering-event-subscribers"><a href="#registering-event-subscribers">Registering Event Subscribers</a></h3>
<p>After writing the subscriber, Laravel will automatically register handler methods within the subscriber if they follow Laravel&#x27;s <a href="#event-discovery">event discovery conventions</a>. Otherwise, you may manually register your subscriber using the <code>subscribe</code> method of the <code>Event</code> facade. Typically, this should be done within the <code>boot</code> method of your application&#x27;s <code>AppServiceProvider</code>:</p>
<pre><code class="language-php">&lt;?php

namespace App\Providers;

use App\Listeners\UserEventSubscriber;
use Illuminate\Support\Facades\Event;
use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    /**
     * Bootstrap any application services.
     */
    public function boot(): void
    {
        Event::subscribe(UserEventSubscriber::class);
    }
}
</code></pre>
<a name="testing"></a>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>When testing code that dispatches events, you may wish to instruct Laravel to not actually execute the event&#x27;s listeners, since the listener&#x27;s code can be tested directly and separately of the code that dispatches the corresponding event. Of course, to test the listener itself, you may instantiate a listener instance and invoke the <code>handle</code> method directly in your test.</p>
<p>Using the <code>Event</code> facade&#x27;s <code>fake</code> method, you may prevent listeners from executing, execute the code under test, and then assert which events were dispatched by your application using the <code>assertDispatched</code>, <code>assertNotDispatched</code>, and <code>assertNothingDispatched</code> methods:</p>
<pre><code class="language-php">&lt;?php

use App\Events\OrderFailedToShip;
use App\Events\OrderShipped;
use Illuminate\Support\Facades\Event;

test(&#x27;orders can be shipped&#x27;, function () {
    Event::fake();

    // Perform order shipping...

    // Assert that an event was dispatched...
    Event::assertDispatched(OrderShipped::class);

    // Assert an event was dispatched twice...
    Event::assertDispatched(OrderShipped::class, 2);

    // Assert an event was dispatched once...
    Event::assertDispatchedOnce(OrderShipped::class);

    // Assert an event was not dispatched...
    Event::assertNotDispatched(OrderFailedToShip::class);

    // Assert that no events were dispatched...
    Event::assertNothingDispatched();
});
</code></pre>
<pre><code class="language-php">&lt;?php

namespace Tests\Feature;

use App\Events\OrderFailedToShip;
use App\Events\OrderShipped;
use Illuminate\Support\Facades\Event;
use Tests\TestCase;

class ExampleTest extends TestCase
{
    /**
     * Test order shipping.
     */
    public function test_orders_can_be_shipped(): void
    {
        Event::fake();

        // Perform order shipping...

        // Assert that an event was dispatched...
        Event::assertDispatched(OrderShipped::class);

        // Assert an event was dispatched twice...
        Event::assertDispatched(OrderShipped::class, 2);

        // Assert an event was dispatched once...
        Event::assertDispatchedOnce(OrderShipped::class);

        // Assert an event was not dispatched...
        Event::assertNotDispatched(OrderFailedToShip::class);

        // Assert that no events were dispatched...
        Event::assertNothingDispatched();
    }
}
</code></pre>
<p>You may pass a closure to the <code>assertDispatched</code> or <code>assertNotDispatched</code> methods in order to assert that an event was dispatched that passes a given &quot;truth test&quot;. If at least one event was dispatched that passes the given truth test then the assertion will be successful:</p>
<pre><code class="language-php">Event::assertDispatched(function (OrderShipped $event) use ($order) {
    return $event-&gt;order-&gt;id === $order-&gt;id;
});
</code></pre>
<p>If you would simply like to assert that an event listener is listening to a given event, you may use the <code>assertListening</code> method:</p>
<pre><code class="language-php">Event::assertListening(
    OrderShipped::class,
    SendShipmentNotification::class
);
</code></pre>
<blockquote>
<p>[!WARNING]
After calling <code>Event::fake()</code>, no event listeners will be executed. So, if your tests use model factories that rely on events, such as creating a UUID during a model&#x27;s <code>creating</code> event, you should call <code>Event::fake()</code> <strong>after</strong> using your factories.</p>
</blockquote>
<a name="faking-a-subset-of-events"></a>
<h3 id="faking-a-subset-of-events"><a href="#faking-a-subset-of-events">Faking a Subset of Events</a></h3>
<p>If you only want to fake event listeners for a specific set of events, you may pass them to the <code>fake</code> or <code>fakeFor</code> method:</p>
<pre><code class="language-php">test(&#x27;orders can be processed&#x27;, function () {
    Event::fake([
        OrderCreated::class,
    ]);

    $order = Order::factory()-&gt;create();

    Event::assertDispatched(OrderCreated::class);

    // Other events are dispatched as normal...
    $order-&gt;update([
        // ...
    ]);
});
</code></pre>
<pre><code class="language-php">/**
 * Test order process.
 */
public function test_orders_can_be_processed(): void
{
    Event::fake([
        OrderCreated::class,
    ]);

    $order = Order::factory()-&gt;create();

    Event::assertDispatched(OrderCreated::class);

    // Other events are dispatched as normal...
    $order-&gt;update([
        // ...
    ]);
}
</code></pre>
<p>You may fake all events except for a set of specified events using the <code>except</code> method:</p>
<pre><code class="language-php">Event::fake()-&gt;except([
    OrderCreated::class,
]);
</code></pre>
<a name="scoped-event-fakes"></a>
<h3 id="scoped-event-fakes"><a href="#scoped-event-fakes">Scoped Event Fakes</a></h3>
<p>If you only want to fake event listeners for a portion of your test, you may use the <code>fakeFor</code> method:</p>
<pre><code class="language-php">&lt;?php

use App\Events\OrderCreated;
use App\Models\Order;
use Illuminate\Support\Facades\Event;

test(&#x27;orders can be processed&#x27;, function () {
    $order = Event::fakeFor(function () {
        $order = Order::factory()-&gt;create();

        Event::assertDispatched(OrderCreated::class);

        return $order;
    });

    // Events are dispatched as normal and observers will run...
    $order-&gt;update([
        // ...
    ]);
});
</code></pre>
<pre><code class="language-php">&lt;?php

namespace Tests\Feature;

use App\Events\OrderCreated;
use App\Models\Order;
use Illuminate\Support\Facades\Event;
use Tests\TestCase;

class ExampleTest extends TestCase
{
    /**
     * Test order process.
     */
    public function test_orders_can_be_processed(): void
    {
        $order = Event::fakeFor(function () {
            $order = Order::factory()-&gt;create();

            Event::assertDispatched(OrderCreated::class);

            return $order;
        });

        // Events are dispatched as normal and observers will run...
        $order-&gt;update([
            // ...
        ]);
    }
}
</code></pre></article></div></div><!--$--><!--/$--></main></div><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[93649,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/16ad486f9df855f5.js\"],\"DocsSidebar\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/8d8bfdb8c7183f74.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"064VbOcPM65IQylKQ-S9h\",\"c\":[\"\",\"docs\",\"events\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"events\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/8d8bfdb8c7183f74.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/16ad486f9df855f5.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen bg-background\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 relative\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"container mx-auto py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl\",\"children\":\"Events\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-muted-foreground mt-2\",\"children\":\"Laravel events 提供簡單的觀察者模式實作\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"h1\",null,{\"id\":\"events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#events\",\"children\":\"Events\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#introduction\",\"children\":\"Introduction\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#generating-events-and-listeners\",\"children\":\"Generating Events and Listeners\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#registering-events-and-listeners\",\"children\":\"Registering Events and Listeners\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#event-discovery\",\"children\":\"Event Discovery\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#manually-registering-events\",\"children\":\"Manually Registering Events\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#closure-listeners\",\"children\":\"Closure Listeners\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-events\",\"children\":\"Defining Events\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-listeners\",\"children\":\"Defining Listeners\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#queued-event-listeners\",\"children\":\"Queued Event Listeners\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#manually-interacting-with-the-queue\",\"children\":\"Manually Interacting With the Queue\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#queued-event-listeners-and-database-transactions\",\"children\":\"Queued Event Listeners and Database Transactions\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#queued-listener-middleware\",\"children\":\"Queued Listener Middleware\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#encrypted-queued-listeners\",\"children\":\"Encrypted Queued Listeners\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#handling-failed-jobs\",\"children\":\"Handling Failed Jobs\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#dispatching-events\",\"children\":\"Dispatching Events\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#dispatching-events-after-database-transactions\",\"children\":\"Dispatching Events After Database Transactions\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#deferring-events\",\"children\":\"Deferring Events\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#event-subscribers\",\"children\":\"Event Subscribers\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#writing-event-subscribers\",\"children\":\"Writing Event Subscribers\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#registering-event-subscribers\",\"children\":\"Registering Event Subscribers\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#testing\",\"children\":\"Testing\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#faking-a-subset-of-events\",\"children\":\"Faking a Subset of Events\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#scoped-event-fakes\",\"children\":\"Scoped Events Fakes\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"a\",null,{\"name\":\"introduction\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"簡介\",\"children\":[\"$\",\"a\",null,{\"href\":\"#簡介\",\"children\":\"簡介\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Laravel's events provide a simple observer pattern implementation, allowing you to subscribe and listen for various events that occur within your application. Event classes are typically stored in the \",[\"$\",\"code\",null,{\"children\":\"app/Events\"}],\" directory, while their listeners are stored in \",[\"$\",\"code\",null,{\"children\":\"app/Listeners\"}],\". Don't worry if you don't see these directories in your application as they will be created for you as you generate events and listeners using Artisan console commands.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Events serve as a great way to decouple various aspects of your application, since a single event can have multiple listeners that do not depend on each other. For example, you may wish to send a Slack notification to your user each time an order has shipped. Instead of coupling your order processing code to your Slack notification code, you can raise an \",\"$Le\",\" event which a listener can receive and use to dispatch a Slack notification.\"]}],\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\",\"\\n\",\"$L71\",\"\\n\",\"$L72\",\"\\n\",\"$L73\",\"\\n\",\"$L74\",\"\\n\",\"$L75\",\"\\n\",\"$L76\",\"\\n\",\"$L77\",\"\\n\",\"$L78\",\"\\n\",\"$L79\",\"\\n\",\"$L7a\",\"\\n\",\"$L7b\",\"\\n\",\"$L7c\",\"\\n\",\"$L7d\",\"\\n\",\"$L7e\",\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\",\"\\n\",\"$L82\",\"\\n\",\"$L83\",\"\\n\",\"$L84\",\"\\n\",\"$L85\",\"\\n\",\"$L86\",\"\\n\",\"$L87\",\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\",\"\\n\",\"$L91\",\"\\n\",\"$L92\",\"\\n\",\"$L93\",\"\\n\",\"$L94\",\"\\n\",\"$L95\",\"\\n\",\"$L96\",\"\\n\",\"$L97\",\"\\n\",\"$L98\",\"\\n\",\"$L99\",\"\\n\",\"$L9a\",\"\\n\",\"$L9b\",\"\\n\",\"$L9c\",\"\\n\",\"$L9d\",\"\\n\",\"$L9e\",\"\\n\",\"$L9f\",\"\\n\",\"$La0\",\"\\n\",\"$La1\",\"\\n\",\"$La2\",\"\\n\",\"$La3\",\"\\n\",\"$La4\",\"\\n\",\"$La5\",\"\\n\",\"$La6\",\"\\n\",\"$La7\",\"\\n\",\"$La8\",\"\\n\",\"$La9\",\"\\n\",\"$Laa\",\"\\n\",\"$Lab\",\"\\n\",\"$Lac\",\"\\n\",\"$Lad\",\"\\n\",\"$Lae\",\"\\n\",\"$Laf\",\"\\n\",\"$Lb0\",\"\\n\",\"$Lb1\",\"\\n\",\"$Lb2\",\"\\n\",\"$Lb3\",\"\\n\",\"$Lb4\",\"\\n\",\"$Lb5\",\"\\n\",\"$Lb6\",\"\\n\",\"$Lb7\",\"\\n\",\"$Lb8\",\"\\n\",\"$Lb9\",\"\\n\",\"$Lba\",\"\\n\",\"$Lbb\",\"\\n\",\"$Lbc\",\"\\n\",\"$Lbd\",\"\\n\",\"$Lbe\",\"\\n\",\"$Lbf\",\"\\n\",\"$Lc0\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"code\",null,{\"children\":\"App\\\\Events\\\\OrderShipped\"}]\nf:[\"$\",\"a\",null,{\"name\":\"generating-events-and-listeners\"}]\n10:[\"$\",\"h2\",null,{\"id\":\"generating-events-and-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#generating-events-and-listeners\",\"children\":\"Generating Events and Listeners\"}]}]\n11:[\"$\",\"p\",null,{\"children\":[\"To quickly generate events and listeners, you may use the \",[\"$\",\"code\",null,{\"children\":\"make:event\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"make:listener\"}],\" Artisan commands:\"]}]\n12:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan make:event PodcastProcessed\\n\\nphp artisan make:listener SendPodcastNotification --event=PodcastProcessed\\n\"}]}]\n13:[\"$\",\"p\",null,{\"children\":[\"For convenience, you may also invoke the \",[\"$\",\"code\",null,{\"children\":\"make:event\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"make:listener\"}],\" Artisan commands without additional arguments. When you do so, Laravel will automatically prompt you for the class name and, when creating a listener, the event it should listen to:\"]}]\n14:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan make:event\\n\\nphp artisan make:listener\\n\"}]}]\n15:[\"$\",\"a\",null,{\"name\":\"registering-events-and-listeners\"}]\n16:[\"$\",\"h2\",null,{\"id\":\"registering-events-and-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#registering-events-and-listeners\",\"children\":\"Registering Events and Listeners\"}]}]\n17:[\"$\",\"a\",null,{\"name\":\"event-discovery\"}]\n18:[\"$\",\"h3\",null,{\"id\":\"event-discovery\",\"children\":[\"$\",\"a\",null,{\"href\":\"#event-discovery\",\"children\":\"Event Discovery\"}]}]\n19:[\"$\",\"p\",null,{\"children\":[\"By default, Laravel will automatically find and register your event listeners by scanning your application's \",[\"$\",\"code\",null,{\"children\":\"Listeners\"}],\" directory. When Laravel finds any listener class method that begins with \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"__invoke\"}],\", Laravel will register those methods as event listeners for the event that is type-hinted in the method's signature:\"]}]\n1a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Events\\\\PodcastProcessed;\\n\\nclass SendPodcastNotification\\n{\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(PodcastProcessed $event): void\\n    {\\n        // ...\\n    }\\n}\\n\"}]}]\n1b:[\"$\",\"p\",null,{\"children\":\"You may listen to multiple events using PHP's union types:\"}]\n1c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Handle the event.\\n */\\npublic function handle(PodcastProcessed|PodcastPublished $event): void\\n{\\n    // ...\\n}\\n\"}]}]\n1d:[\"$\",\"p\",null,{\"children\":[\"If you plan to store your listeners in a different directory or within multiple directories, you may instruct Laravel to scan those directories using the \",[\"$\",\"code\",null,{\"children\":\"withEvents\"}],\" method in your application's \",[\"$\",\"code\",null,{\"children\":\"bootstrap/app.php\"}],\" file:\"]}]\n1e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"-\u003ewithEvents(discover: [\\n    __DIR__.'/../app/Domain/Orders/Listeners',\\n])\\n\"}]}]\n1f:[\"$\",\"p\",null,{\"children\":[\"You may scan for listeners in multiple similar directories using the \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" character as a wildcard:\"]}]\n20:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"-\u003ewithEvents(discover: [\\n    __DIR__.'/../app/Domain/*/Listeners',\\n])\\n\"}]}]\n21:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"event:list\"}],\" command may be used to list all of the listeners registered within your application:\"]}]\n22:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan event:list\\n\"}]}]\n23:[\"$\",\"a\",null,{\"name\":\"event-discovery-in-production\"}]\n24:[\"$\",\"h4\",null,{\"id\":\"event-discovery-in-production\",\"children\":[\"$\",\"a\",null,{\"href\":\"#event-discovery-in-production\",\"children\":\"Event Discovery in Production\"}]}]\n25:[\"$\",\"p\""])</script><script>self.__next_f.push([1,",null,{\"children\":[\"To give your application a speed boost, you should cache a manifest of all of your application's listeners using the \",[\"$\",\"code\",null,{\"children\":\"optimize\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"event:cache\"}],\" Artisan commands. Typically, this command should be run as part of your application's \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/deployment#optimization\",\"children\":\"deployment process\"}],\". This manifest will be used by the framework to speed up the event registration process. The \",[\"$\",\"code\",null,{\"children\":\"event:clear\"}],\" command may be used to destroy the event cache.\"]}]\n26:[\"$\",\"a\",null,{\"name\":\"manually-registering-events\"}]\n27:[\"$\",\"h3\",null,{\"id\":\"manually-registering-events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#manually-registering-events\",\"children\":\"Manually Registering Events\"}]}]\n28:[\"$\",\"p\",null,{\"children\":[\"Using the \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\" facade, you may manually register events and their corresponding listeners within the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\":\"]}]\n29:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Domain\\\\Orders\\\\Events\\\\PodcastProcessed;\\nuse App\\\\Domain\\\\Orders\\\\Listeners\\\\SendPodcastNotification;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Event::listen(\\n        PodcastProcessed::class,\\n        SendPodcastNotification::class,\\n    );\\n}\\n\"}]}]\n2a:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"event:list\"}],\" command may be used to list all of the listeners registered within your application:\"]}]\n2b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-shell\",\"children\":\"php artisan event:list\\n\"}]}]\n2c:[\"$\",\"a\",null,{\"name\":\"closure-listeners\"}]\n2d:[\"$\",\"h3\",null,{\"id\":\"closure-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#closure-listeners\",\"children\":\"Closure Listeners\"}]}]\n2e:[\"$\",\"p\",null,{\"children\":[\"Typically, listeners are defined as classes; however, you may also manually register closure-based event listeners in the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\":\"]}]\n2f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Events\\\\PodcastProcessed;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Event::listen(function (PodcastProcessed $event) {\\n        // ...\\n    });\\n}\\n\"}]}]\n30:[\"$\",\"a\",null,{\"name\":\"queuable-anonymous-event-listeners\"}]\n31:[\"$\",\"h4\",null,{\"id\":\"queueable-anonymous-event-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#queueable-anonymous-event-listeners\",\"children\":\"Queueable Anonymous Event Listeners\"}]}]\n32:[\"$\",\"p\",null,{\"children\":[\"When registering closure-based event listeners, you may wrap the listener closure within the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Events\\\\queueable\"}],\" function to instruct Laravel to execute the listener using the \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/queues\",\"children\":\"queue\"}],\":\"]}]\n33:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Events\\\\PodcastProcessed;\\nuse function Illuminate\\\\Events\\\\queueable;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\n/**\\n * Bootstrap any application services.\\n */\\npublic function boot(): void\\n{\\n    Event::listen(queueable(function (PodcastProcessed $event) {\\n        // ...\\n    }));\\n}\\n\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"Like queued jobs, you may use the \",[\"$\",\"code\",null,{\"children\":\"onConnection\"}],\", \",[\"$\",\"code\",null,{\"children\":\"onQueue\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"delay\"}],\" methods to customize the execution of the queued listener:\"]}]\n35:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Event::listen(queueable(function (PodcastProcessed $event) {\\n    // ...\\"])</script><script>self.__next_f.push([1,"n})-\u003eonConnection('redis')-\u003eonQueue('podcasts')-\u003edelay(now()-\u003eaddSeconds(10)));\\n\"}]}]\n36:[\"$\",\"p\",null,{\"children\":[\"If you would like to handle anonymous queued listener failures, you may provide a closure to the \",[\"$\",\"code\",null,{\"children\":\"catch\"}],\" method while defining the \",[\"$\",\"code\",null,{\"children\":\"queueable\"}],\" listener. This closure will receive the event instance and the \",[\"$\",\"code\",null,{\"children\":\"Throwable\"}],\" instance that caused the listener's failure:\"]}]\n37:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Events\\\\PodcastProcessed;\\nuse function Illuminate\\\\Events\\\\queueable;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\nuse Throwable;\\n\\nEvent::listen(queueable(function (PodcastProcessed $event) {\\n    // ...\\n})-\u003ecatch(function (PodcastProcessed $event, Throwable $e) {\\n    // The queued listener failed...\\n}));\\n\"}]}]\n38:[\"$\",\"a\",null,{\"name\":\"wildcard-event-listeners\"}]\n39:[\"$\",\"h4\",null,{\"id\":\"wildcard-event-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#wildcard-event-listeners\",\"children\":\"Wildcard Event Listeners\"}]}]\n3a:[\"$\",\"p\",null,{\"children\":[\"You may also register listeners using the \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" character as a wildcard parameter, allowing you to catch multiple events on the same listener. Wildcard listeners receive the event name as their first argument and the entire event data array as their second argument:\"]}]\n3b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Event::listen('event.*', function (string $eventName, array $data) {\\n    // ...\\n});\\n\"}]}]\n3c:[\"$\",\"a\",null,{\"name\":\"defining-events\"}]\n3d:[\"$\",\"h2\",null,{\"id\":\"defining-events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-events\",\"children\":\"Defining Events\"}]}]\n3e:[\"$\",\"p\",null,{\"children\":[\"An event class is essentially a data container which holds the information related to the event. For example, let's assume an \",[\"$\",\"code\",null,{\"children\":\"App\\\\Events\\\\OrderShipped\"}],\" event receives an \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/eloquent\",\"children\":\"Eloquent ORM\"}],\" object:\"]}]\n3f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Events;\\n\\nuse App\\\\Models\\\\Order;\\nuse Illuminate\\\\Broadcasting\\\\InteractsWithSockets;\\nuse Illuminate\\\\Foundation\\\\Events\\\\Dispatchable;\\nuse Illuminate\\\\Queue\\\\SerializesModels;\\n\\nclass OrderShipped\\n{\\n    use Dispatchable, InteractsWithSockets, SerializesModels;\\n\\n    /**\\n     * Create a new event instance.\\n     */\\n    public function __construct(\\n        public Order $order,\\n    ) {}\\n}\\n\"}]}]\n40:[\"$\",\"p\",null,{\"children\":[\"As you can see, this event class contains no logic. It is a container for the \",[\"$\",\"code\",null,{\"children\":\"App\\\\Models\\\\Order\"}],\" instance that was purchased. The \",[\"$\",\"code\",null,{\"children\":\"SerializesModels\"}],\" trait used by the event will gracefully serialize any Eloquent models if the event object is serialized using PHP's \",[\"$\",\"code\",null,{\"children\":\"serialize\"}],\" function, such as when utilizing \",[\"$\",\"a\",null,{\"href\":\"#queued-event-listeners\",\"children\":\"queued listeners\"}],\".\"]}]\n41:[\"$\",\"a\",null,{\"name\":\"defining-listeners\"}]\n42:[\"$\",\"h2\",null,{\"id\":\"defining-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#defining-listeners\",\"children\":\"Defining Listeners\"}]}]\n43:[\"$\",\"p\",null,{\"children\":[\"Next, let's take a look at the listener for our example event. Event listeners receive event instances in their \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" method. The \",[\"$\",\"code\",null,{\"children\":\"make:listener\"}],\" Artisan command, when invoked with the \",[\"$\",\"code\",null,{\"children\":\"--event\"}],\" option, will automatically import the proper event class and type-hint the event in the \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" method. Within the \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" method, you may perform any actions necessary to respond to the event:\"]}]\n44:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Li"])</script><script>self.__next_f.push([1,"steners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\n\\nclass SendShipmentNotification\\n{\\n    /**\\n     * Create the event listener.\\n     */\\n    public function __construct() {}\\n\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(OrderShipped $event): void\\n    {\\n        // Access the order using $event-\u003eorder...\\n    }\\n}\\n\"}]}]\n45:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nYour event listeners may also type-hint any dependencies they need on their constructors. All event listeners are resolved via the Laravel \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/container\",\"children\":\"service container\"}],\", so dependencies will be injected automatically.\"]}],\"\\n\"]}]\n46:[\"$\",\"a\",null,{\"name\":\"stopping-the-propagation-of-an-event\"}]\n47:[\"$\",\"h4\",null,{\"id\":\"stopping-the-propagation-of-an-event\",\"children\":[\"$\",\"a\",null,{\"href\":\"#stopping-the-propagation-of-an-event\",\"children\":\"Stopping The Propagation Of An Event\"}]}]\n48:[\"$\",\"p\",null,{\"children\":[\"Sometimes, you may wish to stop the propagation of an event to other listeners. You may do so by returning \",[\"$\",\"code\",null,{\"children\":\"false\"}],\" from your listener's \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" method.\"]}]\n49:[\"$\",\"a\",null,{\"name\":\"queued-event-listeners\"}]\n4a:[\"$\",\"h2\",null,{\"id\":\"queued-event-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#queued-event-listeners\",\"children\":\"Queued Event Listeners\"}]}]\n4b:[\"$\",\"p\",null,{\"children\":[\"Queueing listeners can be beneficial if your listener is going to perform a slow task such as sending an email or making an HTTP request. Before using queued listeners, make sure to \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/queues\",\"children\":\"configure your queue\"}],\" and start a queue worker on your server or local development environment.\"]}]\n4c:[\"$\",\"p\",null,{\"children\":[\"To specify that a listener should be queued, add the \",[\"$\",\"code\",null,{\"children\":\"ShouldQueue\"}],\" interface to the listener class. Listeners generated by the \",[\"$\",\"code\",null,{\"children\":\"make:listener\"}],\" Artisan commands already have this interface imported into the current namespace so you can use it immediately:\"]}]\n4d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    // ...\\n}\\n\"}]}]\n4e:[\"$\",\"p\",null,{\"children\":[\"That's it! Now, when an event handled by this listener is dispatched, the listener will automatically be queued by the event dispatcher using Laravel's \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/queues\",\"children\":\"queue system\"}],\". If no exceptions are thrown when the listener is executed by the queue, the queued job will automatically be deleted after it has finished processing.\"]}]\n4f:[\"$\",\"a\",null,{\"name\":\"customizing-the-queue-connection-queue-name\"}]\n50:[\"$\",\"h4\",null,{\"id\":\"customizing-the-queue-connection-name--delay\",\"children\":[\"$\",\"a\",null,{\"href\":\"#customizing-the-queue-connection-name--delay\",\"children\":\"Customizing The Queue Connection, Name, \u0026 Delay\"}]}]\n51:[\"$\",\"p\",null,{\"children\":[\"If you would like to customize the queue connection, queue name, or queue delay time of an event listener, you may define the \",[\"$\",\"code\",null,{\"children\":\"$$connection\"}],\", \",[\"$\",\"code\",null,{\"children\":\"$$queue\"}],\", or \",[\"$\",\"code\",null,{\"children\":\"$$delay\"}],\" properties on your listener class:\"]}]\n52:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    /**\\n     * The name of the connection the job should be sent to.\\n     *\\n     * @var string|null\\n     */\\n    public $connection = 'sqs';\\n\\n    /**\\n     * The name of the queue the job should be sent to.\\n     *\\n     * @var string|null\\n     */\\n    public $queue = 'listeners';\\n\\n    /**\\n     * The time "])</script><script>self.__next_f.push([1,"(seconds) before the job should be processed.\\n     *\\n     * @var int\\n     */\\n    public $delay = 60;\\n}\\n\"}]}]\n53:[\"$\",\"p\",null,{\"children\":[\"If you would like to define the listener's queue connection, queue name, or delay at runtime, you may define \",[\"$\",\"code\",null,{\"children\":\"viaConnection\"}],\", \",[\"$\",\"code\",null,{\"children\":\"viaQueue\"}],\", or \",[\"$\",\"code\",null,{\"children\":\"withDelay\"}],\" methods on the listener:\"]}]\n54:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Get the name of the listener's queue connection.\\n */\\npublic function viaConnection(): string\\n{\\n    return 'sqs';\\n}\\n\\n/**\\n * Get the name of the listener's queue.\\n */\\npublic function viaQueue(): string\\n{\\n    return 'listeners';\\n}\\n\\n/**\\n * Get the number of seconds before the job should be processed.\\n */\\npublic function withDelay(OrderShipped $event): int\\n{\\n    return $event-\u003ehighPriority ? 0 : 60;\\n}\\n\"}]}]\n55:[\"$\",\"a\",null,{\"name\":\"conditionally-queueing-listeners\"}]\n56:[\"$\",\"h4\",null,{\"id\":\"conditionally-queueing-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#conditionally-queueing-listeners\",\"children\":\"Conditionally Queueing Listeners\"}]}]\n57:[\"$\",\"p\",null,{\"children\":[\"Sometimes, you may need to determine whether a listener should be queued based on some data that are only available at runtime. To accomplish this, a \",[\"$\",\"code\",null,{\"children\":\"shouldQueue\"}],\" method may be added to a listener to determine whether the listener should be queued. If the \",[\"$\",\"code\",null,{\"children\":\"shouldQueue\"}],\" method returns \",[\"$\",\"code\",null,{\"children\":\"false\"}],\", the listener will not be queued:\"]}]\n58:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderCreated;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass RewardGiftCard implements ShouldQueue\\n{\\n    /**\\n     * Reward a gift card to the customer.\\n     */\\n    public function handle(OrderCreated $event): void\\n    {\\n        // ...\\n    }\\n\\n    /**\\n     * Determine whether the listener should be queued.\\n     */\\n    public function shouldQueue(OrderCreated $event): bool\\n    {\\n        return $event-\u003eorder-\u003esubtotal \u003e= 5000;\\n    }\\n}\\n\"}]}]\n59:[\"$\",\"a\",null,{\"name\":\"manually-interacting-with-the-queue\"}]\n5a:[\"$\",\"h3\",null,{\"id\":\"manually-interacting-with-the-queue\",\"children\":[\"$\",\"a\",null,{\"href\":\"#manually-interacting-with-the-queue\",\"children\":\"Manually Interacting With the Queue\"}]}]\n5b:[\"$\",\"p\",null,{\"children\":[\"If you need to manually access the listener's underlying queue job's \",[\"$\",\"code\",null,{\"children\":\"delete\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"release\"}],\" methods, you may do so using the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Queue\\\\InteractsWithQueue\"}],\" trait. This trait is imported by default on generated listeners and provides access to these methods:\"]}]\n5c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\nuse Illuminate\\\\Queue\\\\InteractsWithQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    use InteractsWithQueue;\\n\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(OrderShipped $event): void\\n    {\\n        if ($condition) {\\n            $this-\u003erelease(30);\\n        }\\n    }\\n}\\n\"}]}]\n5d:[\"$\",\"a\",null,{\"name\":\"queued-event-listeners-and-database-transactions\"}]\n5e:[\"$\",\"h3\",null,{\"id\":\"queued-event-listeners-and-database-transactions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#queued-event-listeners-and-database-transactions\",\"children\":\"Queued Event Listeners and Database Transactions\"}]}]\n5f:[\"$\",\"p\",null,{\"children\":\"When queued listeners are dispatched within database transactions, they may be processed by the queue before the database transaction has committed. When this happens, any updates you have made to models or database records during the database transaction may not yet be reflected in the data"])</script><script>self.__next_f.push([1,"base. In addition, any models or database records created within the transaction may not exist in the database. If your listener depends on these models, unexpected errors can occur when the job that dispatches the queued listener is processed.\"}]\n60:[\"$\",\"p\",null,{\"children\":[\"If your queue connection's \",[\"$\",\"code\",null,{\"children\":\"after_commit\"}],\" configuration option is set to \",[\"$\",\"code\",null,{\"children\":\"false\"}],\", you may still indicate that a particular queued listener should be dispatched after all open database transactions have been committed by implementing the \",[\"$\",\"code\",null,{\"children\":\"ShouldQueueAfterCommit\"}],\" interface on the listener class:\"]}]\n61:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueueAfterCommit;\\nuse Illuminate\\\\Queue\\\\InteractsWithQueue;\\n\\nclass SendShipmentNotification implements ShouldQueueAfterCommit\\n{\\n    use InteractsWithQueue;\\n}\\n\"}]}]\n62:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nTo learn more about working around these issues, please review the documentation regarding \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/queues#jobs-and-database-transactions\",\"children\":\"queued jobs and database transactions\"}],\".\"]}],\"\\n\"]}]\n63:[\"$\",\"a\",null,{\"name\":\"queued-listener-middleware\"}]\n64:[\"$\",\"h3\",null,{\"id\":\"queued-listener-middleware\",\"children\":[\"$\",\"a\",null,{\"href\":\"#queued-listener-middleware\",\"children\":\"Queued Listener Middleware\"}]}]\n65:[\"$\",\"p\",null,{\"children\":[\"Queued listeners can also utilize \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/queues#job-middleware\",\"children\":\"job middleware\"}],\". Job middleware allow you to wrap custom logic around the execution of queued listeners, reducing boilerplate in the listeners themselves. After creating job middleware, they may be attached to a listener by returning them from the listener's \",[\"$\",\"code\",null,{\"children\":\"middleware\"}],\" method:\"]}]\n66:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse App\\\\Jobs\\\\Middleware\\\\RateLimited;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(OrderShipped $event): void\\n    {\\n        // Process the event...\\n    }\\n\\n    /**\\n     * Get the middleware the listener should pass through.\\n     *\\n     * @return array\u003cint, object\u003e\\n     */\\n    public function middleware(OrderShipped $event): array\\n    {\\n        return [new RateLimited];\\n    }\\n}\\n\"}]}]\n67:[\"$\",\"a\",null,{\"name\":\"encrypted-queued-listeners\"}]\n68:[\"$\",\"h4\",null,{\"id\":\"encrypted-queued-listeners\",\"children\":[\"$\",\"a\",null,{\"href\":\"#encrypted-queued-listeners\",\"children\":\"Encrypted Queued Listeners\"}]}]\n69:[\"$\",\"p\",null,{\"children\":[\"Laravel allows you to ensure the privacy and integrity of a queued listener's data via \",[\"$\",\"a\",null,{\"href\":\"/docs/%7B'12.x'%7D/encryption\",\"children\":\"encryption\"}],\". To get started, simply add the \",[\"$\",\"code\",null,{\"children\":\"ShouldBeEncrypted\"}],\" interface to the listener class. Once this interface has been added to the class, Laravel will automatically encrypt your listener before pushing it onto a queue:\"]}]\n6a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldBeEncrypted;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue, ShouldBeEncrypted\\n{\\n    // ...\\n}\\n\"}]}]\n6b:[\"$\",\"a\",null,{\"name\":\"handling-failed-jobs\"}]\n6c:[\"$\",\"h3\",null,{\"id\":\"handling-failed-jobs\",\"children\":[\"$\",\"a\",null,{\"href\":\"#handling-failed-jobs\",\"children\":\"Handling Failed Jobs\"}]}]\n6d:[\"$\",\"p\",null,{\"children\":[\"Sometimes your queued event listeners may fail. If the queued listener exceeds the maximum number of attempts as define"])</script><script>self.__next_f.push([1,"d by your queue worker, the \",[\"$\",\"code\",null,{\"children\":\"failed\"}],\" method will be called on your listener. The \",[\"$\",\"code\",null,{\"children\":\"failed\"}],\" method receives the event instance and the \",[\"$\",\"code\",null,{\"children\":\"Throwable\"}],\" that caused the failure:\"]}]\n6e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\nuse Illuminate\\\\Queue\\\\InteractsWithQueue;\\nuse Throwable;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    use InteractsWithQueue;\\n\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(OrderShipped $event): void\\n    {\\n        // ...\\n    }\\n\\n    /**\\n     * Handle a job failure.\\n     */\\n    public function failed(OrderShipped $event, Throwable $exception): void\\n    {\\n        // ...\\n    }\\n}\\n\"}]}]\n6f:[\"$\",\"a\",null,{\"name\":\"specifying-queued-listener-maximum-attempts\"}]\n70:[\"$\",\"h4\",null,{\"id\":\"specifying-queued-listener-maximum-attempts\",\"children\":[\"$\",\"a\",null,{\"href\":\"#specifying-queued-listener-maximum-attempts\",\"children\":\"Specifying Queued Listener Maximum Attempts\"}]}]\n71:[\"$\",\"p\",null,{\"children\":\"If one of your queued listeners is encountering an error, you likely do not want it to keep retrying indefinitely. Therefore, Laravel provides various ways to specify how many times or for how long a listener may be attempted.\"}]\n72:[\"$\",\"p\",null,{\"children\":[\"You may define a \",[\"$\",\"code\",null,{\"children\":\"tries\"}],\" property or method on your listener class to specify how many times the listener may be attempted before it is considered to have failed:\"]}]\n73:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\nuse Illuminate\\\\Queue\\\\InteractsWithQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    use InteractsWithQueue;\\n\\n    /**\\n     * The number of times the queued listener may be attempted.\\n     *\\n     * @var int\\n     */\\n    public $tries = 5;\\n}\\n\"}]}]\n74:[\"$\",\"p\",null,{\"children\":[\"As an alternative to defining how many times a listener may be attempted before it fails, you may define a time at which the listener should no longer be attempted. This allows a listener to be attempted any number of times within a given time frame. To define the time at which a listener should no longer be attempted, add a \",[\"$\",\"code\",null,{\"children\":\"retryUntil\"}],\" method to your listener class. This method should return a \",[\"$\",\"code\",null,{\"children\":\"DateTime\"}],\" instance:\"]}]\n75:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use DateTime;\\n\\n/**\\n * Determine the time at which the listener should timeout.\\n */\\npublic function retryUntil(): DateTime\\n{\\n    return now()-\u003eaddMinutes(5);\\n}\\n\"}]}]\n76:[\"$\",\"p\",null,{\"children\":[\"If both \",[\"$\",\"code\",null,{\"children\":\"retryUntil\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"tries\"}],\" are defined, Laravel gives precedence to the \",[\"$\",\"code\",null,{\"children\":\"retryUntil\"}],\" method.\"]}]\n77:[\"$\",\"a\",null,{\"name\":\"specifying-queued-listener-backoff\"}]\n78:[\"$\",\"h4\",null,{\"id\":\"specifying-queued-listener-backoff\",\"children\":[\"$\",\"a\",null,{\"href\":\"#specifying-queued-listener-backoff\",\"children\":\"Specifying Queued Listener Backoff\"}]}]\n79:[\"$\",\"p\",null,{\"children\":[\"If you would like to configure how many seconds Laravel should wait before retrying a listener that has encountered an exception, you may do so by defining a \",[\"$\",\"code\",null,{\"children\":\"backoff\"}],\" property on your listener class:\"]}]\n7a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * The number of seconds to wait before retrying the queued listener.\\n *\\n * @var int\\n */\\npublic $backoff = 3;\\n\"}]}]\n7b:[\"$\",\"p\",null,{\"children\":[\"If you require more complex logic for determining the listeners's backoff time, you may define a \",[\"$\",\"code\",null"])</script><script>self.__next_f.push([1,",{\"children\":\"backoff\"}],\" method on your listener class:\"]}]\n7c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Calculate the number of seconds to wait before retrying the queued listener.\\n */\\npublic function backoff(OrderShipped $event): int\\n{\\n    return 3;\\n}\\n\"}]}]\n7d:[\"$\",\"p\",null,{\"children\":[\"You may easily configure \\\"exponential\\\" backoffs by returning an array of backoff values from the \",[\"$\",\"code\",null,{\"children\":\"backoff\"}],\" method. In this example, the retry delay will be 1 second for the first retry, 5 seconds for the second retry, 10 seconds for the third retry, and 10 seconds for every subsequent retry if there are more attempts remaining:\"]}]\n7e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Calculate the number of seconds to wait before retrying the queued listener.\\n *\\n * @return list\u003cint\u003e\\n */\\npublic function backoff(OrderShipped $event): array\\n{\\n    return [1, 5, 10];\\n}\\n\"}]}]\n7f:[\"$\",\"a\",null,{\"name\":\"specifying-queued-listener-max-exceptions\"}]\n80:[\"$\",\"h4\",null,{\"id\":\"specifying-queued-listener-max-exceptions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#specifying-queued-listener-max-exceptions\",\"children\":\"Specifying Queued Listener Max Exceptions\"}]}]\n81:[\"$\",\"p\",null,{\"children\":[\"Sometimes you may wish to specify that a queued listener may be attempted many times, but should fail if the retries are triggered by a given number of unhandled exceptions (as opposed to being released by the \",[\"$\",\"code\",null,{\"children\":\"release\"}],\" method directly). To accomplish this, you may define a \",[\"$\",\"code\",null,{\"children\":\"maxExceptions\"}],\" property on your listener class:\"]}]\n82:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\nuse Illuminate\\\\Queue\\\\InteractsWithQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    use InteractsWithQueue;\\n\\n    /**\\n     * The number of times the queued listener may be attempted.\\n     *\\n     * @var int\\n     */\\n    public $tries = 25;\\n\\n    /**\\n     * The maximum number of unhandled exceptions to allow before failing.\\n     *\\n     * @var int\\n     */\\n    public $maxExceptions = 3;\\n\\n    /**\\n     * Handle the event.\\n     */\\n    public function handle(OrderShipped $event): void\\n    {\\n        // Process the event...\\n    }\\n}\\n\"}]}]\n83:[\"$\",\"p\",null,{\"children\":\"In this example, the listener will be retried up to 25 times. However, the listener will fail if three unhandled exceptions are thrown by the listener.\"}]\n84:[\"$\",\"a\",null,{\"name\":\"specifying-queued-listener-timeout\"}]\n85:[\"$\",\"h4\",null,{\"id\":\"specifying-queued-listener-timeout\",\"children\":[\"$\",\"a\",null,{\"href\":\"#specifying-queued-listener-timeout\",\"children\":\"Specifying Queued Listener Timeout\"}]}]\n86:[\"$\",\"p\",null,{\"children\":[\"Often, you know roughly how long you expect your queued listeners to take. For this reason, Laravel allows you to specify a \\\"timeout\\\" value. If a listener is processing for longer than the number of seconds specified by the timeout value, the worker processing the listener will exit with an error. You may define the maximum number of seconds a listener should be allowed to run by defining a \",[\"$\",\"code\",null,{\"children\":\"timeout\"}],\" property on your listener class:\"]}]\n87:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    /**\\n     * The number of seconds the listener can run before timing out.\\n     *\\n     * @var int\\n     */\\n    public $timeout = 120;\\n}\\n\"}]}]\n88:[\"$\",\"p\",null,{\"children\":[\"If you would like to indicate that a listener should be marked as failed on timeout, you may define the \",[\"$\",\"code\",null,{\"children\":\"failOnTimeout\"}],\" property on the listener class:\"]}]\n89:[\"$\",\"pr"])</script><script>self.__next_f.push([1,"e\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Contracts\\\\Queue\\\\ShouldQueue;\\n\\nclass SendShipmentNotification implements ShouldQueue\\n{\\n    /**\\n     * Indicate if the listener should be marked as failed on timeout.\\n     *\\n     * @var bool\\n     */\\n    public $failOnTimeout = true;\\n}\\n\"}]}]\n8a:[\"$\",\"a\",null,{\"name\":\"dispatching-events\"}]\n8b:[\"$\",\"h2\",null,{\"id\":\"dispatching-events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#dispatching-events\",\"children\":\"Dispatching Events\"}]}]\n8c:[\"$\",\"p\",null,{\"children\":[\"To dispatch an event, you may call the static \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\" method on the event. This method is made available on the event by the \",[\"$\",\"code\",null,{\"children\":\"Illuminate\\\\Foundation\\\\Events\\\\Dispatchable\"}],\" trait. Any arguments passed to the \",[\"$\",\"code\",null,{\"children\":\"dispatch\"}],\" method will be passed to the event's constructor:\"]}]\n8d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Http\\\\Controllers;\\n\\nuse App\\\\Events\\\\OrderShipped;\\nuse App\\\\Models\\\\Order;\\nuse Illuminate\\\\Http\\\\RedirectResponse;\\nuse Illuminate\\\\Http\\\\Request;\\n\\nclass OrderShipmentController extends Controller\\n{\\n    /**\\n     * Ship the given order.\\n     */\\n    public function store(Request $request): RedirectResponse\\n    {\\n        $order = Order::findOrFail($request-\u003eorder_id);\\n\\n        // Order shipment logic...\\n\\n        OrderShipped::dispatch($order);\\n\\n        return redirect('/orders');\\n    }\\n}\\n\"}]}]\n8e:[\"$\",\"p\",null,{\"children\":[\"If you would like to conditionally dispatch an event, you may use the \",[\"$\",\"code\",null,{\"children\":\"dispatchIf\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"dispatchUnless\"}],\" methods:\"]}]\n8f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"OrderShipped::dispatchIf($condition, $order);\\n\\nOrderShipped::dispatchUnless($condition, $order);\\n\"}]}]\n90:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!NOTE]\\nWhen testing, it can be helpful to assert that certain events were dispatched without actually triggering their listeners. Laravel's \",[\"$\",\"a\",null,{\"href\":\"#testing\",\"children\":\"built-in testing helpers\"}],\" make it a cinch.\"]}],\"\\n\"]}]\n91:[\"$\",\"a\",null,{\"name\":\"dispatching-events-after-database-transactions\"}]\n92:[\"$\",\"h3\",null,{\"id\":\"dispatching-events-after-database-transactions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#dispatching-events-after-database-transactions\",\"children\":\"Dispatching Events After Database Transactions\"}]}]\n93:[\"$\",\"p\",null,{\"children\":[\"Sometimes, you may want to instruct Laravel to only dispatch an event after the active database transaction has committed. To do so, you may implement the \",[\"$\",\"code\",null,{\"children\":\"ShouldDispatchAfterCommit\"}],\" interface on the event class.\"]}]\n94:[\"$\",\"p\",null,{\"children\":\"This interface instructs Laravel to not dispatch the event until the current database transaction is committed. If the transaction fails, the event will be discarded. If no database transaction is in progress when the event is dispatched, the event will be dispatched immediately:\"}]\n95:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Events;\\n\\nuse App\\\\Models\\\\Order;\\nuse Illuminate\\\\Broadcasting\\\\InteractsWithSockets;\\nuse Illuminate\\\\Contracts\\\\Events\\\\ShouldDispatchAfterCommit;\\nuse Illuminate\\\\Foundation\\\\Events\\\\Dispatchable;\\nuse Illuminate\\\\Queue\\\\SerializesModels;\\n\\nclass OrderShipped implements ShouldDispatchAfterCommit\\n{\\n    use Dispatchable, InteractsWithSockets, SerializesModels;\\n\\n    /**\\n     * Create a new event instance.\\n     */\\n    public function __construct(\\n        public Order $order,\\n    ) {}\\n}\\n\"}]}]\n96:[\"$\",\"a\",null,{\"name\":\"deferring-events\"}]\n97:[\"$\",\"h3\",null,{\"id\":\"deferring-events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#deferring-events\",\"children\":\"Deferring Events\"}]}]\n98:[\"$\",\"p\",null,{\"children\":\"Def"])</script><script>self.__next_f.push([1,"erred events allow you to delay the dispatching of model events and execution of event listeners until after a specific block of code has completed. This is particularly useful when you need to ensure that all related records are created before event listeners are triggered.\"}]\n99:[\"$\",\"p\",null,{\"children\":[\"To defer events, provide a closure to the \",[\"$\",\"code\",null,{\"children\":\"Event::defer()\"}],\" method:\"]}]\n9a:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\nEvent::defer(function () {\\n    $user = User::create(['name' =\u003e 'Victoria Otwell']);\\n\\n    $user-\u003eposts()-\u003ecreate(['title' =\u003e 'My first post!']);\\n});\\n\"}]}]\n9b:[\"$\",\"p\",null,{\"children\":\"All events triggered within the closure will be dispatched after the closure is executed. This ensures that event listeners have access to all related records that were created during the deferred execution. If an exception occurs within the closure, the deferred events will not be dispatched.\"}]\n9c:[\"$\",\"p\",null,{\"children\":[\"To defer only specific events, pass an array of events as the second argument to the \",[\"$\",\"code\",null,{\"children\":\"defer\"}],\" method:\"]}]\n9d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"use App\\\\Models\\\\User;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\nEvent::defer(function () {\\n    $user = User::create(['name' =\u003e 'Victoria Otwell']);\\n\\n    $user-\u003eposts()-\u003ecreate(['title' =\u003e 'My first post!']);\\n}, ['eloquent.created: '.User::class]);\\n\"}]}]\n9e:[\"$\",\"a\",null,{\"name\":\"event-subscribers\"}]\n9f:[\"$\",\"h2\",null,{\"id\":\"event-subscribers\",\"children\":[\"$\",\"a\",null,{\"href\":\"#event-subscribers\",\"children\":\"Event Subscribers\"}]}]\na0:[\"$\",\"a\",null,{\"name\":\"writing-event-subscribers\"}]\na1:[\"$\",\"h3\",null,{\"id\":\"writing-event-subscribers\",\"children\":[\"$\",\"a\",null,{\"href\":\"#writing-event-subscribers\",\"children\":\"Writing Event Subscribers\"}]}]\na2:[\"$\",\"p\",null,{\"children\":[\"Event subscribers are classes that may subscribe to multiple events from within the subscriber class itself, allowing you to define several event handlers within a single class. Subscribers should define a \",[\"$\",\"code\",null,{\"children\":\"subscribe\"}],\" method, which receives an event dispatcher instance. You may call the \",[\"$\",\"code\",null,{\"children\":\"listen\"}],\" method on the given dispatcher to register event listeners:\"]}]\na3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse Illuminate\\\\Auth\\\\Events\\\\Login;\\nuse Illuminate\\\\Auth\\\\Events\\\\Logout;\\nuse Illuminate\\\\Events\\\\Dispatcher;\\n\\nclass UserEventSubscriber\\n{\\n    /**\\n     * Handle user login events.\\n     */\\n    public function handleUserLogin(Login $event): void {}\\n\\n    /**\\n     * Handle user logout events.\\n     */\\n    public function handleUserLogout(Logout $event): void {}\\n\\n    /**\\n     * Register the listeners for the subscriber.\\n     */\\n    public function subscribe(Dispatcher $events): void\\n    {\\n        $events-\u003elisten(\\n            Login::class,\\n            [UserEventSubscriber::class, 'handleUserLogin']\\n        );\\n\\n        $events-\u003elisten(\\n            Logout::class,\\n            [UserEventSubscriber::class, 'handleUserLogout']\\n        );\\n    }\\n}\\n\"}]}]\na4:[\"$\",\"p\",null,{\"children\":[\"If your event listener methods are defined within the subscriber itself, you may find it more convenient to return an array of events and method names from the subscriber's \",[\"$\",\"code\",null,{\"children\":\"subscribe\"}],\" method. Laravel will automatically determine the subscriber's class name when registering the event listeners:\"]}]\na5:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Listeners;\\n\\nuse Illuminate\\\\Auth\\\\Events\\\\Login;\\nuse Illuminate\\\\Auth\\\\Events\\\\Logout;\\nuse Illuminate\\\\Events\\\\Dispatcher;\\n\\nclass UserEventSubscriber\\n{\\n    /**\\n     * Handle user login events.\\n     */\\n    public function handleUserLogin(Login $event): void {}\\n\\n "])</script><script>self.__next_f.push([1,"   /**\\n     * Handle user logout events.\\n     */\\n    public function handleUserLogout(Logout $event): void {}\\n\\n    /**\\n     * Register the listeners for the subscriber.\\n     *\\n     * @return array\u003cstring, string\u003e\\n     */\\n    public function subscribe(Dispatcher $events): array\\n    {\\n        return [\\n            Login::class =\u003e 'handleUserLogin',\\n            Logout::class =\u003e 'handleUserLogout',\\n        ];\\n    }\\n}\\n\"}]}]\na6:[\"$\",\"a\",null,{\"name\":\"registering-event-subscribers\"}]\na7:[\"$\",\"h3\",null,{\"id\":\"registering-event-subscribers\",\"children\":[\"$\",\"a\",null,{\"href\":\"#registering-event-subscribers\",\"children\":\"Registering Event Subscribers\"}]}]\na8:[\"$\",\"p\",null,{\"children\":[\"After writing the subscriber, Laravel will automatically register handler methods within the subscriber if they follow Laravel's \",[\"$\",\"a\",null,{\"href\":\"#event-discovery\",\"children\":\"event discovery conventions\"}],\". Otherwise, you may manually register your subscriber using the \",[\"$\",\"code\",null,{\"children\":\"subscribe\"}],\" method of the \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\" facade. Typically, this should be done within the \",[\"$\",\"code\",null,{\"children\":\"boot\"}],\" method of your application's \",[\"$\",\"code\",null,{\"children\":\"AppServiceProvider\"}],\":\"]}]\na9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace App\\\\Providers;\\n\\nuse App\\\\Listeners\\\\UserEventSubscriber;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\nuse Illuminate\\\\Support\\\\ServiceProvider;\\n\\nclass AppServiceProvider extends ServiceProvider\\n{\\n    /**\\n     * Bootstrap any application services.\\n     */\\n    public function boot(): void\\n    {\\n        Event::subscribe(UserEventSubscriber::class);\\n    }\\n}\\n\"}]}]\naa:[\"$\",\"a\",null,{\"name\":\"testing\"}]\nab:[\"$\",\"h2\",null,{\"id\":\"testing\",\"children\":[\"$\",\"a\",null,{\"href\":\"#testing\",\"children\":\"Testing\"}]}]\nac:[\"$\",\"p\",null,{\"children\":[\"When testing code that dispatches events, you may wish to instruct Laravel to not actually execute the event's listeners, since the listener's code can be tested directly and separately of the code that dispatches the corresponding event. Of course, to test the listener itself, you may instantiate a listener instance and invoke the \",[\"$\",\"code\",null,{\"children\":\"handle\"}],\" method directly in your test.\"]}]\nad:[\"$\",\"p\",null,{\"children\":[\"Using the \",[\"$\",\"code\",null,{\"children\":\"Event\"}],\" facade's \",[\"$\",\"code\",null,{\"children\":\"fake\"}],\" method, you may prevent listeners from executing, execute the code under test, and then assert which events were dispatched by your application using the \",[\"$\",\"code\",null,{\"children\":\"assertDispatched\"}],\", \",[\"$\",\"code\",null,{\"children\":\"assertNotDispatched\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"assertNothingDispatched\"}],\" methods:\"]}]\nae:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse App\\\\Events\\\\OrderFailedToShip;\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\ntest('orders can be shipped', function () {\\n    Event::fake();\\n\\n    // Perform order shipping...\\n\\n    // Assert that an event was dispatched...\\n    Event::assertDispatched(OrderShipped::class);\\n\\n    // Assert an event was dispatched twice...\\n    Event::assertDispatched(OrderShipped::class, 2);\\n\\n    // Assert an event was dispatched once...\\n    Event::assertDispatchedOnce(OrderShipped::class);\\n\\n    // Assert an event was not dispatched...\\n    Event::assertNotDispatched(OrderFailedToShip::class);\\n\\n    // Assert that no events were dispatched...\\n    Event::assertNothingDispatched();\\n});\\n\"}]}]\naf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace Tests\\\\Feature;\\n\\nuse App\\\\Events\\\\OrderFailedToShip;\\nuse App\\\\Events\\\\OrderShipped;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\nuse Tests\\\\TestCase;\\n\\nclass ExampleTest extends TestCase\\n{\\n    /**\\n     * Test order shipping.\\n     */\\n    public function test_orders_can_be_shipped(): void\\n    {\\n        Event::fake();\\n\\n        // Perform ord"])</script><script>self.__next_f.push([1,"er shipping...\\n\\n        // Assert that an event was dispatched...\\n        Event::assertDispatched(OrderShipped::class);\\n\\n        // Assert an event was dispatched twice...\\n        Event::assertDispatched(OrderShipped::class, 2);\\n\\n        // Assert an event was dispatched once...\\n        Event::assertDispatchedOnce(OrderShipped::class);\\n\\n        // Assert an event was not dispatched...\\n        Event::assertNotDispatched(OrderFailedToShip::class);\\n\\n        // Assert that no events were dispatched...\\n        Event::assertNothingDispatched();\\n    }\\n}\\n\"}]}]\nb0:[\"$\",\"p\",null,{\"children\":[\"You may pass a closure to the \",[\"$\",\"code\",null,{\"children\":\"assertDispatched\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"assertNotDispatched\"}],\" methods in order to assert that an event was dispatched that passes a given \\\"truth test\\\". If at least one event was dispatched that passes the given truth test then the assertion will be successful:\"]}]\nb1:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Event::assertDispatched(function (OrderShipped $event) use ($order) {\\n    return $event-\u003eorder-\u003eid === $order-\u003eid;\\n});\\n\"}]}]\nb2:[\"$\",\"p\",null,{\"children\":[\"If you would simply like to assert that an event listener is listening to a given event, you may use the \",[\"$\",\"code\",null,{\"children\":\"assertListening\"}],\" method:\"]}]\nb3:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Event::assertListening(\\n    OrderShipped::class,\\n    SendShipmentNotification::class\\n);\\n\"}]}]\nb4:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[!WARNING]\\nAfter calling \",[\"$\",\"code\",null,{\"children\":\"Event::fake()\"}],\", no event listeners will be executed. So, if your tests use model factories that rely on events, such as creating a UUID during a model's \",[\"$\",\"code\",null,{\"children\":\"creating\"}],\" event, you should call \",[\"$\",\"code\",null,{\"children\":\"Event::fake()\"}],\" \",[\"$\",\"strong\",null,{\"children\":\"after\"}],\" using your factories.\"]}],\"\\n\"]}]\nb5:[\"$\",\"a\",null,{\"name\":\"faking-a-subset-of-events\"}]\nb6:[\"$\",\"h3\",null,{\"id\":\"faking-a-subset-of-events\",\"children\":[\"$\",\"a\",null,{\"href\":\"#faking-a-subset-of-events\",\"children\":\"Faking a Subset of Events\"}]}]\nb7:[\"$\",\"p\",null,{\"children\":[\"If you only want to fake event listeners for a specific set of events, you may pass them to the \",[\"$\",\"code\",null,{\"children\":\"fake\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"fakeFor\"}],\" method:\"]}]\nb8:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"test('orders can be processed', function () {\\n    Event::fake([\\n        OrderCreated::class,\\n    ]);\\n\\n    $order = Order::factory()-\u003ecreate();\\n\\n    Event::assertDispatched(OrderCreated::class);\\n\\n    // Other events are dispatched as normal...\\n    $order-\u003eupdate([\\n        // ...\\n    ]);\\n});\\n\"}]}]\nb9:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"/**\\n * Test order process.\\n */\\npublic function test_orders_can_be_processed(): void\\n{\\n    Event::fake([\\n        OrderCreated::class,\\n    ]);\\n\\n    $order = Order::factory()-\u003ecreate();\\n\\n    Event::assertDispatched(OrderCreated::class);\\n\\n    // Other events are dispatched as normal...\\n    $order-\u003eupdate([\\n        // ...\\n    ]);\\n}\\n\"}]}]\nba:[\"$\",\"p\",null,{\"children\":[\"You may fake all events except for a set of specified events using the \",[\"$\",\"code\",null,{\"children\":\"except\"}],\" method:\"]}]\nbb:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"Event::fake()-\u003eexcept([\\n    OrderCreated::class,\\n]);\\n\"}]}]\nbc:[\"$\",\"a\",null,{\"name\":\"scoped-event-fakes\"}]\nbd:[\"$\",\"h3\",null,{\"id\":\"scoped-event-fakes\",\"children\":[\"$\",\"a\",null,{\"href\":\"#scoped-event-fakes\",\"children\":\"Scoped Event Fakes\"}]}]\nbe:[\"$\",\"p\",null,{\"children\":[\"If you only want to fake event listeners for a portion of your test, you may use the \",[\"$\",\"code\",null,{\"children\":\"fakeFor\"}],\" method:\"]}]\nbf:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nuse App"])</script><script>self.__next_f.push([1,"\\\\Events\\\\OrderCreated;\\nuse App\\\\Models\\\\Order;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\n\\ntest('orders can be processed', function () {\\n    $order = Event::fakeFor(function () {\\n        $order = Order::factory()-\u003ecreate();\\n\\n        Event::assertDispatched(OrderCreated::class);\\n\\n        return $order;\\n    });\\n\\n    // Events are dispatched as normal and observers will run...\\n    $order-\u003eupdate([\\n        // ...\\n    ]);\\n});\\n\"}]}]\nc0:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-php\",\"children\":\"\u003c?php\\n\\nnamespace Tests\\\\Feature;\\n\\nuse App\\\\Events\\\\OrderCreated;\\nuse App\\\\Models\\\\Order;\\nuse Illuminate\\\\Support\\\\Facades\\\\Event;\\nuse Tests\\\\TestCase;\\n\\nclass ExampleTest extends TestCase\\n{\\n    /**\\n     * Test order process.\\n     */\\n    public function test_orders_can_be_processed(): void\\n    {\\n        $order = Event::fakeFor(function () {\\n            $order = Order::factory()-\u003ecreate();\\n\\n            Event::assertDispatched(OrderCreated::class);\\n\\n            return $order;\\n        });\\n\\n        // Events are dispatched as normal and observers will run...\\n        $order-\u003eupdate([\\n            // ...\\n        ]);\\n    }\\n}\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"c1:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$Lc1\",\"3\",{}]]\n8:null\n"])</script></body></html>