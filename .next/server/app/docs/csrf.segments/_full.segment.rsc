1:"$Sreact.fragment"
2:I[39756,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"default"]
3:I[37457,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"default"]
4:I[93649,["/_next/static/chunks/796e69ae18b2784c.js","/_next/static/chunks/97c0560122aa0f49.js"],"DocsSidebar"]
6:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"OutletBoundary"]
7:"$Sreact.suspense"
9:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"ViewportBoundary"]
b:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"MetadataBoundary"]
d:I[68027,[],"default"]
:HL["/_next/static/chunks/8d8bfdb8c7183f74.css","style"]
:HL["/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
0:{"P":null,"b":"c2cpI4EdIeAozP6eEqxqR","c":["","docs","csrf"],"q":"","i":false,"f":[[["",{"children":["docs",{"children":[["slug","csrf","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/8d8bfdb8c7183f74.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]]}],{"children":[["$","$1","c",{"children":[[["$","script","script-0",{"src":"/_next/static/chunks/796e69ae18b2784c.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/97c0560122aa0f49.js","async":true,"nonce":"$undefined"}]],["$","div",null,{"className":"flex min-h-screen bg-background","children":[["$","$L4",null,{}],["$","main",null,{"className":"flex-1 relative","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$","$7",null,{"name":"Next.MetadataOutlet","children":"$@8"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],["$","$1","h",{"children":[null,["$","$L9",null,{"children":"$@a"}],["$","div",null,{"hidden":true,"children":["$","$Lb",null,{"children":["$","$7",null,{"name":"Next.Metadata","children":"$@c"}]}]}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],false]],"m":"$undefined","G":["$d",[]],"S":true}
5:["$","div",null,{"className":"container mx-auto py-10","children":["$","div",null,{"className":"mx-auto max-w-3xl","children":[["$","div",null,{"className":"mb-8","children":[["$","h1",null,{"className":"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl","children":"CSRF Protection"}],["$","p",null,{"className":"text-xl text-muted-foreground mt-2","children":"CSRF Protection"}]]}],["$","article",null,{"className":"prose prose-slate dark:prose-invert max-w-none","children":[["$","h1",null,{"id":"csrf-保護-csrf-protection","children":["$","a",null,{"href":"#csrf-保護-csrf-protection","children":"CSRF 保護 (CSRF Protection)"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"#csrf-introduction","children":"簡介"}]}],"\n",["$","li",null,{"children":[["$","a",null,{"href":"#preventing-csrf-requests","children":"防止 CSRF 請求"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"#csrf-excluding-uris","children":"排除特定 URI"}]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"#csrf-x-csrf-token","children":"X-CSRF-Token"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"#csrf-x-xsrf-token","children":"X-XSRF-Token"}]}],"\n"]}],"\n",["$","a",null,{"name":"csrf-introduction"}],"\n",["$","h2",null,{"id":"簡介","children":["$","a",null,{"href":"#簡介","children":"簡介"}]}],"\n",["$","p",null,{"children":["跨站請求偽造 (Cross-site request forgery) 是一種惡意攻擊，會在使用者已通過驗證的情況下代為執行未經授權的操作。所幸，Laravel 讓你可以輕鬆防止 ",["$","a",null,{"href":"https://en.wikipedia.org/wiki/Cross-site_request_forgery","children":"CSRF 攻擊"}],"。"]}],"\n",["$","a",null,{"name":"csrf-explanation"}],"\n",["$","h4",null,{"id":"漏洞說明","children":["$","a",null,{"href":"#漏洞說明","children":"漏洞說明"}]}],"\n",["$","p",null,{"children":["若你對跨站請求偽造不熟悉，我們來看一個可能被濫用的例子。假設應用程式有個 ",["$","code",null,{"children":"/user/email"}]," 路由，可接受 ",["$","code",null,{"children":"POST"}]," 請求來修改已驗證使用者的 Email。通常該路由會期待 ",["$","code",null,{"children":"email"}]," 輸入欄位包含使用者想改用的 Email。"]}],"\n",["$","p",null,{"children":["沒有 CSRF 保護時，惡意網站可以建立一個 HTML 表單，指向你應用程式的 ",["$","code",null,{"children":"/user/email"}]," 路由，並送出惡意使用者自己的 Email："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-blade","children":"<form action=\"https://your-application.com/user/email\" method=\"POST\">\n    <input type=\"email\" value=\"malicious-email@example.com\">\n</form>\n\n<script>\n    document.forms[0].submit();\n</script>\n"}]}],"\n",["$","p",null,{"children":"若該惡意網站在載入頁面時自動送出表單，攻擊者只要誘使你應用程式的使用者造訪該網站，就能將帳號 Email 變成惡意使用者的 Email。"}],"\n",["$","p",null,{"children":["為了避免這種漏洞，我們需要在每個進來的 ",["$","code",null,{"children":"POST"}],"、",["$","code",null,{"children":"PUT"}],"、",["$","code",null,{"children":"PATCH"}]," 或 ",["$","code",null,{"children":"DELETE"}]," 請求上檢查一組惡意應用程式無法得知的秘密 Session 值。"]}],"\n",["$","a",null,{"name":"preventing-csrf-requests"}],"\n",["$","h2",null,{"id":"防止-csrf-請求","children":["$","a",null,{"href":"#防止-csrf-請求","children":"防止 CSRF 請求"}]}],"\n",["$","p",null,{"children":["Laravel 會為每個由應用程式管理的作用中 ",["$","a",null,{"href":"/docs/%7B'12.x'%7D/session","children":"使用者 Session"}]," 自動產生一組 CSRF「Token」。這組 Token 用來確認實際發出請求的人就是該已驗證使用者。由於 Token 儲存在使用者的 Session 中，且每次重新產生 Session 時都會更新，惡意應用程式無法取得它。"]}],"\n",["$","p",null,{"children":["當前 Session 的 CSRF Token 可以透過 Request 的 Session 或 ",["$","code",null,{"children":"csrf_token"}]," 輔助函式存取："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"use Illuminate\\Http\\Request;\n\nRoute::get('/token', function (Request $request) {\n    $token = $request->session()->token();\n\n    $token = csrf_token();\n\n    // ...\n});\n"}]}],"\n",["$","p",null,{"children":["只要你在應用程式中建立「POST」、「PUT」、「PATCH」或「DELETE」的 HTML 表單，就應該在表單內加入隱藏的 CSRF ",["$","code",null,{"children":"_token"}]," 欄位，讓 CSRF 保護 Middleware 能驗證請求。為了方便，你可以使用 ",["$","code",null,{"children":"@csrf"}]," Blade 指示詞來產生隱藏的 Token 輸入欄位："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-blade","children":"<form method=\"POST\" action=\"/profile\">\n    @csrf\n\n    <!-- Equivalent to... -->\n    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\" />\n</form>\n"}]}],"\n",["$","p",null,{"children":["預設包含在 ",["$","code",null,{"children":"web"}]," Middleware 群組內的 ",["$","code",null,{"children":"Illuminate\\Foundation\\Http\\Middleware\\ValidateCsrfToken"}]," ",["$","a",null,{"href":"/docs/%7B'12.x'%7D/middleware","children":"Middleware"}]," 會自動驗證請求輸入中的 Token 是否與 Session 儲存的 Token 相符。當兩者一致時，我們便能確認是已驗證使用者正在發起請求。"]}],"\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21"]}]]}]}]
e:["$","a",null,{"name":"csrf-tokens-and-spas"}]
f:["$","h3",null,{"id":"csrf-token-與-spa","children":["$","a",null,{"href":"#csrf-token-與-spa","children":"CSRF Token 與 SPA"}]}]
10:["$","p",null,{"children":["若你正在建立以 Laravel 作為 API 後端的 SPA，請參考 ",["$","a",null,{"href":"/docs/%7B'12.x'%7D/sanctum","children":"Laravel Sanctum 文件"}],"，瞭解如何與 API 進行驗證並防止 CSRF 漏洞。"]}]
11:["$","a",null,{"name":"csrf-excluding-uris"}]
12:["$","h3",null,{"id":"從-csrf-保護中排除-uri","children":["$","a",null,{"href":"#從-csrf-保護中排除-uri","children":"從 CSRF 保護中排除 URI"}]}]
13:["$","p",null,{"children":["有時你可能想將某些 URI 排除在 CSRF 保護之外。例如，若你使用 ",["$","a",null,{"href":"https://stripe.com","children":"Stripe"}]," 處理付款並採用他們的 Webhook 系統，就必須將 Stripe Webhook 處理路由排除，因為 Stripe 無法得知要傳給你路由的 CSRF Token。"]}]
14:["$","p",null,{"children":["一般來說，應該把這類路由放在 Laravel 自動套用於 ",["$","code",null,{"children":"routes/web.php"}]," 的 ",["$","code",null,{"children":"web"}]," Middleware 群組之外。不過，你也可以在應用程式的 ",["$","code",null,{"children":"bootstrap/app.php"}]," 中，透過 ",["$","code",null,{"children":"validateCsrfTokens"}]," 方法提供 URI 來排除特定路由："]}]
15:["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"->withMiddleware(function (Middleware $middleware): void {\n    $middleware->validateCsrfTokens(except: [\n        'stripe/*',\n        'http://example.com/foo/bar',\n        'http://example.com/foo/*',\n    ]);\n})\n"}]}]
16:["$","blockquote",null,{"children":["\n",["$","p",null,{"children":["[!NOTE]\n為了方便，",["$","a",null,{"href":"/docs/%7B'12.x'%7D/testing","children":"執行測試"}],"時會自動停用所有路由的 CSRF Middleware。"]}],"\n"]}]
17:["$","a",null,{"name":"csrf-x-csrf-token"}]
18:["$","h2",null,{"id":"x-csrf-token","children":["$","a",null,{"href":"#x-csrf-token","children":"X-CSRF-TOKEN"}]}]
19:["$","p",null,{"children":["除了檢查作為 POST 參數的 CSRF Token 外，預設包含在 ",["$","code",null,{"children":"web"}]," Middleware 群組內的 ",["$","code",null,{"children":"Illuminate\\Foundation\\Http\\Middleware\\ValidateCsrfToken"}]," Middleware 也會檢查 ",["$","code",null,{"children":"X-CSRF-TOKEN"}]," 請求標頭。你可以將 Token 存在 HTML ",["$","code",null,{"children":"meta"}]," 標籤中："]}]
1a:["$","pre",null,{"children":["$","code",null,{"className":"language-blade","children":"<meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">\n"}]}]
1b:["$","p",null,{"children":"接著，你可以指示像 jQuery 這樣的函式庫，自動將 Token 加到所有請求標頭。這能為使用傳統 JavaScript 技術的 AJAX 應用程式提供簡單且便利的 CSRF 保護："}]
1c:["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"$$.ajaxSetup({\n  headers: {\n    \"X-CSRF-TOKEN\": $('meta[name=\"csrf-token\"]').attr(\"content\"),\n  },\n});\n"}]}]
1d:["$","a",null,{"name":"csrf-x-xsrf-token"}]
1e:["$","h2",null,{"id":"x-xsrf-token","children":["$","a",null,{"href":"#x-xsrf-token","children":"X-XSRF-TOKEN"}]}]
1f:["$","p",null,{"children":["Laravel 會將目前的 CSRF Token 儲存在加密的 ",["$","code",null,{"children":"XSRF-TOKEN"}]," Cookie 中，且每個由框架產生的回應都會包含此 Cookie。你可以使用 Cookie 的值來設定 ",["$","code",null,{"children":"X-XSRF-TOKEN"}]," 請求標頭。"]}]
20:["$","p",null,{"children":["此 Cookie 主要是為了方便開發者，因為某些 JavaScript 框架與函式庫（例如 Angular 與 Axios）會在同來源請求上自動將它的值放進 ",["$","code",null,{"children":"X-XSRF-TOKEN"}]," 標頭。"]}]
21:["$","blockquote",null,{"children":["\n",["$","p",null,{"children":["[!NOTE]\n預設情況下，",["$","code",null,{"children":"resources/js/bootstrap.js"}]," 會載入 Axios HTTP 函式庫，它會自動幫你送出 ",["$","code",null,{"children":"X-XSRF-TOKEN"}]," 標頭。"]}],"\n"]}]
a:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
22:I[27201,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"IconMark"]
c:[["$","title","0",{"children":"Create Next App"}],["$","meta","1",{"name":"description","content":"Generated by create next app"}],["$","link","2",{"rel":"icon","href":"/favicon.ico?favicon.0b3bf435.ico","sizes":"256x256","type":"image/x-icon"}],["$","$L22","3",{}]]
8:null
